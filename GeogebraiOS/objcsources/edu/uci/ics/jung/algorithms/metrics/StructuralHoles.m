//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/edu/uci/ics/jung/algorithms/metrics/StructuralHoles.java
//


#include "J2ObjC_source.h"
#include "edu/uci/ics/jung/algorithms/metrics/StructuralHoles.h"
#include "edu/uci/ics/jung/graph/Graph.h"
#include "java/lang/Double.h"
#include "java/lang/Math.h"
#include "java/util/Collection.h"
#include "org/apache/commons/collections15/Transformer.h"

@implementation EduUciIcsJungAlgorithmsMetricsStructuralHoles

- (instancetype)initWithEduUciIcsJungGraphGraph:(id<EduUciIcsJungGraphGraph>)graph
   withOrgApacheCommonsCollections15Transformer:(id<OrgApacheCommonsCollections15Transformer>)nev {
  EduUciIcsJungAlgorithmsMetricsStructuralHoles_initWithEduUciIcsJungGraphGraph_withOrgApacheCommonsCollections15Transformer_(self, graph, nev);
  return self;
}

- (jdouble)effectiveSizeWithId:(id)v {
  jdouble result = [((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) degreeWithId:v];
  for (id __strong u in nil_chk([g_ getNeighborsWithId:v])) {
    for (id __strong w in nil_chk([g_ getNeighborsWithId:u])) {
      if (w != v && w != u) result -= [self normalizedMutualEdgeWeightWithId:v withId:w] * [self maxScaledMutualEdgeWeightWithId:u withId:w];
    }
  }
  return result;
}

- (jdouble)efficiencyWithId:(id)v {
  jdouble degree = [((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) degreeWithId:v];
  if (degree == 0) return 0;
  else return [self effectiveSizeWithId:v] / degree;
}

- (jdouble)constraintWithId:(id)v {
  jdouble result = 0;
  for (id __strong w in nil_chk([((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) getSuccessorsWithId:v])) {
    if (v != w && [g_ isPredecessorWithId:v withId:w]) {
      result += [self localConstraintWithId:v withId:w];
    }
  }
  return result;
}

- (jdouble)hierarchyWithId:(id)v {
  jdouble v_degree = [((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) degreeWithId:v];
  if (v_degree == 0) return JavaLangDouble_NaN;
  if (v_degree == 1) return 1;
  jdouble v_constraint = [self aggregateConstraintWithId:v];
  jdouble numerator = 0;
  for (id __strong w in nil_chk([g_ getNeighborsWithId:v])) {
    if (v != w) {
      jdouble sl_constraint = [self localConstraintWithId:v withId:w] / (v_constraint / v_degree);
      numerator += sl_constraint * JavaLangMath_logWithDouble_(sl_constraint);
    }
  }
  return numerator / (v_degree * JavaLangMath_logWithDouble_(v_degree));
}

- (jdouble)localConstraintWithId:(id)v1
                          withId:(id)v2 {
  jdouble nmew_vw = [self normalizedMutualEdgeWeightWithId:v1 withId:v2];
  jdouble inner_result = 0;
  for (id __strong w in nil_chk([((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) getNeighborsWithId:v1])) {
    inner_result += [self normalizedMutualEdgeWeightWithId:v1 withId:w] * [self normalizedMutualEdgeWeightWithId:w withId:v2];
  }
  return (nmew_vw + inner_result) * (nmew_vw + inner_result);
}

- (jdouble)aggregateConstraintWithId:(id)v {
  jdouble result = 0;
  for (id __strong w in nil_chk([((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) getNeighborsWithId:v])) {
    result += [self localConstraintWithId:v withId:w] * [self organizationalMeasureWithEduUciIcsJungGraphGraph:g_ withId:w];
  }
  return result;
}

- (jdouble)organizationalMeasureWithEduUciIcsJungGraphGraph:(id<EduUciIcsJungGraphGraph>)g
                                                     withId:(id)v {
  return 1.0;
}

- (jdouble)normalizedMutualEdgeWeightWithId:(id)v1
                                     withId:(id)v2 {
  if (v1 == v2) return 0;
  jdouble numerator = [self mutualWeightWithId:v1 withId:v2];
  if (numerator == 0) return 0;
  jdouble denominator = 0;
  for (id __strong v in nil_chk([((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) getNeighborsWithId:v1])) {
    denominator += [self mutualWeightWithId:v1 withId:v];
  }
  if (denominator == 0) return 0;
  return numerator / denominator;
}

- (jdouble)mutualWeightWithId:(id)v1
                       withId:(id)v2 {
  id e12 = [((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) findEdgeWithId:v1 withId:v2];
  id e21 = [g_ findEdgeWithId:v2 withId:v1];
  jdouble w12 = (e12 != nil ? [((NSNumber *) nil_chk([((id<OrgApacheCommonsCollections15Transformer>) nil_chk(edge_weight_)) transformWithId:e12])) doubleValue] : 0);
  jdouble w21 = (e21 != nil ? [((NSNumber *) nil_chk([((id<OrgApacheCommonsCollections15Transformer>) nil_chk(edge_weight_)) transformWithId:e21])) doubleValue] : 0);
  return w12 + w21;
}

- (jdouble)maxScaledMutualEdgeWeightWithId:(id)v1
                                    withId:(id)v2 {
  if (v1 == v2) return 0;
  jdouble numerator = [self mutualWeightWithId:v1 withId:v2];
  if (numerator == 0) return 0;
  jdouble denominator = 0;
  for (id __strong w in nil_chk([((id<EduUciIcsJungGraphGraph>) nil_chk(g_)) getNeighborsWithId:v1])) {
    if (v2 != w) denominator = JavaLangMath_maxWithDouble_withDouble_(numerator, [self mutualWeightWithId:v1 withId:w]);
  }
  if (denominator == 0) return 0;
  return numerator / denominator;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithEduUciIcsJungGraphGraph:withOrgApacheCommonsCollections15Transformer:", "StructuralHoles", NULL, 0x1, NULL, NULL },
    { "effectiveSizeWithId:", "effectiveSize", "D", 0x1, NULL, "(TV;)D" },
    { "efficiencyWithId:", "efficiency", "D", 0x1, NULL, "(TV;)D" },
    { "constraintWithId:", "constraint", "D", 0x1, NULL, "(TV;)D" },
    { "hierarchyWithId:", "hierarchy", "D", 0x1, NULL, "(TV;)D" },
    { "localConstraintWithId:withId:", "localConstraint", "D", 0x1, NULL, "(TV;TV;)D" },
    { "aggregateConstraintWithId:", "aggregateConstraint", "D", 0x1, NULL, "(TV;)D" },
    { "organizationalMeasureWithEduUciIcsJungGraphGraph:withId:", "organizationalMeasure", "D", 0x4, NULL, "(Ledu/uci/ics/jung/graph/Graph<TV;TE;>;TV;)D" },
    { "normalizedMutualEdgeWeightWithId:withId:", "normalizedMutualEdgeWeight", "D", 0x4, NULL, "(TV;TV;)D" },
    { "mutualWeightWithId:withId:", "mutualWeight", "D", 0x4, NULL, "(TV;TV;)D" },
    { "maxScaledMutualEdgeWeightWithId:withId:", "maxScaledMutualEdgeWeight", "D", 0x4, NULL, "(TV;TV;)D" },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "edge_weight_", NULL, 0x4, "Lorg.apache.commons.collections15.Transformer;", NULL, "Lorg/apache/commons/collections15/Transformer<TE;+Ljava/lang/Number;>;",  },
    { "g_", NULL, 0x4, "Ledu.uci.ics.jung.graph.Graph;", NULL, "Ledu/uci/ics/jung/graph/Graph<TV;TE;>;",  },
  };
  static const J2ObjcClassInfo _EduUciIcsJungAlgorithmsMetricsStructuralHoles = { 2, "StructuralHoles", "edu.uci.ics.jung.algorithms.metrics", NULL, 0x1, 11, methods, 2, fields, 0, NULL, 0, NULL, NULL, "<V:Ljava/lang/Object;E:Ljava/lang/Object;>Ljava/lang/Object;" };
  return &_EduUciIcsJungAlgorithmsMetricsStructuralHoles;
}

@end

void EduUciIcsJungAlgorithmsMetricsStructuralHoles_initWithEduUciIcsJungGraphGraph_withOrgApacheCommonsCollections15Transformer_(EduUciIcsJungAlgorithmsMetricsStructuralHoles *self, id<EduUciIcsJungGraphGraph> graph, id<OrgApacheCommonsCollections15Transformer> nev) {
  (void) NSObject_init(self);
  self->g_ = graph;
  self->edge_weight_ = nev;
}

EduUciIcsJungAlgorithmsMetricsStructuralHoles *new_EduUciIcsJungAlgorithmsMetricsStructuralHoles_initWithEduUciIcsJungGraphGraph_withOrgApacheCommonsCollections15Transformer_(id<EduUciIcsJungGraphGraph> graph, id<OrgApacheCommonsCollections15Transformer> nev) {
  EduUciIcsJungAlgorithmsMetricsStructuralHoles *self = [EduUciIcsJungAlgorithmsMetricsStructuralHoles alloc];
  EduUciIcsJungAlgorithmsMetricsStructuralHoles_initWithEduUciIcsJungGraphGraph_withOrgApacheCommonsCollections15Transformer_(self, graph, nev);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(EduUciIcsJungAlgorithmsMetricsStructuralHoles)
