//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/com/vividsolutions/jts/operation/valid/QuadtreeNestedRingTester.java
//


#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "com/vividsolutions/jts/algorithm/CGAlgorithms.h"
#include "com/vividsolutions/jts/geom/Coordinate.h"
#include "com/vividsolutions/jts/geom/Envelope.h"
#include "com/vividsolutions/jts/geom/LinearRing.h"
#include "com/vividsolutions/jts/geomgraph/GeometryGraph.h"
#include "com/vividsolutions/jts/index/quadtree/Quadtree.h"
#include "com/vividsolutions/jts/operation/valid/IsValidOp.h"
#include "com/vividsolutions/jts/operation/valid/QuadtreeNestedRingTester.h"
#include "com/vividsolutions/jts/util/Assert.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"

@interface ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester () {
 @public
  ComVividsolutionsJtsGeomgraphGeometryGraph *graph_;
  id<JavaUtilList> rings_;
  ComVividsolutionsJtsGeomEnvelope *totalEnv_;
  ComVividsolutionsJtsIndexQuadtreeQuadtree *quadtree_;
  ComVividsolutionsJtsGeomCoordinate *nestedPt_;
}

- (void)buildQuadtree;

@end

J2OBJC_FIELD_SETTER(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester, graph_, ComVividsolutionsJtsGeomgraphGeometryGraph *)
J2OBJC_FIELD_SETTER(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester, rings_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester, totalEnv_, ComVividsolutionsJtsGeomEnvelope *)
J2OBJC_FIELD_SETTER(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester, quadtree_, ComVividsolutionsJtsIndexQuadtreeQuadtree *)
J2OBJC_FIELD_SETTER(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester, nestedPt_, ComVividsolutionsJtsGeomCoordinate *)

__attribute__((unused)) static void ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_buildQuadtree(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester *self);

@implementation ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester

- (instancetype)initWithComVividsolutionsJtsGeomgraphGeometryGraph:(ComVividsolutionsJtsGeomgraphGeometryGraph *)graph {
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_initWithComVividsolutionsJtsGeomgraphGeometryGraph_(self, graph);
  return self;
}

- (ComVividsolutionsJtsGeomCoordinate *)getNestedPoint {
  return nestedPt_;
}

- (void)addWithComVividsolutionsJtsGeomLinearRing:(ComVividsolutionsJtsGeomLinearRing *)ring {
  [((id<JavaUtilList>) nil_chk(rings_)) addWithId:ring];
  [((ComVividsolutionsJtsGeomEnvelope *) nil_chk(totalEnv_)) expandToIncludeWithComVividsolutionsJtsGeomEnvelope:[((ComVividsolutionsJtsGeomLinearRing *) nil_chk(ring)) getEnvelopeInternal]];
}

- (jboolean)isNonNested {
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_buildQuadtree(self);
  for (jint i = 0; i < [((id<JavaUtilList>) nil_chk(rings_)) size]; i++) {
    ComVividsolutionsJtsGeomLinearRing *innerRing = (ComVividsolutionsJtsGeomLinearRing *) check_class_cast([rings_ getWithInt:i], [ComVividsolutionsJtsGeomLinearRing class]);
    IOSObjectArray *innerRingPts = [((ComVividsolutionsJtsGeomLinearRing *) nil_chk(innerRing)) getCoordinates];
    id<JavaUtilList> results = [((ComVividsolutionsJtsIndexQuadtreeQuadtree *) nil_chk(quadtree_)) queryWithComVividsolutionsJtsGeomEnvelope:[innerRing getEnvelopeInternal]];
    for (jint j = 0; j < [((id<JavaUtilList>) nil_chk(results)) size]; j++) {
      ComVividsolutionsJtsGeomLinearRing *searchRing = (ComVividsolutionsJtsGeomLinearRing *) check_class_cast([results getWithInt:j], [ComVividsolutionsJtsGeomLinearRing class]);
      IOSObjectArray *searchRingPts = [((ComVividsolutionsJtsGeomLinearRing *) nil_chk(searchRing)) getCoordinates];
      if (innerRing == searchRing) continue;
      if (![((ComVividsolutionsJtsGeomEnvelope *) nil_chk([innerRing getEnvelopeInternal])) intersectsWithComVividsolutionsJtsGeomEnvelope:[searchRing getEnvelopeInternal]]) continue;
      ComVividsolutionsJtsGeomCoordinate *innerRingPt = ComVividsolutionsJtsOperationValidIsValidOp_findPtNotNodeWithComVividsolutionsJtsGeomCoordinateArray_withComVividsolutionsJtsGeomLinearRing_withComVividsolutionsJtsGeomgraphGeometryGraph_(innerRingPts, searchRing, graph_);
      ComVividsolutionsJtsUtilAssert_isTrueWithBoolean_withNSString_(innerRingPt != nil, @"Unable to find a ring point not a node of the search ring");
      jboolean isInside = ComVividsolutionsJtsAlgorithmCGAlgorithms_isPointInRingWithComVividsolutionsJtsGeomCoordinate_withComVividsolutionsJtsGeomCoordinateArray_(innerRingPt, searchRingPts);
      if (isInside) {
        ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_set_nestedPt_(self, innerRingPt);
        return NO;
      }
    }
  }
  return YES;
}

- (void)buildQuadtree {
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_buildQuadtree(self);
}

- (void)dealloc {
  RELEASE_(graph_);
  RELEASE_(rings_);
  RELEASE_(totalEnv_);
  RELEASE_(quadtree_);
  RELEASE_(nestedPt_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithComVividsolutionsJtsGeomgraphGeometryGraph:", "QuadtreeNestedRingTester", NULL, 0x1, NULL, NULL },
    { "getNestedPoint", NULL, "Lcom.vividsolutions.jts.geom.Coordinate;", 0x1, NULL, NULL },
    { "addWithComVividsolutionsJtsGeomLinearRing:", "add", "V", 0x1, NULL, NULL },
    { "isNonNested", NULL, "Z", 0x1, NULL, NULL },
    { "buildQuadtree", NULL, "V", 0x2, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "graph_", NULL, 0x2, "Lcom.vividsolutions.jts.geomgraph.GeometryGraph;", NULL, NULL,  },
    { "rings_", NULL, 0x2, "Ljava.util.List;", NULL, NULL,  },
    { "totalEnv_", NULL, 0x2, "Lcom.vividsolutions.jts.geom.Envelope;", NULL, NULL,  },
    { "quadtree_", NULL, 0x2, "Lcom.vividsolutions.jts.index.quadtree.Quadtree;", NULL, NULL,  },
    { "nestedPt_", NULL, 0x2, "Lcom.vividsolutions.jts.geom.Coordinate;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester = { 2, "QuadtreeNestedRingTester", "com.vividsolutions.jts.operation.valid", NULL, 0x1, 5, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester;
}

@end

void ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_initWithComVividsolutionsJtsGeomgraphGeometryGraph_(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester *self, ComVividsolutionsJtsGeomgraphGeometryGraph *graph) {
  NSObject_init(self);
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_setAndConsume_rings_(self, new_JavaUtilArrayList_init());
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_setAndConsume_totalEnv_(self, new_ComVividsolutionsJtsGeomEnvelope_init());
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_set_graph_(self, graph);
}

ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester *new_ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_initWithComVividsolutionsJtsGeomgraphGeometryGraph_(ComVividsolutionsJtsGeomgraphGeometryGraph *graph) {
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester *self = [ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester alloc];
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_initWithComVividsolutionsJtsGeomgraphGeometryGraph_(self, graph);
  return self;
}

void ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_buildQuadtree(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester *self) {
  ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester_setAndConsume_quadtree_(self, new_ComVividsolutionsJtsIndexQuadtreeQuadtree_init());
  for (jint i = 0; i < [((id<JavaUtilList>) nil_chk(self->rings_)) size]; i++) {
    ComVividsolutionsJtsGeomLinearRing *ring = (ComVividsolutionsJtsGeomLinearRing *) check_class_cast([self->rings_ getWithInt:i], [ComVividsolutionsJtsGeomLinearRing class]);
    ComVividsolutionsJtsGeomEnvelope *env = [((ComVividsolutionsJtsGeomLinearRing *) nil_chk(ring)) getEnvelopeInternal];
    [self->quadtree_ insertWithComVividsolutionsJtsGeomEnvelope:env withId:ring];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComVividsolutionsJtsOperationValidQuadtreeNestedRingTester)
