//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/com/vividsolutions/jts/algorithm/CentroidLine.java
//


#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "com/vividsolutions/jts/algorithm/CentroidLine.h"
#include "com/vividsolutions/jts/geom/Coordinate.h"
#include "com/vividsolutions/jts/geom/Geometry.h"
#include "com/vividsolutions/jts/geom/GeometryCollection.h"
#include "com/vividsolutions/jts/geom/LineString.h"
#include "com/vividsolutions/jts/geom/Polygon.h"

@interface ComVividsolutionsJtsAlgorithmCentroidLine () {
 @public
  ComVividsolutionsJtsGeomCoordinate *centSum_;
  jdouble totalLength_;
}

@end

J2OBJC_FIELD_SETTER(ComVividsolutionsJtsAlgorithmCentroidLine, centSum_, ComVividsolutionsJtsGeomCoordinate *)

@implementation ComVividsolutionsJtsAlgorithmCentroidLine

- (instancetype)init {
  ComVividsolutionsJtsAlgorithmCentroidLine_init(self);
  return self;
}

- (void)addWithComVividsolutionsJtsGeomGeometry:(ComVividsolutionsJtsGeomGeometry *)geom {
  if ([geom isKindOfClass:[ComVividsolutionsJtsGeomLineString class]]) {
    [self addWithComVividsolutionsJtsGeomCoordinateArray:[((ComVividsolutionsJtsGeomGeometry *) nil_chk(geom)) getCoordinates]];
  }
  else if ([geom isKindOfClass:[ComVividsolutionsJtsGeomPolygon class]]) {
    ComVividsolutionsJtsGeomPolygon *poly = (ComVividsolutionsJtsGeomPolygon *) check_class_cast(geom, [ComVividsolutionsJtsGeomPolygon class]);
    [self addWithComVividsolutionsJtsGeomCoordinateArray:[((ComVividsolutionsJtsGeomLineString *) nil_chk([((ComVividsolutionsJtsGeomPolygon *) nil_chk(poly)) getExteriorRing])) getCoordinates]];
    for (jint i = 0; i < [poly getNumInteriorRing]; i++) {
      [self addWithComVividsolutionsJtsGeomCoordinateArray:[((ComVividsolutionsJtsGeomLineString *) nil_chk([poly getInteriorRingNWithInt:i])) getCoordinates]];
    }
  }
  else if ([geom isKindOfClass:[ComVividsolutionsJtsGeomGeometryCollection class]]) {
    ComVividsolutionsJtsGeomGeometryCollection *gc = (ComVividsolutionsJtsGeomGeometryCollection *) check_class_cast(geom, [ComVividsolutionsJtsGeomGeometryCollection class]);
    for (jint i = 0; i < [((ComVividsolutionsJtsGeomGeometryCollection *) nil_chk(gc)) getNumGeometries]; i++) {
      [self addWithComVividsolutionsJtsGeomGeometry:[gc getGeometryNWithInt:i]];
    }
  }
}

- (ComVividsolutionsJtsGeomCoordinate *)getCentroid {
  ComVividsolutionsJtsGeomCoordinate *cent = [new_ComVividsolutionsJtsGeomCoordinate_init() autorelease];
  cent->x_ = ((ComVividsolutionsJtsGeomCoordinate *) nil_chk(centSum_))->x_ / totalLength_;
  cent->y_ = centSum_->y_ / totalLength_;
  return cent;
}

- (void)addWithComVividsolutionsJtsGeomCoordinateArray:(IOSObjectArray *)pts {
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(pts))->size_ - 1; i++) {
    jdouble segmentLen = [((ComVividsolutionsJtsGeomCoordinate *) nil_chk(IOSObjectArray_Get(pts, i))) distanceWithComVividsolutionsJtsGeomCoordinate:IOSObjectArray_Get(pts, i + 1)];
    totalLength_ += segmentLen;
    jdouble midx = (((ComVividsolutionsJtsGeomCoordinate *) nil_chk(IOSObjectArray_Get(pts, i)))->x_ + ((ComVividsolutionsJtsGeomCoordinate *) nil_chk(IOSObjectArray_Get(pts, i + 1)))->x_) / 2;
    ((ComVividsolutionsJtsGeomCoordinate *) nil_chk(centSum_))->x_ += segmentLen * midx;
    jdouble midy = (((ComVividsolutionsJtsGeomCoordinate *) nil_chk(IOSObjectArray_Get(pts, i)))->y_ + ((ComVividsolutionsJtsGeomCoordinate *) nil_chk(IOSObjectArray_Get(pts, i + 1)))->y_) / 2;
    centSum_->y_ += segmentLen * midy;
  }
}

- (void)dealloc {
  RELEASE_(centSum_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "CentroidLine", NULL, 0x1, NULL, NULL },
    { "addWithComVividsolutionsJtsGeomGeometry:", "add", "V", 0x1, NULL, NULL },
    { "getCentroid", NULL, "Lcom.vividsolutions.jts.geom.Coordinate;", 0x1, NULL, NULL },
    { "addWithComVividsolutionsJtsGeomCoordinateArray:", "add", "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "centSum_", NULL, 0x2, "Lcom.vividsolutions.jts.geom.Coordinate;", NULL, NULL,  },
    { "totalLength_", NULL, 0x2, "D", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _ComVividsolutionsJtsAlgorithmCentroidLine = { 2, "CentroidLine", "com.vividsolutions.jts.algorithm", NULL, 0x1, 4, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_ComVividsolutionsJtsAlgorithmCentroidLine;
}

@end

void ComVividsolutionsJtsAlgorithmCentroidLine_init(ComVividsolutionsJtsAlgorithmCentroidLine *self) {
  NSObject_init(self);
  ComVividsolutionsJtsAlgorithmCentroidLine_setAndConsume_centSum_(self, new_ComVividsolutionsJtsGeomCoordinate_init());
  self->totalLength_ = 0.0;
}

ComVividsolutionsJtsAlgorithmCentroidLine *new_ComVividsolutionsJtsAlgorithmCentroidLine_init() {
  ComVividsolutionsJtsAlgorithmCentroidLine *self = [ComVividsolutionsJtsAlgorithmCentroidLine alloc];
  ComVividsolutionsJtsAlgorithmCentroidLine_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(ComVividsolutionsJtsAlgorithmCentroidLine)
