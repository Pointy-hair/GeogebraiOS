//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/apache/commons/math/optimization/MultiStartUnivariateRealOptimizer.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/Integer.h"
#include "org/apache/commons/math/ConvergenceException.h"
#include "org/apache/commons/math/FunctionEvaluationException.h"
#include "org/apache/commons/math/MathRuntimeException.h"
#include "org/apache/commons/math/analysis/UnivariateRealFunction.h"
#include "org/apache/commons/math/exception/util/LocalizedFormats.h"
#include "org/apache/commons/math/optimization/GoalType.h"
#include "org/apache/commons/math/optimization/MultiStartUnivariateRealOptimizer.h"
#include "org/apache/commons/math/optimization/OptimizationException.h"
#include "org/apache/commons/math/optimization/UnivariateRealOptimizer.h"
#include "org/apache/commons/math/random/RandomGenerator.h"
#include "org/apache/commons/math/util/FastMath.h"

#define OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer_serialVersionUID 5983375963110961019LL

@interface OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer () {
 @public
  id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer> optimizer_;
  jint maxIterations_;
  jint maxEvaluations_;
  jint totalIterations_;
  jint totalEvaluations_;
  jint starts_;
  id<OrgApacheCommonsMathRandomRandomGenerator> generator_;
  IOSDoubleArray *optima_;
  IOSDoubleArray *optimaValues_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer, optimizer_, id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>)
J2OBJC_FIELD_SETTER(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer, generator_, id<OrgApacheCommonsMathRandomRandomGenerator>)
J2OBJC_FIELD_SETTER(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer, optima_, IOSDoubleArray *)
J2OBJC_FIELD_SETTER(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer, optimaValues_, IOSDoubleArray *)

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer, serialVersionUID, jlong)

@implementation OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer

- (instancetype)initWithOrgApacheCommonsMathOptimizationUnivariateRealOptimizer:(id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>)optimizer
                                                                        withInt:(jint)starts
                                  withOrgApacheCommonsMathRandomRandomGenerator:(id<OrgApacheCommonsMathRandomRandomGenerator>)generator {
  OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer_initWithOrgApacheCommonsMathOptimizationUnivariateRealOptimizer_withInt_withOrgApacheCommonsMathRandomRandomGenerator_(self, optimizer, starts, generator);
  return self;
}

- (jdouble)getFunctionValue {
  return IOSDoubleArray_Get(nil_chk(optimaValues_), 0);
}

- (jdouble)getResult {
  return IOSDoubleArray_Get(nil_chk(optima_), 0);
}

- (jdouble)getAbsoluteAccuracy {
  return [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) getAbsoluteAccuracy];
}

- (jint)getIterationCount {
  return totalIterations_;
}

- (jint)getMaximalIterationCount {
  return maxIterations_;
}

- (jint)getMaxEvaluations {
  return maxEvaluations_;
}

- (jint)getEvaluations {
  return totalEvaluations_;
}

- (jdouble)getRelativeAccuracy {
  return [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) getRelativeAccuracy];
}

- (void)resetAbsoluteAccuracy {
  [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) resetAbsoluteAccuracy];
}

- (void)resetMaximalIterationCount {
  [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) resetMaximalIterationCount];
}

- (void)resetRelativeAccuracy {
  [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) resetRelativeAccuracy];
}

- (void)setAbsoluteAccuracyWithDouble:(jdouble)accuracy {
  [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) setAbsoluteAccuracyWithDouble:accuracy];
}

- (void)setMaximalIterationCountWithInt:(jint)count {
  self->maxIterations_ = count;
}

- (void)setMaxEvaluationsWithInt:(jint)maxEvaluations {
  self->maxEvaluations_ = maxEvaluations;
}

- (void)setRelativeAccuracyWithDouble:(jdouble)accuracy {
  [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) setRelativeAccuracyWithDouble:accuracy];
}

- (IOSDoubleArray *)getOptima {
  if (optima_ == nil) {
    @throw OrgApacheCommonsMathMathRuntimeException_createIllegalStateExceptionWithOrgApacheCommonsMathExceptionUtilLocalizable_withNSObjectArray_(OrgApacheCommonsMathExceptionUtilLocalizedFormatsEnum_get_NO_OPTIMUM_COMPUTED_YET(), [IOSObjectArray newArrayWithLength:0 type:NSObject_class_()]);
  }
  return [((IOSDoubleArray *) nil_chk(optima_)) clone];
}

- (IOSDoubleArray *)getOptimaValues {
  if (optimaValues_ == nil) {
    @throw OrgApacheCommonsMathMathRuntimeException_createIllegalStateExceptionWithOrgApacheCommonsMathExceptionUtilLocalizable_withNSObjectArray_(OrgApacheCommonsMathExceptionUtilLocalizedFormatsEnum_get_NO_OPTIMUM_COMPUTED_YET(), [IOSObjectArray newArrayWithLength:0 type:NSObject_class_()]);
  }
  return [((IOSDoubleArray *) nil_chk(optimaValues_)) clone];
}

- (jdouble)optimizeWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:(id<OrgApacheCommonsMathAnalysisUnivariateRealFunction>)f
                         withOrgApacheCommonsMathOptimizationGoalTypeEnum:(OrgApacheCommonsMathOptimizationGoalTypeEnum *)goalType
                                                               withDouble:(jdouble)min
                                                               withDouble:(jdouble)max {
  optima_ = [IOSDoubleArray newArrayWithLength:starts_];
  optimaValues_ = [IOSDoubleArray newArrayWithLength:starts_];
  totalIterations_ = 0;
  totalEvaluations_ = 0;
  for (jint i = 0; i < starts_; ++i) {
    @try {
      [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) setMaximalIterationCountWithInt:maxIterations_ - totalIterations_];
      [optimizer_ setMaxEvaluationsWithInt:maxEvaluations_ - totalEvaluations_];
      jdouble bound1 = (i == 0) ? min : min + [((id<OrgApacheCommonsMathRandomRandomGenerator>) nil_chk(generator_)) nextDouble] * (max - min);
      jdouble bound2 = (i == 0) ? max : min + [((id<OrgApacheCommonsMathRandomRandomGenerator>) nil_chk(generator_)) nextDouble] * (max - min);
      *IOSDoubleArray_GetRef(optima_, i) = [optimizer_ optimizeWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:f withOrgApacheCommonsMathOptimizationGoalTypeEnum:goalType withDouble:OrgApacheCommonsMathUtilFastMath_minWithDouble_withDouble_(bound1, bound2) withDouble:OrgApacheCommonsMathUtilFastMath_maxWithDouble_withDouble_(bound1, bound2)];
      *IOSDoubleArray_GetRef(optimaValues_, i) = [optimizer_ getFunctionValue];
    }
    @catch (OrgApacheCommonsMathFunctionEvaluationException *fee) {
      *IOSDoubleArray_GetRef(optima_, i) = JavaLangDouble_NaN;
      *IOSDoubleArray_GetRef(optimaValues_, i) = JavaLangDouble_NaN;
    }
    @catch (OrgApacheCommonsMathConvergenceException *ce) {
      *IOSDoubleArray_GetRef(optima_, i) = JavaLangDouble_NaN;
      *IOSDoubleArray_GetRef(optimaValues_, i) = JavaLangDouble_NaN;
    }
    totalIterations_ += [((id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer>) nil_chk(optimizer_)) getIterationCount];
    totalEvaluations_ += [optimizer_ getEvaluations];
  }
  jint lastNaN = optima_->size_;
  for (jint i = 0; i < lastNaN; ++i) {
    if (JavaLangDouble_isNaNWithDouble_(IOSDoubleArray_Get(optima_, i))) {
      *IOSDoubleArray_GetRef(optima_, i) = IOSDoubleArray_Get(optima_, --lastNaN);
      *IOSDoubleArray_GetRef(optima_, lastNaN + 1) = JavaLangDouble_NaN;
      *IOSDoubleArray_GetRef(optimaValues_, i) = IOSDoubleArray_Get(optimaValues_, --lastNaN);
      *IOSDoubleArray_GetRef(optimaValues_, lastNaN + 1) = JavaLangDouble_NaN;
    }
  }
  jdouble currX = IOSDoubleArray_Get(optima_, 0);
  jdouble currY = IOSDoubleArray_Get(optimaValues_, 0);
  for (jint j = 1; j < lastNaN; ++j) {
    jdouble prevY = currY;
    currX = IOSDoubleArray_Get(optima_, j);
    currY = IOSDoubleArray_Get(optimaValues_, j);
    if ((goalType == OrgApacheCommonsMathOptimizationGoalTypeEnum_get_MAXIMIZE()) ^ (currY < prevY)) {
      jint i = j - 1;
      jdouble mIX = IOSDoubleArray_Get(optima_, i);
      jdouble mIY = IOSDoubleArray_Get(optimaValues_, i);
      while ((i >= 0) && ((goalType == OrgApacheCommonsMathOptimizationGoalTypeEnum_get_MAXIMIZE()) ^ (currY < mIY))) {
        *IOSDoubleArray_GetRef(optima_, i + 1) = mIX;
        *IOSDoubleArray_GetRef(optimaValues_, i + 1) = mIY;
        if (i-- != 0) {
          mIX = IOSDoubleArray_Get(optima_, i);
          mIY = IOSDoubleArray_Get(optimaValues_, i);
        }
        else {
          mIX = JavaLangDouble_NaN;
          mIY = JavaLangDouble_NaN;
        }
      }
      *IOSDoubleArray_GetRef(optima_, i + 1) = currX;
      *IOSDoubleArray_GetRef(optimaValues_, i + 1) = currY;
      currX = IOSDoubleArray_Get(optima_, j);
      currY = IOSDoubleArray_Get(optimaValues_, j);
    }
  }
  if (JavaLangDouble_isNaNWithDouble_(IOSDoubleArray_Get(optima_, 0))) {
    @throw new_OrgApacheCommonsMathOptimizationOptimizationException_initWithOrgApacheCommonsMathExceptionUtilLocalizable_withNSObjectArray_(OrgApacheCommonsMathExceptionUtilLocalizedFormatsEnum_get_NO_CONVERGENCE_WITH_ANY_START_POINT(), [IOSObjectArray newArrayWithObjects:(id[]){ JavaLangInteger_valueOfWithInt_(starts_) } count:1 type:NSObject_class_()]);
  }
  return IOSDoubleArray_Get(optima_, 0);
}

- (jdouble)optimizeWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:(id<OrgApacheCommonsMathAnalysisUnivariateRealFunction>)f
                         withOrgApacheCommonsMathOptimizationGoalTypeEnum:(OrgApacheCommonsMathOptimizationGoalTypeEnum *)goalType
                                                               withDouble:(jdouble)min
                                                               withDouble:(jdouble)max
                                                               withDouble:(jdouble)startValue {
  return [self optimizeWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:f withOrgApacheCommonsMathOptimizationGoalTypeEnum:goalType withDouble:min withDouble:max];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheCommonsMathOptimizationUnivariateRealOptimizer:withInt:withOrgApacheCommonsMathRandomRandomGenerator:", "MultiStartUnivariateRealOptimizer", NULL, 0x1, NULL, NULL },
    { "getFunctionValue", NULL, "D", 0x1, NULL, NULL },
    { "getResult", NULL, "D", 0x1, NULL, NULL },
    { "getAbsoluteAccuracy", NULL, "D", 0x1, NULL, NULL },
    { "getIterationCount", NULL, "I", 0x1, NULL, NULL },
    { "getMaximalIterationCount", NULL, "I", 0x1, NULL, NULL },
    { "getMaxEvaluations", NULL, "I", 0x1, NULL, NULL },
    { "getEvaluations", NULL, "I", 0x1, NULL, NULL },
    { "getRelativeAccuracy", NULL, "D", 0x1, NULL, NULL },
    { "resetAbsoluteAccuracy", NULL, "V", 0x1, NULL, NULL },
    { "resetMaximalIterationCount", NULL, "V", 0x1, NULL, NULL },
    { "resetRelativeAccuracy", NULL, "V", 0x1, NULL, NULL },
    { "setAbsoluteAccuracyWithDouble:", "setAbsoluteAccuracy", "V", 0x1, NULL, NULL },
    { "setMaximalIterationCountWithInt:", "setMaximalIterationCount", "V", 0x1, NULL, NULL },
    { "setMaxEvaluationsWithInt:", "setMaxEvaluations", "V", 0x1, NULL, NULL },
    { "setRelativeAccuracyWithDouble:", "setRelativeAccuracy", "V", 0x1, NULL, NULL },
    { "getOptima", NULL, "[D", 0x1, "Ljava.lang.IllegalStateException;", NULL },
    { "getOptimaValues", NULL, "[D", 0x1, "Ljava.lang.IllegalStateException;", NULL },
    { "optimizeWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:withOrgApacheCommonsMathOptimizationGoalTypeEnum:withDouble:withDouble:", "optimize", "D", 0x1, "Lorg.apache.commons.math.ConvergenceException;Lorg.apache.commons.math.FunctionEvaluationException;", NULL },
    { "optimizeWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:withOrgApacheCommonsMathOptimizationGoalTypeEnum:withDouble:withDouble:withDouble:", "optimize", "D", 0x1, "Lorg.apache.commons.math.ConvergenceException;Lorg.apache.commons.math.FunctionEvaluationException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "serialVersionUID_", NULL, 0x1a, "J", NULL, NULL, .constantValue.asLong = OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer_serialVersionUID },
    { "optimizer_", NULL, 0x12, "Lorg.apache.commons.math.optimization.UnivariateRealOptimizer;", NULL, NULL,  },
    { "maxIterations_", NULL, 0x2, "I", NULL, NULL,  },
    { "maxEvaluations_", NULL, 0x2, "I", NULL, NULL,  },
    { "totalIterations_", NULL, 0x2, "I", NULL, NULL,  },
    { "totalEvaluations_", NULL, 0x2, "I", NULL, NULL,  },
    { "starts_", NULL, 0x2, "I", NULL, NULL,  },
    { "generator_", NULL, 0x2, "Lorg.apache.commons.math.random.RandomGenerator;", NULL, NULL,  },
    { "optima_", NULL, 0x2, "[D", NULL, NULL,  },
    { "optimaValues_", NULL, 0x2, "[D", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer = { 2, "MultiStartUnivariateRealOptimizer", "org.apache.commons.math.optimization", NULL, 0x1, 20, methods, 10, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer;
}

@end

void OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer_initWithOrgApacheCommonsMathOptimizationUnivariateRealOptimizer_withInt_withOrgApacheCommonsMathRandomRandomGenerator_(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer *self, id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer> optimizer, jint starts, id<OrgApacheCommonsMathRandomRandomGenerator> generator) {
  (void) NSObject_init(self);
  self->optimizer_ = optimizer;
  self->totalIterations_ = 0;
  self->starts_ = starts;
  self->generator_ = generator;
  self->optima_ = nil;
  [self setMaximalIterationCountWithInt:JavaLangInteger_MAX_VALUE];
  [self setMaxEvaluationsWithInt:JavaLangInteger_MAX_VALUE];
}

OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer *new_OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer_initWithOrgApacheCommonsMathOptimizationUnivariateRealOptimizer_withInt_withOrgApacheCommonsMathRandomRandomGenerator_(id<OrgApacheCommonsMathOptimizationUnivariateRealOptimizer> optimizer, jint starts, id<OrgApacheCommonsMathRandomRandomGenerator> generator) {
  OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer *self = [OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer alloc];
  OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer_initWithOrgApacheCommonsMathOptimizationUnivariateRealOptimizer_withInt_withOrgApacheCommonsMathRandomRandomGenerator_(self, optimizer, starts, generator);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathOptimizationMultiStartUnivariateRealOptimizer)
