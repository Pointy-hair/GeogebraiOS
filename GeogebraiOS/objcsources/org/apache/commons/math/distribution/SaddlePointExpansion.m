//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/org/apache/commons/math/distribution/SaddlePointExpansion.java
//


#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "org/apache/commons/math/distribution/SaddlePointExpansion.h"
#include "org/apache/commons/math/special/Gamma.h"
#include "org/apache/commons/math/util/FastMath.h"
#include "org/apache/commons/math/util/MathUtils.h"

@interface OrgApacheCommonsMathDistributionSaddlePointExpansion ()

- (instancetype)init;

@end

static jdouble OrgApacheCommonsMathDistributionSaddlePointExpansion_HALF_LOG_2_PI_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathDistributionSaddlePointExpansion, HALF_LOG_2_PI_, jdouble)

static IOSDoubleArray *OrgApacheCommonsMathDistributionSaddlePointExpansion_EXACT_STIRLING_ERRORS_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathDistributionSaddlePointExpansion, EXACT_STIRLING_ERRORS_, IOSDoubleArray *)

__attribute__((unused)) static void OrgApacheCommonsMathDistributionSaddlePointExpansion_init(OrgApacheCommonsMathDistributionSaddlePointExpansion *self);

__attribute__((unused)) static OrgApacheCommonsMathDistributionSaddlePointExpansion *new_OrgApacheCommonsMathDistributionSaddlePointExpansion_init() NS_RETURNS_RETAINED;

J2OBJC_INITIALIZED_DEFN(OrgApacheCommonsMathDistributionSaddlePointExpansion)

@implementation OrgApacheCommonsMathDistributionSaddlePointExpansion

- (instancetype)init {
  OrgApacheCommonsMathDistributionSaddlePointExpansion_init(self);
  return self;
}

+ (jdouble)getStirlingErrorWithDouble:(jdouble)z {
  return OrgApacheCommonsMathDistributionSaddlePointExpansion_getStirlingErrorWithDouble_(z);
}

+ (jdouble)getDeviancePartWithDouble:(jdouble)x
                          withDouble:(jdouble)mu {
  return OrgApacheCommonsMathDistributionSaddlePointExpansion_getDeviancePartWithDouble_withDouble_(x, mu);
}

+ (jdouble)logBinomialProbabilityWithInt:(jint)x
                                 withInt:(jint)n
                              withDouble:(jdouble)p
                              withDouble:(jdouble)q {
  return OrgApacheCommonsMathDistributionSaddlePointExpansion_logBinomialProbabilityWithInt_withInt_withDouble_withDouble_(x, n, p, q);
}

+ (void)initialize {
  if (self == [OrgApacheCommonsMathDistributionSaddlePointExpansion class]) {
    OrgApacheCommonsMathDistributionSaddlePointExpansion_HALF_LOG_2_PI_ = 0.5 * OrgApacheCommonsMathUtilFastMath_logWithDouble_(OrgApacheCommonsMathUtilMathUtils_TWO_PI);
    JreStrongAssignAndConsume(&OrgApacheCommonsMathDistributionSaddlePointExpansion_EXACT_STIRLING_ERRORS_, nil, [IOSDoubleArray newArrayWithDoubles:(jdouble[]){ 0.0, 0.1534264097200273452913848, 0.0810614667953272582196702, 0.0548141210519176538961390, 0.0413406959554092940938221, 0.03316287351993628748511048, 0.02767792568499833914878929, 0.02374616365629749597132920, 0.02079067210376509311152277, 0.01848845053267318523077934, 0.01664469118982119216319487, 0.01513497322191737887351255, 0.01387612882307074799874573, 0.01281046524292022692424986, 0.01189670994589177009505572, 0.01110455975820691732662991, 0.010411265261972096497478567, 0.009799416126158803298389475, 0.009255462182712732917728637, 0.008768700134139385462952823, 0.008330563433362871256469318, 0.007934114564314020547248100, 0.007573675487951840794972024, 0.007244554301320383179543912, 0.006942840107209529865664152, 0.006665247032707682442354394, 0.006408994188004207068439631, 0.006171712263039457647532867, 0.005951370112758847735624416, 0.005746216513010115682023589, 0.005554733551962801371038690 } count:31]);
    J2OBJC_SET_INITIALIZED(OrgApacheCommonsMathDistributionSaddlePointExpansion)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "SaddlePointExpansion", NULL, 0x2, NULL, NULL },
    { "getStirlingErrorWithDouble:", "getStirlingError", "D", 0x8, NULL, NULL },
    { "getDeviancePartWithDouble:withDouble:", "getDeviancePart", "D", 0x8, NULL, NULL },
    { "logBinomialProbabilityWithInt:withInt:withDouble:withDouble:", "logBinomialProbability", "D", 0x8, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "HALF_LOG_2_PI_", NULL, 0x1a, "D", &OrgApacheCommonsMathDistributionSaddlePointExpansion_HALF_LOG_2_PI_, NULL,  },
    { "EXACT_STIRLING_ERRORS_", NULL, 0x1a, "[D", &OrgApacheCommonsMathDistributionSaddlePointExpansion_EXACT_STIRLING_ERRORS_, NULL,  },
  };
  static const J2ObjcClassInfo _OrgApacheCommonsMathDistributionSaddlePointExpansion = { 2, "SaddlePointExpansion", "org.apache.commons.math.distribution", NULL, 0x10, 4, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheCommonsMathDistributionSaddlePointExpansion;
}

@end

void OrgApacheCommonsMathDistributionSaddlePointExpansion_init(OrgApacheCommonsMathDistributionSaddlePointExpansion *self) {
  NSObject_init(self);
}

OrgApacheCommonsMathDistributionSaddlePointExpansion *new_OrgApacheCommonsMathDistributionSaddlePointExpansion_init() {
  OrgApacheCommonsMathDistributionSaddlePointExpansion *self = [OrgApacheCommonsMathDistributionSaddlePointExpansion alloc];
  OrgApacheCommonsMathDistributionSaddlePointExpansion_init(self);
  return self;
}

jdouble OrgApacheCommonsMathDistributionSaddlePointExpansion_getStirlingErrorWithDouble_(jdouble z) {
  OrgApacheCommonsMathDistributionSaddlePointExpansion_initialize();
  jdouble ret;
  if (z < 15.0) {
    jdouble z2 = 2.0 * z;
    if (OrgApacheCommonsMathUtilFastMath_floorWithDouble_(z2) == z2) {
      ret = IOSDoubleArray_Get(nil_chk(OrgApacheCommonsMathDistributionSaddlePointExpansion_EXACT_STIRLING_ERRORS_), J2ObjCFpToInt(z2));
    }
    else {
      ret = OrgApacheCommonsMathSpecialGamma_logGammaWithDouble_(z + 1.0) - (z + 0.5) * OrgApacheCommonsMathUtilFastMath_logWithDouble_(z) + z - OrgApacheCommonsMathDistributionSaddlePointExpansion_HALF_LOG_2_PI_;
    }
  }
  else {
    jdouble z2 = z * z;
    ret = (0.083333333333333333333 - (0.00277777777777777777778 - (0.00079365079365079365079365 - (0.000595238095238095238095238 - 0.0008417508417508417508417508 / z2) / z2) / z2) / z2) / z;
  }
  return ret;
}

jdouble OrgApacheCommonsMathDistributionSaddlePointExpansion_getDeviancePartWithDouble_withDouble_(jdouble x, jdouble mu) {
  OrgApacheCommonsMathDistributionSaddlePointExpansion_initialize();
  jdouble ret;
  if (OrgApacheCommonsMathUtilFastMath_absWithDouble_(x - mu) < 0.1 * (x + mu)) {
    jdouble d = x - mu;
    jdouble v = d / (x + mu);
    jdouble s1 = v * d;
    jdouble s = JavaLangDouble_NaN;
    jdouble ej = 2.0 * x * v;
    v = v * v;
    jint j = 1;
    while (s1 != s) {
      s = s1;
      ej *= v;
      s1 = s + ej / ((j * 2) + 1);
      ++j;
    }
    ret = s1;
  }
  else {
    ret = x * OrgApacheCommonsMathUtilFastMath_logWithDouble_(x / mu) + mu - x;
  }
  return ret;
}

jdouble OrgApacheCommonsMathDistributionSaddlePointExpansion_logBinomialProbabilityWithInt_withInt_withDouble_withDouble_(jint x, jint n, jdouble p, jdouble q) {
  OrgApacheCommonsMathDistributionSaddlePointExpansion_initialize();
  jdouble ret;
  if (x == 0) {
    if (p < 0.1) {
      ret = -OrgApacheCommonsMathDistributionSaddlePointExpansion_getDeviancePartWithDouble_withDouble_(n, n * q) - n * p;
    }
    else {
      ret = n * OrgApacheCommonsMathUtilFastMath_logWithDouble_(q);
    }
  }
  else if (x == n) {
    if (q < 0.1) {
      ret = -OrgApacheCommonsMathDistributionSaddlePointExpansion_getDeviancePartWithDouble_withDouble_(n, n * p) - n * q;
    }
    else {
      ret = n * OrgApacheCommonsMathUtilFastMath_logWithDouble_(p);
    }
  }
  else {
    ret = OrgApacheCommonsMathDistributionSaddlePointExpansion_getStirlingErrorWithDouble_(n) - OrgApacheCommonsMathDistributionSaddlePointExpansion_getStirlingErrorWithDouble_(x) - OrgApacheCommonsMathDistributionSaddlePointExpansion_getStirlingErrorWithDouble_(n - x) - OrgApacheCommonsMathDistributionSaddlePointExpansion_getDeviancePartWithDouble_withDouble_(x, n * p) - OrgApacheCommonsMathDistributionSaddlePointExpansion_getDeviancePartWithDouble_withDouble_(n - x, n * q);
    jdouble f = (OrgApacheCommonsMathUtilMathUtils_TWO_PI * x * (n - x)) / n;
    ret = -0.5 * OrgApacheCommonsMathUtilFastMath_logWithDouble_(f) + ret;
  }
  return ret;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathDistributionSaddlePointExpansion)
