//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/apache/commons/math/special/Gamma.java
//


#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/lang/Integer.h"
#include "org/apache/commons/math/MathException.h"
#include "org/apache/commons/math/MaxIterationsExceededException.h"
#include "org/apache/commons/math/special/Gamma.h"
#include "org/apache/commons/math/util/ContinuedFraction.h"
#include "org/apache/commons/math/util/FastMath.h"

#define OrgApacheCommonsMathSpecialGamma_DEFAULT_EPSILON 1.0E-14
#define OrgApacheCommonsMathSpecialGamma_C_LIMIT 49.0
#define OrgApacheCommonsMathSpecialGamma_S_LIMIT 1.0E-5

@interface OrgApacheCommonsMathSpecialGamma ()

- (instancetype)init;

@end

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathSpecialGamma, DEFAULT_EPSILON, jdouble)

static IOSDoubleArray *OrgApacheCommonsMathSpecialGamma_LANCZOS_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathSpecialGamma, LANCZOS_, IOSDoubleArray *)

static jdouble OrgApacheCommonsMathSpecialGamma_HALF_LOG_2_PI_;
J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathSpecialGamma, HALF_LOG_2_PI_, jdouble)

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathSpecialGamma, C_LIMIT, jdouble)

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathSpecialGamma, S_LIMIT, jdouble)

__attribute__((unused)) static void OrgApacheCommonsMathSpecialGamma_init(OrgApacheCommonsMathSpecialGamma *self);

__attribute__((unused)) static OrgApacheCommonsMathSpecialGamma *new_OrgApacheCommonsMathSpecialGamma_init() NS_RETURNS_RETAINED;

@interface OrgApacheCommonsMathSpecialGamma_$1 : OrgApacheCommonsMathUtilContinuedFraction {
 @public
  jdouble val$a_;
}

- (jdouble)getAWithInt:(jint)n
            withDouble:(jdouble)x;

- (jdouble)getBWithInt:(jint)n
            withDouble:(jdouble)x;

- (instancetype)initWithDouble:(jdouble)capture$0;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheCommonsMathSpecialGamma_$1)

__attribute__((unused)) static void OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(OrgApacheCommonsMathSpecialGamma_$1 *self, jdouble capture$0);

__attribute__((unused)) static OrgApacheCommonsMathSpecialGamma_$1 *new_OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(jdouble capture$0) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheCommonsMathSpecialGamma_$1)

J2OBJC_INITIALIZED_DEFN(OrgApacheCommonsMathSpecialGamma)

@implementation OrgApacheCommonsMathSpecialGamma

- (instancetype)init {
  OrgApacheCommonsMathSpecialGamma_init(self);
  return self;
}

+ (jdouble)logGammaWithDouble:(jdouble)x {
  return OrgApacheCommonsMathSpecialGamma_logGammaWithDouble_(x);
}

+ (jdouble)regularizedGammaPWithDouble:(jdouble)a
                            withDouble:(jdouble)x {
  return OrgApacheCommonsMathSpecialGamma_regularizedGammaPWithDouble_withDouble_(a, x);
}

+ (jdouble)regularizedGammaPWithDouble:(jdouble)a
                            withDouble:(jdouble)x
                            withDouble:(jdouble)epsilon
                               withInt:(jint)maxIterations {
  return OrgApacheCommonsMathSpecialGamma_regularizedGammaPWithDouble_withDouble_withDouble_withInt_(a, x, epsilon, maxIterations);
}

+ (jdouble)regularizedGammaQWithDouble:(jdouble)a
                            withDouble:(jdouble)x {
  return OrgApacheCommonsMathSpecialGamma_regularizedGammaQWithDouble_withDouble_(a, x);
}

+ (jdouble)regularizedGammaQWithDouble:(jdouble)a
                            withDouble:(jdouble)x
                            withDouble:(jdouble)epsilon
                               withInt:(jint)maxIterations {
  return OrgApacheCommonsMathSpecialGamma_regularizedGammaQWithDouble_withDouble_withDouble_withInt_(a, x, epsilon, maxIterations);
}

+ (jdouble)digammaWithDouble:(jdouble)x {
  return OrgApacheCommonsMathSpecialGamma_digammaWithDouble_(x);
}

+ (jdouble)trigammaWithDouble:(jdouble)x {
  return OrgApacheCommonsMathSpecialGamma_trigammaWithDouble_(x);
}

+ (void)initialize {
  if (self == [OrgApacheCommonsMathSpecialGamma class]) {
    OrgApacheCommonsMathSpecialGamma_LANCZOS_ = [IOSDoubleArray newArrayWithDoubles:(jdouble[]){ 0.99999999999999709182, 57.156235665862923517, -59.597960355475491248, 14.136097974741747174, -0.49191381609762019978, .33994649984811888699e-4, .46523628927048575665e-4, -.98374475304879564677e-4, .15808870322491248884e-3, -.21026444172410488319e-3, .21743961811521264320e-3, -.16431810653676389022e-3, .84418223983852743293e-4, -.26190838401581408670e-4, .36899182659531622704e-5 } count:15];
    OrgApacheCommonsMathSpecialGamma_HALF_LOG_2_PI_ = 0.5 * OrgApacheCommonsMathUtilFastMath_logWithDouble_(2.0 * OrgApacheCommonsMathUtilFastMath_PI);
    J2OBJC_SET_INITIALIZED(OrgApacheCommonsMathSpecialGamma)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "Gamma", NULL, 0x2, NULL, NULL },
    { "logGammaWithDouble:", "logGamma", "D", 0x9, NULL, NULL },
    { "regularizedGammaPWithDouble:withDouble:", "regularizedGammaP", "D", 0x9, "Lorg.apache.commons.math.MathException;", NULL },
    { "regularizedGammaPWithDouble:withDouble:withDouble:withInt:", "regularizedGammaP", "D", 0x9, "Lorg.apache.commons.math.MathException;", NULL },
    { "regularizedGammaQWithDouble:withDouble:", "regularizedGammaQ", "D", 0x9, "Lorg.apache.commons.math.MathException;", NULL },
    { "regularizedGammaQWithDouble:withDouble:withDouble:withInt:", "regularizedGammaQ", "D", 0x9, "Lorg.apache.commons.math.MathException;", NULL },
    { "digammaWithDouble:", "digamma", "D", 0x9, NULL, NULL },
    { "trigammaWithDouble:", "trigamma", "D", 0x9, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "GAMMA_", NULL, 0x19, "D", NULL, NULL, .constantValue.asDouble = OrgApacheCommonsMathSpecialGamma_GAMMA },
    { "DEFAULT_EPSILON_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = OrgApacheCommonsMathSpecialGamma_DEFAULT_EPSILON },
    { "LANCZOS_", NULL, 0x1a, "[D", &OrgApacheCommonsMathSpecialGamma_LANCZOS_, NULL,  },
    { "HALF_LOG_2_PI_", NULL, 0x1a, "D", &OrgApacheCommonsMathSpecialGamma_HALF_LOG_2_PI_, NULL,  },
    { "C_LIMIT_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = OrgApacheCommonsMathSpecialGamma_C_LIMIT },
    { "S_LIMIT_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = OrgApacheCommonsMathSpecialGamma_S_LIMIT },
  };
  static const J2ObjcClassInfo _OrgApacheCommonsMathSpecialGamma = { 2, "Gamma", "org.apache.commons.math.special", NULL, 0x1, 8, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheCommonsMathSpecialGamma;
}

@end

void OrgApacheCommonsMathSpecialGamma_init(OrgApacheCommonsMathSpecialGamma *self) {
  (void) NSObject_init(self);
}

OrgApacheCommonsMathSpecialGamma *new_OrgApacheCommonsMathSpecialGamma_init() {
  OrgApacheCommonsMathSpecialGamma *self = [OrgApacheCommonsMathSpecialGamma alloc];
  OrgApacheCommonsMathSpecialGamma_init(self);
  return self;
}

jdouble OrgApacheCommonsMathSpecialGamma_logGammaWithDouble_(jdouble x) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  jdouble ret;
  if (JavaLangDouble_isNaNWithDouble_(x) || (x <= 0.0)) {
    ret = JavaLangDouble_NaN;
  }
  else {
    jdouble g = 607.0 / 128.0;
    jdouble sum = 0.0;
    for (jint i = ((IOSDoubleArray *) nil_chk(OrgApacheCommonsMathSpecialGamma_LANCZOS_))->size_ - 1; i > 0; --i) {
      sum = sum + (IOSDoubleArray_Get(OrgApacheCommonsMathSpecialGamma_LANCZOS_, i) / (x + i));
    }
    sum = sum + IOSDoubleArray_Get(OrgApacheCommonsMathSpecialGamma_LANCZOS_, 0);
    jdouble tmp = x + g + .5;
    ret = ((x + .5) * OrgApacheCommonsMathUtilFastMath_logWithDouble_(tmp)) - tmp + OrgApacheCommonsMathSpecialGamma_HALF_LOG_2_PI_ + OrgApacheCommonsMathUtilFastMath_logWithDouble_(sum / x);
  }
  return ret;
}

jdouble OrgApacheCommonsMathSpecialGamma_regularizedGammaPWithDouble_withDouble_(jdouble a, jdouble x) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  return OrgApacheCommonsMathSpecialGamma_regularizedGammaPWithDouble_withDouble_withDouble_withInt_(a, x, OrgApacheCommonsMathSpecialGamma_DEFAULT_EPSILON, JavaLangInteger_MAX_VALUE);
}

jdouble OrgApacheCommonsMathSpecialGamma_regularizedGammaPWithDouble_withDouble_withDouble_withInt_(jdouble a, jdouble x, jdouble epsilon, jint maxIterations) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  jdouble ret;
  if (JavaLangDouble_isNaNWithDouble_(a) || JavaLangDouble_isNaNWithDouble_(x) || (a <= 0.0) || (x < 0.0)) {
    ret = JavaLangDouble_NaN;
  }
  else if (x == 0.0) {
    ret = 0.0;
  }
  else if (x >= a + 1) {
    ret = 1.0 - OrgApacheCommonsMathSpecialGamma_regularizedGammaQWithDouble_withDouble_withDouble_withInt_(a, x, epsilon, maxIterations);
  }
  else {
    jdouble n = 0.0;
    jdouble an = 1.0 / a;
    jdouble sum = an;
    while (OrgApacheCommonsMathUtilFastMath_absWithDouble_(an / sum) > epsilon && n < maxIterations && sum < JavaLangDouble_POSITIVE_INFINITY) {
      n = n + 1.0;
      an = an * (x / (a + n));
      sum = sum + an;
    }
    if (n >= maxIterations) {
      @throw new_OrgApacheCommonsMathMaxIterationsExceededException_initWithInt_(maxIterations);
    }
    else if (JavaLangDouble_isInfiniteWithDouble_(sum)) {
      ret = 1.0;
    }
    else {
      ret = OrgApacheCommonsMathUtilFastMath_expWithDouble_(-x + (a * OrgApacheCommonsMathUtilFastMath_logWithDouble_(x)) - OrgApacheCommonsMathSpecialGamma_logGammaWithDouble_(a)) * sum;
    }
  }
  return ret;
}

jdouble OrgApacheCommonsMathSpecialGamma_regularizedGammaQWithDouble_withDouble_(jdouble a, jdouble x) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  return OrgApacheCommonsMathSpecialGamma_regularizedGammaQWithDouble_withDouble_withDouble_withInt_(a, x, OrgApacheCommonsMathSpecialGamma_DEFAULT_EPSILON, JavaLangInteger_MAX_VALUE);
}

jdouble OrgApacheCommonsMathSpecialGamma_regularizedGammaQWithDouble_withDouble_withDouble_withInt_(jdouble a, jdouble x, jdouble epsilon, jint maxIterations) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  jdouble ret;
  if (JavaLangDouble_isNaNWithDouble_(a) || JavaLangDouble_isNaNWithDouble_(x) || (a <= 0.0) || (x < 0.0)) {
    ret = JavaLangDouble_NaN;
  }
  else if (x == 0.0) {
    ret = 1.0;
  }
  else if (x < a + 1.0) {
    ret = 1.0 - OrgApacheCommonsMathSpecialGamma_regularizedGammaPWithDouble_withDouble_withDouble_withInt_(a, x, epsilon, maxIterations);
  }
  else {
    OrgApacheCommonsMathUtilContinuedFraction *cf = new_OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(a);
    ret = 1.0 / [cf evaluateWithDouble:x withDouble:epsilon withInt:maxIterations];
    ret = OrgApacheCommonsMathUtilFastMath_expWithDouble_(-x + (a * OrgApacheCommonsMathUtilFastMath_logWithDouble_(x)) - OrgApacheCommonsMathSpecialGamma_logGammaWithDouble_(a)) * ret;
  }
  return ret;
}

jdouble OrgApacheCommonsMathSpecialGamma_digammaWithDouble_(jdouble x) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  if (x > 0 && x <= OrgApacheCommonsMathSpecialGamma_S_LIMIT) {
    return -OrgApacheCommonsMathSpecialGamma_GAMMA - 1 / x;
  }
  if (x >= OrgApacheCommonsMathSpecialGamma_C_LIMIT) {
    jdouble inv = 1 / (x * x);
    return OrgApacheCommonsMathUtilFastMath_logWithDouble_(x) - 0.5 / x - inv * ((1.0 / 12) + inv * (1.0 / 120 - inv / 252));
  }
  return OrgApacheCommonsMathSpecialGamma_digammaWithDouble_(x + 1) - 1 / x;
}

jdouble OrgApacheCommonsMathSpecialGamma_trigammaWithDouble_(jdouble x) {
  OrgApacheCommonsMathSpecialGamma_initialize();
  if (x > 0 && x <= OrgApacheCommonsMathSpecialGamma_S_LIMIT) {
    return 1 / (x * x);
  }
  if (x >= OrgApacheCommonsMathSpecialGamma_C_LIMIT) {
    jdouble inv = 1 / (x * x);
    return 1 / x + inv / 2 + inv / x * (1.0 / 6 - inv * (1.0 / 30 + inv / 42));
  }
  return OrgApacheCommonsMathSpecialGamma_trigammaWithDouble_(x + 1) + 1 / (x * x);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathSpecialGamma)

@implementation OrgApacheCommonsMathSpecialGamma_$1

- (jdouble)getAWithInt:(jint)n
            withDouble:(jdouble)x {
  return ((2.0 * n) + 1.0) - val$a_ + x;
}

- (jdouble)getBWithInt:(jint)n
            withDouble:(jdouble)x {
  return n * (val$a_ - n);
}

- (instancetype)initWithDouble:(jdouble)capture$0 {
  OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(self, capture$0);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "getAWithInt:withDouble:", "getA", "D", 0x4, NULL, NULL },
    { "getBWithInt:withDouble:", "getB", "D", 0x4, NULL, NULL },
    { "initWithDouble:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "val$a_", NULL, 0x1012, "D", NULL, NULL,  },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgApacheCommonsMathSpecialGamma", "regularizedGammaQWithDouble:withDouble:withDouble:withInt:" };
  static const J2ObjcClassInfo _OrgApacheCommonsMathSpecialGamma_$1 = { 2, "", "org.apache.commons.math.special", "Gamma", 0x8008, 3, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgApacheCommonsMathSpecialGamma_$1;
}

@end

void OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(OrgApacheCommonsMathSpecialGamma_$1 *self, jdouble capture$0) {
  self->val$a_ = capture$0;
  (void) OrgApacheCommonsMathUtilContinuedFraction_init(self);
}

OrgApacheCommonsMathSpecialGamma_$1 *new_OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(jdouble capture$0) {
  OrgApacheCommonsMathSpecialGamma_$1 *self = [OrgApacheCommonsMathSpecialGamma_$1 alloc];
  OrgApacheCommonsMathSpecialGamma_$1_initWithDouble_(self, capture$0);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathSpecialGamma_$1)
