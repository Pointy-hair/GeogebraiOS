//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/apache/commons/math/stat/descriptive/moment/Kurtosis.java
//


#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/lang/IllegalStateException.h"
#include "org/apache/commons/math/MathRuntimeException.h"
#include "org/apache/commons/math/exception/util/LocalizedFormats.h"
#include "org/apache/commons/math/stat/descriptive/AbstractStorelessUnivariateStatistic.h"
#include "org/apache/commons/math/stat/descriptive/AbstractUnivariateStatistic.h"
#include "org/apache/commons/math/stat/descriptive/moment/FourthMoment.h"
#include "org/apache/commons/math/stat/descriptive/moment/Kurtosis.h"
#include "org/apache/commons/math/stat/descriptive/moment/SecondMoment.h"
#include "org/apache/commons/math/stat/descriptive/moment/Variance.h"
#include "org/apache/commons/math/util/FastMath.h"

#define OrgApacheCommonsMathStatDescriptiveMomentKurtosis_serialVersionUID 2784465764798260919LL

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathStatDescriptiveMomentKurtosis, serialVersionUID, jlong)

@implementation OrgApacheCommonsMathStatDescriptiveMomentKurtosis

- (instancetype)init {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_init(self);
  return self;
}

- (instancetype)initWithOrgApacheCommonsMathStatDescriptiveMomentFourthMoment:(OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *)m4 {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentFourthMoment_(self, m4);
  return self;
}

- (instancetype)initWithOrgApacheCommonsMathStatDescriptiveMomentKurtosis:(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *)original {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(self, original);
  return self;
}

- (void)incrementWithDouble:(jdouble)d {
  if (incMoment_) {
    [((OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *) nil_chk(moment_)) incrementWithDouble:d];
  }
  else {
    @throw OrgApacheCommonsMathMathRuntimeException_createIllegalStateExceptionWithOrgApacheCommonsMathExceptionUtilLocalizable_withNSObjectArray_(OrgApacheCommonsMathExceptionUtilLocalizedFormatsEnum_get_CANNOT_INCREMENT_STATISTIC_CONSTRUCTED_FROM_EXTERNAL_MOMENTS(), [IOSObjectArray newArrayWithLength:0 type:NSObject_class_()]);
  }
}

- (jdouble)getResult {
  jdouble kurtosis = JavaLangDouble_NaN;
  if ([((OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *) nil_chk(moment_)) getN] > 3) {
    jdouble variance = moment_->m2_ / (moment_->n_ - 1);
    if (moment_->n_ <= 3 || variance < 10E-20) {
      kurtosis = 0.0;
    }
    else {
      jdouble n = moment_->n_;
      kurtosis = (n * (n + 1) * moment_->m4_ - 3 * moment_->m2_ * moment_->m2_ * (n - 1)) / ((n - 1) * (n - 2) * (n - 3) * variance * variance);
    }
  }
  return kurtosis;
}

- (void)clear {
  if (incMoment_) {
    [((OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *) nil_chk(moment_)) clear];
  }
  else {
    @throw OrgApacheCommonsMathMathRuntimeException_createIllegalStateExceptionWithOrgApacheCommonsMathExceptionUtilLocalizable_withNSObjectArray_(OrgApacheCommonsMathExceptionUtilLocalizedFormatsEnum_get_CANNOT_CLEAR_STATISTIC_CONSTRUCTED_FROM_EXTERNAL_MOMENTS(), [IOSObjectArray newArrayWithLength:0 type:NSObject_class_()]);
  }
}

- (jlong)getN {
  return [((OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *) nil_chk(moment_)) getN];
}

- (jdouble)evaluateWithDoubleArray:(IOSDoubleArray *)values
                           withInt:(jint)begin
                           withInt:(jint)length {
  jdouble kurt = JavaLangDouble_NaN;
  if ([self testWithDoubleArray:values withInt:begin withInt:length] && length > 3) {
    OrgApacheCommonsMathStatDescriptiveMomentVariance *variance = new_OrgApacheCommonsMathStatDescriptiveMomentVariance_init();
    [variance incrementAllWithDoubleArray:values withInt:begin withInt:length];
    jdouble mean = ((OrgApacheCommonsMathStatDescriptiveMomentSecondMoment *) nil_chk(variance->moment_))->m1_;
    jdouble stdDev = OrgApacheCommonsMathUtilFastMath_sqrtWithDouble_([variance getResult]);
    jdouble accum3 = 0.0;
    for (jint i = begin; i < begin + length; i++) {
      accum3 += OrgApacheCommonsMathUtilFastMath_powWithDouble_withDouble_(IOSDoubleArray_Get(nil_chk(values), i) - mean, 4.0);
    }
    accum3 /= OrgApacheCommonsMathUtilFastMath_powWithDouble_withDouble_(stdDev, 4.0);
    jdouble n0 = length;
    jdouble coefficientOne = (n0 * (n0 + 1)) / ((n0 - 1) * (n0 - 2) * (n0 - 3));
    jdouble termTwo = (3 * OrgApacheCommonsMathUtilFastMath_powWithDouble_withDouble_(n0 - 1, 2.0)) / ((n0 - 2) * (n0 - 3));
    kurt = (coefficientOne * accum3) - termTwo;
  }
  return kurt;
}

- (OrgApacheCommonsMathStatDescriptiveMomentKurtosis *)copy__ {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis *result = new_OrgApacheCommonsMathStatDescriptiveMomentKurtosis_init();
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_copy__WithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_withOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(self, result);
  return result;
}

+ (void)copy__WithOrgApacheCommonsMathStatDescriptiveMomentKurtosis:(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *)source
              withOrgApacheCommonsMathStatDescriptiveMomentKurtosis:(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *)dest {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_copy__WithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_withOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(source, dest);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "Kurtosis", NULL, 0x1, NULL, NULL },
    { "initWithOrgApacheCommonsMathStatDescriptiveMomentFourthMoment:", "Kurtosis", NULL, 0x1, NULL, NULL },
    { "initWithOrgApacheCommonsMathStatDescriptiveMomentKurtosis:", "Kurtosis", NULL, 0x1, NULL, NULL },
    { "incrementWithDouble:", "increment", "V", 0x1, NULL, NULL },
    { "getResult", NULL, "D", 0x1, NULL, NULL },
    { "clear", NULL, "V", 0x1, NULL, NULL },
    { "getN", NULL, "J", 0x1, NULL, NULL },
    { "evaluateWithDoubleArray:withInt:withInt:", "evaluate", "D", 0x1, NULL, NULL },
    { "copy__", "copy", "Lorg.apache.commons.math.stat.descriptive.moment.Kurtosis;", 0x1, NULL, NULL },
    { "copy__WithOrgApacheCommonsMathStatDescriptiveMomentKurtosis:withOrgApacheCommonsMathStatDescriptiveMomentKurtosis:", "copy", "V", 0x9, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "serialVersionUID_", NULL, 0x1a, "J", NULL, NULL, .constantValue.asLong = OrgApacheCommonsMathStatDescriptiveMomentKurtosis_serialVersionUID },
    { "moment_", NULL, 0x4, "Lorg.apache.commons.math.stat.descriptive.moment.FourthMoment;", NULL, NULL,  },
    { "incMoment_", NULL, 0x4, "Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgApacheCommonsMathStatDescriptiveMomentKurtosis = { 2, "Kurtosis", "org.apache.commons.math.stat.descriptive.moment", NULL, 0x1, 10, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheCommonsMathStatDescriptiveMomentKurtosis;
}

@end

void OrgApacheCommonsMathStatDescriptiveMomentKurtosis_init(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *self) {
  (void) OrgApacheCommonsMathStatDescriptiveAbstractStorelessUnivariateStatistic_init(self);
  self->incMoment_ = YES;
  self->moment_ = new_OrgApacheCommonsMathStatDescriptiveMomentFourthMoment_init();
}

OrgApacheCommonsMathStatDescriptiveMomentKurtosis *new_OrgApacheCommonsMathStatDescriptiveMomentKurtosis_init() {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis *self = [OrgApacheCommonsMathStatDescriptiveMomentKurtosis alloc];
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_init(self);
  return self;
}

void OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentFourthMoment_(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *self, OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *m4) {
  (void) OrgApacheCommonsMathStatDescriptiveAbstractStorelessUnivariateStatistic_init(self);
  self->incMoment_ = NO;
  self->moment_ = m4;
}

OrgApacheCommonsMathStatDescriptiveMomentKurtosis *new_OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentFourthMoment_(OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *m4) {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis *self = [OrgApacheCommonsMathStatDescriptiveMomentKurtosis alloc];
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentFourthMoment_(self, m4);
  return self;
}

void OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *self, OrgApacheCommonsMathStatDescriptiveMomentKurtosis *original) {
  (void) OrgApacheCommonsMathStatDescriptiveAbstractStorelessUnivariateStatistic_init(self);
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_copy__WithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_withOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(original, self);
}

OrgApacheCommonsMathStatDescriptiveMomentKurtosis *new_OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *original) {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis *self = [OrgApacheCommonsMathStatDescriptiveMomentKurtosis alloc];
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initWithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(self, original);
  return self;
}

void OrgApacheCommonsMathStatDescriptiveMomentKurtosis_copy__WithOrgApacheCommonsMathStatDescriptiveMomentKurtosis_withOrgApacheCommonsMathStatDescriptiveMomentKurtosis_(OrgApacheCommonsMathStatDescriptiveMomentKurtosis *source, OrgApacheCommonsMathStatDescriptiveMomentKurtosis *dest) {
  OrgApacheCommonsMathStatDescriptiveMomentKurtosis_initialize();
  [((OrgApacheCommonsMathStatDescriptiveMomentKurtosis *) nil_chk(dest)) setDataWithDoubleArray:[((OrgApacheCommonsMathStatDescriptiveMomentKurtosis *) nil_chk(source)) getDataRef]];
  dest->moment_ = [((OrgApacheCommonsMathStatDescriptiveMomentFourthMoment *) nil_chk(source->moment_)) copy__];
  dest->incMoment_ = source->incMoment_;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathStatDescriptiveMomentKurtosis)
