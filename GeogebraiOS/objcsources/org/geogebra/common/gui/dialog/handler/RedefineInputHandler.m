//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/org/geogebra/common/gui/dialog/handler/RedefineInputHandler.java
//


#include "J2ObjC_source.h"
#include "java/lang/Exception.h"
#include "org/geogebra/common/gui/dialog/handler/RedefineInputHandler.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/StringTemplate.h"
#include "org/geogebra/common/kernel/arithmetic/FunctionalNVar.h"
#include "org/geogebra/common/kernel/commands/AlgebraProcessor.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/main/App.h"
#include "org/geogebra/common/main/MyError.h"

@interface OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler () {
 @public
  OrgGeogebraCommonKernelGeosGeoElement *geo_;
  OrgGeogebraCommonMainApp *app_;
  NSString *oldString_;
}

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler, geo_, OrgGeogebraCommonKernelGeosGeoElement *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler, app_, OrgGeogebraCommonMainApp *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler, oldString_, NSString *)

@implementation OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler

- (instancetype)initWithOrgGeogebraCommonMainApp:(OrgGeogebraCommonMainApp *)app
       withOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geo
                                    withNSString:(NSString *)oldString {
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonKernelGeosGeoElement_withNSString_(self, app, geo, oldString);
  return self;
}

- (void)setGeoElementWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geo {
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_set_geo_(self, geo);
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_set_oldString_(self, [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) getRedefineStringWithBoolean:NO withBoolean:YES]);
}

- (OrgGeogebraCommonKernelGeosGeoElement *)getGeoElement {
  return geo_;
}

- (jboolean)processInputWithNSString:(NSString *)rawInput {
  if (rawInput == nil) return NO;
  if ([((NSString *) nil_chk(rawInput)) isEqual:self->oldString_]) return YES;
  @try {
    NSString *inputValue = rawInput;
    if ([OrgGeogebraCommonKernelArithmeticFunctionalNVar_class_() isInstance:geo_]) {
      inputValue = JreStrcat("$C$$$", [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo_)) getLabelWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()], '(', [((id<OrgGeogebraCommonKernelArithmeticFunctionalNVar>) check_protocol_cast(geo_, @protocol(OrgGeogebraCommonKernelArithmeticFunctionalNVar))) getVarStringWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()], @")=", inputValue);
    }
    OrgGeogebraCommonKernelGeosGeoElement *newGeo = [((OrgGeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(app_)) getKernel])) getAlgebraProcessor])) changeGeoElementWithOrgGeogebraCommonKernelGeosGeoElement:geo_ withNSString:inputValue withBoolean:YES withBoolean:YES];
    [((OrgGeogebraCommonKernelKernel *) nil_chk([app_ getKernel])) clearJustCreatedGeosInViews];
    if (newGeo != nil) {
      [app_ doAfterRedefineWithOrgGeogebraCommonKernelGeosGeoElement:newGeo];
      [self setGeoElementWithOrgGeogebraCommonKernelGeosGeoElement:newGeo];
      OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_set_oldString_(self, inputValue);
    }
    return newGeo != nil;
  }
  @catch (JavaLangException *e) {
    [((OrgGeogebraCommonMainApp *) nil_chk(app_)) showErrorWithNSString:@"ReplaceFailed"];
  }
  @catch (OrgGeogebraCommonMainMyError *err) {
    [((OrgGeogebraCommonMainApp *) nil_chk(app_)) showErrorWithOrgGeogebraCommonMainMyError:err];
  }
  return NO;
}

- (void)dealloc {
  RELEASE_(geo_);
  RELEASE_(app_);
  RELEASE_(oldString_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonMainApp:withOrgGeogebraCommonKernelGeosGeoElement:withNSString:", "RedefineInputHandler", NULL, 0x1, NULL, NULL },
    { "setGeoElementWithOrgGeogebraCommonKernelGeosGeoElement:", "setGeoElement", "V", 0x1, NULL, NULL },
    { "getGeoElement", NULL, "Lorg.geogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "processInputWithNSString:", "processInput", "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "geo_", NULL, 0x2, "Lorg.geogebra.common.kernel.geos.GeoElement;", NULL, NULL,  },
    { "app_", NULL, 0x2, "Lorg.geogebra.common.main.App;", NULL, NULL,  },
    { "oldString_", NULL, 0x2, "Ljava.lang.String;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler = { 2, "RedefineInputHandler", "org.geogebra.common.gui.dialog.handler", NULL, 0x1, 4, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler;
}

@end

void OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonKernelGeosGeoElement_withNSString_(OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler *self, OrgGeogebraCommonMainApp *app, OrgGeogebraCommonKernelGeosGeoElement *geo, NSString *oldString) {
  NSObject_init(self);
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_set_geo_(self, geo);
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_set_app_(self, app);
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_set_oldString_(self, oldString);
}

OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler *new_OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonKernelGeosGeoElement_withNSString_(OrgGeogebraCommonMainApp *app, OrgGeogebraCommonKernelGeosGeoElement *geo, NSString *oldString) {
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler *self = [OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler alloc];
  OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonKernelGeosGeoElement_withNSString_(self, app, geo, oldString);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonGuiDialogHandlerRedefineInputHandler)
