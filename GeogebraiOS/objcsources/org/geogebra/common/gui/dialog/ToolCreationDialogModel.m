//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/org/geogebra/common/gui/dialog/ToolCreationDialogModel.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Exception.h"
#include "java/lang/Integer.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/Iterator.h"
#include "java/util/TreeSet.h"
#include "org/geogebra/common/euclidian/EuclidianConstants.h"
#include "org/geogebra/common/gui/dialog/ToolCreationDialogModel.h"
#include "org/geogebra/common/gui/dialog/ToolInputOutputList.h"
#include "org/geogebra/common/gui/dialog/ToolInputOutputListener.h"
#include "org/geogebra/common/kernel/Construction.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/Macro.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/main/App.h"
#include "org/geogebra/common/main/GuiManagerInterface.h"
#include "org/geogebra/common/main/Localization.h"
#include "org/geogebra/common/main/SelectionManager.h"

@interface OrgGeogebraCommonGuiDialogToolCreationDialogModel () {
 @public
  OrgGeogebraCommonKernelKernel *kernel_;
  OrgGeogebraCommonMainApp *app_;
  OrgGeogebraCommonGuiDialogToolInputOutputList *inputAddList_;
  OrgGeogebraCommonGuiDialogToolInputOutputList *outputAddList_;
  OrgGeogebraCommonGuiDialogToolInputOutputList *inputList_;
  OrgGeogebraCommonGuiDialogToolInputOutputList *outputList_;
  id<OrgGeogebraCommonGuiDialogToolInputOutputListener> listener_;
  OrgGeogebraCommonKernelMacro *newTool_;
}

- (void)initLists OBJC_METHOD_FAMILY_NONE;

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, kernel_, OrgGeogebraCommonKernelKernel *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, app_, OrgGeogebraCommonMainApp *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, inputAddList_, OrgGeogebraCommonGuiDialogToolInputOutputList *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, outputAddList_, OrgGeogebraCommonGuiDialogToolInputOutputList *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, inputList_, OrgGeogebraCommonGuiDialogToolInputOutputList *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, outputList_, OrgGeogebraCommonGuiDialogToolInputOutputList *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, listener_, id<OrgGeogebraCommonGuiDialogToolInputOutputListener>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel, newTool_, OrgGeogebraCommonKernelMacro *)

__attribute__((unused)) static void OrgGeogebraCommonGuiDialogToolCreationDialogModel_initLists(OrgGeogebraCommonGuiDialogToolCreationDialogModel *self);

#define OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_serialVersionUID 1LL

@interface OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 : OrgGeogebraCommonGuiDialogToolInputOutputList {
 @public
  OrgGeogebraCommonGuiDialogToolCreationDialogModel *this$0_;
}

- (jboolean)removeWithId:(id)geo;

- (instancetype)initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:(OrgGeogebraCommonGuiDialogToolCreationDialogModel *)outer$;


@end

J2OBJC_EMPTY_STATIC_INIT(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1)

J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1, this$0_, OrgGeogebraCommonGuiDialogToolCreationDialogModel *)

J2OBJC_STATIC_FIELD_GETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1, serialVersionUID, jlong)

__attribute__((unused)) static void OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 *self, OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$);

__attribute__((unused)) static OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1)

@interface OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 : OrgGeogebraCommonGuiDialogToolInputOutputList {
 @public
  OrgGeogebraCommonGuiDialogToolCreationDialogModel *this$0_;
}

- (jboolean)addWithId:(OrgGeogebraCommonKernelGeosGeoElement *)geo;

- (instancetype)initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:(OrgGeogebraCommonGuiDialogToolCreationDialogModel *)outer$;


@end

J2OBJC_EMPTY_STATIC_INIT(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2)

J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2, this$0_, OrgGeogebraCommonGuiDialogToolCreationDialogModel *)

__attribute__((unused)) static void OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 *self, OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$);

__attribute__((unused)) static OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2)

@interface OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 : OrgGeogebraCommonGuiDialogToolInputOutputList {
 @public
  OrgGeogebraCommonGuiDialogToolCreationDialogModel *this$0_;
}

- (jboolean)addWithId:(OrgGeogebraCommonKernelGeosGeoElement *)geo;

- (instancetype)initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:(OrgGeogebraCommonGuiDialogToolCreationDialogModel *)outer$;


@end

J2OBJC_EMPTY_STATIC_INIT(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3)

J2OBJC_FIELD_SETTER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3, this$0_, OrgGeogebraCommonGuiDialogToolCreationDialogModel *)

__attribute__((unused)) static void OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 *self, OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$);

__attribute__((unused)) static OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3)

@implementation OrgGeogebraCommonGuiDialogToolCreationDialogModel

- (instancetype)initWithOrgGeogebraCommonMainApp:(OrgGeogebraCommonMainApp *)app
withOrgGeogebraCommonGuiDialogToolInputOutputListener:(id<OrgGeogebraCommonGuiDialogToolInputOutputListener>)listener {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonGuiDialogToolInputOutputListener_(self, app, listener);
  return self;
}

- (void)initLists {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_initLists(self);
}

- (void)initAddLists {
  if ([((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputAddList_)) size] == 0 || [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputAddList_)) size] == 0) {
    JavaUtilTreeSet *sortedSet = [((OrgGeogebraCommonKernelConstruction *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) getConstruction])) getGeoSetNameDescriptionOrder];
    id<JavaUtilIterator> it = [((JavaUtilTreeSet *) nil_chk(sortedSet)) iterator];
    while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = [it next];
      if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) hasChildren]) {
        [inputAddList_ addWithId:geo];
      }
      if (![geo isIndependent]) {
        [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputAddList_)) addWithId:geo];
      }
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)addSelectedGeosToOutput {
  if ([((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) size] == 0) {
    JavaUtilArrayList *selGeos = [((OrgGeogebraCommonMainSelectionManager *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(app_)) getSelectionManager])) getSelectedGeos];
    for (jint i = 0; i < [((JavaUtilArrayList *) nil_chk(selGeos)) size]; i++) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = [selGeos getWithInt:i];
      [outputList_ addWithId:geo];
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)updateInputList {
  if ([((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) size] > 0) return;
  IOSObjectArray *output = [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) toGeoElements];
  JavaUtilTreeSet *freeParents = [new_JavaUtilTreeSet_init() autorelease];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(output))->size_; i++) {
    [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(output, i))) addPredecessorsToSetWithJavaUtilTreeSet:freeParents withBoolean:YES];
  }
  id<JavaUtilIterator> it = [freeParents iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgGeogebraCommonKernelGeosGeoElement *geo = [it next];
    if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isLabelSet]) {
      [inputList_ addWithId:geo];
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (jboolean)createTool {
  IOSObjectArray *input = [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) toGeoElements];
  IOSObjectArray *output = [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) toGeoElements];
  @try {
    OrgGeogebraCommonGuiDialogToolCreationDialogModel_setAndConsume_newTool_(self, new_OrgGeogebraCommonKernelMacro_initWithOrgGeogebraCommonKernelKernel_withNSString_withOrgGeogebraCommonKernelGeosGeoElementArray_withOrgGeogebraCommonKernelGeosGeoElementArray_(kernel_, @"newTool", input, output));
    return YES;
  }
  @catch (JavaLangException *e) {
    [app_ showErrorWithNSString:JreStrcat("$C$", [((OrgGeogebraCommonMainLocalization *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(app_)) getLocalization])) getErrorWithNSString:@"Tool.CreationFailed"], 0x000a, [((JavaLangException *) nil_chk(e)) getMessage])];
    [e printStackTrace];
    OrgGeogebraCommonGuiDialogToolCreationDialogModel_set_newTool_(self, nil);
    return NO;
  }
}

- (void)finishWithOrgGeogebraCommonMainApp:(OrgGeogebraCommonMainApp *)appToSave
                              withNSString:(NSString *)cmdName
                              withNSString:(NSString *)toolName
                              withNSString:(NSString *)toolHelp
                               withBoolean:(jboolean)showInToolBar
                              withNSString:(NSString *)iconFileName {
  [((OrgGeogebraCommonKernelMacro *) nil_chk(newTool_)) setCommandNameWithNSString:cmdName];
  [newTool_ setToolNameWithNSString:toolName];
  [newTool_ setToolHelpWithNSString:toolHelp];
  [newTool_ setShowInToolBarWithBoolean:showInToolBar];
  [newTool_ setIconFileNameWithNSString:iconFileName];
  [((OrgGeogebraCommonMainApp *) nil_chk(appToSave)) updateCommandDictionary];
  OrgGeogebraCommonKernelKernel *kernel = [appToSave getKernel];
  if ([((OrgGeogebraCommonKernelKernel *) nil_chk(kernel)) getMacroWithNSString:cmdName] != nil) {
    [self overwriteMacroWithOrgGeogebraCommonMainApp:appToSave withOrgGeogebraCommonKernelMacro:[kernel getMacroWithNSString:cmdName]];
    return;
  }
  [kernel addMacroWithOrgGeogebraCommonKernelMacro:newTool_];
  [appToSave updateCommandDictionary];
  if ([newTool_ isShowInToolBar]) {
    jint mode = [kernel getMacroIDWithOrgGeogebraCommonKernelMacro:newTool_] + OrgGeogebraCommonEuclidianEuclidianConstants_MACRO_MODE_ID_OFFSET;
    [((id<OrgGeogebraCommonMainGuiManagerInterface>) nil_chk([appToSave getGuiManager])) addToToolbarDefinitionWithInt:mode];
    [((id<OrgGeogebraCommonMainGuiManagerInterface>) nil_chk([appToSave getGuiManager])) updateToolbar];
    [appToSave setModeWithInt:mode];
  }
}

- (jboolean)overwriteMacroWithOrgGeogebraCommonMainApp:(OrgGeogebraCommonMainApp *)appToSave
                      withOrgGeogebraCommonKernelMacro:(OrgGeogebraCommonKernelMacro *)macro {
  jboolean compatible = [((NSString *) nil_chk([((OrgGeogebraCommonKernelMacro *) nil_chk(newTool_)) getNeededTypesString])) isEqual:[((OrgGeogebraCommonKernelMacro *) nil_chk(macro)) getNeededTypesString]];
  for (jint i = 0; compatible && i < ((IOSObjectArray *) nil_chk([macro getMacroOutput]))->size_; i++) compatible = (compatible && [[((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(nil_chk([macro getMacroOutput]), i))) getClass] isEqual:[((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(nil_chk([newTool_ getMacroOutput]), i))) getClass]]);
  if (compatible) {
    JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
    [newTool_ getXMLWithJavaLangStringBuilder:sb];
    [((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) removeMacroWithOrgGeogebraCommonKernelMacro:[((OrgGeogebraCommonMainApp *) nil_chk(app_)) getMacro]];
    if ([((OrgGeogebraCommonMainApp *) nil_chk(appToSave)) addMacroXMLWithNSString:[sb description]]) {
      [appToSave setXMLWithNSString:[appToSave getXML] withBoolean:YES];
      if ([app_ getMacro] != nil) [app_ setSaved];
    }
    return YES;
  }
  OrgGeogebraCommonMainApp_debugWithNSString_(@"not compatible");
  return NO;
}

- (IOSObjectArray *)getInputAddList {
  return [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputAddList_)) toGeoElements];
}

- (IOSObjectArray *)getOutputAddList {
  return [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputAddList_)) toGeoElements];
}

- (IOSObjectArray *)getInputList {
  return [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) toGeoElements];
}

- (IOSObjectArray *)getOutputList {
  return [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) toGeoElements];
}

- (OrgGeogebraCommonKernelMacro *)getNewTool {
  return newTool_;
}

- (void)addToOutputWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geo {
  [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) addWithId:geo];
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)addToOutputWithInt:(jint)selectedIndex {
  [self addToOutputWithOrgGeogebraCommonKernelGeosGeoElement:[((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputAddList_)) getWithInt:selectedIndex]];
}

- (void)addToInputWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geo {
  [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) addWithId:geo];
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)addToInputWithInt:(jint)selectedIndex {
  [self addToInputWithOrgGeogebraCommonKernelGeosGeoElement:[((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputAddList_)) getWithInt:selectedIndex]];
}

- (void)removeFromOutputWithJavaUtilArrayList:(JavaUtilArrayList *)selIndices {
  for (jint i = [((JavaUtilArrayList *) nil_chk(selIndices)) size] - 1; i >= 0; i--) {
    jint selectedIndex = [((JavaLangInteger *) nil_chk([selIndices getWithInt:i])) intValue];
    [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputAddList_)) addWithId:[((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) removeWithInt:selectedIndex]];
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)removeFromInputWithJavaUtilArrayList:(JavaUtilArrayList *)selIndices {
  for (jint i = [((JavaUtilArrayList *) nil_chk(selIndices)) size] - 1; i >= 0; i--) {
    jint selectedIndex = [((JavaLangInteger *) nil_chk([selIndices getWithInt:i])) intValue];
    [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputAddList_)) addWithId:[((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) removeWithInt:selectedIndex]];
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)moveOutputUpWithJavaUtilArrayList:(JavaUtilArrayList *)selIndices {
  for (jint i = 0; i < [((JavaUtilArrayList *) nil_chk(selIndices)) size]; i++) {
    jint selectedIndex = [((JavaLangInteger *) nil_chk([selIndices getWithInt:i])) intValue];
    if (selectedIndex > 0) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) removeWithInt:selectedIndex];
      [outputList_ addWithInt:selectedIndex - 1 withId:geo];
      [selIndices setWithInt:i withId:JavaLangInteger_valueOfWithInt_(selectedIndex - 1)];
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)moveOutputDownWithJavaUtilArrayList:(JavaUtilArrayList *)selIndices {
  for (jint i = [((JavaUtilArrayList *) nil_chk(selIndices)) size] - 1; i >= 0; i--) {
    jint selectedIndex = [((JavaLangInteger *) nil_chk([selIndices getWithInt:i])) intValue];
    if (selectedIndex < [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(outputList_)) size] - 1) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = [outputList_ removeWithInt:selectedIndex];
      [outputList_ addWithInt:selectedIndex + 1 withId:geo];
      [selIndices setWithInt:i withId:JavaLangInteger_valueOfWithInt_(selectedIndex + 1)];
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)moveInputUpWithJavaUtilArrayList:(JavaUtilArrayList *)selIndices {
  for (jint i = 0; i < [((JavaUtilArrayList *) nil_chk(selIndices)) size]; i++) {
    jint selectedIndex = [((JavaLangInteger *) nil_chk([selIndices getWithInt:i])) intValue];
    if (selectedIndex > 0) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) removeWithInt:selectedIndex];
      [inputList_ addWithInt:selectedIndex - 1 withId:geo];
      [selIndices setWithInt:i withId:JavaLangInteger_valueOfWithInt_(selectedIndex - 1)];
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)moveInputDownWithJavaUtilArrayList:(JavaUtilArrayList *)selIndices {
  for (jint i = [((JavaUtilArrayList *) nil_chk(selIndices)) size] - 1; i >= 0; i--) {
    jint selectedIndex = [((JavaLangInteger *) nil_chk([selIndices getWithInt:i])) intValue];
    if (selectedIndex < [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(inputList_)) size] - 1) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = [inputList_ removeWithInt:selectedIndex];
      [inputList_ addWithInt:selectedIndex + 1 withId:geo];
      [selIndices setWithInt:i withId:JavaLangInteger_valueOfWithInt_(selectedIndex + 1)];
    }
  }
  [((id<OrgGeogebraCommonGuiDialogToolInputOutputListener>) nil_chk(listener_)) updateLists];
}

- (void)dealloc {
  RELEASE_(kernel_);
  RELEASE_(app_);
  RELEASE_(inputAddList_);
  RELEASE_(outputAddList_);
  RELEASE_(inputList_);
  RELEASE_(outputList_);
  RELEASE_(listener_);
  RELEASE_(newTool_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonMainApp:withOrgGeogebraCommonGuiDialogToolInputOutputListener:", "ToolCreationDialogModel", NULL, 0x1, NULL, NULL },
    { "initLists", NULL, "V", 0x2, NULL, NULL },
    { "initAddLists", NULL, "V", 0x1, NULL, NULL },
    { "addSelectedGeosToOutput", NULL, "V", 0x1, NULL, NULL },
    { "updateInputList", NULL, "V", 0x1, NULL, NULL },
    { "createTool", NULL, "Z", 0x1, NULL, NULL },
    { "finishWithOrgGeogebraCommonMainApp:withNSString:withNSString:withNSString:withBoolean:withNSString:", "finish", "V", 0x1, NULL, NULL },
    { "overwriteMacroWithOrgGeogebraCommonMainApp:withOrgGeogebraCommonKernelMacro:", "overwriteMacro", "Z", 0x1, NULL, NULL },
    { "getInputAddList", NULL, "[Lorg.geogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "getOutputAddList", NULL, "[Lorg.geogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "getInputList", NULL, "[Lorg.geogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "getOutputList", NULL, "[Lorg.geogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "getNewTool", NULL, "Lorg.geogebra.common.kernel.Macro;", 0x1, NULL, NULL },
    { "addToOutputWithOrgGeogebraCommonKernelGeosGeoElement:", "addToOutput", "V", 0x1, NULL, NULL },
    { "addToOutputWithInt:", "addToOutput", "V", 0x1, NULL, NULL },
    { "addToInputWithOrgGeogebraCommonKernelGeosGeoElement:", "addToInput", "V", 0x1, NULL, NULL },
    { "addToInputWithInt:", "addToInput", "V", 0x1, NULL, NULL },
    { "removeFromOutputWithJavaUtilArrayList:", "removeFromOutput", "V", 0x1, NULL, NULL },
    { "removeFromInputWithJavaUtilArrayList:", "removeFromInput", "V", 0x1, NULL, NULL },
    { "moveOutputUpWithJavaUtilArrayList:", "moveOutputUp", "V", 0x1, NULL, NULL },
    { "moveOutputDownWithJavaUtilArrayList:", "moveOutputDown", "V", 0x1, NULL, NULL },
    { "moveInputUpWithJavaUtilArrayList:", "moveInputUp", "V", 0x1, NULL, NULL },
    { "moveInputDownWithJavaUtilArrayList:", "moveInputDown", "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "kernel_", NULL, 0x2, "Lorg.geogebra.common.kernel.Kernel;", NULL, NULL,  },
    { "app_", NULL, 0x2, "Lorg.geogebra.common.main.App;", NULL, NULL,  },
    { "inputAddList_", NULL, 0x2, "Lorg.geogebra.common.gui.dialog.ToolInputOutputList;", NULL, NULL,  },
    { "outputAddList_", NULL, 0x2, "Lorg.geogebra.common.gui.dialog.ToolInputOutputList;", NULL, NULL,  },
    { "inputList_", NULL, 0x2, "Lorg.geogebra.common.gui.dialog.ToolInputOutputList;", NULL, NULL,  },
    { "outputList_", NULL, 0x2, "Lorg.geogebra.common.gui.dialog.ToolInputOutputList;", NULL, NULL,  },
    { "listener_", NULL, 0x2, "Lorg.geogebra.common.gui.dialog.ToolInputOutputListener;", NULL, NULL,  },
    { "newTool_", NULL, 0x2, "Lorg.geogebra.common.kernel.Macro;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonGuiDialogToolCreationDialogModel = { 2, "ToolCreationDialogModel", "org.geogebra.common.gui.dialog", NULL, 0x1, 23, methods, 8, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonGuiDialogToolCreationDialogModel;
}

@end

void OrgGeogebraCommonGuiDialogToolCreationDialogModel_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonGuiDialogToolInputOutputListener_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *self, OrgGeogebraCommonMainApp *app, id<OrgGeogebraCommonGuiDialogToolInputOutputListener> listener) {
  NSObject_init(self);
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_set_app_(self, app);
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_set_kernel_(self, [((OrgGeogebraCommonMainApp *) nil_chk(app)) getKernel]);
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_set_listener_(self, listener);
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_initLists(self);
}

OrgGeogebraCommonGuiDialogToolCreationDialogModel *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonGuiDialogToolInputOutputListener_(OrgGeogebraCommonMainApp *app, id<OrgGeogebraCommonGuiDialogToolInputOutputListener> listener) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel *self = [OrgGeogebraCommonGuiDialogToolCreationDialogModel alloc];
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_initWithOrgGeogebraCommonMainApp_withOrgGeogebraCommonGuiDialogToolInputOutputListener_(self, app, listener);
  return self;
}

void OrgGeogebraCommonGuiDialogToolCreationDialogModel_initLists(OrgGeogebraCommonGuiDialogToolCreationDialogModel *self) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_setAndConsume_inputAddList_(self, new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self));
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_setAndConsume_outputAddList_(self, new_OrgGeogebraCommonGuiDialogToolInputOutputList_init());
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_setAndConsume_inputList_(self, new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self));
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_setAndConsume_outputList_(self, new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self));
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonGuiDialogToolCreationDialogModel)

@implementation OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1

- (jboolean)removeWithId:(id)geo {
  jboolean ret = [super removeWithId:geo];
  [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(this$0_->outputList_)) removeWithId:geo];
  return ret;
}

- (instancetype)initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:(OrgGeogebraCommonGuiDialogToolCreationDialogModel *)outer$ {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self, outer$);
  return self;
}

- (void)dealloc {
  RELEASE_(this$0_);
  [super dealloc];
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "removeWithId:", "remove", "Z", 0x1, NULL, NULL },
    { "initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.geogebra.common.gui.dialog.ToolCreationDialogModel;", NULL, NULL,  },
    { "serialVersionUID_", NULL, 0x1a, "J", NULL, NULL, .constantValue.asLong = OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_serialVersionUID },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgGeogebraCommonGuiDialogToolCreationDialogModel", "initLists" };
  static const J2ObjcClassInfo _OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 = { 2, "", "org.geogebra.common.gui.dialog", "ToolCreationDialogModel", 0x8008, 2, methods, 2, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1;
}

@end

void OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 *self, OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_set_this$0_(self, outer$);
  OrgGeogebraCommonGuiDialogToolInputOutputList_init(self);
}

OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 *self = [OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1 alloc];
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$1)

@implementation OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2

- (jboolean)addWithId:(OrgGeogebraCommonKernelGeosGeoElement *)geo {
  if (![((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) hasChildren] || [self containsWithId:geo]) {
    return NO;
  }
  jboolean ret = [super addWithId:geo];
  if (ret) {
    [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(this$0_->inputAddList_)) removeWithId:geo];
  }
  return ret;
}

- (instancetype)initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:(OrgGeogebraCommonGuiDialogToolCreationDialogModel *)outer$ {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self, outer$);
  return self;
}

- (void)dealloc {
  RELEASE_(this$0_);
  [super dealloc];
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "addWithId:", "add", "Z", 0x1, NULL, NULL },
    { "initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.geogebra.common.gui.dialog.ToolCreationDialogModel;", NULL, NULL,  },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgGeogebraCommonGuiDialogToolCreationDialogModel", "initLists" };
  static const J2ObjcClassInfo _OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 = { 2, "", "org.geogebra.common.gui.dialog", "ToolCreationDialogModel", 0x8008, 2, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2;
}

@end

void OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 *self, OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_set_this$0_(self, outer$);
  OrgGeogebraCommonGuiDialogToolInputOutputList_init(self);
}

OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 *self = [OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2 alloc];
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$2)

@implementation OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3

- (jboolean)addWithId:(OrgGeogebraCommonKernelGeosGeoElement *)geo {
  if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isIndependent] || [self containsWithId:geo]) {
    return NO;
  }
  jboolean ret = [super addWithId:geo];
  if (ret) {
    [((OrgGeogebraCommonGuiDialogToolInputOutputList *) nil_chk(this$0_->outputAddList_)) removeWithId:geo];
  }
  return ret;
}

- (instancetype)initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:(OrgGeogebraCommonGuiDialogToolCreationDialogModel *)outer$ {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self, outer$);
  return self;
}

- (void)dealloc {
  RELEASE_(this$0_);
  [super dealloc];
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "addWithId:", "add", "Z", 0x1, NULL, NULL },
    { "initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.geogebra.common.gui.dialog.ToolCreationDialogModel;", NULL, NULL,  },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgGeogebraCommonGuiDialogToolCreationDialogModel", "initLists" };
  static const J2ObjcClassInfo _OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 = { 2, "", "org.geogebra.common.gui.dialog", "ToolCreationDialogModel", 0x8008, 2, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3;
}

@end

void OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 *self, OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_set_this$0_(self, outer$);
  OrgGeogebraCommonGuiDialogToolInputOutputList_init(self);
}

OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 *new_OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(OrgGeogebraCommonGuiDialogToolCreationDialogModel *outer$) {
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 *self = [OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3 alloc];
  OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3_initWithOrgGeogebraCommonGuiDialogToolCreationDialogModel_(self, outer$);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonGuiDialogToolCreationDialogModel_$3)
