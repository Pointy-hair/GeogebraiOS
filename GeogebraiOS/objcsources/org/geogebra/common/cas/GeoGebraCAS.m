//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/org/geogebra/common/cas/GeoGebraCAS.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Exception.h"
#include "java/lang/StringBuilder.h"
#include "java/lang/Throwable.h"
#include "java/util/ArrayList.h"
#include "java/util/HashSet.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "org/geogebra/common/cas/CASparser.h"
#include "org/geogebra/common/cas/CasParserToolsImpl.h"
#include "org/geogebra/common/cas/GeoGebraCAS.h"
#include "org/geogebra/common/cas/singularws/SingularWebService.h"
#include "org/geogebra/common/factories/CASFactory.h"
#include "org/geogebra/common/kernel/AsynchronousCommand.h"
#include "org/geogebra/common/kernel/CASException.h"
#include "org/geogebra/common/kernel/CASGenericInterface.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/StringTemplate.h"
#include "org/geogebra/common/kernel/arithmetic/Command.h"
#include "org/geogebra/common/kernel/arithmetic/ExpressionNode.h"
#include "org/geogebra/common/kernel/arithmetic/ExpressionNodeConstants.h"
#include "org/geogebra/common/kernel/arithmetic/ExpressionValue.h"
#include "org/geogebra/common/kernel/arithmetic/MyArbitraryConstant.h"
#include "org/geogebra/common/kernel/arithmetic/ValidExpression.h"
#include "org/geogebra/common/kernel/commands/AlgebraProcessor.h"
#include "org/geogebra/common/kernel/commands/Commands.h"
#include "org/geogebra/common/kernel/geos/GeoCasCell.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/kernel/parser/Parser.h"
#include "org/geogebra/common/kernel/parser/cashandlers/ParserFunctions.h"
#include "org/geogebra/common/main/App.h"
#include "org/geogebra/common/main/Localization.h"
#include "org/geogebra/common/main/settings/CASSettings.h"
#include "org/geogebra/common/main/settings/Settings.h"
#include "org/geogebra/common/util/MaxSizeHashMap.h"
#include "org/geogebra/common/util/debug/Log.h"

@interface OrgGeogebraCommonCasGeoGebraCAS () {
 @public
  OrgGeogebraCommonMainApp *app_;
  OrgGeogebraCommonCasCASparser *casParser_;
  id<OrgGeogebraCommonKernelCASGenericInterface> cas_;
  id<JavaUtilMap> getPolynomialCoeffsCache_;
  JavaLangStringBuilder *getPolynomialCoeffsSB_;
  JavaLangStringBuilder *sbPolyCoeffs_;
}

- (id<OrgGeogebraCommonKernelCASGenericInterface>)getGiac;

+ (NSString *)toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue:(id<OrgGeogebraCommonKernelArithmeticExpressionValue>)ev
                                                               withBoolean:(jboolean)symbolic
                                 withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl;

- (NSString *)getCASCommandWithNSString:(NSString *)name
                  withJavaUtilArrayList:(JavaUtilArrayList *)args
                            withBoolean:(jboolean)symbolic
withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl
                            withBoolean:(jboolean)allowOutsourcing;

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonCasGeoGebraCAS, app_, OrgGeogebraCommonMainApp *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonCasGeoGebraCAS, casParser_, OrgGeogebraCommonCasCASparser *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonCasGeoGebraCAS, cas_, id<OrgGeogebraCommonKernelCASGenericInterface>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonCasGeoGebraCAS, getPolynomialCoeffsCache_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonCasGeoGebraCAS, getPolynomialCoeffsSB_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonCasGeoGebraCAS, sbPolyCoeffs_, JavaLangStringBuilder *)

__attribute__((unused)) static id<OrgGeogebraCommonKernelCASGenericInterface> OrgGeogebraCommonCasGeoGebraCAS_getGiac(OrgGeogebraCommonCasGeoGebraCAS *self);

__attribute__((unused)) static NSString *OrgGeogebraCommonCasGeoGebraCAS_evaluateWithNSString_(OrgGeogebraCommonCasGeoGebraCAS *self, NSString *exp);

__attribute__((unused)) static NSString *OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev, jboolean symbolic, OrgGeogebraCommonKernelStringTemplate *tpl);

__attribute__((unused)) static NSString *OrgGeogebraCommonCasGeoGebraCAS_getCASCommandWithNSString_withJavaUtilArrayList_withBoolean_withOrgGeogebraCommonKernelStringTemplate_withBoolean_(OrgGeogebraCommonCasGeoGebraCAS *self, NSString *name, JavaUtilArrayList *args, jboolean symbolic, OrgGeogebraCommonKernelStringTemplate *tpl, jboolean allowOutsourcing);

@implementation OrgGeogebraCommonCasGeoGebraCAS

- (instancetype)initWithOrgGeogebraCommonKernelKernel:(OrgGeogebraCommonKernelKernel *)kernel {
  OrgGeogebraCommonCasGeoGebraCAS_initWithOrgGeogebraCommonKernelKernel_(self, kernel);
  return self;
}

- (OrgGeogebraCommonCasCASparser *)getCASparser {
  return casParser_;
}

- (id<OrgGeogebraCommonKernelCASGenericInterface>)getCurrentCAS {
  if (cas_ == nil) {
    [((OrgGeogebraCommonMainApp *) nil_chk(app_)) setWaitCursor];
    [self initCurrentCAS];
    [app_ setDefaultCursor];
  }
  return cas_;
}

- (void)initCurrentCAS {
  @synchronized(self) {
    if (cas_ == nil) {
      [self setCurrentCAS];
    }
  }
}

- (void)setCurrentCAS {
  @synchronized(self) {
    @try {
      OrgGeogebraCommonCasGeoGebraCAS_set_cas_(self, OrgGeogebraCommonCasGeoGebraCAS_getGiac(self));
      [((OrgGeogebraCommonMainSettingsCASSettings *) nil_chk([((OrgGeogebraCommonMainSettingsSettings *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(app_)) getSettings])) getCasSettings])) addListenerWithOrgGeogebraCommonMainSettingsSettingListener:cas_];
    }
    @catch (JavaLangException *e) {
      [((JavaLangException *) nil_chk(e)) printStackTrace];
    }
  }
}

- (void)reset {
  [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) reset];
}

- (id<OrgGeogebraCommonKernelCASGenericInterface>)getGiac {
  return OrgGeogebraCommonCasGeoGebraCAS_getGiac(self);
}

- (NSString *)evaluateGeoGebraCASWithOrgGeogebraCommonKernelArithmeticValidExpression:(OrgGeogebraCommonKernelArithmeticValidExpression *)casInput
                             withOrgGeogebraCommonKernelArithmeticMyArbitraryConstant:(OrgGeogebraCommonKernelArithmeticMyArbitraryConstant *)arbconst
                                            withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl
                                            withOrgGeogebraCommonKernelGeosGeoCasCell:(OrgGeogebraCommonKernelGeosGeoCasCell *)cell
                                                    withOrgGeogebraCommonKernelKernel:(OrgGeogebraCommonKernelKernel *)kernel {
  NSString *result = nil;
  OrgGeogebraCommonKernelCASException *exception = nil;
  @try {
    result = [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) evaluateGeoGebraCASWithOrgGeogebraCommonKernelArithmeticValidExpression:casInput withOrgGeogebraCommonKernelArithmeticMyArbitraryConstant:arbconst withOrgGeogebraCommonKernelStringTemplate:tpl withOrgGeogebraCommonKernelGeosGeoCasCell:cell withOrgGeogebraCommonKernelKernel:kernel];
  }
  @catch (OrgGeogebraCommonKernelCASException *ce) {
    exception = ce;
  }
  @finally {
  }
  if (cell != nil && [cell isKeepInputUsed] && (exception != nil || [@"?" isEqual:result])) {
    return [((OrgGeogebraCommonKernelArithmeticValidExpression *) nil_chk(casInput)) toStringWithOrgGeogebraCommonKernelStringTemplate:tpl];
  }
  if (exception != nil) @throw exception;
  if (result != nil) {
    [((OrgGeogebraCommonMainApp *) nil_chk(app_)) getKernel];
    result = OrgGeogebraCommonKernelKernel_removeCASVariablePrefixWithNSString_withNSString_(result, @" ");
  }
  return result;
}

- (NSString *)evaluateGeoGebraCASWithNSString:(NSString *)exp
withOrgGeogebraCommonKernelArithmeticMyArbitraryConstant:(OrgGeogebraCommonKernelArithmeticMyArbitraryConstant *)arbconst
    withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl
            withOrgGeogebraCommonKernelKernel:(OrgGeogebraCommonKernelKernel *)kernel {
  @try {
    OrgGeogebraCommonKernelArithmeticValidExpression *inVE = [((OrgGeogebraCommonCasCASparser *) nil_chk(casParser_)) parseGeoGebraCASInputWithNSString:exp withOrgGeogebraCommonKernelGeosGeoCasCell:nil];
    NSString *ret = [self evaluateGeoGebraCASWithOrgGeogebraCommonKernelArithmeticValidExpression:inVE withOrgGeogebraCommonKernelArithmeticMyArbitraryConstant:arbconst withOrgGeogebraCommonKernelStringTemplate:tpl withOrgGeogebraCommonKernelGeosGeoCasCell:nil withOrgGeogebraCommonKernelKernel:kernel];
    if (ret == nil) @throw [new_OrgGeogebraCommonKernelCASException_initWithJavaLangThrowable_([new_JavaLangException_initWithNSString_([((OrgGeogebraCommonMainLocalization *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(app_)) getLocalization])) getErrorWithNSString:@"CAS.GeneralErrorMessage"]) autorelease]) autorelease];
    return ret;
  }
  @catch (JavaLangThrowable *t) {
    [((JavaLangThrowable *) nil_chk(t)) printStackTrace];
    @throw [new_OrgGeogebraCommonKernelCASException_initWithJavaLangThrowable_(t) autorelease];
  }
}

- (NSString *)evaluateRawWithNSString:(NSString *)exp {
  return [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) evaluateRawWithNSString:exp];
}

- (NSString *)evaluateWithNSString:(NSString *)exp {
  return OrgGeogebraCommonCasGeoGebraCAS_evaluateWithNSString_(self, exp);
}

- (IOSObjectArray *)getPolynomialCoeffsWithNSString:(NSString *)polyExpr
                                       withNSString:(NSString *)variable {
  [((JavaLangStringBuilder *) nil_chk(getPolynomialCoeffsSB_)) setLengthWithInt:0];
  [getPolynomialCoeffsSB_ appendWithNSString:polyExpr];
  [getPolynomialCoeffsSB_ appendWithChar:','];
  [getPolynomialCoeffsSB_ appendWithNSString:variable];
  IOSObjectArray *result = [((id<JavaUtilMap>) nil_chk(getPolynomialCoeffsCache_)) getWithId:[getPolynomialCoeffsSB_ description]];
  if (result != nil) return result;
  [((JavaLangStringBuilder *) nil_chk(sbPolyCoeffs_)) setLengthWithInt:0];
  [sbPolyCoeffs_ appendWithNSString:@"when(is\\_polynomial("];
  [sbPolyCoeffs_ appendWithNSString:polyExpr];
  [sbPolyCoeffs_ appendWithChar:','];
  [sbPolyCoeffs_ appendWithNSString:variable];
  [sbPolyCoeffs_ appendWithNSString:@"),"];
  [sbPolyCoeffs_ appendWithNSString:@"coeff("];
  [sbPolyCoeffs_ appendWithNSString:[getPolynomialCoeffsSB_ description]];
  [sbPolyCoeffs_ appendWithNSString:@"),{})"];
  @try {
    NSString *tmp = OrgGeogebraCommonCasGeoGebraCAS_evaluateWithNSString_(self, [sbPolyCoeffs_ description]);
    if ([@"{}" isEqual:tmp] || [@"" isEqual:tmp] || tmp == nil) return nil;
    if ([((NSString *) nil_chk(tmp)) indexOfString:variable] >= 0) return nil;
    [((OrgGeogebraCommonMainApp *) nil_chk(app_)) getKernel];
    tmp = OrgGeogebraCommonKernelKernel_removeCASVariablePrefixWithNSString_(tmp);
    tmp = [tmp substring:1 endIndex:((jint) [((NSString *) nil_chk(tmp)) length]) - 1];
    result = [((NSString *) nil_chk(tmp)) split:@","];
    [getPolynomialCoeffsCache_ putWithId:[getPolynomialCoeffsSB_ description] withId:result];
    return result;
  }
  @catch (JavaLangThrowable *e) {
    OrgGeogebraCommonMainApp_debugWithNSString_(JreStrcat("$$", @"GeoGebraCAS.getPolynomialCoeffs(): ", [((JavaLangThrowable *) nil_chk(e)) getMessage]));
  }
  return nil;
}

+ (NSString *)toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue:(id<OrgGeogebraCommonKernelArithmeticExpressionValue>)ev
                                                               withBoolean:(jboolean)symbolic
                                 withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl {
  return OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl);
}

- (NSString *)getCASCommandWithNSString:(NSString *)name
                  withJavaUtilArrayList:(JavaUtilArrayList *)args
                            withBoolean:(jboolean)symbolic
withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl {
  @synchronized(self) {
    return OrgGeogebraCommonCasGeoGebraCAS_getCASCommandWithNSString_withJavaUtilArrayList_withBoolean_withOrgGeogebraCommonKernelStringTemplate_withBoolean_(self, name, args, symbolic, tpl, YES);
  }
}

- (NSString *)getCASCommandWithNSString:(NSString *)name
                  withJavaUtilArrayList:(JavaUtilArrayList *)args
                            withBoolean:(jboolean)symbolic
withOrgGeogebraCommonKernelStringTemplate:(OrgGeogebraCommonKernelStringTemplate *)tpl
                            withBoolean:(jboolean)allowOutsourcing {
  return OrgGeogebraCommonCasGeoGebraCAS_getCASCommandWithNSString_withJavaUtilArrayList_withBoolean_withOrgGeogebraCommonKernelStringTemplate_withBoolean_(self, name, args, symbolic, tpl, allowOutsourcing);
}

- (jboolean)isCommandAvailableWithOrgGeogebraCommonKernelArithmeticCommand:(OrgGeogebraCommonKernelArithmeticCommand *)cmd {
  JavaLangStringBuilder *sbCASCommand = [new_JavaLangStringBuilder_init() autorelease];
  [sbCASCommand appendWithNSString:[((OrgGeogebraCommonKernelArithmeticCommand *) nil_chk(cmd)) getName]];
  [sbCASCommand appendWithNSString:@"."];
  [sbCASCommand appendWithInt:[cmd getArgumentNumber]];
  if ([((OrgGeogebraCommonCasCASparser *) nil_chk(casParser_)) isCommandAvailableWithNSString:[sbCASCommand description]]) return YES;
  OrgGeogebraCommonMainApp_debugWithNSString_(JreStrcat("$@", @"NOT AVAILABLE", sbCASCommand));
  [sbCASCommand setLengthWithInt:0];
  [sbCASCommand appendWithNSString:[cmd getName]];
  [sbCASCommand appendWithNSString:@".N"];
  if ([casParser_ isCommandAvailableWithNSString:[sbCASCommand description]]) {
    return YES;
  }
  return NO;
}

- (jboolean)isStructurallyEqualWithOrgGeogebraCommonKernelArithmeticValidExpression:(OrgGeogebraCommonKernelArithmeticValidExpression *)inputVE
                                                                       withNSString:(NSString *)localizedInput
                                                  withOrgGeogebraCommonKernelKernel:(OrgGeogebraCommonKernelKernel *)kernel {
  @try {
    NSString *input1normalized = [((OrgGeogebraCommonCasCASparser *) nil_chk(casParser_)) toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue:inputVE withOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_getWithOrgGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_(OrgGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_GEOGEBRA_XML())];
    OrgGeogebraCommonKernelArithmeticValidExpression *ve2 = [casParser_ parseGeoGebraCASInputAndResolveDummyVarsWithNSString:localizedInput withOrgGeogebraCommonKernelKernel:kernel withOrgGeogebraCommonKernelGeosGeoCasCell:nil];
    NSString *input2normalized = [casParser_ toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue:ve2 withOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_getWithOrgGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_(OrgGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_GEOGEBRA_XML())];
    return [((NSString *) nil_chk(input1normalized)) isEqual:input2normalized];
  }
  @catch (JavaLangThrowable *th) {
    OrgGeogebraCommonMainApp_debugWithNSString_(JreStrcat("$$", @"Invalid selection: ", localizedInput));
    return NO;
  }
}

- (void)evaluateGeoGebraCASAsyncWithOrgGeogebraCommonKernelAsynchronousCommand:(id<OrgGeogebraCommonKernelAsynchronousCommand>)c {
  [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) evaluateGeoGebraCASAsyncWithOrgGeogebraCommonKernelAsynchronousCommand:c];
}

- (id<JavaUtilSet>)getAvailableCommandNames {
  id<JavaUtilSet> cmdSet = [new_JavaUtilHashSet_init() autorelease];
  for (NSString * __strong signature in nil_chk([((id<JavaUtilMap>) nil_chk([((OrgGeogebraCommonCasCASparser *) nil_chk(casParser_)) getTranslationRessourceBundle])) keySet])) {
    NSString *cmd = [signature substring:0 endIndex:[((NSString *) nil_chk(signature)) indexOf:'.']];
    if (![@"Evaluate" isEqual:cmd]) {
      [cmdSet addWithId:cmd];
    }
  }
  return cmdSet;
}

- (void)clearCache {
  [((id<JavaUtilMap>) nil_chk(getPolynomialCoeffsCache_)) clear];
}

- (void)dealloc {
  RELEASE_(app_);
  RELEASE_(casParser_);
  RELEASE_(cas_);
  RELEASE_(getPolynomialCoeffsCache_);
  RELEASE_(getPolynomialCoeffsSB_);
  RELEASE_(sbPolyCoeffs_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonKernelKernel:", "GeoGebraCAS", NULL, 0x1, NULL, NULL },
    { "getCASparser", NULL, "Lorg.geogebra.common.cas.CASparser;", 0x1, NULL, NULL },
    { "getCurrentCAS", NULL, "Lorg.geogebra.common.kernel.CASGenericInterface;", 0x1, NULL, NULL },
    { "initCurrentCAS", NULL, "V", 0x21, NULL, NULL },
    { "setCurrentCAS", NULL, "V", 0x21, NULL, NULL },
    { "reset", NULL, "V", 0x1, NULL, NULL },
    { "getGiac", NULL, "Lorg.geogebra.common.kernel.CASGenericInterface;", 0x22, NULL, NULL },
    { "evaluateGeoGebraCASWithOrgGeogebraCommonKernelArithmeticValidExpression:withOrgGeogebraCommonKernelArithmeticMyArbitraryConstant:withOrgGeogebraCommonKernelStringTemplate:withOrgGeogebraCommonKernelGeosGeoCasCell:withOrgGeogebraCommonKernelKernel:", "evaluateGeoGebraCAS", "Ljava.lang.String;", 0x1, "Lorg.geogebra.common.kernel.CASException;", NULL },
    { "evaluateGeoGebraCASWithNSString:withOrgGeogebraCommonKernelArithmeticMyArbitraryConstant:withOrgGeogebraCommonKernelStringTemplate:withOrgGeogebraCommonKernelKernel:", "evaluateGeoGebraCAS", "Ljava.lang.String;", 0x11, "Lorg.geogebra.common.kernel.CASException;", NULL },
    { "evaluateRawWithNSString:", "evaluateRaw", "Ljava.lang.String;", 0x11, "Ljava.lang.Throwable;", NULL },
    { "evaluateWithNSString:", "evaluate", "Ljava.lang.String;", 0x11, "Lorg.geogebra.common.kernel.CASException;", NULL },
    { "getPolynomialCoeffsWithNSString:withNSString:", "getPolynomialCoeffs", "[Ljava.lang.String;", 0x11, NULL, NULL },
    { "toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue:withBoolean:withOrgGeogebraCommonKernelStringTemplate:", "toString", "Ljava.lang.String;", 0x1a, NULL, NULL },
    { "getCASCommandWithNSString:withJavaUtilArrayList:withBoolean:withOrgGeogebraCommonKernelStringTemplate:", "getCASCommand", "Ljava.lang.String;", 0x31, NULL, NULL },
    { "getCASCommandWithNSString:withJavaUtilArrayList:withBoolean:withOrgGeogebraCommonKernelStringTemplate:withBoolean:", "getCASCommand", "Ljava.lang.String;", 0x32, NULL, NULL },
    { "isCommandAvailableWithOrgGeogebraCommonKernelArithmeticCommand:", "isCommandAvailable", "Z", 0x11, NULL, NULL },
    { "isStructurallyEqualWithOrgGeogebraCommonKernelArithmeticValidExpression:withNSString:withOrgGeogebraCommonKernelKernel:", "isStructurallyEqual", "Z", 0x1, NULL, NULL },
    { "evaluateGeoGebraCASAsyncWithOrgGeogebraCommonKernelAsynchronousCommand:", "evaluateGeoGebraCASAsync", "V", 0x1, NULL, NULL },
    { "getAvailableCommandNames", NULL, "Ljava.util.Set;", 0x1, NULL, NULL },
    { "clearCache", NULL, "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "app_", NULL, 0x2, "Lorg.geogebra.common.main.App;", NULL, NULL,  },
    { "casParser_", NULL, 0x2, "Lorg.geogebra.common.cas.CASparser;", NULL, NULL,  },
    { "cas_", NULL, 0x2, "Lorg.geogebra.common.kernel.CASGenericInterface;", NULL, NULL,  },
    { "getPolynomialCoeffsCache_", NULL, 0x2, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;L[Ljava/lang/String;;>;",  },
    { "getPolynomialCoeffsSB_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "sbPolyCoeffs_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonCasGeoGebraCAS = { 2, "GeoGebraCAS", "org.geogebra.common.cas", NULL, 0x1, 20, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonCasGeoGebraCAS;
}

@end

void OrgGeogebraCommonCasGeoGebraCAS_initWithOrgGeogebraCommonKernelKernel_(OrgGeogebraCommonCasGeoGebraCAS *self, OrgGeogebraCommonKernelKernel *kernel) {
  NSObject_init(self);
  OrgGeogebraCommonCasGeoGebraCAS_setAndConsume_getPolynomialCoeffsCache_(self, new_OrgGeogebraCommonUtilMaxSizeHashMap_initWithInt_(OrgGeogebraCommonKernelKernel_get_GEOGEBRA_CAS_CACHE_SIZE_()));
  OrgGeogebraCommonCasGeoGebraCAS_setAndConsume_getPolynomialCoeffsSB_(self, new_JavaLangStringBuilder_init());
  OrgGeogebraCommonCasGeoGebraCAS_setAndConsume_sbPolyCoeffs_(self, new_JavaLangStringBuilder_init());
  OrgGeogebraCommonCasGeoGebraCAS_set_app_(self, [((OrgGeogebraCommonKernelKernel *) nil_chk(kernel)) getApplication]);
  OrgGeogebraCommonCasGeoGebraCAS_setAndConsume_casParser_(self, new_OrgGeogebraCommonCasCASparser_initWithOrgGeogebraCommonKernelParserParser_withOrgGeogebraCommonKernelParserCashandlersParserFunctions_([kernel getParser], [((OrgGeogebraCommonMainApp *) nil_chk([kernel getApplication])) getParserFunctions]));
}

OrgGeogebraCommonCasGeoGebraCAS *new_OrgGeogebraCommonCasGeoGebraCAS_initWithOrgGeogebraCommonKernelKernel_(OrgGeogebraCommonKernelKernel *kernel) {
  OrgGeogebraCommonCasGeoGebraCAS *self = [OrgGeogebraCommonCasGeoGebraCAS alloc];
  OrgGeogebraCommonCasGeoGebraCAS_initWithOrgGeogebraCommonKernelKernel_(self, kernel);
  return self;
}

id<OrgGeogebraCommonKernelCASGenericInterface> OrgGeogebraCommonCasGeoGebraCAS_getGiac(OrgGeogebraCommonCasGeoGebraCAS *self) {
  @synchronized(self) {
    if (self->cas_ == nil) {
      OrgGeogebraCommonCasGeoGebraCAS_set_cas_(self, [((OrgGeogebraCommonFactoriesCASFactory *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(self->app_)) getCASFactory])) newGiacWithOrgGeogebraCommonCasCASparser:self->casParser_ withOrgGeogebraCommonCasCasParserTools:[new_OrgGeogebraCommonCasCasParserToolsImpl_initWithChar_('e') autorelease] withOrgGeogebraCommonKernelKernel:[self->app_ getKernel]]);
    }
    return self->cas_;
  }
}

NSString *OrgGeogebraCommonCasGeoGebraCAS_evaluateWithNSString_(OrgGeogebraCommonCasGeoGebraCAS *self, NSString *exp) {
  return [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) evaluateCASWithNSString:exp];
}

NSString *OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev, jboolean symbolic, OrgGeogebraCommonKernelStringTemplate *tpl) {
  OrgGeogebraCommonCasGeoGebraCAS_initialize();
  if (symbolic) {
    return [((OrgGeogebraCommonKernelArithmeticExpressionNode *) nil_chk([((id<OrgGeogebraCommonKernelArithmeticExpressionValue>) nil_chk(ev)) wrap])) toStringWithOrgGeogebraCommonKernelStringTemplate:tpl];
  }
  return [((id<OrgGeogebraCommonKernelArithmeticExpressionValue>) nil_chk(ev)) toValueStringWithOrgGeogebraCommonKernelStringTemplate:tpl];
}

NSString *OrgGeogebraCommonCasGeoGebraCAS_getCASCommandWithNSString_withJavaUtilArrayList_withBoolean_withOrgGeogebraCommonKernelStringTemplate_withBoolean_(OrgGeogebraCommonCasGeoGebraCAS *self, NSString *name, JavaUtilArrayList *args, jboolean symbolic, OrgGeogebraCommonKernelStringTemplate *tpl, jboolean allowOutsourcing) {
  @synchronized(self) {
    JavaLangStringBuilder *sbCASCommand = [new_JavaLangStringBuilder_initWithInt_(80) autorelease];
    [sbCASCommand setLengthWithInt:0];
    [sbCASCommand appendWithNSString:name];
    [sbCASCommand appendWithNSString:@".N"];
    NSString *translation = [((OrgGeogebraCommonCasCASparser *) nil_chk(self->casParser_)) getTranslatedCASCommandWithNSString:[sbCASCommand description]];
    if (translation != nil) {
      [sbCASCommand setLengthWithInt:0];
      for (jint i = 0; i < ((jint) [translation length]); i++) {
        jchar ch = [translation charAtWithInt:i];
        if (ch == '%') {
          if ([((JavaUtilArrayList *) nil_chk(args)) size] == 1) {
            id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev = [((OrgGeogebraCommonKernelArithmeticExpressionNode *) nil_chk([args getWithInt:0])) unwrap];
            NSString *str = OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl);
            [sbCASCommand appendWithNSString:str];
          }
          else {
            [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) appendListStartWithJavaLangStringBuilder:sbCASCommand];
            for (jint j = 0; j < [args size]; j++) {
              id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev = [args getWithInt:j];
              [sbCASCommand appendWithNSString:OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl)];
              [sbCASCommand appendWithChar:','];
            }
            [sbCASCommand setLengthWithInt:[sbCASCommand length] - 1];
            [((id<OrgGeogebraCommonKernelCASGenericInterface>) nil_chk([self getCurrentCAS])) appendListEndWithJavaLangStringBuilder:sbCASCommand];
          }
        }
        else {
          [sbCASCommand appendWithChar:ch];
        }
      }
      return [sbCASCommand description];
    }
    [sbCASCommand setLengthWithInt:[sbCASCommand length] - 1];
    [sbCASCommand appendWithInt:[((JavaUtilArrayList *) nil_chk(args)) size]];
    jboolean outsourced = NO;
    if (allowOutsourcing && OrgGeogebraCommonMainApp_get_singularWS_() != nil && [OrgGeogebraCommonMainApp_get_singularWS_() isAvailable]) {
      translation = [OrgGeogebraCommonMainApp_get_singularWS_() getTranslatedCASCommandWithNSString:[sbCASCommand description]];
      if (translation != nil) {
        outsourced = YES;
      }
    }
    if (!outsourced) {
      translation = [self->casParser_ getTranslatedCASCommandWithNSString:[sbCASCommand description]];
    }
    [sbCASCommand setLengthWithInt:0];
    if (translation == nil) {
      OrgGeogebraCommonKernelKernel *kern = [((OrgGeogebraCommonMainApp *) nil_chk(self->app_)) getKernel];
      jboolean silent = [((OrgGeogebraCommonKernelKernel *) nil_chk(kern)) isSilentMode];
      jboolean handled = NO;
      if (((jint) [((NSString *) nil_chk(name)) length]) == 1) {
        jchar ch = [name charAtWithInt:0];
        if (ch == 'x' || ch == 'y' || ch == 'z') {
          if ([((OrgGeogebraCommonKernelArithmeticExpressionNode *) nil_chk([args getWithInt:0])) evaluatesToList]) {
            [sbCASCommand appendWithNSString:OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_([args getWithInt:0], symbolic, tpl)];
            [sbCASCommand appendWithChar:'['];
            switch (ch) {
              case 'x':
              default:
              [sbCASCommand appendWithChar:'0'];
              break;
              case 'y':
              [sbCASCommand appendWithChar:'1'];
              break;
              case 'z':
              [sbCASCommand appendWithChar:'2'];
              break;
            }
            [sbCASCommand appendWithChar:']'];
            return [sbCASCommand description];
          }
          else if ([((OrgGeogebraCommonKernelArithmeticExpressionNode *) nil_chk([args getWithInt:0])) hasCoords]) {
            [sbCASCommand appendWithChar:ch];
            [sbCASCommand appendWithNSString:@"coord("];
          }
          else {
            [sbCASCommand appendWithChar:'('];
            [sbCASCommand appendWithNSString:[((OrgGeogebraCommonKernelStringTemplate *) nil_chk(tpl)) printVariableNameWithNSString:JreStrcat("C", ch)]];
            [sbCASCommand appendWithNSString:@")*("];
          }
          handled = YES;
        }
      }
      else @try {
        OrgGeogebraCommonKernelCommandsCommandsEnum *c = OrgGeogebraCommonKernelCommandsCommandsEnum_valueOfWithNSString_(name);
        if (c != nil) {
          [kern setSilentModeWithBoolean:YES];
          JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_initWithNSString_(name) autorelease];
          [sb appendWithChar:'['];
          for (jint i = 0; i < [args size]; i++) {
            if (i > 0) [sb appendWithChar:','];
            [sb appendWithNSString:[((OrgGeogebraCommonKernelArithmeticExpressionNode *) nil_chk([args getWithInt:i])) toOutputValueStringWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()]];
          }
          [sb appendWithChar:']'];
          OrgGeogebraCommonMainApp_debugWithNSString_([sb description]);
          IOSObjectArray *ggbResult = [((OrgGeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([kern getAlgebraProcessor])) processAlgebraCommandNoExceptionHandlingWithNSString:[sb description] withBoolean:NO withBoolean:NO withBoolean:NO withBoolean:NO];
          [kern setSilentModeWithBoolean:silent];
          if (ggbResult != nil && ggbResult->size_ > 0 && IOSObjectArray_Get(ggbResult, 0) != nil) return [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(ggbResult, 0))) toValueStringWithOrgGeogebraCommonKernelStringTemplate:tpl];
        }
      }
      @catch (JavaLangException *e) {
        [kern setSilentModeWithBoolean:silent];
        OrgGeogebraCommonUtilDebugLog_infoWithNSString_(JreStrcat("$$", name, @" not known command or function"));
      }
      if (!handled) {
        [sbCASCommand appendWithNSString:[((OrgGeogebraCommonKernelStringTemplate *) nil_chk(tpl)) printVariableNameWithNSString:name]];
        [sbCASCommand appendWithChar:'('];
      }
      for (jint i = 0; i < [args size]; i++) {
        id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev = [args getWithInt:i];
        [sbCASCommand appendWithNSString:OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl)];
        [sbCASCommand appendWithChar:','];
      }
      [sbCASCommand setCharAtWithInt:[sbCASCommand length] - 1 withChar:')'];
    }
    else {
      for (jint i = 0; i < ((jint) [translation length]); i++) {
        jchar ch = [translation charAtWithInt:i];
        if (ch == '%') {
          i++;
          jint pos = [translation charAtWithInt:i] - '0';
          if (pos >= 0 && pos < [args size]) {
            id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev = [args getWithInt:pos];
            [sbCASCommand appendWithNSString:OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl)];
          }
          else {
            [sbCASCommand appendWithChar:ch];
            [sbCASCommand appendWithChar:[translation charAtWithInt:i]];
          }
        }
        else if (ch == '@') {
          i++;
          jint pos = [translation charAtWithInt:i] - '0';
          if (pos >= 0 && pos < [args size]) {
            id<OrgGeogebraCommonKernelArithmeticExpressionValue> ev = [args getWithInt:pos];
            if ([((NSString *) nil_chk(OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl))) matches:@"[^(),]*"]) [sbCASCommand appendWithNSString:OrgGeogebraCommonCasGeoGebraCAS_toStringWithOrgGeogebraCommonKernelArithmeticExpressionValue_withBoolean_withOrgGeogebraCommonKernelStringTemplate_(ev, symbolic, tpl)];
            else [sbCASCommand appendWithNSString:@"x"];
          }
          else {
            [sbCASCommand appendWithChar:ch];
            [sbCASCommand appendWithChar:[translation charAtWithInt:i]];
          }
        }
        else {
          [sbCASCommand appendWithChar:ch];
        }
      }
    }
    if (outsourced) {
      @try {
        NSString *retval = [((OrgGeogebraCommonCasSingularwsSingularWebService *) nil_chk(OrgGeogebraCommonMainApp_get_singularWS_())) directCommandWithNSString:[sbCASCommand description]];
        if (retval == nil || [retval isEqual:@""]) {
          return OrgGeogebraCommonCasGeoGebraCAS_getCASCommandWithNSString_withJavaUtilArrayList_withBoolean_withOrgGeogebraCommonKernelStringTemplate_withBoolean_(self, name, args, symbolic, tpl, NO);
        }
        return retval;
      }
      @catch (JavaLangThrowable *e) {
        return OrgGeogebraCommonCasGeoGebraCAS_getCASCommandWithNSString_withJavaUtilArrayList_withBoolean_withOrgGeogebraCommonKernelStringTemplate_withBoolean_(self, name, args, symbolic, tpl, NO);
      }
    }
    return [sbCASCommand description];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonCasGeoGebraCAS)
