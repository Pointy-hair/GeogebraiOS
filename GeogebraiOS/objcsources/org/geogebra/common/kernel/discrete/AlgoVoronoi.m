//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/org/geogebra/common/kernel/discrete/AlgoVoronoi.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/util/ArrayList.h"
#include "java/util/Comparator.h"
#include "java/util/Iterator.h"
#include "java/util/TreeSet.h"
#include "org/geogebra/common/awt/GPoint2D.h"
#include "org/geogebra/common/kernel/Construction.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/MyPoint.h"
#include "org/geogebra/common/kernel/commands/Commands.h"
#include "org/geogebra/common/kernel/discrete/AlgoDelauneyTriangulation.h"
#include "org/geogebra/common/kernel/discrete/AlgoHull.h"
#include "org/geogebra/common/kernel/discrete/AlgoVoronoi.h"
#include "org/geogebra/common/kernel/discrete/MyLine.h"
#include "org/geogebra/common/kernel/discrete/delaunay/Delaunay_Triangulation.h"
#include "org/geogebra/common/kernel/discrete/delaunay/Point_dt.h"
#include "org/geogebra/common/kernel/discrete/delaunay/Triangle_dt.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/kernel/geos/GeoList.h"
#include "org/geogebra/common/kernel/geos/GeoLocus.h"
#include "org/geogebra/common/kernel/kernelND/GeoPointND.h"

static id<JavaUtilComparator> OrgGeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_;
J2OBJC_STATIC_FIELD_GETTER(OrgGeogebraCommonKernelDiscreteAlgoVoronoi, pointComparator_, id<JavaUtilComparator>)
J2OBJC_STATIC_FIELD_SETTER(OrgGeogebraCommonKernelDiscreteAlgoVoronoi, pointComparator_, id<JavaUtilComparator>)

@interface OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 : NSObject < JavaUtilComparator >

- (jint)compareWithId:(OrgGeogebraCommonAwtGPoint2D *)p1
               withId:(OrgGeogebraCommonAwtGPoint2D *)p2;

- (instancetype)init;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1)

__attribute__((unused)) static void OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 *self);

__attribute__((unused)) static OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 *new_OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init() NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1)

@implementation OrgGeogebraCommonKernelDiscreteAlgoVoronoi

- (instancetype)initWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons
                                               withNSString:(NSString *)label
                     withOrgGeogebraCommonKernelGeosGeoList:(OrgGeogebraCommonKernelGeosGeoList *)inputList {
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_(self, cons, label, inputList);
  return self;
}

- (OrgGeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return OrgGeogebraCommonKernelCommandsCommandsEnum_get_Voronoi();
}

- (void)compute {
  size_ = [((OrgGeogebraCommonKernelGeosGeoList *) nil_chk(inputList_)) size];
  if (![inputList_ isDefined] || size_ == 0) {
    [((OrgGeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setUndefined];
    return;
  }
  IOSDoubleArray *inhom = [IOSDoubleArray arrayWithLength:2];
  JavaUtilArrayList *xcoords = [new_JavaUtilArrayList_init() autorelease];
  JavaUtilArrayList *ycoords = [new_JavaUtilArrayList_init() autorelease];
  jdouble delta = 0.0000001;
  JavaUtilTreeSet *pointTree = [new_JavaUtilTreeSet_initWithJavaUtilComparator_(OrgGeogebraCommonKernelDiscreteAlgoVoronoi_getPointComparator()) autorelease];
  for (jint i = 0; i < size_; i++) {
    OrgGeogebraCommonKernelGeosGeoElement *geo = [inputList_ getWithInt:i];
    if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isDefined] && [geo isGeoPoint]) {
      id<OrgGeogebraCommonKernelKernelNDGeoPointND> p = (id<OrgGeogebraCommonKernelKernelNDGeoPointND>) check_protocol_cast(geo, @protocol(OrgGeogebraCommonKernelKernelNDGeoPointND));
      [p getInhomCoordsWithDoubleArray:inhom];
      [pointTree addWithId:[new_OrgGeogebraCommonAwtGPoint2D_Double_initWithDouble_withDouble_(IOSDoubleArray_Get(inhom, 0), IOSDoubleArray_Get(inhom, 1)) autorelease]];
    }
  }
  IOSObjectArray *points = [IOSObjectArray arrayWithLength:[pointTree size] type:OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt_class_()];
  jint indx = 0;
  id<JavaUtilIterator> it3 = [pointTree iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it3)) hasNext]) {
    OrgGeogebraCommonAwtGPoint2D *p = [it3 next];
    jdouble x = [((OrgGeogebraCommonAwtGPoint2D *) nil_chk(p)) getX];
    jdouble y = [p getY];
    while ([xcoords containsWithId:JavaLangDouble_valueOfWithDouble_(x)]) {
      x += delta;
    }
    while ([ycoords containsWithId:JavaLangDouble_valueOfWithDouble_(y)]) {
      y += delta;
    }
    [xcoords addWithId:JavaLangDouble_valueOfWithDouble_(x)];
    [ycoords addWithId:JavaLangDouble_valueOfWithDouble_(y)];
    IOSObjectArray_SetAndConsume(points, indx++, new_OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt_initWithDouble_withDouble_(x, y));
  }
  OrgGeogebraCommonKernelDiscreteDelaunayDelaunay_Triangulation *dt = [new_OrgGeogebraCommonKernelDiscreteDelaunayDelaunay_Triangulation_initWithOrgGeogebraCommonKernelDiscreteDelaunayPoint_dtArray_(points) autorelease];
  if (dt->allCollinear_) {
    [((OrgGeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setUndefined];
    return;
  }
  id<JavaUtilIterator> it = [dt trianglesIterator];
  if (al_ == nil) {
    OrgGeogebraCommonKernelDiscreteAlgoHull_setAndConsume_al_(self, new_JavaUtilArrayList_init());
  }
  else {
    [al_ clear];
  }
  JavaUtilTreeSet *tree = [new_JavaUtilTreeSet_initWithJavaUtilComparator_(OrgGeogebraCommonKernelDiscreteAlgoDelauneyTriangulation_getComparator()) autorelease];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgGeogebraCommonKernelDiscreteDelaunayTriangle_dt *triangle = [it next];
    for (jint index = 0; index < 3; index++) {
      OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt *corner = [((OrgGeogebraCommonKernelDiscreteDelaunayTriangle_dt *) nil_chk(triangle)) getCornerWithInt:index];
      if (corner != nil) {
        IOSObjectArray *voronoiCell = [dt calcVoronoiCellWithOrgGeogebraCommonKernelDiscreteDelaunayTriangle_dt:triangle withOrgGeogebraCommonKernelDiscreteDelaunayPoint_dt:corner];
        if (voronoiCell != nil) for (jint i = 0; i < voronoiCell->size_ - 1; i++) {
          [tree addWithId:[new_OrgGeogebraCommonKernelDiscreteMyLine_initWithOrgGeogebraCommonAwtGPoint2D_withOrgGeogebraCommonAwtGPoint2D_([new_OrgGeogebraCommonAwtGPoint2D_Double_initWithDouble_withDouble_([((OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, i))) x], [((OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, i))) y]) autorelease], [new_OrgGeogebraCommonAwtGPoint2D_Double_initWithDouble_withDouble_([((OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, (i + 1) % voronoiCell->size_))) x], [((OrgGeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, (i + 1) % voronoiCell->size_))) y]) autorelease]) autorelease]];
        }
      }
    }
  }
  id<JavaUtilIterator> it2 = [tree iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it2)) hasNext]) {
    OrgGeogebraCommonKernelDiscreteMyLine *line = [it2 next];
    [((JavaUtilArrayList *) nil_chk(al_)) addWithId:[new_OrgGeogebraCommonKernelMyPoint_initWithDouble_withDouble_withBoolean_([((OrgGeogebraCommonAwtGPoint2D *) nil_chk(((OrgGeogebraCommonKernelDiscreteMyLine *) nil_chk(line))->p1_)) getX], [line->p1_ getY], NO) autorelease]];
    [al_ addWithId:[new_OrgGeogebraCommonKernelMyPoint_initWithDouble_withDouble_withBoolean_([((OrgGeogebraCommonAwtGPoint2D *) nil_chk(line->p2_)) getX], [line->p2_ getY], YES) autorelease]];
  }
  [((OrgGeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setPointsWithJavaUtilArrayList:al_];
  [locus_ setDefinedWithBoolean:YES];
}

+ (id<JavaUtilComparator>)getPointComparator {
  return OrgGeogebraCommonKernelDiscreteAlgoVoronoi_getPointComparator();
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonKernelConstruction:withNSString:withOrgGeogebraCommonKernelGeosGeoList:", "AlgoVoronoi", NULL, 0x1, NULL, NULL },
    { "getClassName", NULL, "Lorg.geogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "compute", NULL, "V", 0x11, NULL, NULL },
    { "getPointComparator", NULL, "Ljava.util.Comparator;", 0x9, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "pointComparator_", NULL, 0xa, "Ljava.util.Comparator;", &OrgGeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_, "Ljava/util/Comparator<Lorg/geogebra/common/awt/GPoint2D;>;",  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelDiscreteAlgoVoronoi = { 2, "AlgoVoronoi", "org.geogebra.common.kernel.discrete", NULL, 0x1, 4, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonKernelDiscreteAlgoVoronoi;
}

@end

void OrgGeogebraCommonKernelDiscreteAlgoVoronoi_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_(OrgGeogebraCommonKernelDiscreteAlgoVoronoi *self, OrgGeogebraCommonKernelConstruction *cons, NSString *label, OrgGeogebraCommonKernelGeosGeoList *inputList) {
  OrgGeogebraCommonKernelDiscreteAlgoHull_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(self, cons, label, inputList, nil);
}

OrgGeogebraCommonKernelDiscreteAlgoVoronoi *new_OrgGeogebraCommonKernelDiscreteAlgoVoronoi_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_(OrgGeogebraCommonKernelConstruction *cons, NSString *label, OrgGeogebraCommonKernelGeosGeoList *inputList) {
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi *self = [OrgGeogebraCommonKernelDiscreteAlgoVoronoi alloc];
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_(self, cons, label, inputList);
  return self;
}

id<JavaUtilComparator> OrgGeogebraCommonKernelDiscreteAlgoVoronoi_getPointComparator() {
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi_initialize();
  if (OrgGeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_ == nil) {
    JreStrongAssignAndConsume(&OrgGeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_, nil, new_OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init());
  }
  return OrgGeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelDiscreteAlgoVoronoi)

@implementation OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1

- (jint)compareWithId:(OrgGeogebraCommonAwtGPoint2D *)p1
               withId:(OrgGeogebraCommonAwtGPoint2D *)p2 {
  if (OrgGeogebraCommonKernelKernel_isEqualWithDouble_withDouble_([((OrgGeogebraCommonAwtGPoint2D *) nil_chk(p1)) getX], [((OrgGeogebraCommonAwtGPoint2D *) nil_chk(p2)) getX]) && OrgGeogebraCommonKernelKernel_isEqualWithDouble_withDouble_([p1 getY], [p2 getY])) {
    return 0;
  }
  return [p1 getX] > [p2 getX] ? -1 : 1;
}

- (instancetype)init {
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(self);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "compareWithId:withId:", "compare", "I", 0x1, NULL, NULL },
    { "init", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgGeogebraCommonKernelDiscreteAlgoVoronoi", "getPointComparator" };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 = { 2, "", "org.geogebra.common.kernel.discrete", "AlgoVoronoi", 0x8008, 2, methods, 0, NULL, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Ljava/util/Comparator<Lorg/geogebra/common/awt/GPoint2D;>;" };
  return &_OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1;
}

@end

void OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 *self) {
  NSObject_init(self);
}

OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 *new_OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init() {
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 *self = [OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1 alloc];
  OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelDiscreteAlgoVoronoi_$1)
