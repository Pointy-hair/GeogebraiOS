//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/geogebra/common/kernel/discrete/tsp/util/Heap.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Comparable.h"
#include "java/lang/Error.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Integer.h"
#include "java/lang/StringBuilder.h"
#include "java/lang/System.h"
#include "java/util/Comparator.h"
#include "java/util/HashMap.h"
#include "java/util/Map.h"
#include "org/geogebra/common/kernel/discrete/tsp/util/Heap.h"

#define OrgGeogebraCommonKernelDiscreteTspUtilHeap_DEFAULT_CAPACITY 10

@interface OrgGeogebraCommonKernelDiscreteTspUtilHeap () {
 @public
  IOSObjectArray *entries_;
  jint size__;
  id<JavaUtilMap> table_;
  id<JavaUtilComparator> comparator_;
}

- (void)swapWithInt:(jint)index1
            withInt:(jint)index2;

- (void)fixDownWithInt:(jint)index;

- (void)fixUpWithInt:(jint)index;

- (void)growWithInt:(jint)index;

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelDiscreteTspUtilHeap, entries_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelDiscreteTspUtilHeap, table_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelDiscreteTspUtilHeap, comparator_, id<JavaUtilComparator>)

J2OBJC_STATIC_FIELD_GETTER(OrgGeogebraCommonKernelDiscreteTspUtilHeap, DEFAULT_CAPACITY, jint)

__attribute__((unused)) static void OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index1, jint index2);

__attribute__((unused)) static void OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixDownWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index);

__attribute__((unused)) static void OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixUpWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index);

__attribute__((unused)) static void OrgGeogebraCommonKernelDiscreteTspUtilHeap_growWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index);

@implementation OrgGeogebraCommonKernelDiscreteTspUtilHeap

- (instancetype)init {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_init(self);
  return self;
}

- (instancetype)initWithInt:(jint)initialCapacity {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_(self, initialCapacity);
  return self;
}

- (instancetype)initWithJavaUtilComparator:(id<JavaUtilComparator>)comparator {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithJavaUtilComparator_(self, comparator);
  return self;
}

- (instancetype)initWithInt:(jint)initialCapacity
     withJavaUtilComparator:(id<JavaUtilComparator>)comparator {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_withJavaUtilComparator_(self, initialCapacity, comparator);
  return self;
}

- (jboolean)addWithId:(id)key {
  id entry_ = key;
  JavaLangInteger *pointer = [((id<JavaUtilMap>) nil_chk(self->table_)) getWithId:key];
  if (pointer != nil) {
    jint index = [pointer intValue];
    if (self->comparator_ == nil) {
      if ([((id<JavaLangComparable>) nil_chk(((id<JavaLangComparable>) check_protocol_cast(IOSObjectArray_Get(nil_chk(self->entries_), index), @protocol(JavaLangComparable))))) compareToWithId:entry_] > 0) {
        (void) IOSObjectArray_Set(self->entries_, index, entry_);
        OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixUpWithInt_(self, index);
      }
      else {
        return NO;
      }
    }
    else {
      if ([self->comparator_ compareWithId:IOSObjectArray_Get(nil_chk(self->entries_), index) withId:entry_] > 0) {
        (void) IOSObjectArray_Set(self->entries_, index, entry_);
        OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixUpWithInt_(self, index);
      }
      else {
        return NO;
      }
    }
  }
  else {
    OrgGeogebraCommonKernelDiscreteTspUtilHeap_growWithInt_(self, ++self->size__);
    (void) [self->table_ putWithId:key withId:JavaLangInteger_valueOfWithInt_(self->size__)];
    (void) IOSObjectArray_Set(nil_chk(self->entries_), self->size__, entry_);
    OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixUpWithInt_(self, self->size__);
  }
  return YES;
}

- (void)swapWithInt:(jint)index1
            withInt:(jint)index2 {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(self, index1, index2);
}

- (id)poll {
  if (self->size__ == 0) {
    return nil;
  }
  id entry_ = IOSObjectArray_Get(nil_chk(self->entries_), 1);
  (void) [((id<JavaUtilMap>) nil_chk(self->table_)) removeWithId:entry_];
  if (self->size__ > 1) {
    (void) IOSObjectArray_Set(self->entries_, 1, IOSObjectArray_Get(self->entries_, self->size__));
    (void) [self->table_ putWithId:IOSObjectArray_Get(self->entries_, 1) withId:JavaLangInteger_valueOfWithInt_(1)];
  }
  (void) IOSObjectArray_Set(self->entries_, self->size__, nil);
  if (--self->size__ > 1) {
    OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixDownWithInt_(self, 1);
  }
  return entry_;
}

- (id)peek {
  return IOSObjectArray_Get(nil_chk(self->entries_), 1);
}

- (jboolean)containsKeyWithId:(id)key {
  return [((id<JavaUtilMap>) nil_chk(self->table_)) containsKeyWithId:key];
}

- (void)clear {
  [((id<JavaUtilMap>) nil_chk(self->table_)) clear];
  for (jint i = 0; i <= self->size__; i++) {
    (void) IOSObjectArray_Set(nil_chk(self->entries_), i, nil);
  }
  self->size__ = 0;
}

- (void)fixDownWithInt:(jint)index {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixDownWithInt_(self, index);
}

- (void)fixUpWithInt:(jint)index {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixUpWithInt_(self, index);
}

- (jboolean)isEmpty {
  return self->size__ == 0;
}

- (void)growWithInt:(jint)index {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_growWithInt_(self, index);
}

- (NSString *)description {
  if (self->size__ == 0) {
    return @"";
  }
  JavaLangStringBuilder *sb = new_JavaLangStringBuilder_initWithNSString_([nil_chk(IOSObjectArray_Get(nil_chk(self->entries_), 1)) description]);
  for (jint i = 2; i <= self->size__; i++) {
    (void) [sb appendWithNSString:JreStrcat("C$", ',', [nil_chk(IOSObjectArray_Get(self->entries_, i)) description])];
  }
  return [sb description];
}

- (jint)size {
  return self->size__;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "Heap", NULL, 0x1, NULL, NULL },
    { "initWithInt:", "Heap", NULL, 0x1, NULL, NULL },
    { "initWithJavaUtilComparator:", "Heap", NULL, 0x1, NULL, NULL },
    { "initWithInt:withJavaUtilComparator:", "Heap", NULL, 0x1, NULL, NULL },
    { "addWithId:", "add", "Z", 0x1, NULL, "(TE;)Z" },
    { "swapWithInt:withInt:", "swap", "V", 0x2, NULL, NULL },
    { "poll", NULL, "TE;", 0x1, NULL, "()TE;" },
    { "peek", NULL, "TE;", 0x1, NULL, "()TE;" },
    { "containsKeyWithId:", "containsKey", "Z", 0x1, NULL, NULL },
    { "clear", NULL, "V", 0x1, NULL, NULL },
    { "fixDownWithInt:", "fixDown", "V", 0x2, NULL, NULL },
    { "fixUpWithInt:", "fixUp", "V", 0x2, NULL, NULL },
    { "isEmpty", NULL, "Z", 0x1, NULL, NULL },
    { "growWithInt:", "grow", "V", 0x2, NULL, NULL },
    { "description", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "size", NULL, "I", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "DEFAULT_CAPACITY_", NULL, 0x1a, "I", NULL, NULL, .constantValue.asInt = OrgGeogebraCommonKernelDiscreteTspUtilHeap_DEFAULT_CAPACITY },
    { "entries_", NULL, 0x2, "[Ljava.lang.Object;", NULL, "[TE;",  },
    { "size__", "size", 0x2, "I", NULL, NULL,  },
    { "table_", NULL, 0x12, "Ljava.util.Map;", NULL, "Ljava/util/Map<TE;Ljava/lang/Integer;>;",  },
    { "comparator_", NULL, 0x12, "Ljava.util.Comparator;", NULL, "Ljava/util/Comparator<TE;>;",  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelDiscreteTspUtilHeap = { 2, "Heap", "org.geogebra.common.kernel.discrete.tsp.util", NULL, 0x1, 16, methods, 5, fields, 0, NULL, 0, NULL, NULL, "<E:Ljava/lang/Object;>Ljava/lang/Object;" };
  return &_OrgGeogebraCommonKernelDiscreteTspUtilHeap;
}

@end

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_init(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self) {
  (void) OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithJavaUtilComparator_(self, nil);
}

OrgGeogebraCommonKernelDiscreteTspUtilHeap *new_OrgGeogebraCommonKernelDiscreteTspUtilHeap_init() {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap *self = [OrgGeogebraCommonKernelDiscreteTspUtilHeap alloc];
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_init(self);
  return self;
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint initialCapacity) {
  (void) OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_withJavaUtilComparator_(self, initialCapacity, nil);
}

OrgGeogebraCommonKernelDiscreteTspUtilHeap *new_OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_(jint initialCapacity) {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap *self = [OrgGeogebraCommonKernelDiscreteTspUtilHeap alloc];
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_(self, initialCapacity);
  return self;
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithJavaUtilComparator_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, id<JavaUtilComparator> comparator) {
  (void) OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_withJavaUtilComparator_(self, OrgGeogebraCommonKernelDiscreteTspUtilHeap_DEFAULT_CAPACITY, comparator);
}

OrgGeogebraCommonKernelDiscreteTspUtilHeap *new_OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithJavaUtilComparator_(id<JavaUtilComparator> comparator) {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap *self = [OrgGeogebraCommonKernelDiscreteTspUtilHeap alloc];
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithJavaUtilComparator_(self, comparator);
  return self;
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_withJavaUtilComparator_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint initialCapacity, id<JavaUtilComparator> comparator) {
  (void) NSObject_init(self);
  if (initialCapacity < 1) {
    @throw new_JavaLangIllegalArgumentException_init();
  }
  self->size__ = 0;
  self->entries_ = (IOSObjectArray *) check_class_cast([IOSObjectArray newArrayWithLength:initialCapacity + 1 type:NSObject_class_()], [IOSObjectArray class]);
  self->table_ = new_JavaUtilHashMap_init();
  self->comparator_ = comparator;
}

OrgGeogebraCommonKernelDiscreteTspUtilHeap *new_OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_withJavaUtilComparator_(jint initialCapacity, id<JavaUtilComparator> comparator) {
  OrgGeogebraCommonKernelDiscreteTspUtilHeap *self = [OrgGeogebraCommonKernelDiscreteTspUtilHeap alloc];
  OrgGeogebraCommonKernelDiscreteTspUtilHeap_initWithInt_withJavaUtilComparator_(self, initialCapacity, comparator);
  return self;
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index1, jint index2) {
  id tmp = IOSObjectArray_Get(nil_chk(self->entries_), index1);
  (void) IOSObjectArray_Set(self->entries_, index1, IOSObjectArray_Get(self->entries_, index2));
  (void) IOSObjectArray_Set(self->entries_, index2, tmp);
  (void) [((id<JavaUtilMap>) nil_chk(self->table_)) putWithId:IOSObjectArray_Get(self->entries_, index1) withId:JavaLangInteger_valueOfWithInt_(index1)];
  (void) [self->table_ putWithId:IOSObjectArray_Get(self->entries_, index2) withId:JavaLangInteger_valueOfWithInt_(index2)];
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixDownWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index) {
  jint son;
  if (self->comparator_ == nil) {
    while ((son = LShift32(index, 1)) <= self->size__) {
      if (son < self->size__ && [((id<JavaLangComparable>) nil_chk(((id<JavaLangComparable>) check_protocol_cast(IOSObjectArray_Get(nil_chk(self->entries_), son), @protocol(JavaLangComparable))))) compareToWithId:IOSObjectArray_Get(self->entries_, son + 1)] > 0) {
        son++;
      }
      if ([((id<JavaLangComparable>) nil_chk(((id<JavaLangComparable>) check_protocol_cast(IOSObjectArray_Get(nil_chk(self->entries_), index), @protocol(JavaLangComparable))))) compareToWithId:IOSObjectArray_Get(self->entries_, son)] <= 0) {
        break;
      }
      OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(self, index, son);
      index = son;
    }
  }
  else {
    while ((son = LShift32(index, 1)) <= self->size__) {
      if (son < self->size__ && [self->comparator_ compareWithId:IOSObjectArray_Get(nil_chk(self->entries_), son) withId:IOSObjectArray_Get(self->entries_, son + 1)] > 0) {
        son++;
      }
      if ([self->comparator_ compareWithId:IOSObjectArray_Get(nil_chk(self->entries_), index) withId:IOSObjectArray_Get(self->entries_, son)] <= 0) {
        break;
      }
      OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(self, index, son);
      index = son;
    }
  }
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_fixUpWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index) {
  jint parent;
  if (self->comparator_ == nil) {
    while ((parent = RShift32(index, 1)) > 0) {
      if ([((id<JavaLangComparable>) nil_chk(((id<JavaLangComparable>) check_protocol_cast(IOSObjectArray_Get(nil_chk(self->entries_), index), @protocol(JavaLangComparable))))) compareToWithId:IOSObjectArray_Get(self->entries_, parent)] >= 0) {
        break;
      }
      OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(self, index, parent);
      index = parent;
    }
  }
  else {
    while ((parent = RShift32(index, 1)) > 0) {
      if ([self->comparator_ compareWithId:IOSObjectArray_Get(nil_chk(self->entries_), index) withId:IOSObjectArray_Get(self->entries_, parent)] >= 0) {
        break;
      }
      OrgGeogebraCommonKernelDiscreteTspUtilHeap_swapWithInt_withInt_(self, index, parent);
      index = parent;
    }
  }
}

void OrgGeogebraCommonKernelDiscreteTspUtilHeap_growWithInt_(OrgGeogebraCommonKernelDiscreteTspUtilHeap *self, jint index) {
  jint newLength = ((IOSObjectArray *) nil_chk(self->entries_))->size_;
  if (index < newLength) {
    return;
  }
  if (index == JavaLangInteger_MAX_VALUE) {
    @throw new_JavaLangError_initWithNSString_(@"Out of memory");
  }
  while (newLength <= index) {
    if (newLength >= JavaLangInteger_MAX_VALUE / 2) {
      newLength = JavaLangInteger_MAX_VALUE;
    }
    else {
      LShiftAssignInt(&newLength, 2);
    }
  }
  IOSObjectArray *newEntrys = (IOSObjectArray *) check_class_cast([IOSObjectArray newArrayWithLength:newLength type:NSObject_class_()], [IOSObjectArray class]);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(self->entries_, 0, newEntrys, 0, self->entries_->size_);
  self->entries_ = newEntrys;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelDiscreteTspUtilHeap)
