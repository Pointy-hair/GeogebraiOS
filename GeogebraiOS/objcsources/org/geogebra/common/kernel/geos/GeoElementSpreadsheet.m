//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/geogebra/common/kernel/geos/GeoElementSpreadsheet.java
//


#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "com/google/gwt/regexp/shared/MatchResult.h"
#include "com/google/gwt/regexp/shared/RegExp.h"
#include "java/lang/Exception.h"
#include "java/lang/Integer.h"
#include "java/lang/StringBuilder.h"
#include "org/geogebra/common/awt/GPoint.h"
#include "org/geogebra/common/kernel/Construction.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/StringTemplate.h"
#include "org/geogebra/common/kernel/arithmetic/FunctionalNVar.h"
#include "org/geogebra/common/kernel/commands/AlgebraProcessor.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/kernel/geos/GeoElementSpreadsheet.h"
#include "org/geogebra/common/main/App.h"

static JavaLangStringBuilder *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_;
J2OBJC_STATIC_FIELD_GETTER(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet, sb_, JavaLangStringBuilder *)
J2OBJC_STATIC_FIELD_SETTER(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet, sb_, JavaLangStringBuilder *)

J2OBJC_INITIALIZED_DEFN(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet)

ComGoogleGwtRegexpSharedRegExp *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_;

@implementation OrgGeogebraCommonKernelGeosGeoElementSpreadsheet

+ (NSString *)getSpreadsheetColumnNameWithInt:(jint)column {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnNameWithInt_(column);
}

+ (NSString *)getSpreadsheetColumnNameWithNSString:(NSString *)label {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnNameWithNSString_(label);
}

+ (NSString *)getSpreadsheetCellNameWithInt:(jint)column
                                    withInt:(jint)row {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetCellNameWithInt_withInt_(column, row);
}

+ (OrgGeogebraCommonAwtGPoint *)spreadsheetIndicesWithNSString:(NSString *)cellName {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetIndicesWithNSString_(cellName);
}

+ (jboolean)hasSpreadsheetLabelWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geo {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_hasSpreadsheetLabelWithOrgGeogebraCommonKernelGeosGeoElement_(geo);
}

+ (jboolean)isSpreadsheetLabelWithNSString:(NSString *)str {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_isSpreadsheetLabelWithNSString_(str);
}

+ (jint)getSpreadsheetColumnWithComGoogleGwtRegexpSharedMatchResult:(ComGoogleGwtRegexpSharedMatchResult *)matcher {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnWithComGoogleGwtRegexpSharedMatchResult_(matcher);
}

+ (jint)getSpreadsheetRowWithComGoogleGwtRegexpSharedMatchResult:(ComGoogleGwtRegexpSharedMatchResult *)matcher {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetRowWithComGoogleGwtRegexpSharedMatchResult_(matcher);
}

+ (OrgGeogebraCommonAwtGPoint *)getSpreadsheetCoordsForLabelWithNSString:(NSString *)inputLabel {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetCoordsForLabelWithNSString_(inputLabel);
}

- (void)setSpreadsheetCellWithOrgGeogebraCommonMainApp:(OrgGeogebraCommonMainApp *)app
                                               withInt:(jint)row
                                               withInt:(jint)col
             withOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)cellGeo {
  NSString *cellName = OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetCellNameWithInt_withInt_(col, row);
  if (OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ == nil) OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ = new_JavaLangStringBuilder_init();
  else [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ setLengthWithInt:0];
  (void) [((JavaLangStringBuilder *) nil_chk(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_)) appendWithNSString:cellName];
  if ([OrgGeogebraCommonKernelArithmeticFunctionalNVar_class_() isInstance:cellGeo]) {
    (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:@"("];
    (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:[((id<OrgGeogebraCommonKernelArithmeticFunctionalNVar>) nil_chk(((id<OrgGeogebraCommonKernelArithmeticFunctionalNVar>) check_protocol_cast(cellGeo, @protocol(OrgGeogebraCommonKernelArithmeticFunctionalNVar))))) getVarStringWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()]];
    (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:@")"];
  }
  NSString *label = [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(cellGeo)) getLabelWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()];
  if ([((NSString *) nil_chk(label)) indexOf:'='] == -1) (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithChar:'='];
  else (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithChar:':'];
  (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:label];
  if ([OrgGeogebraCommonKernelArithmeticFunctionalNVar_class_() isInstance:cellGeo] && [cellGeo isLabelSet]) {
    (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:@"("];
    (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:[((id<OrgGeogebraCommonKernelArithmeticFunctionalNVar>) check_protocol_cast(cellGeo, @protocol(OrgGeogebraCommonKernelArithmeticFunctionalNVar))) getVarStringWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()]];
    (void) [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ appendWithNSString:@")"];
  }
  (void) [((OrgGeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk(app)) getKernel])) getAlgebraProcessor])) processAlgebraCommandWithNSString:[OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_ description] withBoolean:NO];
  OrgGeogebraCommonKernelGeosGeoElement *cell = [((OrgGeogebraCommonKernelKernel *) nil_chk([app getKernel])) lookupLabelWithNSString:cellName];
  if (cell != nil) {
    [(cell) setVisualStyleWithOrgGeogebraCommonKernelGeosGeoElement:cellGeo];
    [(cell) setAuxiliaryObjectWithBoolean:YES];
  }
}

+ (OrgGeogebraCommonKernelGeosGeoElement *)autoCreateWithNSString:(NSString *)label
                          withOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons {
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_autoCreateWithNSString_withOrgGeogebraCommonKernelConstruction_(label, cons);
}

- (instancetype)init {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_init(self);
  return self;
}

+ (void)initialize {
  if (self == [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet class]) {
    OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_ = ComGoogleGwtRegexpSharedRegExp_compileWithNSString_(@"^(\\$?)([A-Z]+)(\\$?)([1-9][0-9]*)$");
    J2OBJC_SET_INITIALIZED(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "getSpreadsheetColumnNameWithInt:", "getSpreadsheetColumnName", "Ljava.lang.String;", 0x9, NULL, NULL },
    { "getSpreadsheetColumnNameWithNSString:", "getSpreadsheetColumnName", "Ljava.lang.String;", 0x9, NULL, NULL },
    { "getSpreadsheetCellNameWithInt:withInt:", "getSpreadsheetCellName", "Ljava.lang.String;", 0x9, NULL, NULL },
    { "spreadsheetIndicesWithNSString:", "spreadsheetIndices", "Lorg.geogebra.common.awt.GPoint;", 0x9, NULL, NULL },
    { "hasSpreadsheetLabelWithOrgGeogebraCommonKernelGeosGeoElement:", "hasSpreadsheetLabel", "Z", 0x9, NULL, NULL },
    { "isSpreadsheetLabelWithNSString:", "isSpreadsheetLabel", "Z", 0x9, NULL, NULL },
    { "getSpreadsheetColumnWithComGoogleGwtRegexpSharedMatchResult:", "getSpreadsheetColumn", "I", 0x9, NULL, NULL },
    { "getSpreadsheetRowWithComGoogleGwtRegexpSharedMatchResult:", "getSpreadsheetRow", "I", 0x9, NULL, NULL },
    { "getSpreadsheetCoordsForLabelWithNSString:", "getSpreadsheetCoordsForLabel", "Lorg.geogebra.common.awt.GPoint;", 0x9, NULL, NULL },
    { "setSpreadsheetCellWithOrgGeogebraCommonMainApp:withInt:withInt:withOrgGeogebraCommonKernelGeosGeoElement:", "setSpreadsheetCell", "V", 0x1, NULL, NULL },
    { "autoCreateWithNSString:withOrgGeogebraCommonKernelConstruction:", "autoCreate", "Lorg.geogebra.common.kernel.geos.GeoElement;", 0x9, NULL, NULL },
    { "init", NULL, NULL, 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "spreadsheetPattern_", NULL, 0x19, "Lcom.google.gwt.regexp.shared.RegExp;", &OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_, NULL,  },
    { "MATCH_COLUMN_$_", NULL, 0x19, "I", NULL, NULL, .constantValue.asInt = OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_COLUMN_$ },
    { "MATCH_COLUMN_", NULL, 0x19, "I", NULL, NULL, .constantValue.asInt = OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_COLUMN },
    { "MATCH_ROW_$_", NULL, 0x19, "I", NULL, NULL, .constantValue.asInt = OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_ROW_$ },
    { "MATCH_ROW_", NULL, 0x19, "I", NULL, NULL, .constantValue.asInt = OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_ROW },
    { "sb_", NULL, 0xa, "Ljava.lang.StringBuilder;", &OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_sb_, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelGeosGeoElementSpreadsheet = { 2, "GeoElementSpreadsheet", "org.geogebra.common.kernel.geos", NULL, 0x1, 12, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonKernelGeosGeoElementSpreadsheet;
}

@end

NSString *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnNameWithInt_(jint column) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  jint i = column + 1;
  NSString *col = @"";
  while (i > 0) {
    col = JreStrcat("C$", (jchar) ('A' + (i - 1) % 26), col);
    i = (i - 1) / 26;
  }
  return col;
}

NSString *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnNameWithNSString_(NSString *label) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  ComGoogleGwtRegexpSharedMatchResult *matcher = [((ComGoogleGwtRegexpSharedRegExp *) nil_chk(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_)) execWithNSString:label];
  if (matcher == nil) return nil;
  return [((ComGoogleGwtRegexpSharedMatchResult *) nil_chk(matcher)) getGroupWithInt:OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_COLUMN];
}

NSString *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetCellNameWithInt_withInt_(jint column, jint row) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  if (column >= OrgGeogebraCommonKernelKernel_get_MAX_SPREADSHEET_COLUMNS_DESKTOP_() || row >= OrgGeogebraCommonKernelKernel_get_MAX_SPREADSHEET_ROWS_DESKTOP_() || column < 0 || row < 0) {
    return nil;
  }
  return JreStrcat("$I", OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnNameWithInt_(column), (row + 1));
}

OrgGeogebraCommonAwtGPoint *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetIndicesWithNSString_(NSString *cellName) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  ComGoogleGwtRegexpSharedMatchResult *matcher = [((ComGoogleGwtRegexpSharedRegExp *) nil_chk(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_)) execWithNSString:cellName];
  return new_OrgGeogebraCommonAwtGPoint_initWithInt_withInt_(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnWithComGoogleGwtRegexpSharedMatchResult_(matcher), OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetRowWithComGoogleGwtRegexpSharedMatchResult_(matcher));
}

jboolean OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_hasSpreadsheetLabelWithOrgGeogebraCommonKernelGeosGeoElement_(OrgGeogebraCommonKernelGeosGeoElement *geo) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  return OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_isSpreadsheetLabelWithNSString_([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) getLabelWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()]);
}

jboolean OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_isSpreadsheetLabelWithNSString_(NSString *str) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  if (str == nil) return NO;
  ComGoogleGwtRegexpSharedMatchResult *matcher = [((ComGoogleGwtRegexpSharedRegExp *) nil_chk(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_)) execWithNSString:str];
  if (matcher == nil) {
    return NO;
  }
  if (OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnWithComGoogleGwtRegexpSharedMatchResult_(matcher) == -1 || OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetRowWithComGoogleGwtRegexpSharedMatchResult_(matcher) == -1) {
    return NO;
  }
  return YES;
}

jint OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetColumnWithComGoogleGwtRegexpSharedMatchResult_(ComGoogleGwtRegexpSharedMatchResult *matcher) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  if (matcher == nil) return -1;
  NSString *s = [((ComGoogleGwtRegexpSharedMatchResult *) nil_chk(matcher)) getGroupWithInt:OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_COLUMN];
  jint column = 0;
  while (((jint) [((NSString *) nil_chk(s)) length]) > 0) {
    column *= 26;
    column += [s charAtWithInt:0] - 'A' + 1;
    s = [s substring:1];
  }
  if (column > OrgGeogebraCommonKernelKernel_get_MAX_SPREADSHEET_COLUMNS_DESKTOP_()) {
    return -1;
  }
  return column - 1;
}

jint OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetRowWithComGoogleGwtRegexpSharedMatchResult_(ComGoogleGwtRegexpSharedMatchResult *matcher) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  if (matcher == nil) return -1;
  jint ret = -1;
  @try {
    NSString *s = [((ComGoogleGwtRegexpSharedMatchResult *) nil_chk(matcher)) getGroupWithInt:OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_ROW];
    ret = JavaLangInteger_parseIntWithNSString_(s) - 1;
  }
  @catch (JavaLangException *e) {
    return -1;
  }
  if (ret + 1 > OrgGeogebraCommonKernelKernel_get_MAX_SPREADSHEET_ROWS_DESKTOP_()) {
    return -1;
  }
  return ret;
}

OrgGeogebraCommonAwtGPoint *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_getSpreadsheetCoordsForLabelWithNSString_(NSString *inputLabel) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  OrgGeogebraCommonAwtGPoint *p = OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetIndicesWithNSString_(inputLabel);
  if (((OrgGeogebraCommonAwtGPoint *) nil_chk(p))->x_ >= 0 && p->y_ >= 0) {
    return p;
  }
  return nil;
}

OrgGeogebraCommonKernelGeosGeoElement *OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_autoCreateWithNSString_withOrgGeogebraCommonKernelConstruction_(NSString *label, OrgGeogebraCommonKernelConstruction *cons) {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_initialize();
  ComGoogleGwtRegexpSharedMatchResult *cellNameMatcher = [((ComGoogleGwtRegexpSharedRegExp *) nil_chk(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_spreadsheetPattern_)) execWithNSString:label];
  if (cellNameMatcher != nil) {
    NSString *col = [cellNameMatcher getGroupWithInt:OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_COLUMN];
    jint row = JavaLangInteger_parseIntWithNSString_([cellNameMatcher getGroupWithInt:OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_MATCH_ROW]);
    OrgGeogebraCommonKernelGeosGeoElement *neighbourCell = [((OrgGeogebraCommonKernelConstruction *) nil_chk(cons)) geoTableVarLookupWithNSString:JreStrcat("$I", col, (row - 1))];
    if (neighbourCell == nil) neighbourCell = [cons geoTableVarLookupWithNSString:JreStrcat("$I", col, (row + 1))];
    NSString *label1 = JreStrcat("$I", col, row);
    return [cons createSpreadsheetGeoElementWithOrgGeogebraCommonKernelGeosGeoElement:neighbourCell withNSString:label1];
  }
  return nil;
}

void OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_init(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet *self) {
  (void) NSObject_init(self);
}

OrgGeogebraCommonKernelGeosGeoElementSpreadsheet *new_OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_init() {
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet *self = [OrgGeogebraCommonKernelGeosGeoElementSpreadsheet alloc];
  OrgGeogebraCommonKernelGeosGeoElementSpreadsheet_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelGeosGeoElementSpreadsheet)
