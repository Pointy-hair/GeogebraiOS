//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/geogebra/common/kernel/statistics/AlgoNpR.java
//


#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/lang/Exception.h"
#include "java/lang/Math.h"
#include "java/math/BigDecimal.h"
#include "java/math/BigInteger.h"
#include "org/geogebra/common/kernel/Construction.h"
#include "org/geogebra/common/kernel/algos/AlgoElement.h"
#include "org/geogebra/common/kernel/arithmetic/NumberValue.h"
#include "org/geogebra/common/kernel/commands/Commands.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/kernel/geos/GeoNumeric.h"
#include "org/geogebra/common/kernel/statistics/AlgoNpR.h"
#include "org/geogebra/common/util/MyMath2.h"

@interface OrgGeogebraCommonKernelStatisticsAlgoNpR () {
 @public
  OrgGeogebraCommonKernelGeosGeoNumeric *result_;
  id<OrgGeogebraCommonKernelArithmeticNumberValue> num1_, num2_;
}

+ (jdouble)NpRWithDouble:(jdouble)n
              withDouble:(jdouble)r;

+ (jdouble)NpRBigWithDouble:(jdouble)n
                 withDouble:(jdouble)r;

+ (jdouble)NpRLogWithDouble:(jdouble)n
                 withDouble:(jdouble)r;

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoNpR, result_, OrgGeogebraCommonKernelGeosGeoNumeric *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoNpR, num1_, id<OrgGeogebraCommonKernelArithmeticNumberValue>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoNpR, num2_, id<OrgGeogebraCommonKernelArithmeticNumberValue>)

__attribute__((unused)) static jdouble OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRWithDouble_withDouble_(jdouble n, jdouble r);

__attribute__((unused)) static jdouble OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRBigWithDouble_withDouble_(jdouble n, jdouble r);

__attribute__((unused)) static jdouble OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRLogWithDouble_withDouble_(jdouble n, jdouble r);

@implementation OrgGeogebraCommonKernelStatisticsAlgoNpR

- (instancetype)initWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons
                                               withNSString:(NSString *)label
           withOrgGeogebraCommonKernelArithmeticNumberValue:(id<OrgGeogebraCommonKernelArithmeticNumberValue>)num1
           withOrgGeogebraCommonKernelArithmeticNumberValue:(id<OrgGeogebraCommonKernelArithmeticNumberValue>)num2 {
  OrgGeogebraCommonKernelStatisticsAlgoNpR_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelArithmeticNumberValue_withOrgGeogebraCommonKernelArithmeticNumberValue_(self, cons, label, num1, num2);
  return self;
}

- (void)setInputOutput {
  [self setOnlyOutputWithOrgGeogebraCommonKernelGeosToGeoElement:result_];
  input_ = [IOSObjectArray newArrayWithObjects:(id[]){ [((id<OrgGeogebraCommonKernelArithmeticNumberValue>) nil_chk(num1_)) toGeoElement], [((id<OrgGeogebraCommonKernelArithmeticNumberValue>) nil_chk(num2_)) toGeoElement] } count:2 type:OrgGeogebraCommonKernelGeosGeoElement_class_()];
  [self setDependencies];
}

- (void)compute {
  if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(nil_chk(input_), 0))) isDefined] && [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(input_, 1))) isDefined]) {
    jdouble nCr = OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRWithDouble_withDouble_([((id<OrgGeogebraCommonKernelArithmeticNumberValue>) nil_chk(num1_)) getDouble], [((id<OrgGeogebraCommonKernelArithmeticNumberValue>) nil_chk(num2_)) getDouble]);
    [((OrgGeogebraCommonKernelGeosGeoNumeric *) nil_chk(result_)) setValueWithDouble:nCr];
  }
  else [((OrgGeogebraCommonKernelGeosGeoNumeric *) nil_chk(result_)) setUndefined];
}

- (OrgGeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return OrgGeogebraCommonKernelCommandsCommandsEnum_get_nPr();
}

- (OrgGeogebraCommonKernelGeosGeoNumeric *)getResult {
  return result_;
}

+ (jdouble)NpRWithDouble:(jdouble)n
              withDouble:(jdouble)r {
  return OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRWithDouble_withDouble_(n, r);
}

+ (jdouble)NpRBigWithDouble:(jdouble)n
                 withDouble:(jdouble)r {
  return OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRBigWithDouble_withDouble_(n, r);
}

+ (jdouble)NpRLogWithDouble:(jdouble)n
                 withDouble:(jdouble)r {
  return OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRLogWithDouble_withDouble_(n, r);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonKernelConstruction:withNSString:withOrgGeogebraCommonKernelArithmeticNumberValue:withOrgGeogebraCommonKernelArithmeticNumberValue:", "AlgoNpR", NULL, 0x1, NULL, NULL },
    { "setInputOutput", NULL, "V", 0x4, NULL, NULL },
    { "compute", NULL, "V", 0x1, NULL, NULL },
    { "getClassName", NULL, "Lorg.geogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "getResult", NULL, "Lorg.geogebra.common.kernel.geos.GeoNumeric;", 0x1, NULL, NULL },
    { "NpRWithDouble:withDouble:", "NpR", "D", 0xa, NULL, NULL },
    { "NpRBigWithDouble:withDouble:", "NpRBig", "D", 0xa, NULL, NULL },
    { "NpRLogWithDouble:withDouble:", "NpRLog", "D", 0xa, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "result_", NULL, 0x2, "Lorg.geogebra.common.kernel.geos.GeoNumeric;", NULL, NULL,  },
    { "num1_", NULL, 0x2, "Lorg.geogebra.common.kernel.arithmetic.NumberValue;", NULL, NULL,  },
    { "num2_", NULL, 0x2, "Lorg.geogebra.common.kernel.arithmetic.NumberValue;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelStatisticsAlgoNpR = { 2, "AlgoNpR", "org.geogebra.common.kernel.statistics", NULL, 0x1, 8, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonKernelStatisticsAlgoNpR;
}

@end

void OrgGeogebraCommonKernelStatisticsAlgoNpR_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelArithmeticNumberValue_withOrgGeogebraCommonKernelArithmeticNumberValue_(OrgGeogebraCommonKernelStatisticsAlgoNpR *self, OrgGeogebraCommonKernelConstruction *cons, NSString *label, id<OrgGeogebraCommonKernelArithmeticNumberValue> num1, id<OrgGeogebraCommonKernelArithmeticNumberValue> num2) {
  (void) OrgGeogebraCommonKernelAlgosAlgoElement_initWithOrgGeogebraCommonKernelConstruction_(self, cons);
  self->num1_ = num1;
  self->num2_ = num2;
  self->result_ = new_OrgGeogebraCommonKernelGeosGeoNumeric_initWithOrgGeogebraCommonKernelConstruction_(cons);
  [self setInputOutput];
  [self compute];
  [self->result_ setLabelWithNSString:label];
}

OrgGeogebraCommonKernelStatisticsAlgoNpR *new_OrgGeogebraCommonKernelStatisticsAlgoNpR_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelArithmeticNumberValue_withOrgGeogebraCommonKernelArithmeticNumberValue_(OrgGeogebraCommonKernelConstruction *cons, NSString *label, id<OrgGeogebraCommonKernelArithmeticNumberValue> num1, id<OrgGeogebraCommonKernelArithmeticNumberValue> num2) {
  OrgGeogebraCommonKernelStatisticsAlgoNpR *self = [OrgGeogebraCommonKernelStatisticsAlgoNpR alloc];
  OrgGeogebraCommonKernelStatisticsAlgoNpR_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelArithmeticNumberValue_withOrgGeogebraCommonKernelArithmeticNumberValue_(self, cons, label, num1, num2);
  return self;
}

jdouble OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRWithDouble_withDouble_(jdouble n, jdouble r) {
  OrgGeogebraCommonKernelStatisticsAlgoNpR_initialize();
  jdouble INFINITY_ = JavaLangDouble_POSITIVE_INFINITY;
  @try {
    if (n == 0.0 && r == 0.0) return 1.0;
    if (n < 1.0 || r < 0.0 || n < r) return 0.0;
    if (JavaLangMath_floorWithDouble_(n) != n || JavaLangMath_floorWithDouble_(r) != r) return 0.0;
    jdouble ncr = OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRLogWithDouble_withDouble_(n, r);
    if (ncr == INFINITY_) return INFINITY_;
    if (n <= 16) return ncr;
    return OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRBigWithDouble_withDouble_(n, r);
  }
  @catch (JavaLangException *e) {
    return INFINITY_;
  }
}

jdouble OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRBigWithDouble_withDouble_(jdouble n, jdouble r) {
  OrgGeogebraCommonKernelStatisticsAlgoNpR_initialize();
  JavaMathBigInteger *ncr = JavaMathBigInteger_get_ONE_(), *nn, *nr;
  JavaLangDouble *nnn = new_JavaLangDouble_initWithDouble_(n);
  JavaLangDouble *rrr = new_JavaLangDouble_initWithDouble_(n - r);
  nn = [(new_JavaMathBigDecimal_initWithNSString_([nnn description])) toBigInteger];
  nr = [(new_JavaMathBigDecimal_initWithNSString_([rrr description])) toBigInteger];
  nr = [((JavaMathBigInteger *) nil_chk(nr)) addWithJavaMathBigInteger:JavaMathBigInteger_get_ONE_()];
  while ([((JavaMathBigInteger *) nil_chk(nr)) compareToWithId:nn] <= 0) {
    ncr = [((JavaMathBigInteger *) nil_chk(ncr)) multiplyWithJavaMathBigInteger:nr];
    nr = [nr addWithJavaMathBigInteger:JavaMathBigInteger_get_ONE_()];
  }
  return [((JavaMathBigInteger *) nil_chk(ncr)) doubleValue];
}

jdouble OrgGeogebraCommonKernelStatisticsAlgoNpR_NpRLogWithDouble_withDouble_(jdouble n, jdouble r) {
  OrgGeogebraCommonKernelStatisticsAlgoNpR_initialize();
  return JavaLangMath_floorWithDouble_(0.5 + JavaLangMath_expWithDouble_(OrgGeogebraCommonUtilMyMath2_logGammaWithDouble_(n + 1.0) - OrgGeogebraCommonUtilMyMath2_logGammaWithDouble_(n - r + 1)));
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelStatisticsAlgoNpR)
