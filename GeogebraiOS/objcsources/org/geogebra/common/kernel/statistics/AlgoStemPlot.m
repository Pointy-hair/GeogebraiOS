//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeoGebraiOSARC/GeoGebraiOSARC/javasources/org/geogebra/common/kernel/statistics/AlgoStemPlot.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Comparable.h"
#include "java/lang/Double.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/StringBuffer.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "org/geogebra/common/kernel/Construction.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/algos/AlgoElement.h"
#include "org/geogebra/common/kernel/algos/ConstructionElement.h"
#include "org/geogebra/common/kernel/commands/Commands.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/kernel/geos/GeoList.h"
#include "org/geogebra/common/kernel/geos/GeoNumeric.h"
#include "org/geogebra/common/kernel/geos/GeoText.h"
#include "org/geogebra/common/kernel/statistics/AlgoStemPlot.h"
#include "org/geogebra/common/main/App.h"
#include "org/geogebra/common/main/Localization.h"
#include "org/geogebra/common/util/StringUtil.h"

@interface OrgGeogebraCommonKernelStatisticsAlgoStemPlot () {
 @public
  OrgGeogebraCommonKernelGeosGeoList *geoList_;
  OrgGeogebraCommonKernelGeosGeoNumeric *scaleAdjustment_;
  OrgGeogebraCommonKernelGeosGeoText *text_;
  JavaLangStringBuilder *low_, *high_;
  JavaLangStringBuilder *sb_;
}

+ (IOSIntArray *)getOutlierIndexWithDoubleArray:(IOSDoubleArray *)data;

+ (JavaUtilArrayList *)createStemPlotArrayWithDoubleArray:(IOSDoubleArray *)data
                                               withDouble:(jdouble)stemFactor
                                             withIntArray:(IOSIntArray *)outlierIndex;

- (void)stemPlotWithDoubleArray:(IOSDoubleArray *)data
                   withIntArray:(IOSIntArray *)outlierIndex
                     withDouble:(jdouble)multUnit
          withJavaUtilArrayList:(JavaUtilArrayList *)stemLines;

- (void)stemPlotMQWithDoubleArray:(IOSDoubleArray *)data
                     withIntArray:(IOSIntArray *)outlierIndex
                       withDouble:(jdouble)multUnit
            withJavaUtilArrayList:(JavaUtilArrayList *)stemLines;

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoStemPlot, geoList_, OrgGeogebraCommonKernelGeosGeoList *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoStemPlot, scaleAdjustment_, OrgGeogebraCommonKernelGeosGeoNumeric *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoStemPlot, text_, OrgGeogebraCommonKernelGeosGeoText *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoStemPlot, low_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoStemPlot, high_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelStatisticsAlgoStemPlot, sb_, JavaLangStringBuilder *)

__attribute__((unused)) static IOSIntArray *OrgGeogebraCommonKernelStatisticsAlgoStemPlot_getOutlierIndexWithDoubleArray_(IOSDoubleArray *data);

__attribute__((unused)) static JavaUtilArrayList *OrgGeogebraCommonKernelStatisticsAlgoStemPlot_createStemPlotArrayWithDoubleArray_withDouble_withIntArray_(IOSDoubleArray *data, jdouble stemFactor, IOSIntArray *outlierIndex);

__attribute__((unused)) static void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_compute(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self);

__attribute__((unused)) static void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self, IOSDoubleArray *data, IOSIntArray *outlierIndex, jdouble multUnit, JavaUtilArrayList *stemLines);

__attribute__((unused)) static void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotMQWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self, IOSDoubleArray *data, IOSIntArray *outlierIndex, jdouble multUnit, JavaUtilArrayList *stemLines);

@implementation OrgGeogebraCommonKernelStatisticsAlgoStemPlot

- (instancetype)initWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons
                                               withNSString:(NSString *)label
                     withOrgGeogebraCommonKernelGeosGeoList:(OrgGeogebraCommonKernelGeosGeoList *)geoList
                  withOrgGeogebraCommonKernelGeosGeoNumeric:(OrgGeogebraCommonKernelGeosGeoNumeric *)scaleAdjustment {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(self, cons, label, geoList, scaleAdjustment);
  return self;
}

- (instancetype)initWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons
                     withOrgGeogebraCommonKernelGeosGeoList:(OrgGeogebraCommonKernelGeosGeoList *)geoList
                  withOrgGeogebraCommonKernelGeosGeoNumeric:(OrgGeogebraCommonKernelGeosGeoNumeric *)scaleAdjustment {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(self, cons, geoList, scaleAdjustment);
  return self;
}

- (OrgGeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return OrgGeogebraCommonKernelCommandsCommandsEnum_get_StemPlot();
}

- (void)setInputOutput {
  input_ = [IOSObjectArray newArrayWithLength:scaleAdjustment_ == nil ? 1 : 2 type:OrgGeogebraCommonKernelGeosGeoElement_class_()];
  (void) IOSObjectArray_Set(input_, 0, geoList_);
  if (scaleAdjustment_ != nil) (void) IOSObjectArray_Set(input_, 1, scaleAdjustment_);
  [super setOutputLengthWithInt:1];
  [super setOutputWithInt:0 withOrgGeogebraCommonKernelGeosGeoElement:text_];
  [self setDependencies];
}

- (OrgGeogebraCommonKernelGeosGeoText *)getResult {
  return text_;
}

+ (IOSIntArray *)getOutlierIndexWithDoubleArray:(IOSDoubleArray *)data {
  return OrgGeogebraCommonKernelStatisticsAlgoStemPlot_getOutlierIndexWithDoubleArray_(data);
}

+ (JavaUtilArrayList *)createStemPlotArrayWithDoubleArray:(IOSDoubleArray *)data
                                               withDouble:(jdouble)stemFactor
                                             withIntArray:(IOSIntArray *)outlierIndex {
  return OrgGeogebraCommonKernelStatisticsAlgoStemPlot_createStemPlotArrayWithDoubleArray_withDouble_withIntArray_(data, stemFactor, outlierIndex);
}

- (void)compute {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_compute(self);
}

- (void)stemPlotWithDoubleArray:(IOSDoubleArray *)data
                   withIntArray:(IOSIntArray *)outlierIndex
                     withDouble:(jdouble)multUnit
          withJavaUtilArrayList:(JavaUtilArrayList *)stemLines {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(self, data, outlierIndex, multUnit, stemLines);
}

- (void)stemPlotMQWithDoubleArray:(IOSDoubleArray *)data
                     withIntArray:(IOSIntArray *)outlierIndex
                       withDouble:(jdouble)multUnit
            withJavaUtilArrayList:(JavaUtilArrayList *)stemLines {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotMQWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(self, data, outlierIndex, multUnit, stemLines);
}

- (jboolean)isLaTeXTextCommand {
  return YES;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonKernelConstruction:withNSString:withOrgGeogebraCommonKernelGeosGeoList:withOrgGeogebraCommonKernelGeosGeoNumeric:", "AlgoStemPlot", NULL, 0x1, NULL, NULL },
    { "initWithOrgGeogebraCommonKernelConstruction:withOrgGeogebraCommonKernelGeosGeoList:withOrgGeogebraCommonKernelGeosGeoNumeric:", "AlgoStemPlot", NULL, 0x1, NULL, NULL },
    { "getClassName", NULL, "Lorg.geogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "setInputOutput", NULL, "V", 0x4, NULL, NULL },
    { "getResult", NULL, "Lorg.geogebra.common.kernel.geos.GeoText;", 0x1, NULL, NULL },
    { "getOutlierIndexWithDoubleArray:", "getOutlierIndex", "[I", 0xa, NULL, NULL },
    { "createStemPlotArrayWithDoubleArray:withDouble:withIntArray:", "createStemPlotArray", "Ljava.util.ArrayList;", 0xa, NULL, NULL },
    { "compute", NULL, "V", 0x11, NULL, NULL },
    { "stemPlotWithDoubleArray:withIntArray:withDouble:withJavaUtilArrayList:", "stemPlot", "V", 0x2, NULL, NULL },
    { "stemPlotMQWithDoubleArray:withIntArray:withDouble:withJavaUtilArrayList:", "stemPlotMQ", "V", 0x2, NULL, NULL },
    { "isLaTeXTextCommand", NULL, "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "geoList_", NULL, 0x2, "Lorg.geogebra.common.kernel.geos.GeoList;", NULL, NULL,  },
    { "scaleAdjustment_", NULL, 0x2, "Lorg.geogebra.common.kernel.geos.GeoNumeric;", NULL, NULL,  },
    { "text_", NULL, 0x2, "Lorg.geogebra.common.kernel.geos.GeoText;", NULL, NULL,  },
    { "low_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "high_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "sb_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelStatisticsAlgoStemPlot = { 2, "AlgoStemPlot", "org.geogebra.common.kernel.statistics", NULL, 0x1, 11, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgGeogebraCommonKernelStatisticsAlgoStemPlot;
}

@end

void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self, OrgGeogebraCommonKernelConstruction *cons, NSString *label, OrgGeogebraCommonKernelGeosGeoList *geoList, OrgGeogebraCommonKernelGeosGeoNumeric *scaleAdjustment) {
  (void) OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(self, cons, geoList, scaleAdjustment);
  [((OrgGeogebraCommonKernelGeosGeoText *) nil_chk(self->text_)) setLabelWithNSString:label];
}

OrgGeogebraCommonKernelStatisticsAlgoStemPlot *new_OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(OrgGeogebraCommonKernelConstruction *cons, NSString *label, OrgGeogebraCommonKernelGeosGeoList *geoList, OrgGeogebraCommonKernelGeosGeoNumeric *scaleAdjustment) {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self = [OrgGeogebraCommonKernelStatisticsAlgoStemPlot alloc];
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(self, cons, label, geoList, scaleAdjustment);
  return self;
}

void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self, OrgGeogebraCommonKernelConstruction *cons, OrgGeogebraCommonKernelGeosGeoList *geoList, OrgGeogebraCommonKernelGeosGeoNumeric *scaleAdjustment) {
  (void) OrgGeogebraCommonKernelAlgosAlgoElement_initWithOrgGeogebraCommonKernelConstruction_(self, cons);
  self->sb_ = new_JavaLangStringBuilder_init();
  self->geoList_ = geoList;
  self->scaleAdjustment_ = scaleAdjustment;
  self->text_ = new_OrgGeogebraCommonKernelGeosGeoText_initWithOrgGeogebraCommonKernelConstruction_(cons);
  [self->text_ setIsTextCommandWithBoolean:YES];
  [self setInputOutput];
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_compute(self);
  [self->text_ setSerifFontWithBoolean:NO];
}

OrgGeogebraCommonKernelStatisticsAlgoStemPlot *new_OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(OrgGeogebraCommonKernelConstruction *cons, OrgGeogebraCommonKernelGeosGeoList *geoList, OrgGeogebraCommonKernelGeosGeoNumeric *scaleAdjustment) {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self = [OrgGeogebraCommonKernelStatisticsAlgoStemPlot alloc];
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelGeosGeoList_withOrgGeogebraCommonKernelGeosGeoNumeric_(self, cons, geoList, scaleAdjustment);
  return self;
}

IOSIntArray *OrgGeogebraCommonKernelStatisticsAlgoStemPlot_getOutlierIndexWithDoubleArray_(IOSDoubleArray *data) {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initialize();
  jint size = ((IOSDoubleArray *) nil_chk(data))->size_;
  IOSIntArray *outlierIndex = [IOSIntArray newArrayWithInts:(jint[]){ 0, size } count:2];
  if (size <= 1) return outlierIndex;
  jdouble Q1;
  switch (size % 4) {
    case 0:
    Q1 = (IOSDoubleArray_Get(data, (size) / 4 - 1) + IOSDoubleArray_Get(data, (size + 4) / 4 - 1)) / 2;
    break;
    case 1:
    Q1 = (IOSDoubleArray_Get(data, (size - 1) / 4 - 1) + IOSDoubleArray_Get(data, (size + 3) / 4 - 1)) / 2;
    break;
    case 2:
    Q1 = IOSDoubleArray_Get(data, (size + 2) / 4 - 1);
    break;
    default:
    Q1 = IOSDoubleArray_Get(data, (size + 1) / 4 - 1);
    break;
  }
  jdouble Q3;
  switch (size % 4) {
    case 0:
    Q3 = (IOSDoubleArray_Get(data, (3 * size) / 4 - 1) + IOSDoubleArray_Get(data, (3 * size + 4) / 4 - 1)) / 2;
    break;
    case 1:
    Q3 = (IOSDoubleArray_Get(data, (3 * size + 1) / 4 - 1) + IOSDoubleArray_Get(data, (3 * size + 5) / 4 - 1)) / 2;
    break;
    case 2:
    Q3 = IOSDoubleArray_Get(data, (3 * size + 2) / 4 - 1);
    break;
    default:
    Q3 = IOSDoubleArray_Get(data, (3 * size + 3) / 4 - 1);
    break;
  }
  jdouble IQRplus = 1.5 * (Q3 - Q1);
  for (jint i = 0; i < data->size_ && IOSDoubleArray_Get(data, i) < Q1 - IQRplus - OrgGeogebraCommonKernelKernel_STANDARD_PRECISION; i++) (*IOSIntArray_GetRef(outlierIndex, 0))++;
  for (jint i = data->size_ - 1; i >= 0 && IOSDoubleArray_Get(data, i) > Q3 + IQRplus + OrgGeogebraCommonKernelKernel_STANDARD_PRECISION; i--) (*IOSIntArray_GetRef(outlierIndex, 1))--;
  return outlierIndex;
}

JavaUtilArrayList *OrgGeogebraCommonKernelStatisticsAlgoStemPlot_createStemPlotArrayWithDoubleArray_withDouble_withIntArray_(IOSDoubleArray *data, jdouble stemFactor, IOSIntArray *outlierIndex) {
  OrgGeogebraCommonKernelStatisticsAlgoStemPlot_initialize();
  JavaUtilArrayList *lines = new_JavaUtilArrayList_init();
  jint size = IOSIntArray_Get(nil_chk(outlierIndex), 1);
  jint startIndex = IOSIntArray_Get(outlierIndex, 0);
  jint n = (jint) JavaLangMath_roundWithDouble_(IOSDoubleArray_Get(nil_chk(data), startIndex) * stemFactor);
  jint stem = n / 10;
  jint leaf = JavaLangMath_absWithInt_(n % 10);
  jint currentStem = stem;
  [lines addWithId:new_JavaUtilArrayList_init()];
  [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 1])) addWithId:JavaLangInteger_valueOfWithInt_(currentStem)];
  if (currentStem == 0 && n < 0) {
    [lines addWithId:new_JavaUtilArrayList_init()];
    [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 1])) addWithId:JavaLangInteger_valueOfWithInt_(currentStem)];
    [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 2])) addWithId:new_JavaLangInteger_initWithInt_(leaf)];
  }
  else {
    [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 1])) addWithId:new_JavaLangInteger_initWithInt_(leaf)];
  }
  for (jint i = startIndex + 1; i < size; i++) {
    n = (jint) JavaLangMath_roundWithDouble_(IOSDoubleArray_Get(data, i) * stemFactor);
    stem = n / 10;
    leaf = JavaLangMath_absWithInt_(n % 10);
    while (currentStem < stem) {
      currentStem++;
      [lines addWithId:new_JavaUtilArrayList_init()];
      [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 1])) addWithId:JavaLangInteger_valueOfWithInt_(currentStem)];
      if (currentStem == 0 && n < 0) {
        [lines addWithId:new_JavaUtilArrayList_init()];
        [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 1])) addWithId:JavaLangInteger_valueOfWithInt_(currentStem)];
      }
    }
    if (stem == 0 && n < 0) [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 2])) addWithId:JavaLangInteger_valueOfWithInt_(leaf)];
    else [((JavaUtilArrayList *) nil_chk([lines getWithInt:[lines size] - 1])) addWithId:JavaLangInteger_valueOfWithInt_(leaf)];
  }
  return lines;
}

void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_compute(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self) {
  jint size = [((OrgGeogebraCommonKernelGeosGeoList *) nil_chk(self->geoList_)) size];
  if (![self->geoList_ isDefined] || size == 0) {
    [((OrgGeogebraCommonKernelGeosGeoText *) nil_chk(self->text_)) setTextStringWithNSString:@""];
    return;
  }
  IOSDoubleArray *data = [IOSDoubleArray newArrayWithLength:size];
  for (jint i = 0; i < size; i++) {
    OrgGeogebraCommonKernelGeosGeoElement *geo = [self->geoList_ getWithInt:i];
    if (![((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isGeoNumeric] || ![geo isDefined]) {
      [((OrgGeogebraCommonKernelGeosGeoText *) nil_chk(self->text_)) setTextStringWithNSString:@""];
      return;
    }
    *IOSDoubleArray_GetRef(data, i) = [((OrgGeogebraCommonKernelGeosGeoNumeric *) check_class_cast(geo, [OrgGeogebraCommonKernelGeosGeoNumeric class])) getDouble];
  }
  JavaUtilArrays_sortWithDoubleArray_(data);
  IOSIntArray *outlierIndex = OrgGeogebraCommonKernelStatisticsAlgoStemPlot_getOutlierIndexWithDoubleArray_(data);
  jdouble max = IOSDoubleArray_Get(data, IOSIntArray_Get(nil_chk(outlierIndex), 1) - 1);
  jdouble min = IOSDoubleArray_Get(data, IOSIntArray_Get(outlierIndex, 0));
  jint magnitude;
  jdouble maxTemp = JavaLangMath_maxWithDouble_withDouble_(max, JavaLangMath_absWithDouble_(min));
  magnitude = J2ObjCFpToInt(JavaLangMath_floorWithDouble_(JavaLangMath_log10WithDouble_(maxTemp * 1.00000001)));
  if (((IOSObjectArray *) nil_chk(self->input_))->size_ == 2) {
    jint s = JavaLangMath_absWithDouble_([((OrgGeogebraCommonKernelGeosGeoNumeric *) nil_chk(self->scaleAdjustment_)) getDouble]) > 1 ? 0 : J2ObjCFpToInt([self->scaleAdjustment_ getDouble]);
    magnitude = magnitude + s;
  }
  jdouble factor = JavaLangMath_powWithDouble_withDouble_(10.0, 1 - magnitude);
  jdouble multUnit = JavaLangMath_powWithDouble_withDouble_(10.0, magnitude - 1);
  JavaUtilArrayList *stemLines = OrgGeogebraCommonKernelStatisticsAlgoStemPlot_createStemPlotArrayWithDoubleArray_withDouble_withIntArray_(data, factor, outlierIndex);
  self->low_ = OrgGeogebraCommonUtilStringUtil_resetStringBuilderWithJavaLangStringBuilder_(self->low_);
  (void) [((JavaLangStringBuilder *) nil_chk(self->low_)) appendWithNSString:@"\\text{"];
  (void) [self->low_ appendWithNSString:[((OrgGeogebraCommonMainLocalization *) nil_chk([self getLoc])) getPlainWithNSString:@"StemPlot.low"]];
  (void) [self->low_ appendWithNSString:@": "];
  for (jint i = 0; i < IOSIntArray_Get(outlierIndex, 0); i++) {
    (void) [self->low_ appendWithId:(i < IOSIntArray_Get(outlierIndex, 0) - 1) ? JreStrcat("DC", IOSDoubleArray_Get(data, i), ',') : JavaLangDouble_valueOfWithDouble_(IOSDoubleArray_Get(data, i))];
  }
  (void) [self->low_ appendWithNSString:@"} \\\\ "];
  self->high_ = OrgGeogebraCommonUtilStringUtil_resetStringBuilderWithJavaLangStringBuilder_(self->high_);
  (void) [((JavaLangStringBuilder *) nil_chk(self->high_)) appendWithNSString:[((OrgGeogebraCommonMainLocalization *) nil_chk([self getLoc])) getPlainWithNSString:@"\\text{"]];
  (void) [self->high_ appendWithNSString:[((OrgGeogebraCommonMainLocalization *) nil_chk([self getLoc])) getPlainWithNSString:@"StemPlot.high"]];
  (void) [self->high_ appendWithNSString:@": "];
  for (jint i = IOSIntArray_Get(outlierIndex, 1); i < data->size_; i++) {
    (void) [self->high_ appendWithId:(i < data->size_ - 1) ? JreStrcat("DC", IOSDoubleArray_Get(data, i), ',') : JavaLangDouble_valueOfWithDouble_(IOSDoubleArray_Get(data, i))];
  }
  (void) [self->high_ appendWithNSString:@"} \\\\ "];
  if ([((OrgGeogebraCommonMainApp *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk(self->kernel_)) getApplication])) isLatexMathQuillStyleWithOrgGeogebraCommonKernelStringTemplate:nil]) {
    OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotMQWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(self, data, outlierIndex, multUnit, stemLines);
  }
  else {
    OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(self, data, outlierIndex, multUnit, stemLines);
  }
  [((OrgGeogebraCommonKernelGeosGeoText *) nil_chk(self->text_)) setTextStringWithNSString:[((JavaLangStringBuilder *) nil_chk(self->sb_)) description]];
  [self->text_ setLaTeXWithBoolean:YES withBoolean:NO];
}

void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self, IOSDoubleArray *data, IOSIntArray *outlierIndex, jdouble multUnit, JavaUtilArrayList *stemLines) {
  jint maxSize = 0;
  for (jint i = 0; i < [((JavaUtilArrayList *) nil_chk(stemLines)) size]; i++) {
    maxSize = JavaLangMath_maxWithInt_withInt_(maxSize, [((JavaUtilArrayList *) nil_chk([stemLines getWithInt:i])) size]);
  }
  JavaLangStringBuffer *body = new_JavaLangStringBuffer_init();
  [body setLengthWithInt:0];
  (void) [body appendWithNSString:@"\\begin{array}{"];
  (void) [body appendWithNSString:@"r|"];
  for (jint i = 0; i < maxSize; i++) {
    (void) [body appendWithChar:'l'];
  }
  (void) [body appendWithNSString:@"}"];
  JavaUtilArrayList *currentLine = new_JavaUtilArrayList_init();
  jint stem;
  for (jint r = 0; r < [stemLines size]; r++) {
    currentLine = [stemLines getWithInt:r];
    stem = [((JavaLangInteger *) nil_chk([((JavaUtilArrayList *) nil_chk(currentLine)) getWithInt:0])) intValue];
    if (stem == 0 && (r < [stemLines size] - 2 && [((JavaLangInteger *) nil_chk([((JavaUtilArrayList *) nil_chk([stemLines getWithInt:r + 1])) getWithInt:0])) intValue] == 0)) (void) [body appendWithNSString:JreStrcat("CI", '-', stem)];
    else (void) [body appendWithNSString:JreStrcat("I", stem)];
    (void) [body appendWithNSString:@"&"];
    for (jint c = 1; c < maxSize; c++) {
      (void) [body appendWithNSString:[currentLine size] > c ? JreStrcat("@", [currentLine getWithInt:c]) : @" "];
      if (c < maxSize - 1) (void) [body appendWithNSString:@"&"];
    }
    (void) [body appendWithNSString:@" \\\\ "];
  }
  (void) [body appendWithNSString:@"\\end{array}"];
  (void) [body appendWithNSString:@" \\\\ "];
  JavaLangStringBuilder *key = new_JavaLangStringBuilder_init();
  [key setLengthWithInt:0];
  (void) [key appendWithNSString:@"\\fbox{\\text{"];
  NSString *keyCode = (multUnit >= 1) ? JreStrcat("I", 31 * J2ObjCFpToInt(multUnit)) : JreStrcat("D", 31.0 * multUnit);
  (void) [key appendWithNSString:[((OrgGeogebraCommonMainLocalization *) nil_chk([self getLoc])) getPlainWithNSString:@"StemPlot.KeyAMeansB" withNSString:@"3|1" withNSString:keyCode]];
  (void) [key appendWithNSString:@"}}"];
  (void) [key appendWithNSString:@" \\\\ "];
  [((JavaLangStringBuilder *) nil_chk(self->sb_)) setLengthWithInt:0];
  (void) [self->sb_ appendWithChar:'{'];
  (void) [self->sb_ appendWithNSString:@"\\begin{tabular}{ll}"];
  if (IOSIntArray_Get(nil_chk(outlierIndex), 0) > 0) (void) [self->sb_ appendWithJavaLangCharSequence:self->low_];
  (void) [self->sb_ appendWithJavaLangStringBuffer:body];
  if (IOSIntArray_Get(outlierIndex, 1) < ((IOSDoubleArray *) nil_chk(data))->size_) (void) [self->sb_ appendWithJavaLangCharSequence:self->high_];
  (void) [self->sb_ appendWithJavaLangCharSequence:key];
  (void) [self->sb_ appendWithNSString:@"\\end{tabular}"];
  (void) [self->sb_ appendWithChar:'}'];
}

void OrgGeogebraCommonKernelStatisticsAlgoStemPlot_stemPlotMQWithDoubleArray_withIntArray_withDouble_withJavaUtilArrayList_(OrgGeogebraCommonKernelStatisticsAlgoStemPlot *self, IOSDoubleArray *data, IOSIntArray *outlierIndex, jdouble multUnit, JavaUtilArrayList *stemLines) {
  jint maxSize = 0;
  for (jint i = 0; i < [((JavaUtilArrayList *) nil_chk(stemLines)) size]; i++) {
    maxSize = JavaLangMath_maxWithInt_withInt_(maxSize, [((JavaUtilArrayList *) nil_chk([stemLines getWithInt:i])) size]);
  }
  JavaLangStringBuffer *body = new_JavaLangStringBuffer_init();
  [body setLengthWithInt:0];
  (void) [body appendWithChar:'{'];
  (void) [body appendWithNSString:@" \\ggbtable{ "];
  JavaUtilArrayList *currentLine = new_JavaUtilArrayList_init();
  jint stem;
  for (jint r = 0; r < [stemLines size]; r++) {
    (void) [body appendWithNSString:@" \\ggbtr{ "];
    currentLine = [stemLines getWithInt:r];
    stem = [((JavaLangInteger *) nil_chk([((JavaUtilArrayList *) nil_chk(currentLine)) getWithInt:0])) intValue];
    (void) [body appendWithNSString:@" \\ggbtdlrR{ "];
    if (stem == 0 && (r < [stemLines size] - 2 && [((JavaLangInteger *) nil_chk([((JavaUtilArrayList *) nil_chk([stemLines getWithInt:r + 1])) getWithInt:0])) intValue] == 0)) (void) [body appendWithNSString:JreStrcat("CI", '-', stem)];
    else (void) [body appendWithNSString:JreStrcat("I", stem)];
    (void) [body appendWithNSString:@" } "];
    for (jint c = 1; c < maxSize; c++) {
      (void) [body appendWithNSString:@" \\ggbtdL{ "];
      (void) [body appendWithNSString:[currentLine size] > c ? JreStrcat("@", [currentLine getWithInt:c]) : @" "];
      (void) [body appendWithNSString:@" } "];
    }
    (void) [body appendWithNSString:@" } "];
  }
  (void) [body appendWithNSString:@"} "];
  (void) [body appendWithChar:'}'];
  (void) [body appendWithNSString:@" \\\\ "];
  JavaLangStringBuffer *key = new_JavaLangStringBuffer_init();
  [key setLengthWithInt:0];
  (void) [key appendWithNSString:@" \\ggbtable{ \\ggbtrl{ \\ggbtdl{ \\text{ "];
  NSString *keyCode = (multUnit >= 1) ? JreStrcat("I", 31 * J2ObjCFpToInt(multUnit)) : JreStrcat("D", 31.0 * multUnit);
  (void) [key appendWithNSString:[((OrgGeogebraCommonMainLocalization *) nil_chk([self getLoc])) getPlainWithNSString:@"StemPlot.KeyAMeansB" withNSString:@"3|1" withNSString:keyCode]];
  (void) [key appendWithNSString:@" } } } } "];
  (void) [key appendWithNSString:@" \\\\ "];
  [((JavaLangStringBuilder *) nil_chk(self->sb_)) setLengthWithInt:0];
  (void) [self->sb_ appendWithChar:'{'];
  if (IOSIntArray_Get(nil_chk(outlierIndex), 0) > 0) (void) [self->sb_ appendWithJavaLangCharSequence:self->low_];
  (void) [self->sb_ appendWithJavaLangStringBuffer:body];
  if (IOSIntArray_Get(outlierIndex, 1) < ((IOSDoubleArray *) nil_chk(data))->size_) (void) [self->sb_ appendWithJavaLangCharSequence:self->high_];
  (void) [self->sb_ appendWithJavaLangStringBuffer:key];
  (void) [self->sb_ appendWithChar:'}'];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelStatisticsAlgoStemPlot)
