//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/GeogebraiOS/GeogebraiOS/sources/org/geogebra/common/kernel/algos/AlgoLocusND.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/PrintStream.h"
#include "java/lang/Double.h"
#include "java/lang/Exception.h"
#include "java/lang/StringBuilder.h"
#include "java/lang/System.h"
#include "java/util/ArrayList.h"
#include "java/util/Iterator.h"
#include "java/util/TreeSet.h"
#include "org/geogebra/common/awt/GPoint2D.h"
#include "org/geogebra/common/awt/GRectangle2D.h"
#include "org/geogebra/common/euclidian/EuclidianConstants.h"
#include "org/geogebra/common/euclidian/EuclidianView.h"
#include "org/geogebra/common/euclidian3D/EuclidianView3DInterface.h"
#include "org/geogebra/common/factories/AwtFactory.h"
#include "org/geogebra/common/kernel/Construction.h"
#include "org/geogebra/common/kernel/Kernel.h"
#include "org/geogebra/common/kernel/Macro.h"
#include "org/geogebra/common/kernel/MacroKernel.h"
#include "org/geogebra/common/kernel/MyPoint.h"
#include "org/geogebra/common/kernel/Path.h"
#include "org/geogebra/common/kernel/PathMover.h"
#include "org/geogebra/common/kernel/PathParameter.h"
#include "org/geogebra/common/kernel/StringTemplate.h"
#include "org/geogebra/common/kernel/algos/AlgoElement.h"
#include "org/geogebra/common/kernel/algos/AlgoLocusND.h"
#include "org/geogebra/common/kernel/algos/ConstructionElement.h"
#include "org/geogebra/common/kernel/commands/Commands.h"
#include "org/geogebra/common/kernel/geos/GeoElement.h"
#include "org/geogebra/common/kernel/geos/GeoLocusND.h"
#include "org/geogebra/common/kernel/implicit/GeoImplicitPoly.h"
#include "org/geogebra/common/kernel/kernelND/GeoPointND.h"
#include "org/geogebra/common/main/App.h"

@interface OrgGeogebraCommonKernelAlgosAlgoLocusND () {
 @public
  IOSObjectArray *efficientInput_AlgoLocusND_, *standardInput_;
  id<OrgGeogebraCommonKernelPath> path_;
  id<OrgGeogebraCommonKernelPathMover> pathMover_;
  IOSObjectArray *nearToScreenRect_;
  jboolean continuous_;
  jboolean foundDefined_;
  jboolean maxTimeExceeded_;
  OrgGeogebraCommonKernelConstruction *macroCons_;
  OrgGeogebraCommonKernelMacroKernel *macroKernel_;
  JavaUtilTreeSet *locusConsOrigElements_;
  JavaUtilTreeSet *Qin_;
  jint views_;
  IOSObjectArray *qcopyCache_;
  jint cacheIndex_;
}

- (void)init__ OBJC_METHOD_FAMILY_NONE;

- (void)buildLocusMacroConstructionWithJavaUtilTreeSet:(JavaUtilTreeSet *)locusConsElements;

- (void)resetMacroConstruction;

+ (jboolean)isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geoElement;

- (void)pcopyUpdateCascade;

- (void)clearCache;

- (OrgGeogebraCommonAwtGPoint2D *)getCachedPointWithDouble:(jdouble)param;

- (void)putCachedPointWithDouble:(jdouble)param
withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Qcopy;

- (jboolean)distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Q;

@end

J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, efficientInput_AlgoLocusND_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, standardInput_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, path_, id<OrgGeogebraCommonKernelPath>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, pathMover_, id<OrgGeogebraCommonKernelPathMover>)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, nearToScreenRect_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, macroCons_, OrgGeogebraCommonKernelConstruction *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, macroKernel_, OrgGeogebraCommonKernelMacroKernel *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, locusConsOrigElements_, JavaUtilTreeSet *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, Qin_, JavaUtilTreeSet *)
J2OBJC_FIELD_SETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, qcopyCache_, IOSObjectArray *)

static jint OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_Y_PIXEL_DIST_ = 5;
J2OBJC_STATIC_FIELD_GETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, MAX_Y_PIXEL_DIST_, jint)
J2OBJC_STATIC_FIELD_REF_GETTER(OrgGeogebraCommonKernelAlgosAlgoLocusND, MAX_Y_PIXEL_DIST_, jint)

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_init__(OrgGeogebraCommonKernelAlgosAlgoLocusND *self);

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_buildLocusMacroConstructionWithJavaUtilTreeSet_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, JavaUtilTreeSet *locusConsElements);

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_resetMacroConstruction(OrgGeogebraCommonKernelAlgosAlgoLocusND *self);

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_compute(OrgGeogebraCommonKernelAlgosAlgoLocusND *self);

__attribute__((unused)) static jboolean OrgGeogebraCommonKernelAlgosAlgoLocusND_isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement_(OrgGeogebraCommonKernelGeosGeoElement *geoElement);

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(OrgGeogebraCommonKernelAlgosAlgoLocusND *self);

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_clearCache(OrgGeogebraCommonKernelAlgosAlgoLocusND *self);

__attribute__((unused)) static OrgGeogebraCommonAwtGPoint2D *OrgGeogebraCommonKernelAlgosAlgoLocusND_getCachedPointWithDouble_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, jdouble param);

__attribute__((unused)) static void OrgGeogebraCommonKernelAlgosAlgoLocusND_putCachedPointWithDouble_withOrgGeogebraCommonKernelKernelNDGeoPointND_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, jdouble param, id<OrgGeogebraCommonKernelKernelNDGeoPointND> Qcopy);

__attribute__((unused)) static jboolean OrgGeogebraCommonKernelAlgosAlgoLocusND_distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, id<OrgGeogebraCommonKernelKernelNDGeoPointND> Q);

jint OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_TIME_FOR_ONE_STEP_ = 500;
jint OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_X_PIXEL_DIST_ = 5;

@implementation OrgGeogebraCommonKernelAlgosAlgoLocusND

- (instancetype)initWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons
              withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Q
              withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)P
                                                    withInt:(jint)min_steps
                                                withBoolean:(jboolean)registerCE {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelKernelNDGeoPointND_withOrgGeogebraCommonKernelKernelNDGeoPointND_withInt_withBoolean_(self, cons, Q, P, min_steps, registerCE);
  return self;
}

- (void)createMaxDistances {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_maxXdist_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_maxYdist_(self, [IOSDoubleArray newArrayWithLength:3]);
}

- (void)createStartPosWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (OrgGeogebraCommonKernelGeosGeoLocusND *)newGeoLocusWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (instancetype)initWithOrgGeogebraCommonKernelConstruction:(OrgGeogebraCommonKernelConstruction *)cons
                                               withNSString:(NSString *)label
              withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Q
              withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)P {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelKernelNDGeoPointND_withOrgGeogebraCommonKernelKernelNDGeoPointND_(self, cons, label, Q, P);
  return self;
}

- (OrgGeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return OrgGeogebraCommonKernelCommandsCommandsEnum_get_Locus();
}

- (jint)getRelatedModeID {
  return OrgGeogebraCommonEuclidianEuclidianConstants_MODE_LOCUS;
}

- (JavaUtilArrayList *)getMoveableInputPoints {
  return nil;
}

- (id<OrgGeogebraCommonKernelKernelNDGeoPointND>)getQ {
  return locusPoint_;
}

- (id<OrgGeogebraCommonKernelKernelNDGeoPointND>)getLocusPoint {
  return locusPoint_;
}

- (id<OrgGeogebraCommonKernelKernelNDGeoPointND>)getMovingPoint {
  return movingPoint_;
}

- (void)init__ {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_init__(self);
}

- (void)setInputOutput {
  JavaUtilTreeSet *inSet = [new_JavaUtilTreeSet_init() autorelease];
  [inSet addWithId:[((id<OrgGeogebraCommonKernelPath>) nil_chk(path_)) toGeoElement]];
  id<JavaUtilIterator> it = [((JavaUtilTreeSet *) nil_chk(Qin_)) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgGeogebraCommonKernelGeosGeoElement *geo = [it next];
    if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isIndependent] || [geo isPointOnPath]) {
      [inSet addWithId:geo];
    }
  }
  [inSet removeWithId:movingPoint_];
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_efficientInput_AlgoLocusND_(self, [IOSObjectArray newArrayWithLength:[inSet size] type:OrgGeogebraCommonKernelGeosGeoElement_class_()]);
  it = [inSet iterator];
  jint i = 0;
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    IOSObjectArray_Set(efficientInput_AlgoLocusND_, i, [it next]);
    i++;
  }
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_standardInput_(self, [IOSObjectArray newArrayWithLength:2 type:OrgGeogebraCommonKernelGeosGeoElement_class_()]);
  IOSObjectArray_Set(standardInput_, 0, (OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]));
  IOSObjectArray_Set(standardInput_, 1, (OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]));
  [self setOutputLengthWithInt:1];
  [self setOutputWithInt:0 withOrgGeogebraCommonKernelGeosGeoElement:locus_];
  [self setEfficientDependenciesWithOrgGeogebraCommonKernelGeosGeoElementArray:standardInput_ withOrgGeogebraCommonKernelGeosGeoElementArray:efficientInput_AlgoLocusND_];
}

- (OrgGeogebraCommonKernelGeosGeoLocusND *)getLocus {
  return locus_;
}

- (void)buildLocusMacroConstructionWithJavaUtilTreeSet:(JavaUtilTreeSet *)locusConsElements {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_buildLocusMacroConstructionWithJavaUtilTreeSet_(self, locusConsElements);
}

- (void)resetMacroConstruction {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_resetMacroConstruction(self);
}

- (void)compute {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_compute(self);
}

- (jboolean)differentFromLastWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)point {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (jboolean)areEqualWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)p1
                    withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)p2 {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

+ (jboolean)isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *)geoElement {
  return OrgGeogebraCommonKernelAlgosAlgoLocusND_isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement_(geoElement);
}

- (void)pcopyUpdateCascade {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(self);
}

- (void)clearCache {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_clearCache(self);
}

- (OrgGeogebraCommonAwtGPoint2D *)getCachedPointWithDouble:(jdouble)param {
  return OrgGeogebraCommonKernelAlgosAlgoLocusND_getCachedPointWithDouble_(self, param);
}

- (void)putCachedPointWithDouble:(jdouble)param
withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Qcopy {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_putCachedPointWithDouble_withOrgGeogebraCommonKernelKernelNDGeoPointND_(self, param, Qcopy);
}

- (IOSObjectArray *)createQCopyCache {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (void)setQCopyCacheWithOrgGeogebraCommonKernelMyPoint:(OrgGeogebraCommonKernelMyPoint *)copy_
          withOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)point {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (id)newCache {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (void)insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)point
                                                     withBoolean:(jboolean)lineTo {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (jboolean)isFarAwayWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)point
                                                           withInt:(jint)i {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (jboolean)distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Q
                               withOrgGeogebraCommonAwtGRectangle2D:(id<OrgGeogebraCommonAwtGRectangle2D>)rectangle {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (jboolean)distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Q {
  return OrgGeogebraCommonKernelAlgosAlgoLocusND_distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND_(self, Q);
}

- (jboolean)distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:(id<OrgGeogebraCommonKernelKernelNDGeoPointND>)Q
                                                           withBoolean:(jboolean)orInsteadOfAnd {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (jboolean)isVisibleInEVWithInt:(jint)i {
  switch (i) {
    case 1:
    if (![((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(locus_)) isVisibleInViewWithInt:OrgGeogebraCommonMainApp_VIEW_EUCLIDIAN]) return NO;
    if (![((OrgGeogebraCommonEuclidianEuclidianView *) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) getApplication])) getEuclidianView1])) isShowing]) return NO;
    return YES;
    case 2:
    if (![((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(locus_)) isVisibleInViewWithInt:OrgGeogebraCommonMainApp_VIEW_EUCLIDIAN2]) return NO;
    if (![((OrgGeogebraCommonMainApp *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) getApplication])) hasEuclidianView2WithInt:1]) return NO;
    return YES;
    case 3:
    if (![((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(locus_)) isVisibleInView3D]) return NO;
    if ([((OrgGeogebraCommonMainApp *) nil_chk([((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) getApplication])) isEuclidianView3Dinited]) return [((id<OrgGeogebraCommonEuclidian3DEuclidianView3DInterface>) nil_chk([((OrgGeogebraCommonMainApp *) nil_chk([kernel_ getApplication])) getEuclidianView3D])) isShowing];
  }
  return NO;
}

- (void)updateScreenBordersIfNecessary {
  for (jint i = 0; i < ((IOSBooleanArray *) nil_chk(visibleEV_))->size_; i++) {
    if ([self isVisibleInEVWithInt:i + 1] != IOSBooleanArray_Get(visibleEV_, i)) {
      [self updateScreenBorders];
      return;
    }
  }
}

- (void)updateScreenBordersWithInt:(jint)i {
  *IOSDoubleArray_GetRef(nil_chk(xmax_), i) = [((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) getXmaxWithInt:i];
  *IOSDoubleArray_GetRef(nil_chk(xmin_), i) = [kernel_ getXminWithInt:i];
  *IOSDoubleArray_GetRef(nil_chk(ymax_), i) = [kernel_ getYmaxWithInt:i];
  *IOSDoubleArray_GetRef(nil_chk(ymin_), i) = [kernel_ getYminWithInt:i];
  [self setMaxDistancesWithInt:i];
  [((id<OrgGeogebraCommonAwtGRectangle2D>) nil_chk(IOSObjectArray_Get(nil_chk(nearToScreenRect_), i))) setFrameWithDouble:IOSDoubleArray_Get(nil_chk(farXmin_), i) withDouble:IOSDoubleArray_Get(nil_chk(farYmin_), i) withDouble:IOSDoubleArray_Get(nil_chk(farXmax_), i) - IOSDoubleArray_Get(farXmin_, i) withDouble:IOSDoubleArray_Get(nil_chk(farYmax_), i) - IOSDoubleArray_Get(farYmin_, i)];
}

- (void)setMaxDistancesWithInt:(jint)i {
  *IOSDoubleArray_GetRef(nil_chk(maxXdist_), i) = OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_X_PIXEL_DIST_ / [((OrgGeogebraCommonKernelKernel *) nil_chk(kernel_)) getXscaleWithInt:i];
  *IOSDoubleArray_GetRef(nil_chk(maxYdist_), i) = OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_Y_PIXEL_DIST_ / [kernel_ getYscaleWithInt:i];
  jdouble widthRW = IOSDoubleArray_Get(nil_chk(xmax_), i) - IOSDoubleArray_Get(nil_chk(xmin_), i);
  jdouble heightRW = IOSDoubleArray_Get(nil_chk(ymax_), i) - IOSDoubleArray_Get(nil_chk(ymin_), i);
  *IOSDoubleArray_GetRef(nil_chk(farXmin_), i) = IOSDoubleArray_Get(xmin_, i) - widthRW / 2;
  *IOSDoubleArray_GetRef(nil_chk(farXmax_), i) = IOSDoubleArray_Get(xmax_, i) + widthRW / 2;
  *IOSDoubleArray_GetRef(nil_chk(farYmin_), i) = IOSDoubleArray_Get(ymin_, i) - heightRW / 2;
  *IOSDoubleArray_GetRef(nil_chk(farYmax_), i) = IOSDoubleArray_Get(ymax_, i) + heightRW / 2;
}

- (void)updateScreenBorders {
  for (jint i = 0; i < ((IOSBooleanArray *) nil_chk(visibleEV_))->size_; i++) {
    *IOSBooleanArray_GetRef(visibleEV_, i) = [self isVisibleInEVWithInt:i + 1];
  }
  if (IOSBooleanArray_Get(visibleEV_, 0) && IOSBooleanArray_Get(visibleEV_, 1)) {
    views_ = 2;
  }
  else {
    views_ = 1;
  }
  if (IOSBooleanArray_Get(visibleEV_, 2)) {
    views_++;
  }
  for (jint i = 0; i < visibleEV_->size_; i++) {
    if (IOSBooleanArray_Get(visibleEV_, i)) {
      [self updateScreenBordersWithInt:i];
    }
  }
}

- (jboolean)euclidianViewUpdate {
  [self updateScreenBorders];
  [self update];
  return NO;
}

- (void)dealloc {
  RELEASE_(movingPoint_);
  RELEASE_(locusPoint_);
  RELEASE_(locus_);
  RELEASE_(efficientInput_AlgoLocusND_);
  RELEASE_(standardInput_);
  RELEASE_(path_);
  RELEASE_(pathMover_);
  RELEASE_(Pcopy_);
  RELEASE_(Qcopy_);
  RELEASE_(PstartPos_);
  RELEASE_(QstartPos_);
  RELEASE_(maxXdist_);
  RELEASE_(maxYdist_);
  RELEASE_(xmin_);
  RELEASE_(xmax_);
  RELEASE_(ymin_);
  RELEASE_(ymax_);
  RELEASE_(farXmin_);
  RELEASE_(farXmax_);
  RELEASE_(farYmin_);
  RELEASE_(farYmax_);
  RELEASE_(nearToScreenRect_);
  RELEASE_(lastFarAway_);
  RELEASE_(macroCons_);
  RELEASE_(macroKernel_);
  RELEASE_(locusConsOrigElements_);
  RELEASE_(Qin_);
  RELEASE_(paramCache_);
  RELEASE_(qcopyCache_);
  RELEASE_(visibleEV_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgGeogebraCommonKernelConstruction:withOrgGeogebraCommonKernelKernelNDGeoPointND:withOrgGeogebraCommonKernelKernelNDGeoPointND:withInt:withBoolean:", "AlgoLocusND", NULL, 0x1, NULL, NULL },
    { "createMaxDistances", NULL, "V", 0x4, NULL, NULL },
    { "createStartPosWithOrgGeogebraCommonKernelConstruction:", "createStartPos", "V", 0x404, NULL, NULL },
    { "newGeoLocusWithOrgGeogebraCommonKernelConstruction:", "newGeoLocus", "Lorg.geogebra.common.kernel.geos.GeoLocusND;", 0x404, NULL, NULL },
    { "initWithOrgGeogebraCommonKernelConstruction:withNSString:withOrgGeogebraCommonKernelKernelNDGeoPointND:withOrgGeogebraCommonKernelKernelNDGeoPointND:", "AlgoLocusND", NULL, 0x1, NULL, NULL },
    { "getClassName", NULL, "Lorg.geogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "getRelatedModeID", NULL, "I", 0x1, NULL, NULL },
    { "getMoveableInputPoints", NULL, "Ljava.util.ArrayList;", 0x1, NULL, NULL },
    { "getQ", NULL, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", 0x1, NULL, NULL },
    { "getLocusPoint", NULL, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", 0x1, NULL, NULL },
    { "getMovingPoint", NULL, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", 0x1, NULL, NULL },
    { "init__", "init", "V", 0x2, NULL, NULL },
    { "setInputOutput", NULL, "V", 0x4, NULL, NULL },
    { "getLocus", NULL, "Lorg.geogebra.common.kernel.geos.GeoLocusND;", 0x1, NULL, NULL },
    { "buildLocusMacroConstructionWithJavaUtilTreeSet:", "buildLocusMacroConstruction", "V", 0x2, NULL, NULL },
    { "resetMacroConstruction", NULL, "V", 0x2, NULL, NULL },
    { "compute", NULL, "V", 0x11, NULL, NULL },
    { "differentFromLastWithOrgGeogebraCommonKernelKernelNDGeoPointND:", "differentFromLast", "Z", 0x404, NULL, NULL },
    { "areEqualWithOrgGeogebraCommonKernelKernelNDGeoPointND:withOrgGeogebraCommonKernelKernelNDGeoPointND:", "areEqual", "Z", 0x404, NULL, NULL },
    { "isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement:", "isPathIterable", "Z", 0xa, NULL, NULL },
    { "pcopyUpdateCascade", NULL, "V", 0x2, NULL, NULL },
    { "clearCache", NULL, "V", 0x2, NULL, NULL },
    { "getCachedPointWithDouble:", "getCachedPoint", "Lorg.geogebra.common.awt.GPoint2D;", 0x2, NULL, NULL },
    { "putCachedPointWithDouble:withOrgGeogebraCommonKernelKernelNDGeoPointND:", "putCachedPoint", "V", 0x2, NULL, NULL },
    { "createQCopyCache", NULL, "[Lorg.geogebra.common.kernel.MyPoint;", 0x404, NULL, NULL },
    { "setQCopyCacheWithOrgGeogebraCommonKernelMyPoint:withOrgGeogebraCommonKernelKernelNDGeoPointND:", "setQCopyCache", "V", 0x404, NULL, "(TT;Lorg/geogebra/common/kernel/kernelND/GeoPointND;)V" },
    { "newCache", NULL, "TT;", 0x404, NULL, "()TT;" },
    { "insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:withBoolean:", "insertPoint", "V", 0x404, NULL, NULL },
    { "isFarAwayWithOrgGeogebraCommonKernelKernelNDGeoPointND:withInt:", "isFarAway", "Z", 0x404, NULL, NULL },
    { "distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND:withOrgGeogebraCommonAwtGRectangle2D:", "distanceOK", "Z", 0x404, NULL, NULL },
    { "distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND:", "distanceOK", "Z", 0x2, NULL, NULL },
    { "distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:withBoolean:", "distanceSmall", "Z", 0x404, NULL, NULL },
    { "isVisibleInEVWithInt:", "isVisibleInEV", "Z", 0x0, NULL, NULL },
    { "updateScreenBordersIfNecessary", NULL, "V", 0x0, NULL, NULL },
    { "updateScreenBordersWithInt:", "updateScreenBorders", "V", 0x0, NULL, NULL },
    { "setMaxDistancesWithInt:", "setMaxDistances", "V", 0x4, NULL, NULL },
    { "updateScreenBorders", NULL, "V", 0x0, NULL, NULL },
    { "euclidianViewUpdate", NULL, "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "MAX_TIME_FOR_ONE_STEP_", NULL, 0x9, "I", &OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_TIME_FOR_ONE_STEP_, NULL,  },
    { "MIN_STEPS_INSTANCE_", NULL, 0x1, "I", NULL, NULL,  },
    { "MAX_X_PIXEL_DIST_", NULL, 0xc, "I", &OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_X_PIXEL_DIST_, NULL,  },
    { "MAX_Y_PIXEL_DIST_", NULL, 0xa, "I", &OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_Y_PIXEL_DIST_, NULL,  },
    { "movingPoint_", NULL, 0x4, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "locusPoint_", NULL, 0x4, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "locus_", NULL, 0x4, "Lorg.geogebra.common.kernel.geos.GeoLocusND;", NULL, "Lorg/geogebra/common/kernel/geos/GeoLocusND<TT;>;",  },
    { "efficientInput_AlgoLocusND_", "efficientInput", 0x2, "[Lorg.geogebra.common.kernel.geos.GeoElement;", NULL, NULL,  },
    { "standardInput_", NULL, 0x2, "[Lorg.geogebra.common.kernel.geos.GeoElement;", NULL, NULL,  },
    { "path_", NULL, 0x2, "Lorg.geogebra.common.kernel.Path;", NULL, NULL,  },
    { "pathMover_", NULL, 0x2, "Lorg.geogebra.common.kernel.PathMover;", NULL, NULL,  },
    { "pointCount_", NULL, 0x4, "I", NULL, NULL,  },
    { "Pcopy_", NULL, 0x4, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "Qcopy_", NULL, 0x4, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "PstartPos_", NULL, 0x4, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "QstartPos_", NULL, 0x4, "Lorg.geogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "lastX_", NULL, 0x4, "D", NULL, NULL,  },
    { "lastY_", NULL, 0x4, "D", NULL, NULL,  },
    { "maxXdist_", NULL, 0x4, "[D", NULL, NULL,  },
    { "maxYdist_", NULL, 0x4, "[D", NULL, NULL,  },
    { "xmin_", NULL, 0x4, "[D", NULL, NULL,  },
    { "xmax_", NULL, 0x4, "[D", NULL, NULL,  },
    { "ymin_", NULL, 0x4, "[D", NULL, NULL,  },
    { "ymax_", NULL, 0x4, "[D", NULL, NULL,  },
    { "farXmin_", NULL, 0x4, "[D", NULL, NULL,  },
    { "farXmax_", NULL, 0x4, "[D", NULL, NULL,  },
    { "farYmin_", NULL, 0x4, "[D", NULL, NULL,  },
    { "farYmax_", NULL, 0x4, "[D", NULL, NULL,  },
    { "nearToScreenRect_", NULL, 0x2, "[Lorg.geogebra.common.awt.GRectangle2D;", NULL, NULL,  },
    { "continuous_", NULL, 0x2, "Z", NULL, NULL,  },
    { "lastFarAway_", NULL, 0x4, "[Z", NULL, NULL,  },
    { "foundDefined_", NULL, 0x2, "Z", NULL, NULL,  },
    { "maxTimeExceeded_", NULL, 0x2, "Z", NULL, NULL,  },
    { "macroCons_", NULL, 0x2, "Lorg.geogebra.common.kernel.Construction;", NULL, NULL,  },
    { "macroKernel_", NULL, 0x2, "Lorg.geogebra.common.kernel.MacroKernel;", NULL, NULL,  },
    { "locusConsOrigElements_", NULL, 0x2, "Ljava.util.TreeSet;", NULL, "Ljava/util/TreeSet<Lorg/geogebra/common/kernel/algos/ConstructionElement;>;",  },
    { "Qin_", NULL, 0x2, "Ljava.util.TreeSet;", NULL, "Ljava/util/TreeSet<Lorg/geogebra/common/kernel/geos/GeoElement;>;",  },
    { "views_", NULL, 0x2, "I", NULL, NULL,  },
    { "paramCache_", NULL, 0x4, "[D", NULL, NULL,  },
    { "qcopyCache_", NULL, 0x2, "[Lorg.geogebra.common.kernel.MyPoint;", NULL, "[TT;",  },
    { "cacheIndex_", NULL, 0x2, "I", NULL, NULL,  },
    { "visibleEV_", NULL, 0x4, "[Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgGeogebraCommonKernelAlgosAlgoLocusND = { 2, "AlgoLocusND", "org.geogebra.common.kernel.algos", NULL, 0x401, 38, methods, 42, fields, 0, NULL, 0, NULL, NULL, "<T:Lorg/geogebra/common/kernel/MyPoint;>Lorg/geogebra/common/kernel/algos/AlgoElement;" };
  return &_OrgGeogebraCommonKernelAlgosAlgoLocusND;
}

@end

void OrgGeogebraCommonKernelAlgosAlgoLocusND_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelKernelNDGeoPointND_withOrgGeogebraCommonKernelKernelNDGeoPointND_withInt_withBoolean_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, OrgGeogebraCommonKernelConstruction *cons, id<OrgGeogebraCommonKernelKernelNDGeoPointND> Q, id<OrgGeogebraCommonKernelKernelNDGeoPointND> P, jint min_steps, jboolean registerCE) {
  OrgGeogebraCommonKernelAlgosAlgoElement_initWithOrgGeogebraCommonKernelConstruction_(self, cons);
  self->MIN_STEPS_INSTANCE_ = OrgGeogebraCommonKernelPathMover_MIN_STEPS;
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_xmin_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_xmax_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_ymin_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_ymax_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_farXmin_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_farXmax_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_farYmin_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_farYmax_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_nearToScreenRect_(self, [IOSObjectArray newArrayWithObjects:(id[]){ [((OrgGeogebraCommonFactoriesAwtFactory *) nil_chk(OrgGeogebraCommonFactoriesAwtFactory_get_prototype_())) newRectangle2D], [OrgGeogebraCommonFactoriesAwtFactory_get_prototype_() newRectangle2D], [OrgGeogebraCommonFactoriesAwtFactory_get_prototype_() newRectangle2D] } count:3 type:OrgGeogebraCommonAwtGRectangle2D_class_()]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_lastFarAway_(self, [IOSBooleanArray newArrayWithBooleans:(jboolean[]){ NO, NO, NO } count:3]);
  self->views_ = 1;
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_paramCache_(self, [IOSDoubleArray newArrayWithLength:3]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_qcopyCache_(self, [self createQCopyCache]);
  self->cacheIndex_ = 0;
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_visibleEV_(self, [IOSBooleanArray newArrayWithBooleans:(jboolean[]){ NO, NO, NO } count:3]);
  [self createMaxDistances];
  self->MIN_STEPS_INSTANCE_ = min_steps;
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_movingPoint_(self, P);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_locusPoint_(self, Q);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_path_(self, [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(P)) getPath]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_pathMover_(self, [((id<OrgGeogebraCommonKernelPath>) nil_chk(self->path_)) createPathMover]);
  [self createStartPosWithOrgGeogebraCommonKernelConstruction:cons];
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_locus_(self, [self newGeoLocusWithOrgGeogebraCommonKernelConstruction:cons]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_init__(self);
  [self updateScreenBorders];
  [self setInputOutput];
  if (registerCE) {
    [((OrgGeogebraCommonKernelConstruction *) nil_chk(cons)) registerEuclidianViewCEWithOrgGeogebraCommonKernelEuclidianViewCE:self];
  }
  OrgGeogebraCommonKernelAlgosAlgoLocusND_compute(self);
  [self->path_ pointChangedWithOrgGeogebraCommonKernelKernelNDGeoPointND:P];
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_initWithOrgGeogebraCommonKernelConstruction_withNSString_withOrgGeogebraCommonKernelKernelNDGeoPointND_withOrgGeogebraCommonKernelKernelNDGeoPointND_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, OrgGeogebraCommonKernelConstruction *cons, NSString *label, id<OrgGeogebraCommonKernelKernelNDGeoPointND> Q, id<OrgGeogebraCommonKernelKernelNDGeoPointND> P) {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_initWithOrgGeogebraCommonKernelConstruction_withOrgGeogebraCommonKernelKernelNDGeoPointND_withOrgGeogebraCommonKernelKernelNDGeoPointND_withInt_withBoolean_(self, cons, Q, P, OrgGeogebraCommonKernelPathMover_MIN_STEPS, YES);
  [((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(self->locus_)) setLabelWithNSString:label];
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_init__(OrgGeogebraCommonKernelAlgosAlgoLocusND *self) {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_Qin_(self, [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])))) getAllPredecessors]);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_setAndConsume_locusConsOrigElements_(self, new_JavaUtilTreeSet_init());
  JavaUtilTreeSet *usedAlgoIds = [new_JavaUtilTreeSet_init() autorelease];
  id<JavaUtilIterator> it = [((JavaUtilTreeSet *) nil_chk(self->Qin_)) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgGeogebraCommonKernelGeosGeoElement *parent = [it next];
    if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(parent)) isLabelSet] && [parent isChildOfWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])]) {
      OrgGeogebraCommonKernelMacro_addDependentElementWithOrgGeogebraCommonKernelGeosGeoElement_withJavaUtilSet_withJavaUtilSet_(parent, self->locusConsOrigElements_, usedAlgoIds);
    }
  }
  jboolean isLabeledP = [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->movingPoint_)) isLabelSet];
  if (!isLabeledP) {
    [((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])) setLabelSimpleWithNSString:[((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])) getDefaultLabel]];
    ((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]))->labelSet_ = YES;
  }
  jboolean isLabeledQ = [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->locusPoint_)) isLabelSet];
  if (!isLabeledQ) {
    [((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])) setLabelSimpleWithNSString:[((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])) getDefaultLabel]];
    ((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]))->labelSet_ = YES;
  }
  OrgGeogebraCommonKernelMacro_addDependentElementWithOrgGeogebraCommonKernelGeosGeoElement_withJavaUtilSet_withJavaUtilSet_((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]), self->locusConsOrigElements_, usedAlgoIds);
  OrgGeogebraCommonKernelMacro_addDependentElementWithOrgGeogebraCommonKernelGeosGeoElement_withJavaUtilSet_withJavaUtilSet_((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]), self->locusConsOrigElements_, usedAlgoIds);
  OrgGeogebraCommonKernelAlgosAlgoLocusND_buildLocusMacroConstructionWithJavaUtilTreeSet_(self, self->locusConsOrigElements_);
  if (!isLabeledP) ((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]))->labelSet_ = NO;
  if (!isLabeledQ) ((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class]))->labelSet_ = NO;
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_buildLocusMacroConstructionWithJavaUtilTreeSet_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, JavaUtilTreeSet *locusConsElements) {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_set_macroKernel_(self, [((OrgGeogebraCommonKernelKernel *) nil_chk(self->kernel_)) newMacroKernel]);
  [((OrgGeogebraCommonKernelMacroKernel *) nil_chk(self->macroKernel_)) setGlobalVariableLookupWithBoolean:YES];
  id<JavaUtilIterator> it = [((JavaUtilTreeSet *) nil_chk(locusConsElements)) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgGeogebraCommonKernelAlgosConstructionElement *ce = [it next];
    if ([((OrgGeogebraCommonKernelAlgosConstructionElement *) nil_chk(ce)) isGeoElement]) {
      OrgGeogebraCommonKernelGeosGeoElement *geo = (OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(ce, [OrgGeogebraCommonKernelGeosGeoElement class]);
      [self->macroKernel_ addReservedLabelWithNSString:[geo getLabelWithOrgGeogebraCommonKernelStringTemplate:OrgGeogebraCommonKernelStringTemplate_get_defaultTemplate_()]];
    }
  }
  @try {
    NSString *locusConsXML = [((JavaLangStringBuilder *) nil_chk(OrgGeogebraCommonKernelMacro_buildMacroXMLWithOrgGeogebraCommonKernelKernel_withJavaUtilSet_(self->kernel_, locusConsElements))) description];
    [self->macroKernel_ loadXMLWithNSString:locusConsXML];
    OrgGeogebraCommonKernelAlgosAlgoLocusND_set_Pcopy_(self, (id<OrgGeogebraCommonKernelKernelNDGeoPointND>) check_protocol_cast([self->macroKernel_ lookupLabelWithNSString:[((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->movingPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])))) getLabelSimple]], @protocol(OrgGeogebraCommonKernelKernelNDGeoPointND)));
    [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->Pcopy_, [OrgGeogebraCommonKernelGeosGeoElement class])))) setFixedWithBoolean:NO];
    [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->Pcopy_)) setPathWithOrgGeogebraCommonKernelPath:[((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->movingPoint_)) getPath]];
    OrgGeogebraCommonKernelAlgosAlgoLocusND_set_Qcopy_(self, (id<OrgGeogebraCommonKernelKernelNDGeoPointND>) check_protocol_cast([self->macroKernel_ lookupLabelWithNSString:[((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->locusPoint_, [OrgGeogebraCommonKernelGeosGeoElement class])))) getLabelSimple]], @protocol(OrgGeogebraCommonKernelKernelNDGeoPointND)));
    OrgGeogebraCommonKernelAlgosAlgoLocusND_set_macroCons_(self, [self->macroKernel_ getConstruction]);
  }
  @catch (JavaLangException *e) {
    [((JavaLangException *) nil_chk(e)) printStackTrace];
    [((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(self->locus_)) setUndefined];
    OrgGeogebraCommonKernelAlgosAlgoLocusND_set_macroCons_(self, nil);
  }
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_resetMacroConstruction(OrgGeogebraCommonKernelAlgosAlgoLocusND *self) {
  id<JavaUtilIterator> it = [((JavaUtilTreeSet *) nil_chk(self->locusConsOrigElements_)) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    OrgGeogebraCommonKernelAlgosConstructionElement *ce = [it next];
    if ([((OrgGeogebraCommonKernelAlgosConstructionElement *) nil_chk(ce)) isGeoElement]) {
      OrgGeogebraCommonKernelGeosGeoElement *geoOrig = (OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(ce, [OrgGeogebraCommonKernelGeosGeoElement class]);
      if (![geoOrig isGeoFunction]) {
        OrgGeogebraCommonKernelGeosGeoElement *geoCopy = [((OrgGeogebraCommonKernelConstruction *) nil_chk(self->macroCons_)) lookupLabelWithNSString:[geoOrig getLabelSimple]];
        if (geoCopy != nil) {
          @try {
            [geoCopy setWithOrgGeogebraCommonKernelGeosGeoElement:geoOrig];
            [geoCopy update];
          }
          @catch (JavaLangException *e) {
            OrgGeogebraCommonMainApp_debugWithNSString_(JreStrcat("$$", @"AlgoLocus: error in resetMacroConstruction(): ", [((JavaLangException *) nil_chk(e)) getMessage]));
          }
        }
      }
    }
  }
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_compute(OrgGeogebraCommonKernelAlgosAlgoLocusND *self) {
  if (![((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->movingPoint_)) isDefined] || self->macroCons_ == nil || !OrgGeogebraCommonKernelAlgosAlgoLocusND_isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement_([((id<OrgGeogebraCommonKernelPath>) nil_chk(self->path_)) toGeoElement])) {
    [((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(self->locus_)) setUndefined];
    return;
  }
  [self updateScreenBordersIfNecessary];
  [((OrgGeogebraCommonKernelGeosGeoLocusND *) nil_chk(self->locus_)) clearPoints];
  OrgGeogebraCommonKernelAlgosAlgoLocusND_clearCache(self);
  self->pointCount_ = 0;
  self->lastX_ = JavaLangDouble_MAX_VALUE;
  self->lastY_ = JavaLangDouble_MAX_VALUE;
  self->maxTimeExceeded_ = NO;
  self->foundDefined_ = NO;
  jboolean prevQcopyDefined = NO;
  jint max_runs;
  self->continuous_ = [((OrgGeogebraCommonKernelKernel *) nil_chk(self->kernel_)) isContinuous];
  [((OrgGeogebraCommonKernelMacroKernel *) nil_chk(self->macroKernel_)) setContinuousWithBoolean:self->continuous_];
  OrgGeogebraCommonKernelAlgosAlgoLocusND_resetMacroConstruction(self);
  [((OrgGeogebraCommonKernelConstruction *) nil_chk(self->macroCons_)) updateConstruction];
  [((id<OrgGeogebraCommonKernelPathMover>) nil_chk(self->pathMover_)) init__WithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Pcopy_ withInt:self->MIN_STEPS_INSTANCE_];
  if (self->continuous_) {
    max_runs = OrgGeogebraCommonKernelGeosGeoLocusND_MAX_PATH_RUNS;
  }
  else {
    max_runs = 1;
  }
  OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(self);
  prevQcopyDefined = ([((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->Qcopy_)) isDefined] && ![self->Qcopy_ isInfinite]);
  jint runs = 1;
  jint MAX_LOOPS = 2 * OrgGeogebraCommonKernelPathMover_MAX_POINTS * self->views_;
  jint whileLoops = 0;
  do {
    jboolean finishedRun = NO;
    while (!finishedRun && !self->maxTimeExceeded_ && self->pointCount_ <= OrgGeogebraCommonKernelPathMover_MAX_POINTS * self->views_ && whileLoops <= MAX_LOOPS) {
      whileLoops++;
      jboolean parameterJump = ![self->pathMover_ getNextWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Pcopy_];
      jboolean stepChanged = NO;
      OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(self);
      if ([self->Qcopy_ isDefined] && ![self->Qcopy_ isInfinite]) {
        if (!parameterJump) {
          while ([self->Qcopy_ isDefined] && ![self->Qcopy_ isInfinite] && !OrgGeogebraCommonKernelAlgosAlgoLocusND_distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND_(self, self->Qcopy_) && !self->maxTimeExceeded_) {
            jboolean smallerStep = [self->pathMover_ smallerStep];
            if (!smallerStep) break;
            stepChanged = YES;
            [self->pathMover_ stepBack];
            [self->pathMover_ getNextWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Pcopy_];
            OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(self);
          }
          if ([self->Qcopy_ isDefined] && ![self->Qcopy_ isInfinite]) {
            [self insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:[self distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:YES]];
            prevQcopyDefined = YES;
          }
        }
        else {
          [self insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:[self distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:YES]];
          prevQcopyDefined = YES;
        }
      }
      else {
        if (prevQcopyDefined && !parameterJump) {
          [self->pathMover_ stepBack];
          if (![self->pathMover_ smallerStep]) {
            prevQcopyDefined = NO;
          }
          else stepChanged = YES;
        }
      }
      if (!stepChanged) {
        [self->pathMover_ biggerStep];
      }
      if (![self->pathMover_ hasNext]) {
        if ([self distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->QstartPos_ withBoolean:YES]) {
          [self insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->QstartPos_ withBoolean:YES];
          finishedRun = YES;
        }
        else {
          while (![self->pathMover_ hasNext] && [self->pathMover_ smallerStep]) {
          }
          if (![self->pathMover_ hasNext]) finishedRun = YES;
        }
      }
    }
    if (self->maxTimeExceeded_) {
      [((JavaIoPrintStream *) nil_chk(JavaLangSystem_get_err_())) printlnWithNSString:@"AlgoLocus: max time exceeded"];
      return;
    }
    [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->Pcopy_, [OrgGeogebraCommonKernelGeosGeoElement class])))) setWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->PstartPos_, [OrgGeogebraCommonKernelGeosGeoElement class])];
    OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(self);
    if ([self differentFromLastWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_]) [self insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:[self distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:YES]];
    if ([self->pathMover_ hasPositiveOrientation]) {
      jboolean equal = [self areEqualWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->QstartPos_ withOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_];
      if (equal) {
        break;
      }
    }
    [self->pathMover_ resetStartParameter];
    runs++;
  }
  while (runs < max_runs);
  [self->locus_ setDefinedWithBoolean:self->foundDefined_];
}

jboolean OrgGeogebraCommonKernelAlgosAlgoLocusND_isPathIterableWithOrgGeogebraCommonKernelGeosGeoElement_(OrgGeogebraCommonKernelGeosGeoElement *geoElement) {
  OrgGeogebraCommonKernelAlgosAlgoLocusND_initialize();
  if ([((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(geoElement)) isGeoImplicitPoly]) return [((OrgGeogebraCommonKernelImplicitGeoImplicitPoly *) check_class_cast(geoElement, [OrgGeogebraCommonKernelImplicitGeoImplicitPoly class])) isOnScreen];
  return [geoElement isDefined];
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_pcopyUpdateCascade(OrgGeogebraCommonKernelAlgosAlgoLocusND *self) {
  if (self->continuous_) {
    [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->Pcopy_)) updateCascade];
  }
  else {
    jdouble param = ((OrgGeogebraCommonKernelPathParameter *) nil_chk([((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->Pcopy_)) getPathParameter]))->t_;
    OrgGeogebraCommonAwtGPoint2D *cachedPoint = OrgGeogebraCommonKernelAlgosAlgoLocusND_getCachedPointWithDouble_(self, param);
    if (cachedPoint == nil) {
      jlong startTime = JavaLangSystem_currentTimeMillis();
      [self->Pcopy_ updateCascade];
      jlong updateTime = JavaLangSystem_currentTimeMillis() - startTime;
      if (updateTime > OrgGeogebraCommonKernelAlgosAlgoLocusND_MAX_TIME_FOR_ONE_STEP_) {
        OrgGeogebraCommonMainApp_debugWithNSString_(JreStrcat("$J", @"AlgoLocus: max time exceeded ", updateTime));
        self->maxTimeExceeded_ = YES;
      }
      OrgGeogebraCommonKernelAlgosAlgoLocusND_putCachedPointWithDouble_withOrgGeogebraCommonKernelKernelNDGeoPointND_(self, param, self->Qcopy_);
    }
    else {
      [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->Qcopy_)) setCoordsWithDouble:[cachedPoint getX] withDouble:[cachedPoint getY] withDouble:1.0];
    }
  }
  if (!self->foundDefined_ && [((id<OrgGeogebraCommonKernelKernelNDGeoPointND>) nil_chk(self->Qcopy_)) isDefined] && ![self->Qcopy_ isInfinite]) {
    [((id<OrgGeogebraCommonKernelPathMover>) nil_chk(self->pathMover_)) init__WithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Pcopy_ withInt:self->MIN_STEPS_INSTANCE_];
    [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->PstartPos_, [OrgGeogebraCommonKernelGeosGeoElement class])))) setWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->Pcopy_, [OrgGeogebraCommonKernelGeosGeoElement class])];
    [((OrgGeogebraCommonKernelGeosGeoElement *) nil_chk(((OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->QstartPos_, [OrgGeogebraCommonKernelGeosGeoElement class])))) setWithOrgGeogebraCommonKernelGeosGeoElement:(OrgGeogebraCommonKernelGeosGeoElement *) check_class_cast(self->Qcopy_, [OrgGeogebraCommonKernelGeosGeoElement class])];
    self->foundDefined_ = YES;
    [self insertPointWithOrgGeogebraCommonKernelKernelNDGeoPointND:self->Qcopy_ withBoolean:NO];
  }
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_clearCache(OrgGeogebraCommonKernelAlgosAlgoLocusND *self) {
  for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(self->paramCache_))->size_; i++) {
    *IOSDoubleArray_GetRef(self->paramCache_, i) = JavaLangDouble_NaN;
    if (IOSObjectArray_Get(nil_chk(self->qcopyCache_), i) == nil) IOSObjectArray_Set(self->qcopyCache_, i, [self newCache]);
  }
}

OrgGeogebraCommonAwtGPoint2D *OrgGeogebraCommonKernelAlgosAlgoLocusND_getCachedPointWithDouble_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, jdouble param) {
  for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(self->paramCache_))->size_; i++) {
    if (param == IOSDoubleArray_Get(self->paramCache_, i)) return IOSObjectArray_Get(nil_chk(self->qcopyCache_), i);
  }
  return nil;
}

void OrgGeogebraCommonKernelAlgosAlgoLocusND_putCachedPointWithDouble_withOrgGeogebraCommonKernelKernelNDGeoPointND_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, jdouble param, id<OrgGeogebraCommonKernelKernelNDGeoPointND> Qcopy) {
  self->cacheIndex_++;
  if (self->cacheIndex_ >= ((IOSDoubleArray *) nil_chk(self->paramCache_))->size_) self->cacheIndex_ = 0;
  *IOSDoubleArray_GetRef(self->paramCache_, self->cacheIndex_) = param;
  [self setQCopyCacheWithOrgGeogebraCommonKernelMyPoint:IOSObjectArray_Get(nil_chk(self->qcopyCache_), self->cacheIndex_) withOrgGeogebraCommonKernelKernelNDGeoPointND:Qcopy];
}

jboolean OrgGeogebraCommonKernelAlgosAlgoLocusND_distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND_(OrgGeogebraCommonKernelAlgosAlgoLocusND *self, id<OrgGeogebraCommonKernelKernelNDGeoPointND> Q) {
  IOSBooleanArray *distanceOK = [IOSBooleanArray arrayWithBooleans:(jboolean[]){ NO, NO, NO } count:3];
  for (jint i = 0; i < distanceOK->size_; i++) {
    if (IOSBooleanArray_Get(nil_chk(self->lastFarAway_), i) && [self isFarAwayWithOrgGeogebraCommonKernelKernelNDGeoPointND:Q withInt:i]) {
      *IOSBooleanArray_GetRef(distanceOK, i) = [self distanceOKWithOrgGeogebraCommonKernelKernelNDGeoPointND:Q withOrgGeogebraCommonAwtGRectangle2D:IOSObjectArray_Get(nil_chk(self->nearToScreenRect_), i)];
    }
    else {
      *IOSBooleanArray_GetRef(distanceOK, i) = [self distanceSmallWithOrgGeogebraCommonKernelKernelNDGeoPointND:Q withBoolean:NO];
    }
  }
  for (jint i = 0; i < distanceOK->size_; i++) {
    if (!IOSBooleanArray_Get(distanceOK, i)) {
      return NO;
    }
  }
  return YES;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgGeogebraCommonKernelAlgosAlgoLocusND)
