//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/kernel/algos/AlgoIntersectFunctionLineNewton.java
//


#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/euclidian/EuclidianConstants.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/StringTemplate.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/algos/AlgoIntersectFunctionLineNewton.h"
#include "geogebra/common/kernel/algos/AlgoRootNewton.h"
#include "geogebra/common/kernel/algos/ConstructionElement.h"
#include "geogebra/common/kernel/algos/TangentAlgo.h"
#include "geogebra/common/kernel/arithmetic/Function.h"
#include "geogebra/common/kernel/commands/Commands.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoFunction.h"
#include "geogebra/common/kernel/geos/GeoLine.h"
#include "geogebra/common/kernel/geos/GeoPoint.h"
#include "geogebra/common/kernel/kernelND/GeoPointND.h"
#include "geogebra/common/main/Localization.h"
#include "java/lang/Double.h"

@interface GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton () {
 @public
  GeogebraCommonKernelGeosGeoFunction *f_AlgoIntersectFunctionLineNewton_;
  GeogebraCommonKernelGeosGeoLine *line_;
  GeogebraCommonKernelGeosGeoPoint *startPoint_, *rootPoint_AlgoIntersectFunctionLineNewton_;
  id<GeogebraCommonKernelKernelNDGeoPointND> tangentPoint_;
  GeogebraCommonKernelArithmeticFunction *diffFunction_;
  jboolean isDefinedAsTangent_;
}

- (void)addIncidence;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton, f_AlgoIntersectFunctionLineNewton_, GeogebraCommonKernelGeosGeoFunction *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton, line_, GeogebraCommonKernelGeosGeoLine *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton, startPoint_, GeogebraCommonKernelGeosGeoPoint *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton, rootPoint_AlgoIntersectFunctionLineNewton_, GeogebraCommonKernelGeosGeoPoint *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton, tangentPoint_, id<GeogebraCommonKernelKernelNDGeoPointND>)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton, diffFunction_, GeogebraCommonKernelArithmeticFunction *)

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_addIncidence(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self);

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_compute(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self);

@implementation GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons
                                            withNSString:(NSString *)label
                 withGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f
                     withGeogebraCommonKernelGeosGeoLine:(GeogebraCommonKernelGeosGeoLine *)line
                    withGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)startPoint {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(self, cons, label, f, line, startPoint);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons
                 withGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f
                     withGeogebraCommonKernelGeosGeoLine:(GeogebraCommonKernelGeosGeoLine *)line
                    withGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)startPoint {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(self, cons, f, line, startPoint);
  return self;
}

- (void)addIncidence {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_addIncidence(self);
}

- (GeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return GeogebraCommonKernelCommandsCommandsEnum_get_Intersect();
}

- (jint)getRelatedModeID {
  return GeogebraCommonEuclidianEuclidianConstants_MODE_INTERSECT;
}

- (void)setInputOutput {
  GeogebraCommonKernelAlgosAlgoElement_setAndConsume_input_(self, [IOSObjectArray newArrayWithLength:3 type:GeogebraCommonKernelGeosGeoElement_class_()]);
  IOSObjectArray_Set(input_, 0, f_AlgoIntersectFunctionLineNewton_);
  IOSObjectArray_Set(input_, 1, line_);
  IOSObjectArray_Set(input_, 2, startPoint_);
  [super setOutputLengthWithInt:1];
  [super setOutputWithInt:0 withGeogebraCommonKernelGeosGeoElement:rootPoint_AlgoIntersectFunctionLineNewton_];
  [self setDependencies];
}

- (void)compute {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_compute(self);
}

- (GeogebraCommonKernelGeosGeoPoint *)getIntersectionPoint {
  return rootPoint_AlgoIntersectFunctionLineNewton_;
}

- (NSString *)toStringWithGeogebraCommonKernelStringTemplate:(GeogebraCommonKernelStringTemplate *)tpl {
  return [((GeogebraCommonMainLocalization *) nil_chk([self getLoc])) getPlainWithNSString:@"IntersectionPointOfABWithInitialValueC" withNSString:[((GeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(nil_chk(input_), 0))) getLabelWithGeogebraCommonKernelStringTemplate:tpl] withNSString:[((GeogebraCommonKernelGeosGeoElement *) nil_chk(IOSObjectArray_Get(input_, 1))) getLabelWithGeogebraCommonKernelStringTemplate:tpl] withNSString:[((GeogebraCommonKernelGeosGeoPoint *) nil_chk(startPoint_)) getLabelWithGeogebraCommonKernelStringTemplate:tpl]];
}

- (void)dealloc {
  RELEASE_(f_AlgoIntersectFunctionLineNewton_);
  RELEASE_(line_);
  RELEASE_(startPoint_);
  RELEASE_(rootPoint_AlgoIntersectFunctionLineNewton_);
  RELEASE_(tangentPoint_);
  RELEASE_(diffFunction_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:withNSString:withGeogebraCommonKernelGeosGeoFunction:withGeogebraCommonKernelGeosGeoLine:withGeogebraCommonKernelGeosGeoPoint:", "AlgoIntersectFunctionLineNewton", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withGeogebraCommonKernelGeosGeoFunction:withGeogebraCommonKernelGeosGeoLine:withGeogebraCommonKernelGeosGeoPoint:", "AlgoIntersectFunctionLineNewton", NULL, 0x1, NULL, NULL },
    { "addIncidence", NULL, "V", 0x2, NULL, NULL },
    { "getClassName", NULL, "Lgeogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "getRelatedModeID", NULL, "I", 0x1, NULL, NULL },
    { "setInputOutput", NULL, "V", 0x4, NULL, NULL },
    { "compute", NULL, "V", 0x11, NULL, NULL },
    { "getIntersectionPoint", NULL, "Lgeogebra.common.kernel.geos.GeoPoint;", 0x1, NULL, NULL },
    { "toStringWithGeogebraCommonKernelStringTemplate:", "toString", "Ljava.lang.String;", 0x11, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "f_AlgoIntersectFunctionLineNewton_", "f", 0x2, "Lgeogebra.common.kernel.geos.GeoFunction;", NULL, NULL,  },
    { "line_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoLine;", NULL, NULL,  },
    { "startPoint_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoPoint;", NULL, NULL,  },
    { "rootPoint_AlgoIntersectFunctionLineNewton_", "rootPoint", 0x2, "Lgeogebra.common.kernel.geos.GeoPoint;", NULL, NULL,  },
    { "tangentPoint_", NULL, 0x2, "Lgeogebra.common.kernel.kernelND.GeoPointND;", NULL, NULL,  },
    { "diffFunction_", NULL, 0x2, "Lgeogebra.common.kernel.arithmetic.Function;", NULL, NULL,  },
    { "isDefinedAsTangent_", NULL, 0x2, "Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton = { 2, "AlgoIntersectFunctionLineNewton", "geogebra.common.kernel.algos", NULL, 0x1, 9, methods, 7, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton;
}

@end

void GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self, GeogebraCommonKernelConstruction *cons, NSString *label, GeogebraCommonKernelGeosGeoFunction *f, GeogebraCommonKernelGeosGeoLine *line, GeogebraCommonKernelGeosGeoPoint *startPoint) {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(self, cons, f, line, startPoint);
  [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->rootPoint_AlgoIntersectFunctionLineNewton_)) setLabelWithNSString:label];
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_addIncidence(self);
}

GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *new_GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(GeogebraCommonKernelConstruction *cons, NSString *label, GeogebraCommonKernelGeosGeoFunction *f, GeogebraCommonKernelGeosGeoLine *line, GeogebraCommonKernelGeosGeoPoint *startPoint) {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self = [GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton alloc];
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(self, cons, label, f, line, startPoint);
  return self;
}

void GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self, GeogebraCommonKernelConstruction *cons, GeogebraCommonKernelGeosGeoFunction *f, GeogebraCommonKernelGeosGeoLine *line, GeogebraCommonKernelGeosGeoPoint *startPoint) {
  GeogebraCommonKernelAlgosAlgoRootNewton_initWithGeogebraCommonKernelConstruction_(self, cons);
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_set_f_AlgoIntersectFunctionLineNewton_(self, f);
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_set_line_(self, line);
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_set_startPoint_(self, startPoint);
  if ([GeogebraCommonKernelAlgosTangentAlgo_class_() isInstance:[((GeogebraCommonKernelGeosGeoLine *) nil_chk(line)) getParentAlgorithm]]) {
    id<GeogebraCommonKernelAlgosTangentAlgo> algo = (id<GeogebraCommonKernelAlgosTangentAlgo>) check_protocol_cast([line getParentAlgorithm], @protocol(GeogebraCommonKernelAlgosTangentAlgo));
    GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_set_tangentPoint_(self, [((id<GeogebraCommonKernelAlgosTangentAlgo>) nil_chk(algo)) getTangentPointWithGeogebraCommonKernelGeosGeoElement:f withGeogebraCommonKernelGeosGeoLine:line]);
    self->isDefinedAsTangent_ = (self->tangentPoint_ != nil);
  }
  if (!self->isDefinedAsTangent_) {
    GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_setAndConsume_diffFunction_(self, new_GeogebraCommonKernelArithmeticFunction_initWithGeogebraCommonKernelKernel_(self->kernel_));
  }
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_setAndConsume_rootPoint_AlgoIntersectFunctionLineNewton_(self, new_GeogebraCommonKernelGeosGeoPoint_initWithGeogebraCommonKernelConstruction_(cons));
  [self setInputOutput];
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_compute(self);
}

GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *new_GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(GeogebraCommonKernelConstruction *cons, GeogebraCommonKernelGeosGeoFunction *f, GeogebraCommonKernelGeosGeoLine *line, GeogebraCommonKernelGeosGeoPoint *startPoint) {
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self = [GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton alloc];
  GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelGeosGeoPoint_(self, cons, f, line, startPoint);
  return self;
}

void GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_addIncidence(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self) {
  [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->rootPoint_AlgoIntersectFunctionLineNewton_)) addIncidenceWithGeogebraCommonKernelGeosGeoElement:self->f_AlgoIntersectFunctionLineNewton_ withBoolean:NO];
  [self->rootPoint_AlgoIntersectFunctionLineNewton_ addIncidenceWithGeogebraCommonKernelGeosGeoElement:self->line_ withBoolean:NO];
}

void GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton_compute(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton *self) {
  if (!([((GeogebraCommonKernelGeosGeoFunction *) nil_chk(self->f_AlgoIntersectFunctionLineNewton_)) isDefined] && [((GeogebraCommonKernelGeosGeoLine *) nil_chk(self->line_)) isDefined] && [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->startPoint_)) isDefined])) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->rootPoint_AlgoIntersectFunctionLineNewton_)) setUndefined];
    return;
  }
  if (self->isDefinedAsTangent_) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->rootPoint_AlgoIntersectFunctionLineNewton_)) setCoordsFromPointWithGeogebraCommonKernelKernelNDGeoPointND:self->tangentPoint_];
    return;
  }
  jdouble x;
  if (GeogebraCommonKernelKernel_isZeroWithDouble_(((GeogebraCommonKernelGeosGeoLine *) nil_chk(self->line_))->y_)) {
    x = -self->line_->z_ / self->line_->x_;
  }
  else {
    GeogebraCommonKernelArithmeticFunction_differenceWithGeogebraCommonKernelArithmeticFunction_withGeogebraCommonKernelGeosGeoLine_withGeogebraCommonKernelArithmeticFunction_([self->f_AlgoIntersectFunctionLineNewton_ getFunctionWithDouble:((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->startPoint_))->inhomX_], self->line_, self->diffFunction_);
    x = [self calcRootWithGeogebraCommonKernelArithmeticFunction:self->diffFunction_ withDouble:self->startPoint_->inhomX_];
  }
  if (JavaLangDouble_isNaNWithDouble_(x)) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->rootPoint_AlgoIntersectFunctionLineNewton_)) setUndefined];
    return;
  }
  jdouble y = [self->f_AlgoIntersectFunctionLineNewton_ evaluateWithDouble:x];
  [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->rootPoint_AlgoIntersectFunctionLineNewton_)) setCoordsWithDouble:x withDouble:y withDouble:1.0];
  if (![self->line_ isIntersectionPointIncidentWithGeogebraCommonKernelGeosGeoPoint:self->rootPoint_AlgoIntersectFunctionLineNewton_ withDouble:GeogebraCommonKernelKernel_MIN_PRECISION]) {
    [self->rootPoint_AlgoIntersectFunctionLineNewton_ setUndefined];
    return;
  }
  if (![((GeogebraCommonKernelGeosGeoPoint *) nil_chk(self->startPoint_)) isLabelSet] && [self->startPoint_ isIndependent] && [self->rootPoint_AlgoIntersectFunctionLineNewton_ isDefined]) {
    [self->startPoint_ setCoordsWithGeogebraCommonKernelGeosGeoVec3D:self->rootPoint_AlgoIntersectFunctionLineNewton_];
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelAlgosAlgoIntersectFunctionLineNewton)
