//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/kernel/implicit/GeoImplicitPoly.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/MacroConstruction.h"
#include "geogebra/common/kernel/Matrix/Coords.h"
#include "geogebra/common/kernel/MyPoint.h"
#include "geogebra/common/kernel/Path.h"
#include "geogebra/common/kernel/PathMover.h"
#include "geogebra/common/kernel/StringTemplate.h"
#include "geogebra/common/kernel/algos/AlgoClosestPoint.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/algos/AlgoPointOnPath.h"
#include "geogebra/common/kernel/algos/AlgorithmSet.h"
#include "geogebra/common/kernel/algos/ConstructionElement.h"
#include "geogebra/common/kernel/arithmetic/ExpressionNodeConstants.h"
#include "geogebra/common/kernel/arithmetic/ExpressionValue.h"
#include "geogebra/common/kernel/arithmetic/NumberValue.h"
#include "geogebra/common/kernel/arithmetic/Polynomial.h"
#include "geogebra/common/kernel/geos/GeoConic.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoLine.h"
#include "geogebra/common/kernel/geos/GeoList.h"
#include "geogebra/common/kernel/geos/GeoLocus.h"
#include "geogebra/common/kernel/geos/GeoPoint.h"
#include "geogebra/common/kernel/geos/GeoUserInputElement.h"
#include "geogebra/common/kernel/implicit/GeoImplicitPoly.h"
#include "geogebra/common/kernel/implicit/PolynomialUtils.h"
#include "geogebra/common/kernel/kernelND/GeoConicND.h"
#include "geogebra/common/kernel/kernelND/GeoLineND.h"
#include "geogebra/common/kernel/kernelND/GeoPointND.h"
#include "geogebra/common/main/App.h"
#include "geogebra/common/plugin/GeoClass.h"
#include "java/lang/Double.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "java/util/Iterator.h"
#include "java/util/List.h"
#include "org/apache/commons/math/linear/Array2DRowRealMatrix.h"
#include "org/apache/commons/math/linear/DecompositionSolver.h"
#include "org/apache/commons/math/linear/LUDecompositionImpl.h"
#include "org/apache/commons/math/linear/RealMatrix.h"

#define GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_GRAD 1.0E-8
#define GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_STEP_SIZE 0.1
#define GeogebraCommonKernelImplicitGeoImplicitPoly_START_STEP_SIZE 0.5
#define GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEP_SIZE 1.0
#define GeogebraCommonKernelImplicitGeoImplicitPoly_SING_RADIUS 1.0
#define GeogebraCommonKernelImplicitGeoImplicitPoly_NEAR_SING 0.001
#define GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEPS 10000

@interface GeogebraCommonKernelImplicitGeoImplicitPoly () {
 @public
  IOSObjectArray *coeff_;
  IOSObjectArray *coeffSquarefree_;
  jint degX_;
  jint degY_;
  jboolean defined_;
  jboolean isConstant__;
  jboolean calcPath_;
  jboolean trace_;
  GeogebraCommonKernelGeosGeoLocus *locus_;
  id<JavaUtilList> singularitiesCollection_;
  id<JavaUtilList> boundaryIntersectCollection_;
  IOSObjectArray *remember_;
  IOSObjectArray *grid_;
  jint gridWidth_;
  jint gridHeight_;
  jdouble scaleX_;
  jdouble scaleY_;
  jdouble minGap_;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                            withNSString:(NSString *)label
                                        withDoubleArray2:(IOSObjectArray *)coeff
                                             withBoolean:(jboolean)calcPath;

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                            withNSString:(NSString *)label
            withGeogebraCommonKernelArithmeticPolynomial:(GeogebraCommonKernelArithmeticPolynomial *)poly
                                             withBoolean:(jboolean)calcPath;

+ (IOSObjectArray *)coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND:(GeogebraCommonKernelKernelNDGeoConicND *)c;

+ (void)addPowWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                                withInt:(jint)exp
 withGeogebraCommonKernelStringTemplate:(GeogebraCommonKernelStringTemplate *)tpl;

+ (void)appendMultiplyWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb;

+ (void)polyMultWithDoubleArray2:(IOSObjectArray *)polyDest
                withDoubleArray2:(IOSObjectArray *)polySrc
                         withInt:(jint)degDestX
                         withInt:(jint)degDestY
                         withInt:(jint)degSrcX
                         withInt:(jint)degSrcY;

- (void)getFactors;

- (jdouble)scaledNormSquaredWithDouble:(jdouble)x
                            withDouble:(jdouble)y;

- (void)startPathWithInt:(jint)width
                 withInt:(jint)height
              withDouble:(jdouble)x
              withDouble:(jdouble)y
withGeogebraCommonKernelGeosGeoLocus:(GeogebraCommonKernelGeosGeoLocus *)loc1;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, coeff_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, coeffSquarefree_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, locus_, GeogebraCommonKernelGeosGeoLocus *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, singularitiesCollection_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, boundaryIntersectCollection_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, remember_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, grid_, IOSObjectArray *)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, MIN_GRAD, jdouble)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, MIN_STEP_SIZE, jdouble)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, START_STEP_SIZE, jdouble)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, MAX_STEP_SIZE, jdouble)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, SING_RADIUS, jdouble)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, NEAR_SING, jdouble)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelImplicitGeoImplicitPoly, MAX_STEPS, jint)

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c, NSString *label, IOSObjectArray *coeff, jboolean calcPath);

__attribute__((unused)) static GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(GeogebraCommonKernelConstruction *c, NSString *label, IOSObjectArray *coeff, jboolean calcPath) NS_RETURNS_RETAINED;

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c, NSString *label, GeogebraCommonKernelArithmeticPolynomial *poly, jboolean calcPath);

__attribute__((unused)) static GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(GeogebraCommonKernelConstruction *c, NSString *label, GeogebraCommonKernelArithmeticPolynomial *poly, jboolean calcPath) NS_RETURNS_RETAINED;

__attribute__((unused)) static IOSObjectArray *GeogebraCommonKernelImplicitGeoImplicitPoly_coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND_(GeogebraCommonKernelKernelNDGeoConicND *c);

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_addPowWithJavaLangStringBuilder_withInt_withGeogebraCommonKernelStringTemplate_(JavaLangStringBuilder *sb, jint exp, GeogebraCommonKernelStringTemplate *tpl);

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_appendMultiplyWithJavaLangStringBuilder_(JavaLangStringBuilder *sb);

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(IOSObjectArray *polyDest, IOSObjectArray *polySrc, jint degDestX, jint degDestY, jint degSrcX, jint degSrcY);

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_getFactors(GeogebraCommonKernelImplicitGeoImplicitPoly *self);

__attribute__((unused)) static jdouble GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, jdouble x, jdouble y);

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_startPathWithInt_withInt_withDouble_withDouble_withGeogebraCommonKernelGeosGeoLocus_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, jint width, jint height, jdouble x, jdouble y, GeogebraCommonKernelGeosGeoLocus *loc1);

@interface GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect : NSObject {
 @public
  jdouble x_, y_, width_, height_;
  IOSIntArray *eval_;
}

- (instancetype)initWithDouble:(jdouble)x
                    withDouble:(jdouble)y
                    withDouble:(jdouble)width
                    withDouble:(jdouble)height;

@end

J2OBJC_EMPTY_STATIC_INIT(GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect)

J2OBJC_FIELD_SETTER(GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect, eval_, IOSIntArray *)

__attribute__((unused)) static void GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *self, jdouble x, jdouble y, jdouble width, jdouble height);

__attribute__((unused)) static GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *new_GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(jdouble x, jdouble y, jdouble width, jdouble height) NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect)

@implementation GeogebraCommonKernelImplicitGeoImplicitPoly

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(self, c);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                            withNSString:(NSString *)label
                                        withDoubleArray2:(IOSObjectArray *)coeff
                                             withBoolean:(jboolean)calcPath {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(self, c, label, coeff, calcPath);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                            withNSString:(NSString *)label
                                        withDoubleArray2:(IOSObjectArray *)coeff {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_(self, c, label, coeff);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                            withNSString:(NSString *)label
            withGeogebraCommonKernelArithmeticPolynomial:(GeogebraCommonKernelArithmeticPolynomial *)poly
                                             withBoolean:(jboolean)calcPath {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(self, c, label, poly, calcPath);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                            withNSString:(NSString *)label
            withGeogebraCommonKernelArithmeticPolynomial:(GeogebraCommonKernelArithmeticPolynomial *)poly {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_(self, c, label, poly);
  return self;
}

+ (GeogebraCommonKernelImplicitGeoImplicitPoly *)createImplicitPolyWithoutPathWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                                                                                  withDoubleArray2:(IOSObjectArray *)coeff {
  return GeogebraCommonKernelImplicitGeoImplicitPoly_createImplicitPolyWithoutPathWithGeogebraCommonKernelConstruction_withDoubleArray2_(c, coeff);
}

- (void)preventPathCreation {
  calcPath_ = NO;
  [((GeogebraCommonKernelConstruction *) nil_chk(cons_)) unregisterEuclidianViewCEWithGeogebraCommonKernelEuclidianViewCE:self];
}

- (instancetype)initWithGeogebraCommonKernelImplicitGeoImplicitPoly:(GeogebraCommonKernelImplicitGeoImplicitPoly *)g {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelImplicitGeoImplicitPoly_(self, g);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelKernelNDGeoConicND:(GeogebraCommonKernelKernelNDGeoConicND *)c {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelKernelNDGeoConicND_(self, c);
  return self;
}

+ (IOSObjectArray *)coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND:(GeogebraCommonKernelKernelNDGeoConicND *)c {
  return GeogebraCommonKernelImplicitGeoImplicitPoly_coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND_(c);
}

- (GeogebraCommonKernelGeosGeoElement *)copy__ {
  return [new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelImplicitGeoImplicitPoly_(self) autorelease];
}

- (GeogebraCommonPluginGeoClassEnum *)getGeoClassType {
  return GeogebraCommonPluginGeoClassEnum_get_IMPLICIT_POLY();
}

- (void)getXMLtagsWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  [super getXMLtagsWithJavaLangStringBuilder:sb];
  [self getLineStyleXMLWithJavaLangStringBuilder:sb];
  [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"\t<coefficients rep=\"array\" data=\""];
  [sb appendWithNSString:@"["];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(coeff_))->size_; i++) {
    if (i > 0) [sb appendWithChar:','];
    [sb appendWithNSString:@"["];
    for (jint j = 0; j < ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, i)))->size_; j++) {
      if (j > 0) [sb appendWithChar:','];
      [sb appendWithDouble:IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j)];
    }
    [sb appendWithNSString:@"]"];
  }
  [sb appendWithNSString:@"]"];
  [sb appendWithNSString:@"\" />\n"];
}

- (jboolean)isDefined {
  return defined_;
}

- (jboolean)isOnScreen {
  return defined_ && [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) isDefined] && [((JavaUtilArrayList *) nil_chk([locus_ getPoints])) size] > 0;
}

- (jboolean)isEqualWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)Geo {
  if ([Geo isKindOfClass:[GeogebraCommonKernelImplicitGeoImplicitPoly class]]) {
    GeogebraCommonKernelImplicitGeoImplicitPoly *imp = (GeogebraCommonKernelImplicitGeoImplicitPoly *) check_class_cast(Geo, [GeogebraCommonKernelImplicitGeoImplicitPoly class]);
    for (jint i = 0; i < JavaLangMath_maxWithInt_withInt_(((IOSObjectArray *) nil_chk(((GeogebraCommonKernelImplicitGeoImplicitPoly *) nil_chk(imp))->coeff_))->size_, coeff_->size_); i++) {
      jint l = 0;
      if (i < imp->coeff_->size_) l = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(imp->coeff_, i)))->size_;
      if (i < coeff_->size_) {
        l = JavaLangMath_maxWithInt_withInt_(l, ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, i)))->size_);
      }
      for (jint j = 0; j < l; j++) {
        jdouble c = 0;
        if (i < imp->coeff_->size_) {
          if (j < ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(imp->coeff_, i)))->size_) {
            c = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(imp->coeff_, i)), j);
          }
        }
        jdouble d = 0;
        if (i < coeff_->size_) {
          if (j < ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, i)))->size_) {
            d = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j);
          }
        }
        if (!GeogebraCommonKernelKernel_isEqualWithDouble_withDouble_(c, d)) return NO;
      }
    }
    return YES;
  }
  return NO;
}

- (jboolean)isGeoImplicitPoly {
  return YES;
}

- (jboolean)isPath {
  return YES;
}

- (void)setWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  if ([geo isKindOfClass:[GeogebraCommonKernelKernelNDGeoConicND class]]) {
    [self setCoeffWithDoubleArray2:GeogebraCommonKernelImplicitGeoImplicitPoly_coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND_((GeogebraCommonKernelKernelNDGeoConicND *) check_class_cast(geo, [GeogebraCommonKernelKernelNDGeoConicND class]))];
    return;
  }
  else if ([geo isKindOfClass:[GeogebraCommonKernelGeosGeoLine class]]) {
    GeogebraCommonKernelGeosGeoLine *l = (GeogebraCommonKernelGeosGeoLine *) check_class_cast(geo, [GeogebraCommonKernelGeosGeoLine class]);
    [self setCoeffWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ [((GeogebraCommonKernelGeosGeoLine *) nil_chk(l)) getZ], [l getY] } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ [l getX], 0 } count:2] } count:2 type:IOSClass_doubleArray(1)]];
    return;
  }
  else if (!([geo isKindOfClass:[GeogebraCommonKernelImplicitGeoImplicitPoly class]])) {
    [self setUndefined];
    return;
  }
  [super setWithGeogebraCommonKernelGeosGeoElement:geo];
  [self setCoeffWithDoubleArray2:[((GeogebraCommonKernelImplicitGeoImplicitPoly *) nil_chk(((GeogebraCommonKernelImplicitGeoImplicitPoly *) check_class_cast(geo, [GeogebraCommonKernelImplicitGeoImplicitPoly class])))) getCoeff] withBoolean:NO];
  id<JavaUtilList> list = [((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) getViewSet];
  jboolean needsNewLocus = NO;
  if (list == nil) {
    needsNewLocus = ![self isVisibleInViewWithInt:GeogebraCommonMainApp_VIEW_EUCLIDIAN];
  }
  else {
    for (jint i = 0; i < [list size]; i++) {
      if (![self isVisibleInViewWithInt:[((JavaLangInteger *) nil_chk([list getWithInt:i])) intValue]]) {
        needsNewLocus = YES;
        break;
      }
    }
  }
  if (needsNewLocus) {
    [self updatePath];
  }
  else {
    [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setWithGeogebraCommonKernelGeosGeoElement:((GeogebraCommonKernelImplicitGeoImplicitPoly *) check_class_cast(geo, [GeogebraCommonKernelImplicitGeoImplicitPoly class]))->locus_];
  }
  self->defined_ = [((GeogebraCommonKernelImplicitGeoImplicitPoly *) check_class_cast(geo, [GeogebraCommonKernelImplicitGeoImplicitPoly class])) isDefined];
}

- (void)setUndefined {
  defined_ = NO;
}

- (void)setDefined {
  defined_ = YES;
}

- (jboolean)showInAlgebraView {
  return YES;
}

- (jboolean)showInEuclidianView {
  return YES;
}

+ (void)addPowWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                                withInt:(jint)exp
 withGeogebraCommonKernelStringTemplate:(GeogebraCommonKernelStringTemplate *)tpl {
  GeogebraCommonKernelImplicitGeoImplicitPoly_addPowWithJavaLangStringBuilder_withInt_withGeogebraCommonKernelStringTemplate_(sb, exp, tpl);
}

- (NSString *)toRawValueStringWithGeogebraCommonKernelStringTemplate:(GeogebraCommonKernelStringTemplate *)tpl {
  if (coeff_ == nil) return @"";
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  jboolean first = YES;
  for (jint i = ((IOSObjectArray *) nil_chk(coeff_))->size_ - 1; i >= 0; i--) {
    for (jint j = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, i)))->size_ - 1; j >= 0; j--) {
      if (i == 0 && j == 0) {
        if (first) {
          [sb appendWithNSString:@"0"];
        }
        [sb appendWithNSString:@"= "];
        [sb appendWithNSString:[((GeogebraCommonKernelKernel *) nil_chk(kernel_)) formatWithDouble:-IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, 0)), 0) withGeogebraCommonKernelStringTemplate:tpl]];
      }
      else {
        NSString *number = [((GeogebraCommonKernelKernel *) nil_chk(kernel_)) formatWithDouble:IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j) withGeogebraCommonKernelStringTemplate:tpl];
        jboolean pos = YES;
        if ([((NSString *) nil_chk(number)) charAtWithInt:0] == '-') {
          pos = NO;
          number = [number substring:1];
        }
        if (![((NSString *) nil_chk(number)) isEqual:@"0"] && IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j) != 0) {
          if (pos) {
            if (!first) {
              [sb appendWithChar:'+'];
            }
          }
          else {
            [sb appendWithChar:'-'];
          }
          if (!first) {
            [sb appendWithChar:' '];
          }
          first = NO;
          if (![number isEqual:@"1"] && IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j) != 1) {
            [sb appendWithNSString:number];
            if ([((GeogebraCommonKernelStringTemplate *) nil_chk(tpl)) hasTypeWithGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum:GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_GIAC()]) {
              GeogebraCommonKernelImplicitGeoImplicitPoly_appendMultiplyWithJavaLangStringBuilder_(sb);
            }
          }
          if (i > 0) {
            [sb appendWithNSString:[((GeogebraCommonKernelStringTemplate *) nil_chk(tpl)) printVariableNameWithNSString:@"x"]];
          }
          GeogebraCommonKernelImplicitGeoImplicitPoly_addPowWithJavaLangStringBuilder_withInt_withGeogebraCommonKernelStringTemplate_(sb, i, tpl);
          if (j > 0) {
            if ([((GeogebraCommonKernelStringTemplate *) nil_chk(tpl)) hasTypeWithGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum:GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_GIAC()]) {
              GeogebraCommonKernelImplicitGeoImplicitPoly_appendMultiplyWithJavaLangStringBuilder_(sb);
            }
            else if (i > 0) {
              [sb appendWithChar:' '];
            }
            [sb appendWithNSString:[tpl printVariableNameWithNSString:@"y"]];
          }
          GeogebraCommonKernelImplicitGeoImplicitPoly_addPowWithJavaLangStringBuilder_withInt_withGeogebraCommonKernelStringTemplate_(sb, j, tpl);
          [sb appendWithChar:' '];
        }
      }
    }
  }
  return [sb description];
}

+ (void)appendMultiplyWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  GeogebraCommonKernelImplicitGeoImplicitPoly_appendMultiplyWithJavaLangStringBuilder_(sb);
}

- (void)setCoeffWithDoubleArray2:(IOSObjectArray *)c {
  [self setCoeffWithDoubleArray2:c withBoolean:YES];
}

- (void)setCoeffWithDoubleArray2:(IOSObjectArray *)c
                     withBoolean:(jboolean)calcPath {
  isConstant__ = YES;
  degX_ = -1;
  degY_ = -1;
  GeogebraCommonKernelImplicitGeoImplicitPoly_set_coeffSquarefree_(self, nil);
  degX_ = ((IOSObjectArray *) nil_chk(c))->size_ - 1;
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_coeff_(self, [IOSObjectArray newArrayWithLength:c->size_ type:IOSClass_doubleArray(1)]);
  for (jint i = 0; i < c->size_; i++) {
    IOSObjectArray_SetAndConsume(coeff_, i, [IOSDoubleArray newArrayWithLength:((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(c, i)))->size_]);
    if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(c, i)))->size_ > degY_ + 1) degY_ = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(c, i)))->size_ - 1;
    for (jint j = 0; j < ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(c, i)))->size_; j++) {
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(coeff_, i)), j) = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(c, i)), j);
      if (JavaLangDouble_isInfiniteWithDouble_(IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j))) {
        [self setUndefined];
      }
      isConstant__ = (isConstant__ && (IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(c, i)), j) == 0 || (i == 0 && j == 0)));
    }
  }
  if (calcPath && self->calcPath_) [self updatePath];
}

- (void)setCoeffWithGeogebraCommonKernelArithmeticExpressionValueArray2:(IOSObjectArray *)ev {
  [self setCoeffWithGeogebraCommonKernelArithmeticExpressionValueArray2:ev withBoolean:YES];
}

- (void)setCoeffWithGeogebraCommonKernelArithmeticExpressionValueArray2:(IOSObjectArray *)ev
                                                            withBoolean:(jboolean)calcPath {
  isConstant__ = YES;
  degX_ = -1;
  degY_ = -1;
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_coeff_(self, [IOSObjectArray newArrayWithLength:((IOSObjectArray *) nil_chk(ev))->size_ type:IOSClass_doubleArray(1)]);
  degX_ = ev->size_ - 1;
  GeogebraCommonKernelImplicitGeoImplicitPoly_set_coeffSquarefree_(self, nil);
  for (jint i = 0; i < ev->size_; i++) {
    IOSObjectArray_SetAndConsume(coeff_, i, [IOSDoubleArray newArrayWithLength:((IOSObjectArray *) nil_chk(IOSObjectArray_Get(ev, i)))->size_]);
    if (((IOSObjectArray *) nil_chk(IOSObjectArray_Get(ev, i)))->size_ > degY_ + 1) degY_ = ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(ev, i)))->size_ - 1;
    for (jint j = 0; j < ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(ev, i)))->size_; j++) {
      if (IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(ev, i)), j) == nil) *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(coeff_, i)), j) = 0;
      else *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(coeff_, i)), j) = [((id<GeogebraCommonKernelArithmeticExpressionValue>) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(ev, i)), j))) evaluateDouble];
      if (JavaLangDouble_isInfiniteWithDouble_(IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j))) {
        [self setUndefined];
      }
      isConstant__ = (isConstant__ && (GeogebraCommonKernelKernel_isZeroWithDouble_(IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, i)), j)) || (i == 0 && j == 0)));
    }
  }
  GeogebraCommonKernelImplicitGeoImplicitPoly_getFactors(self);
  if (calcPath && self->calcPath_) [self updatePath];
}

- (IOSObjectArray *)getCoeffWithBoolean:(jboolean)squarefree {
  if (squarefree && coeffSquarefree_ != nil) {
    return coeffSquarefree_;
  }
  return coeff_;
}

- (IOSObjectArray *)getCoeff {
  return coeff_;
}

- (jdouble)evalPolyAtWithDouble:(jdouble)x
                     withDouble:(jdouble)y {
  return [self evalPolyAtWithDouble:x withDouble:y withBoolean:NO];
}

- (jdouble)evalPolyAtWithDouble:(jdouble)x
                     withDouble:(jdouble)y
                    withBoolean:(jboolean)squarefree {
  return GeogebraCommonKernelImplicitGeoImplicitPoly_evalPolyCoeffAtWithDouble_withDouble_withDoubleArray2_(x, y, [self getCoeffWithBoolean:squarefree]);
}

+ (jdouble)evalPolyCoeffAtWithDouble:(jdouble)x
                          withDouble:(jdouble)y
                    withDoubleArray2:(IOSObjectArray *)coeff {
  return GeogebraCommonKernelImplicitGeoImplicitPoly_evalPolyCoeffAtWithDouble_withDouble_withDoubleArray2_(x, y, coeff);
}

- (jdouble)evalDiffXPolyAtWithDouble:(jdouble)x
                          withDouble:(jdouble)y {
  return [self evalDiffXPolyAtWithDouble:x withDouble:y withBoolean:NO];
}

- (jdouble)evalDiffXPolyAtWithDouble:(jdouble)x
                          withDouble:(jdouble)y
                         withBoolean:(jboolean)squarefree {
  jdouble sum = 0;
  jdouble zs = 0;
  IOSObjectArray *coeff1 = [self getCoeffWithBoolean:squarefree];
  if (coeff1 != nil) for (jint i = coeff1->size_ - 1; i >= 1; i--) {
    zs = 0;
    for (jint j = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff1, i)))->size_ - 1; j >= 0; j--) {
      zs = y * zs + IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff1, i)), j);
    }
    sum = sum * x + i * zs;
  }
  return sum;
}

- (jdouble)evalDiffYPolyAtWithDouble:(jdouble)x
                          withDouble:(jdouble)y {
  return [self evalDiffYPolyAtWithDouble:x withDouble:y withBoolean:NO];
}

- (jdouble)evalDiffYPolyAtWithDouble:(jdouble)x
                          withDouble:(jdouble)y
                         withBoolean:(jboolean)squarefree {
  jdouble sum = 0;
  jdouble zs = 0;
  IOSObjectArray *coeff1 = [self getCoeffWithBoolean:squarefree];
  if (coeff1 != nil) for (jint i = coeff1->size_ - 1; i >= 0; i--) {
    zs = 0;
    for (jint j = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff1, i)))->size_ - 1; j >= 1; j--) {
      zs = y * zs + j * IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff1, i)), j);
    }
    sum = sum * x + zs;
  }
  return sum;
}

- (void)plugInRatPolyWithDoubleArray2:(IOSObjectArray *)pX
                     withDoubleArray2:(IOSObjectArray *)pY
                     withDoubleArray2:(IOSObjectArray *)qX
                     withDoubleArray2:(IOSObjectArray *)qY {
  jint degXpX = ((IOSObjectArray *) nil_chk(pX))->size_ - 1;
  jint degYpX = 0;
  for (jint i = 0; i < pX->size_; i++) {
    if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pX, i)))->size_ - 1 > degYpX) degYpX = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pX, i)))->size_ - 1;
  }
  jint degXqX = -1;
  jint degYqX = -1;
  if (qX != nil) {
    degXqX = qX->size_ - 1;
    for (jint i = 0; i < qX->size_; i++) {
      if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(qX, i)))->size_ - 1 > degYqX) degYqX = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(qX, i)))->size_ - 1;
    }
  }
  jint degXpY = ((IOSObjectArray *) nil_chk(pY))->size_ - 1;
  jint degYpY = 0;
  for (jint i = 0; i < pY->size_; i++) {
    if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pY, i)))->size_ - 1 > degYpY) degYpY = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pY, i)))->size_ - 1;
  }
  jint degXqY = -1;
  jint degYqY = -1;
  if (qY != nil) {
    degXqY = qY->size_ - 1;
    for (jint i = 0; i < qY->size_; i++) {
      if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(qY, i)))->size_ - 1 > degYqY) degYqY = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(qY, i)))->size_ - 1;
    }
  }
  jboolean sameDenom = NO;
  if (qX != nil && qY != nil) {
    sameDenom = YES;
    if (degXqX == degXqY && degYqX == degYqY) {
      for (jint i = 0; i < qX->size_; i++) if (!JavaUtilArrays_equalsWithDoubleArray_withDoubleArray_(IOSObjectArray_Get(qY, i), IOSObjectArray_Get(qX, i))) {
        sameDenom = NO;
        break;
      }
    }
  }
  jint commDeg = 0;
  if (sameDenom) {
    commDeg = [self getDeg];
  }
  jint newDegX = JavaLangMath_maxWithInt_withInt_(degXpX, degXqX) * degX_ + JavaLangMath_maxWithInt_withInt_(degXpY, degXqY) * degY_;
  jint newDegY = JavaLangMath_maxWithInt_withInt_(degYpX, degYqX) * degX_ + JavaLangMath_maxWithInt_withInt_(degYpY, degYqY) * degY_;
  IOSObjectArray *newCoeff = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ newDegX + 1, newDegY + 1 }];
  IOSObjectArray *tmpCoeff = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ newDegX + 1, newDegY + 1 }];
  IOSObjectArray *ratXCoeff = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ newDegX + 1, newDegY + 1 }];
  IOSObjectArray *ratYCoeff = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ newDegX + 1, newDegY + 1 }];
  jint tmpCoeffDegX = 0;
  jint tmpCoeffDegY = 0;
  jint newCoeffDegX = 0;
  jint newCoeffDegY = 0;
  jint ratXCoeffDegX = 0;
  jint ratXCoeffDegY = 0;
  jint ratYCoeffDegX = 0;
  jint ratYCoeffDegY = 0;
  for (jint i = 0; i < newDegX; i++) {
    for (jint j = 0; j < newDegY; j++) {
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(newCoeff, i)), j) = 0;
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(tmpCoeff, i)), j) = 0;
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(ratXCoeff, i)), j) = 0;
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(ratYCoeff, i)), j) = 0;
    }
  }
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(ratXCoeff, 0)), 0) = 1;
  for (jint x = ((IOSObjectArray *) nil_chk(coeff_))->size_ - 1; x >= 0; x--) {
    if (qY != nil) {
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(ratYCoeff, 0)), 0) = 1;
      ratYCoeffDegX = 0;
      ratYCoeffDegY = 0;
    }
    jint startY = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, x)))->size_ - 1;
    if (sameDenom) startY = commDeg - x;
    for (jint y = startY; y >= 0; y--) {
      if (qY == nil || y == startY) {
        if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, x)))->size_ > y) *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(tmpCoeff, 0)), 0) += IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, x)), y);
      }
      else {
        GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(ratYCoeff, qY, ratYCoeffDegX, ratYCoeffDegY, degXqY, degYqY);
        ratYCoeffDegX += degXqY;
        ratYCoeffDegY += degYqY;
        if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, x)))->size_ > y) for (jint i = 0; i <= ratYCoeffDegX; i++) {
          for (jint j = 0; j <= ratYCoeffDegY; j++) {
            *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(tmpCoeff, i)), j) += IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, x)), y) * IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(ratYCoeff, i)), j);
            if (y == 0) {
              *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(ratYCoeff, i)), j) = 0;
            }
          }
        }
        tmpCoeffDegX = JavaLangMath_maxWithInt_withInt_(tmpCoeffDegX, ratYCoeffDegX);
        tmpCoeffDegY = JavaLangMath_maxWithInt_withInt_(tmpCoeffDegY, ratYCoeffDegY);
      }
      if (y > 0) {
        GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(tmpCoeff, pY, tmpCoeffDegX, tmpCoeffDegY, degXpY, degYpY);
        tmpCoeffDegX += degXpY;
        tmpCoeffDegY += degYpY;
      }
    }
    if (qX != nil && x != coeff_->size_ - 1 && !sameDenom) {
      GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(ratXCoeff, qX, ratXCoeffDegX, ratXCoeffDegY, degXqX, degYqX);
      ratXCoeffDegX += degXqX;
      ratXCoeffDegY += degYqX;
      GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(tmpCoeff, ratXCoeff, tmpCoeffDegX, tmpCoeffDegY, ratXCoeffDegX, ratXCoeffDegY);
      tmpCoeffDegX += ratXCoeffDegX;
      tmpCoeffDegY += ratXCoeffDegY;
    }
    for (jint i = 0; i <= tmpCoeffDegX; i++) {
      for (jint j = 0; j <= tmpCoeffDegY; j++) {
        *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(newCoeff, i)), j) += IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(tmpCoeff, i)), j);
        *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(tmpCoeff, i)), j) = 0;
      }
    }
    newCoeffDegX = JavaLangMath_maxWithInt_withInt_(newCoeffDegX, tmpCoeffDegX);
    newCoeffDegY = JavaLangMath_maxWithInt_withInt_(newCoeffDegY, tmpCoeffDegY);
    tmpCoeffDegX = 0;
    tmpCoeffDegY = 0;
    if (x > 0) {
      GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(newCoeff, pX, newCoeffDegX, newCoeffDegY, degXpX, degYpX);
      newCoeffDegX += degXpX;
      newCoeffDegY += degYpX;
    }
  }
  GeogebraCommonKernelImplicitGeoImplicitPoly_set_coeff_(self, GeogebraCommonKernelImplicitPolynomialUtils_coeffMinDegWithDoubleArray2_(newCoeff));
  degX_ = ((IOSObjectArray *) nil_chk(coeff_))->size_ - 1;
  degY_ = 0;
  for (jint i = 0; i < coeff_->size_; i++) {
    degY_ = JavaLangMath_maxWithInt_withInt_(degY_, ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff_, i)))->size_ - 1);
  }
  [self setValidInputFormWithBoolean:NO];
  [self updatePath];
  if (algoUpdateSet_ != nil) {
    jdouble a = 0, ax = 0, ay = 0, b = 0, bx = 0, by = 0;
    if (qX == nil && qY == nil && degXpX <= 1 && degYpX <= 1 && degXpY <= 1 && degYpY <= 1) {
      if ((degXpX != 1 || degYpX != 1 || ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pX, 1)))->size_ == 1 || GeogebraCommonKernelKernel_isZeroWithDouble_(IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pX, 1)), 1))) && (degXpY != 1 || degYpY != 1 || ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pY, 1)))->size_ == 1 || GeogebraCommonKernelKernel_isZeroWithDouble_(IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pY, 1)), 1)))) {
        if (pX->size_ > 0) {
          if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pX, 0)))->size_ > 0) {
            a = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pX, 0)), 0);
          }
          if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pX, 0)))->size_ > 1) {
            ay = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pX, 0)), 1);
          }
        }
        if (pX->size_ > 1) {
          ax = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pX, 1)), 0);
        }
        if (pY->size_ > 0) {
          if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pY, 0)))->size_ > 0) {
            b = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pY, 0)), 0);
          }
          if (((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(pY, 0)))->size_ > 1) {
            by = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pY, 0)), 1);
          }
        }
        if (pY->size_ > 1) {
          bx = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(pY, 1)), 0);
        }
        jdouble det = ax * by - bx * ay;
        if (!GeogebraCommonKernelKernel_isZeroWithDouble_(det)) {
          IOSObjectArray *iX = [IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ (b * ay - a * by) / det, -ay / det } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ by / det } count:1] } count:2 type:IOSClass_doubleArray(1)];
          IOSObjectArray *iY = [IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -(b * ax - a * bx) / det, ax / det } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -bx / det } count:1] } count:2 type:IOSClass_doubleArray(1)];
          id<JavaUtilIterator> it = [algoUpdateSet_ getIterator];
          while (it != nil && [it hasNext]) {
            GeogebraCommonKernelAlgosAlgoElement *elem = [((id<JavaUtilIterator>) nil_chk(it)) next];
            if ([elem isKindOfClass:[GeogebraCommonKernelAlgosAlgoPointOnPath class]] && [self isIndependent]) {
              GeogebraCommonKernelGeosGeoPoint *point = (GeogebraCommonKernelGeosGeoPoint *) check_class_cast([((GeogebraCommonKernelAlgosAlgoPointOnPath *) nil_chk(((GeogebraCommonKernelAlgosAlgoPointOnPath *) check_class_cast(elem, [GeogebraCommonKernelAlgosAlgoPointOnPath class])))) getP], [GeogebraCommonKernelGeosGeoPoint class]);
              if (!GeogebraCommonKernelKernel_isZeroWithDouble_([((GeogebraCommonKernelGeosGeoPoint *) nil_chk(point)) getZ])) {
                jdouble x = [point getX] / [point getZ];
                jdouble y = [point getY] / [point getZ];
                jdouble px = GeogebraCommonKernelImplicitGeoImplicitPoly_evalPolyCoeffAtWithDouble_withDouble_withDoubleArray2_(x, y, iX);
                jdouble py = GeogebraCommonKernelImplicitGeoImplicitPoly_evalPolyCoeffAtWithDouble_withDouble_withDoubleArray2_(x, y, iY);
                [point setCoordsWithDouble:px withDouble:py withDouble:1];
                [point updateCoords];
              }
            }
          }
        }
      }
    }
  }
}

- (void)plugInPolyWithDoubleArray2:(IOSObjectArray *)polyX
                  withDoubleArray2:(IOSObjectArray *)polyY {
  [self plugInRatPolyWithDoubleArray2:polyX withDoubleArray2:polyY withDoubleArray2:nil withDoubleArray2:nil];
}

+ (void)polyMultWithDoubleArray2:(IOSObjectArray *)polyDest
                withDoubleArray2:(IOSObjectArray *)polySrc
                         withInt:(jint)degDestX
                         withInt:(jint)degDestY
                         withInt:(jint)degSrcX
                         withInt:(jint)degSrcY {
  GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(polyDest, polySrc, degDestX, degDestY, degSrcX, degSrcY);
}

- (jboolean)isConstant {
  return isConstant__;
}

- (jint)getDegX {
  return degX_;
}

- (jint)getDegY {
  return degY_;
}

- (void)getFactors {
  GeogebraCommonKernelImplicitGeoImplicitPoly_getFactors(self);
}

- (jdouble)distanceWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)p {
  GeogebraCommonKernelAlgosAlgoClosestPoint *algo = [new_GeogebraCommonKernelAlgosAlgoClosestPoint_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelPath_withGeogebraCommonKernelKernelNDGeoPointND_(cons_, self, p) autorelease];
  [algo remove];
  id<GeogebraCommonKernelKernelNDGeoPointND> pointOnCurve = [algo getP];
  return [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(p)) distanceWithGeogebraCommonKernelKernelNDGeoPointND:pointOnCurve];
}

- (void)throughPointsWithGeogebraCommonKernelGeosGeoPointArray:(IOSObjectArray *)points {
  JavaUtilArrayList *p = [new_JavaUtilArrayList_init() autorelease];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(points))->size_; i++) [p addWithId:IOSObjectArray_Get(points, i)];
  [self throughPointsWithJavaUtilArrayList:p];
}

- (void)throughPointsWithGeogebraCommonKernelGeosGeoList:(GeogebraCommonKernelGeosGeoList *)points {
  JavaUtilArrayList *p = [new_JavaUtilArrayList_init() autorelease];
  for (jint i = 0; i < [((GeogebraCommonKernelGeosGeoList *) nil_chk(points)) size]; i++) [p addWithId:(GeogebraCommonKernelGeosGeoPoint *) check_class_cast([points getWithInt:i], [GeogebraCommonKernelGeosGeoPoint class])];
  [self throughPointsWithJavaUtilArrayList:p];
}

- (void)throughPointsWithJavaUtilArrayList:(JavaUtilArrayList *)points {
  if (J2ObjCFpToInt(JavaLangMath_sqrtWithDouble_(9 + 8 * [((JavaUtilArrayList *) nil_chk(points)) size])) != JavaLangMath_sqrtWithDouble_(9 + 8 * [points size])) {
    [self setUndefined];
    return;
  }
  jint degree = J2ObjCFpToInt((0.5 * JavaLangMath_sqrtWithDouble_(8 * (1 + [points size])))) - 1;
  jint realDegree = degree;
  id<OrgApacheCommonsMathLinearRealMatrix> extendMatrix = [new_OrgApacheCommonsMathLinearArray2DRowRealMatrix_initWithInt_withInt_([points size], [points size] + 1) autorelease];
  id<OrgApacheCommonsMathLinearRealMatrix> matrix = [new_OrgApacheCommonsMathLinearArray2DRowRealMatrix_initWithInt_withInt_([points size], [points size]) autorelease];
  IOSObjectArray *coeffMatrix = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ degree + 1, degree + 1 }];
  id<OrgApacheCommonsMathLinearDecompositionSolver> solver;
  IOSDoubleArray *matrixRow = [IOSDoubleArray arrayWithLength:[points size] + 1];
  IOSDoubleArray *results;
  for (jint i = 0; i < [points size]; i++) {
    jdouble x = ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([points getWithInt:i]))->x_ / ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([points getWithInt:i]))->z_;
    jdouble y = ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([points getWithInt:i]))->y_ / ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([points getWithInt:i]))->z_;
    for (jint j = 0, m = 0; j < degree + 1; j++) for (jint k = 0; j + k != degree + 1; k++) *IOSDoubleArray_GetRef(matrixRow, m++) = JavaLangMath_powWithDouble_withDouble_(x, j) * JavaLangMath_powWithDouble_withDouble_(y, k);
    [extendMatrix setRowWithInt:i withDoubleArray:matrixRow];
  }
  jint solutionColumn = 0, noPoints = [points size];
  do {
    if (solutionColumn > noPoints) {
      noPoints = noPoints - realDegree - 1;
      if (noPoints < 2) {
        [self setUndefined];
        return;
      }
      extendMatrix = [new_OrgApacheCommonsMathLinearArray2DRowRealMatrix_initWithInt_withInt_(noPoints, noPoints + 1) autorelease];
      realDegree -= 1;
      matrixRow = [IOSDoubleArray arrayWithLength:noPoints + 1];
      for (jint i = 0; i < noPoints; i++) {
        jdouble x = ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([points getWithInt:i]))->x_;
        jdouble y = ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([points getWithInt:i]))->y_;
        for (jint j = 0, m = 0; j < realDegree + 1; j++) for (jint k = 0; j + k != realDegree + 1; k++) *IOSDoubleArray_GetRef(matrixRow, m++) = JavaLangMath_powWithDouble_withDouble_(x, j) * JavaLangMath_powWithDouble_withDouble_(y, k);
        [extendMatrix setRowWithInt:i withDoubleArray:matrixRow];
      }
      matrix = [new_OrgApacheCommonsMathLinearArray2DRowRealMatrix_initWithInt_withInt_(noPoints, noPoints) autorelease];
      solutionColumn = 0;
    }
    results = [extendMatrix getColumnWithInt:solutionColumn];
    for (jint i = 0, j = 0; i < noPoints + 1; i++) {
      if (i == solutionColumn) continue;
      [matrix setColumnWithInt:j++ withDoubleArray:[extendMatrix getColumnWithInt:i]];
    }
    solutionColumn++;
    solver = [((OrgApacheCommonsMathLinearLUDecompositionImpl *) [new_OrgApacheCommonsMathLinearLUDecompositionImpl_initWithOrgApacheCommonsMathLinearRealMatrix_(matrix) autorelease]) getSolver];
  }
  while (![((id<OrgApacheCommonsMathLinearDecompositionSolver>) nil_chk(solver)) isNonSingular]);
  for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(results))->size_; i++) *IOSDoubleArray_GetRef(results, i) *= -1;
  IOSDoubleArray *partialSolution = [((id<OrgApacheCommonsMathLinearDecompositionSolver>) nil_chk(solver)) solveWithDoubleArray:results];
  IOSDoubleArray *solution = [IOSDoubleArray arrayWithLength:((IOSDoubleArray *) nil_chk(partialSolution))->size_ + 1];
  for (jint i = 0, j = 0; i < solution->size_; i++) if (i == solutionColumn - 1) *IOSDoubleArray_GetRef(solution, i) = 1;
  else {
    *IOSDoubleArray_GetRef(solution, i) = (GeogebraCommonKernelKernel_isZeroWithDouble_(IOSDoubleArray_Get(partialSolution, j))) ? 0 : IOSDoubleArray_Get(partialSolution, j);
    j++;
  }
  for (jint i = 0, k = 0; i < realDegree + 1; i++) for (jint j = 0; i + j < realDegree + 1; j++) *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(coeffMatrix, i)), j) = IOSDoubleArray_Get(solution, k++);
  [self setCoeffWithDoubleArray2:coeffMatrix withBoolean:YES];
  [self setDefined];
  for (jint i = 0; i < [points size]; i++) if (![self isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:[points getWithInt:i] withDouble:1]) {
    [self setUndefined];
    return;
  }
}

- (void)polishPointOnPathWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)PI {
  [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(PI)) updateCoords2D];
  jdouble x = [PI getX2D];
  jdouble y = [PI getY2D];
  jdouble dx, dy;
  dx = [self evalDiffXPolyAtWithDouble:x withDouble:y];
  dy = [self evalDiffYPolyAtWithDouble:x withDouble:y];
  jdouble d = JavaLangMath_absWithDouble_(dx) + JavaLangMath_absWithDouble_(dy);
  if (GeogebraCommonKernelKernel_isZeroWithDouble_(d)) return;
  dx /= d;
  dy /= d;
  IOSDoubleArray *pair = [IOSDoubleArray arrayWithDoubles:(jdouble[]){ x, y } count:2];
  IOSDoubleArray *line = [IOSDoubleArray arrayWithDoubles:(jdouble[]){ y * dx - x * dy, dy, -dx } count:3];
  if (GeogebraCommonKernelImplicitPolynomialUtils_rootPolishingWithDoubleArray_withGeogebraCommonKernelImplicitGeoImplicitPoly_withDoubleArray_(pair, self, line)) {
    [PI setCoords2DWithDouble:IOSDoubleArray_Get(pair, 0) withDouble:IOSDoubleArray_Get(pair, 1) withDouble:1];
  }
}

- (void)pointChangedWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)PI {
  if ([((JavaUtilArrayList *) nil_chk([((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) getPoints])) size] > 0) {
    [locus_ pointChangedWithGeogebraCommonKernelKernelNDGeoPointND:PI];
    [self polishPointOnPathWithGeogebraCommonKernelKernelNDGeoPointND:PI];
  }
}

- (void)pathChangedWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)PI {
  if (![((GeogebraCommonKernelKernel *) nil_chk([self getKernel])) usePathAndRegionParametersWithGeogebraCommonKernelKernelNDGeoPointND:PI]) {
    [self pointChangedWithGeogebraCommonKernelKernelNDGeoPointND:PI];
    return;
  }
  if ([((JavaUtilArrayList *) nil_chk([((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) getPoints])) size] > 0) {
    [locus_ pathChangedWithGeogebraCommonKernelKernelNDGeoPointND:PI];
    [self polishPointOnPathWithGeogebraCommonKernelKernelNDGeoPointND:PI];
  }
}

- (jboolean)isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)PI {
  return [self isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:PI withDouble:GeogebraCommonKernelKernel_STANDARD_PRECISION];
}

- (jboolean)isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)PI
                                                    withDouble:(jdouble)eps {
  if (![((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(PI)) isDefined]) return NO;
  jdouble px, py, pz;
  if ([PI isGeoElement3D]) {
    GeogebraCommonKernelMatrixCoords *coords = [PI getInhomCoordsInD3];
    if (!GeogebraCommonKernelKernel_isZeroWithDouble_([((GeogebraCommonKernelMatrixCoords *) nil_chk(coords)) getZ])) {
      return NO;
    }
    px = [coords getX];
    py = [coords getY];
  }
  else {
    GeogebraCommonKernelGeosGeoPoint *P = (GeogebraCommonKernelGeosGeoPoint *) check_class_cast(PI, [GeogebraCommonKernelGeosGeoPoint class]);
    px = P->x_;
    py = P->y_;
    pz = P->z_;
    if ([P isFinite]) {
      px /= pz;
      py /= pz;
    }
  }
  jdouble value = [self evalPolyAtWithDouble:px withDouble:py];
  return JavaLangMath_absWithDouble_(value) < GeogebraCommonKernelKernel_MIN_PRECISION;
}

- (jdouble)getMinParameter {
  return [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) getMinParameter];
}

- (jdouble)getMaxParameter {
  return [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) getMaxParameter];
}

- (jboolean)isClosedPath {
  return [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) isClosedPath];
}

- (id<GeogebraCommonKernelPathMover>)createPathMover {
  return [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) createPathMover];
}

- (jboolean)isTraceable {
  return YES;
}

- (void)setTraceWithBoolean:(jboolean)trace {
  self->trace_ = trace;
}

- (jboolean)getTrace {
  return trace_;
}

- (jint)getDeg {
  jint deg = 0;
  for (jint d = degX_ + degY_; d >= 0; d--) {
    for (jint x = 0; x <= degX_; x++) {
      jint y = d - x;
      if (y >= 0 && y < ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(nil_chk(coeff_), x)))->size_) {
        if (JavaLangMath_absWithDouble_(IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff_, x)), y)) > GeogebraCommonKernelKernel_STANDARD_PRECISION) {
          deg = d;
          d = 0;
          break;
        }
      }
    }
  }
  return deg;
}

- (void)mirrorWithGeogebraCommonKernelGeosGeoConic:(GeogebraCommonKernelGeosGeoConic *)c {
  if ([((GeogebraCommonKernelGeosGeoConic *) nil_chk(c)) getCircleRadius] < 10e-2) {
    [self setUndefined];
    return;
  }
  jdouble cx = [((GeogebraCommonKernelMatrixCoords *) nil_chk([c getMidpoint])) getX];
  jdouble cy = [((GeogebraCommonKernelMatrixCoords *) nil_chk([c getMidpoint])) getY];
  jdouble cr = [c getCircleRadius];
  [self plugInRatPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cx * cx * cx + cx * cy * cy - cx * cr * cr, -2 * cx * cy, cx } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -2 * cx * cx + cr * cr, 0, 0 } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cx, 0, 0 } count:3] } count:3 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cx * cx * cy + cy * cy * cy - cy * cr * cr, -2 * cy * cy + cr * cr, cy } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -2 * cx * cy, 0, 0 } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cy, 0, 0 } count:3] } count:3 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cx * cx + cy * cy, -2 * cy, 1 } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -2 * cx, 0, 0 } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 1, 0, 0 } count:3] } count:3 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cx * cx + cy * cy, -2 * cy, 1 } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -2 * cx, 0, 0 } count:3], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 1, 0, 0 } count:3] } count:3 type:IOSClass_doubleArray(1)]];
}

- (void)mirrorWithGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)Q {
  [self plugInPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 2 * [((GeogebraCommonKernelMatrixCoords *) nil_chk(Q)) getX] } count:1], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -1 } count:1] } count:2 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 2 * [Q getY], -1 } count:2] } count:1 type:IOSClass_doubleArray(1)]];
}

- (void)mirrorWithGeogebraCommonKernelKernelNDGeoLineND:(id<GeogebraCommonKernelKernelNDGeoLineND>)g1 {
  if (![((id<GeogebraCommonKernelKernelNDGeoLineND>) nil_chk(g1)) isDefined]) {
    [self setUndefined];
    return;
  }
  GeogebraCommonKernelGeosGeoLine *g = (GeogebraCommonKernelGeosGeoLine *) check_class_cast(g1, [GeogebraCommonKernelGeosGeoLine class]);
  IOSDoubleArray *dir = [IOSDoubleArray arrayWithLength:2];
  [g getDirectionWithDoubleArray:dir];
  jdouble dx = IOSDoubleArray_Get(dir, 0);
  jdouble dy = IOSDoubleArray_Get(dir, 1);
  jdouble x = ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([g getStartPoint]))->inhomX_;
  jdouble y = ((GeogebraCommonKernelGeosGeoPoint *) nil_chk([g getStartPoint]))->inhomY_;
  jdouble n = 1 / (dx * dx + dy * dy);
  [self plugInPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 2 * n * dy * (x * dy - y * dx), 2 * n * dx * dy } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 1 - 2 * dy * dy * n, 0 } count:2] } count:2 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 2 * n * dx * (y * dx - x * dy), 1 - 2 * n * dx * dx } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 2 * n * dx * dy, 0 } count:2] } count:2 type:IOSClass_doubleArray(1)]];
}

- (void)translateWithGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)v {
  [self translateWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk(v)) getX] withDouble:[v getY]];
}

- (void)translateWithDouble:(jdouble)vx
                 withDouble:(jdouble)vy {
  jdouble a = -vx;
  jdouble b = -vy;
  [self plugInPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ a } count:1], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 1 } count:1] } count:2 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ b, 1 } count:2] } count:1 type:IOSClass_doubleArray(1)]];
}

- (void)rotateWithGeogebraCommonKernelArithmeticNumberValue:(id<GeogebraCommonKernelArithmeticNumberValue>)phiValue {
  jdouble phi = [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk(phiValue)) getDouble];
  jdouble cos = JavaLangMath_cosWithDouble_(phi);
  jdouble sin = JavaLangMath_sinWithDouble_(-phi);
  [self plugInPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 0, -sin } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cos, 0 } count:2] } count:2 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ 0, cos } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ sin, 0 } count:2] } count:2 type:IOSClass_doubleArray(1)]];
}

- (void)rotateWithGeogebraCommonKernelArithmeticNumberValue:(id<GeogebraCommonKernelArithmeticNumberValue>)phiValue
                 withGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)point {
  GeogebraCommonKernelMatrixCoords *S = [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(point)) getInhomCoords];
  jdouble phi = [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk(phiValue)) getDouble];
  jdouble cos = JavaLangMath_cosWithDouble_(phi);
  jdouble sin = JavaLangMath_sinWithDouble_(-phi);
  jdouble x = [((GeogebraCommonKernelMatrixCoords *) nil_chk(S)) getX];
  jdouble y = [S getY];
  [self plugInPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ x * (1 - cos) + y * sin, -sin } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ cos, 0 } count:2] } count:2 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -x * sin + y * (1 - cos), cos } count:2], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ sin, 0 } count:2] } count:2 type:IOSClass_doubleArray(1)]];
}

- (void)dilateWithGeogebraCommonKernelArithmeticNumberValue:(id<GeogebraCommonKernelArithmeticNumberValue>)rval
                       withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)S {
  jdouble r = 1 / [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk(rval)) getDouble];
  [self plugInPolyWithDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ (1 - r) * [((GeogebraCommonKernelMatrixCoords *) nil_chk(S)) getX] } count:1], [IOSDoubleArray arrayWithDoubles:(jdouble[]){ r } count:1] } count:2 type:IOSClass_doubleArray(1)] withDoubleArray2:[IOSObjectArray arrayWithObjects:(id[]){ [IOSDoubleArray arrayWithDoubles:(jdouble[]){ (1 - r) * [S getY], r } count:2] } count:1 type:IOSClass_doubleArray(1)]];
}

- (jboolean)isTranslateable {
  return YES;
}

- (jchar)getLabelDelimiter {
  return ':';
}

- (jboolean)euclidianViewUpdate {
  if ([self isDefined]) {
    [self updatePath];
    return YES;
  }
  return NO;
}

- (jint)epsSignumWithDouble:(jdouble)x {
  if (x > GeogebraCommonKernelKernel_STANDARD_PRECISION) return 1;
  if (x < -GeogebraCommonKernelKernel_STANDARD_PRECISION) return -1;
  return 0;
}

- (void)updatePath {
  IOSDoubleArray *viewBounds = [((GeogebraCommonKernelKernel *) nil_chk(kernel_)) getViewBoundsForGeoWithGeogebraCommonKernelGeosGeoElement:self];
  if (IOSDoubleArray_Get(nil_chk(viewBounds), 0) == JavaLangDouble_POSITIVE_INFINITY) {
    viewBounds = [IOSDoubleArray arrayWithDoubles:(jdouble[]){ -10, 10, -10, 10, 10, 10 } count:6];
  }
  gridWidth_ = JavaLangMath_minWithInt_withInt_(60, JavaLangMath_maxWithInt_withInt_(30, J2ObjCFpToInt((IOSDoubleArray_Get(viewBounds, 4) * (IOSDoubleArray_Get(viewBounds, 1) - IOSDoubleArray_Get(viewBounds, 0)) / 40))));
  gridHeight_ = JavaLangMath_minWithInt_withInt_(60, JavaLangMath_maxWithInt_withInt_(30, J2ObjCFpToInt((IOSDoubleArray_Get(viewBounds, 5) * (IOSDoubleArray_Get(viewBounds, 3) - IOSDoubleArray_Get(viewBounds, 2)) / 30))));
  GeogebraCommonMainApp_debugWithNSString_(JreStrcat("ICICD", gridWidth_, 'x', gridHeight_, ',', (IOSDoubleArray_Get(viewBounds, 1) - IOSDoubleArray_Get(viewBounds, 0))));
  [self updatePathWithDouble:IOSDoubleArray_Get(viewBounds, 0) withDouble:IOSDoubleArray_Get(viewBounds, 2) withDouble:IOSDoubleArray_Get(viewBounds, 1) - IOSDoubleArray_Get(viewBounds, 0) withDouble:IOSDoubleArray_Get(viewBounds, 3) - IOSDoubleArray_Get(viewBounds, 2) withDouble:1. / IOSDoubleArray_Get(viewBounds, 4) / IOSDoubleArray_Get(viewBounds, 5)];
}

- (void)updatePathWithDouble:(jdouble)rectX
                  withDouble:(jdouble)rectY
                  withDouble:(jdouble)rectW
                  withDouble:(jdouble)rectH
                  withDouble:(jdouble)resolution {
  if (!calcPath_ || [cons_ isKindOfClass:[GeogebraCommonKernelMacroConstruction class]]) return;
  [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) clearPoints];
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_singularitiesCollection_(self, new_JavaUtilArrayList_init());
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_boundaryIntersectCollection_(self, new_JavaUtilArrayList_init());
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_grid_(self, [IOSObjectArray newArrayWithDimensions:2 lengths:(jint[]){ gridWidth_, gridHeight_ } type:GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_class_()]);
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_remember_(self, [IOSBooleanArray newArrayWithDimensions:2 lengths:(jint[]){ gridWidth_, gridHeight_ }]);
  jdouble prec = 5;
  scaleX_ = prec * JavaLangMath_sqrtWithDouble_(resolution);
  scaleY_ = prec * JavaLangMath_sqrtWithDouble_(resolution);
  jdouble grw = rectW / gridWidth_;
  jdouble grh = rectH / gridHeight_;
  jdouble x = rectX;
  jint e;
  for (jint w = 0; w < gridWidth_; w++) {
    jdouble y = rectY;
    for (jint h = 0; h < gridHeight_; h++) {
      e = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x withDouble:y withBoolean:YES]];
      IOSObjectArray_SetAndConsume(nil_chk(IOSObjectArray_Get(grid_, w)), h, new_GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(x, y, grw, grh));
      *IOSIntArray_GetRef(nil_chk(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_), 0) = e;
      if (w > 0) {
        *IOSIntArray_GetRef(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w - 1)), h)))->eval_, 1) = e;
        if (h > 0) {
          *IOSIntArray_GetRef(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h - 1)))->eval_, 2) = e;
          *IOSIntArray_GetRef(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w - 1)), h - 1)))->eval_, 3) = e;
        }
      }
      else if (h > 0) *IOSIntArray_GetRef(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h - 1)))->eval_, 2) = e;
      y += grh;
    }
    e = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x withDouble:y withBoolean:YES]];
    *IOSIntArray_GetRef(nil_chk(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), gridHeight_ - 1)))->eval_), 2) = e;
    if (w > 0) *IOSIntArray_GetRef(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w - 1)), gridHeight_ - 1)))->eval_, 3) = e;
    x += grw;
  }
  jdouble y = rectY;
  for (jint h = 0; h < gridHeight_; h++) {
    e = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x withDouble:y withBoolean:YES]];
    *IOSIntArray_GetRef(nil_chk(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, gridWidth_ - 1)), h)))->eval_), 1) = e;
    if (h > 0) *IOSIntArray_GetRef(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, gridWidth_ - 1)), h - 1)))->eval_, 3) = e;
    y += grh;
  }
  *IOSIntArray_GetRef(nil_chk(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, gridWidth_ - 1)), gridHeight_ - 1)))->eval_), 3) = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x withDouble:y withBoolean:YES]];
  for (jint w = 0; w < gridWidth_; w++) {
    for (jint h = 0; h < gridHeight_; h++) {
      *IOSBooleanArray_GetRef(nil_chk(IOSObjectArray_Get(remember_, w)), h) = NO;
      if (IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 0) == 0) {
        *IOSBooleanArray_GetRef(nil_chk(IOSObjectArray_Get(remember_, w)), h) = YES;
        continue;
      }
      for (jint i = 1; i < 4; i++) {
        if (IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 0) != IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, i)) {
          *IOSBooleanArray_GetRef(nil_chk(IOSObjectArray_Get(remember_, w)), h) = YES;
          break;
        }
      }
    }
  }
  for (jint w = 0; w < gridWidth_; w++) {
    for (jint h = 0; h < gridHeight_; h++) {
      if (IOSBooleanArray_Get(nil_chk(IOSObjectArray_Get(remember_, w)), h)) {
        if (IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 0) == 0) {
          GeogebraCommonKernelImplicitGeoImplicitPoly_startPathWithInt_withInt_withDouble_withDouble_withGeogebraCommonKernelGeosGeoLocus_(self, w, h, ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_, ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_, locus_);
        }
        else {
          jdouble xs, ys;
          if (IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 0) != IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 3)) {
            jdouble a = [self bisecWithDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->width_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->height_];
            xs = ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ + a * ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->width_;
            ys = ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ + a * ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->height_;
          }
          else if (IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 1) != IOSIntArray_Get(((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->eval_, 2)) {
            jdouble a = [self bisecWithDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->width_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->height_];
            xs = ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ + (1 - a) * ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->width_;
            ys = ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ + a * ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->height_;
          }
          else {
            jdouble a = [self bisecWithDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->width_ withDouble:((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_];
            xs = ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->x_ + a * ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->width_;
            ys = ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(grid_, w)), h)))->y_;
          }
          GeogebraCommonKernelImplicitGeoImplicitPoly_startPathWithInt_withInt_withDouble_withDouble_withGeogebraCommonKernelGeosGeoLocus_(self, w, h, xs, ys, locus_);
        }
      }
    }
  }
  if (algoUpdateSet_ != nil) {
    id<JavaUtilIterator> it = [algoUpdateSet_ getIterator];
    while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
      GeogebraCommonKernelAlgosAlgoElement *elem = [it next];
      if ([elem isKindOfClass:[GeogebraCommonKernelAlgosAlgoPointOnPath class]]) {
        for (jint i = 0; i < ((IOSObjectArray *) nil_chk([((GeogebraCommonKernelAlgosAlgoElement *) nil_chk(elem)) getInput]))->size_; i++) {
          if (IOSObjectArray_Get(nil_chk([elem getInput]), i) == self) {
            GeogebraCommonKernelAlgosAlgoPointOnPath *ap = (GeogebraCommonKernelAlgosAlgoPointOnPath *) check_class_cast(elem, [GeogebraCommonKernelAlgosAlgoPointOnPath class]);
            if ([ap getPath] == self) {
              [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk([ap getP])) setCoordsWithGeogebraCommonKernelMatrixCoords:[((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk([ap getP])) getCoords] withBoolean:YES];
            }
            break;
          }
        }
      }
    }
  }
}

- (jdouble)scaledNormSquaredWithDouble:(jdouble)x
                            withDouble:(jdouble)y {
  return GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(self, x, y);
}

- (void)startPathWithInt:(jint)width
                 withInt:(jint)height
              withDouble:(jdouble)x
              withDouble:(jdouble)y
withGeogebraCommonKernelGeosGeoLocus:(GeogebraCommonKernelGeosGeoLocus *)loc1 {
  GeogebraCommonKernelImplicitGeoImplicitPoly_startPathWithInt_withInt_withDouble_withDouble_withGeogebraCommonKernelGeosGeoLocus_(self, width, height, x, y, loc1);
}

- (jdouble)bisecWithDouble:(jdouble)x1
                withDouble:(jdouble)y1
                withDouble:(jdouble)x2
                withDouble:(jdouble)y2 {
  jint e1 = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x1 withDouble:y1 withBoolean:YES]];
  jint e2 = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x2 withDouble:y2 withBoolean:YES]];
  if (e1 == 0) return 0.;
  if (e2 == 0) return 1.;
  jdouble a1 = 0;
  jdouble a2 = 1;
  jint e;
  if (e1 != e2) {
    while (a2 - a1 > GeogebraCommonKernelKernel_MAX_PRECISION) {
      e = [self epsSignumWithDouble:[self evalPolyAtWithDouble:x1 + (x2 - x1) * (a2 + a1) / 2 withDouble:y1 + (y2 - y1) * (a2 + a1) / 2 withBoolean:YES]];
      if (e == 0) {
        return (a2 + a1) / 2;
      }
      if (e == e1) {
        a1 = (a2 + a1) / 2;
      }
      else {
        a2 = (a1 + a2) / 2;
      }
    }
    return (a1 + a2) / 2;
  }
  return JavaLangDouble_NaN;
}

- (GeogebraCommonKernelGeosGeoLocus *)getLocus {
  return locus_;
}

- (jboolean)isCasEvaluableObject {
  return YES;
}

- (GeogebraCommonKernelGeosGeoElement_HitTypeEnum *)getLastHitType {
  return GeogebraCommonKernelGeosGeoElement_HitTypeEnum_get_ON_BOUNDARY();
}

- (void)dealloc {
  RELEASE_(coeff_);
  RELEASE_(coeffSquarefree_);
  RELEASE_(locus_);
  RELEASE_(singularitiesCollection_);
  RELEASE_(boundaryIntersectCollection_);
  RELEASE_(remember_);
  RELEASE_(grid_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:", "GeoImplicitPoly", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withNSString:withDoubleArray2:withBoolean:", "GeoImplicitPoly", NULL, 0x2, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withNSString:withDoubleArray2:", "GeoImplicitPoly", NULL, 0x4, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withNSString:withGeogebraCommonKernelArithmeticPolynomial:withBoolean:", "GeoImplicitPoly", NULL, 0x2, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withNSString:withGeogebraCommonKernelArithmeticPolynomial:", "GeoImplicitPoly", NULL, 0x1, NULL, NULL },
    { "createImplicitPolyWithoutPathWithGeogebraCommonKernelConstruction:withDoubleArray2:", "createImplicitPolyWithoutPath", "Lgeogebra.common.kernel.implicit.GeoImplicitPoly;", 0x9, NULL, NULL },
    { "preventPathCreation", NULL, "V", 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelImplicitGeoImplicitPoly:", "GeoImplicitPoly", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelKernelNDGeoConicND:", "GeoImplicitPoly", NULL, 0x1, NULL, NULL },
    { "coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND:", "coeffFromConic", "[[D", 0xa, NULL, NULL },
    { "copy__", "copy", "Lgeogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "getGeoClassType", NULL, "Lgeogebra.common.plugin.GeoClass;", 0x1, NULL, NULL },
    { "getXMLtagsWithJavaLangStringBuilder:", "getXMLtags", "V", 0x4, NULL, NULL },
    { "isDefined", NULL, "Z", 0x1, NULL, NULL },
    { "isOnScreen", NULL, "Z", 0x1, NULL, NULL },
    { "isEqualWithGeogebraCommonKernelGeosGeoElement:", "isEqual", "Z", 0x1, NULL, NULL },
    { "isGeoImplicitPoly", NULL, "Z", 0x1, NULL, NULL },
    { "isPath", NULL, "Z", 0x1, NULL, NULL },
    { "setWithGeogebraCommonKernelGeosGeoElement:", "set", "V", 0x1, NULL, NULL },
    { "setUndefined", NULL, "V", 0x1, NULL, NULL },
    { "setDefined", NULL, "V", 0x1, NULL, NULL },
    { "showInAlgebraView", NULL, "Z", 0x1, NULL, NULL },
    { "showInEuclidianView", NULL, "Z", 0x4, NULL, NULL },
    { "addPowWithJavaLangStringBuilder:withInt:withGeogebraCommonKernelStringTemplate:", "addPow", "V", 0xa, NULL, NULL },
    { "toRawValueStringWithGeogebraCommonKernelStringTemplate:", "toRawValueString", "Ljava.lang.String;", 0x4, NULL, NULL },
    { "appendMultiplyWithJavaLangStringBuilder:", "appendMultiply", "V", 0xa, NULL, NULL },
    { "setCoeffWithDoubleArray2:", "setCoeff", "V", 0x1, NULL, NULL },
    { "setCoeffWithDoubleArray2:withBoolean:", "setCoeff", "V", 0x1, NULL, NULL },
    { "setCoeffWithGeogebraCommonKernelArithmeticExpressionValueArray2:", "setCoeff", "V", 0x1, NULL, NULL },
    { "setCoeffWithGeogebraCommonKernelArithmeticExpressionValueArray2:withBoolean:", "setCoeff", "V", 0x1, NULL, NULL },
    { "getCoeffWithBoolean:", "getCoeff", "[[D", 0x1, NULL, NULL },
    { "getCoeff", NULL, "[[D", 0x1, NULL, NULL },
    { "evalPolyAtWithDouble:withDouble:", "evalPolyAt", "D", 0x1, NULL, NULL },
    { "evalPolyAtWithDouble:withDouble:withBoolean:", "evalPolyAt", "D", 0x1, NULL, NULL },
    { "evalPolyCoeffAtWithDouble:withDouble:withDoubleArray2:", "evalPolyCoeffAt", "D", 0x9, NULL, NULL },
    { "evalDiffXPolyAtWithDouble:withDouble:", "evalDiffXPolyAt", "D", 0x1, NULL, NULL },
    { "evalDiffXPolyAtWithDouble:withDouble:withBoolean:", "evalDiffXPolyAt", "D", 0x1, NULL, NULL },
    { "evalDiffYPolyAtWithDouble:withDouble:", "evalDiffYPolyAt", "D", 0x1, NULL, NULL },
    { "evalDiffYPolyAtWithDouble:withDouble:withBoolean:", "evalDiffYPolyAt", "D", 0x1, NULL, NULL },
    { "plugInRatPolyWithDoubleArray2:withDoubleArray2:withDoubleArray2:withDoubleArray2:", "plugInRatPoly", "V", 0x1, NULL, NULL },
    { "plugInPolyWithDoubleArray2:withDoubleArray2:", "plugInPoly", "V", 0x1, NULL, NULL },
    { "polyMultWithDoubleArray2:withDoubleArray2:withInt:withInt:withInt:withInt:", "polyMult", "V", 0xa, NULL, NULL },
    { "isConstant", NULL, "Z", 0x1, NULL, NULL },
    { "getDegX", NULL, "I", 0x1, NULL, NULL },
    { "getDegY", NULL, "I", 0x1, NULL, NULL },
    { "getFactors", NULL, "V", 0x2, NULL, NULL },
    { "distanceWithGeogebraCommonKernelGeosGeoPoint:", "distance", "D", 0x11, NULL, NULL },
    { "throughPointsWithGeogebraCommonKernelGeosGeoPointArray:", "throughPoints", "V", 0x1, NULL, NULL },
    { "throughPointsWithGeogebraCommonKernelGeosGeoList:", "throughPoints", "V", 0x1, NULL, NULL },
    { "throughPointsWithJavaUtilArrayList:", "throughPoints", "V", 0x1, NULL, NULL },
    { "polishPointOnPathWithGeogebraCommonKernelKernelNDGeoPointND:", "polishPointOnPath", "V", 0x4, NULL, NULL },
    { "pointChangedWithGeogebraCommonKernelKernelNDGeoPointND:", "pointChanged", "V", 0x1, NULL, NULL },
    { "pathChangedWithGeogebraCommonKernelKernelNDGeoPointND:", "pathChanged", "V", 0x1, NULL, NULL },
    { "isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:", "isOnPath", "Z", 0x1, NULL, NULL },
    { "isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:withDouble:", "isOnPath", "Z", 0x1, NULL, NULL },
    { "getMinParameter", NULL, "D", 0x1, NULL, NULL },
    { "getMaxParameter", NULL, "D", 0x1, NULL, NULL },
    { "isClosedPath", NULL, "Z", 0x1, NULL, NULL },
    { "createPathMover", NULL, "Lgeogebra.common.kernel.PathMover;", 0x1, NULL, NULL },
    { "isTraceable", NULL, "Z", 0x1, NULL, NULL },
    { "setTraceWithBoolean:", "setTrace", "V", 0x1, NULL, NULL },
    { "getTrace", NULL, "Z", 0x1, NULL, NULL },
    { "getDeg", NULL, "I", 0x1, NULL, NULL },
    { "mirrorWithGeogebraCommonKernelGeosGeoConic:", "mirror", "V", 0x1, NULL, NULL },
    { "mirrorWithGeogebraCommonKernelMatrixCoords:", "mirror", "V", 0x1, NULL, NULL },
    { "mirrorWithGeogebraCommonKernelKernelNDGeoLineND:", "mirror", "V", 0x1, NULL, NULL },
    { "translateWithGeogebraCommonKernelMatrixCoords:", "translate", "V", 0x1, NULL, NULL },
    { "translateWithDouble:withDouble:", "translate", "V", 0x1, NULL, NULL },
    { "rotateWithGeogebraCommonKernelArithmeticNumberValue:", "rotate", "V", 0x1, NULL, NULL },
    { "rotateWithGeogebraCommonKernelArithmeticNumberValue:withGeogebraCommonKernelKernelNDGeoPointND:", "rotate", "V", 0x1, NULL, NULL },
    { "dilateWithGeogebraCommonKernelArithmeticNumberValue:withGeogebraCommonKernelMatrixCoords:", "dilate", "V", 0x1, NULL, NULL },
    { "isTranslateable", NULL, "Z", 0x1, NULL, NULL },
    { "getLabelDelimiter", NULL, "C", 0x4, NULL, NULL },
    { "euclidianViewUpdate", NULL, "Z", 0x1, NULL, NULL },
    { "epsSignumWithDouble:", "epsSignum", "I", 0x1, NULL, NULL },
    { "updatePath", NULL, "V", 0x1, NULL, NULL },
    { "updatePathWithDouble:withDouble:withDouble:withDouble:withDouble:", "updatePath", "V", 0x1, NULL, NULL },
    { "scaledNormSquaredWithDouble:withDouble:", "scaledNormSquared", "D", 0x2, NULL, NULL },
    { "startPathWithInt:withInt:withDouble:withDouble:withGeogebraCommonKernelGeosGeoLocus:", "startPath", "V", 0x2, NULL, NULL },
    { "bisecWithDouble:withDouble:withDouble:withDouble:", "bisec", "D", 0x1, NULL, NULL },
    { "getLocus", NULL, "Lgeogebra.common.kernel.geos.GeoLocus;", 0x1, NULL, NULL },
    { "isCasEvaluableObject", NULL, "Z", 0x1, NULL, NULL },
    { "getLastHitType", NULL, "Lgeogebra.common.kernel.geos.GeoElement$HitType;", 0x11, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "coeff_", NULL, 0x2, "[[D", NULL, NULL,  },
    { "coeffSquarefree_", NULL, 0x2, "[[D", NULL, NULL,  },
    { "degX_", NULL, 0x2, "I", NULL, NULL,  },
    { "degY_", NULL, 0x2, "I", NULL, NULL,  },
    { "defined_", NULL, 0x2, "Z", NULL, NULL,  },
    { "isConstant__", "isConstant", 0x2, "Z", NULL, NULL,  },
    { "calcPath_", NULL, 0x2, "Z", NULL, NULL,  },
    { "trace_", NULL, 0x2, "Z", NULL, NULL,  },
    { "locus_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoLocus;", NULL, NULL,  },
    { "singularitiesCollection_", NULL, 0x2, "Ljava.util.List;", NULL, "Ljava/util/List<L[D;>;",  },
    { "boundaryIntersectCollection_", NULL, 0x2, "Ljava.util.List;", NULL, "Ljava/util/List<L[D;>;",  },
    { "remember_", NULL, 0x2, "[[Z", NULL, NULL,  },
    { "grid_", NULL, 0x2, "[[Lgeogebra.common.kernel.implicit.GeoImplicitPoly$GridRect;", NULL, NULL,  },
    { "gridWidth_", NULL, 0x2, "I", NULL, NULL,  },
    { "gridHeight_", NULL, 0x2, "I", NULL, NULL,  },
    { "scaleX_", NULL, 0x2, "D", NULL, NULL,  },
    { "scaleY_", NULL, 0x2, "D", NULL, NULL,  },
    { "minGap_", NULL, 0x2, "D", NULL, NULL,  },
    { "MIN_GRAD_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_GRAD },
    { "MIN_STEP_SIZE_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_STEP_SIZE },
    { "START_STEP_SIZE_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonKernelImplicitGeoImplicitPoly_START_STEP_SIZE },
    { "MAX_STEP_SIZE_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEP_SIZE },
    { "SING_RADIUS_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonKernelImplicitGeoImplicitPoly_SING_RADIUS },
    { "NEAR_SING_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonKernelImplicitGeoImplicitPoly_NEAR_SING },
    { "MAX_STEPS_", NULL, 0x1a, "I", NULL, NULL, .constantValue.asInt = GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEPS },
  };
  static const char *inner_classes[] = {"Lgeogebra.common.kernel.implicit.GeoImplicitPoly$GridRect;"};
  static const J2ObjcClassInfo _GeogebraCommonKernelImplicitGeoImplicitPoly = { 2, "GeoImplicitPoly", "geogebra.common.kernel.implicit", NULL, 0x1, 83, methods, 25, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_GeogebraCommonKernelImplicitGeoImplicitPoly;
}

@end

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c) {
  GeogebraCommonKernelGeosGeoUserInputElement_initWithGeogebraCommonKernelConstruction_(self, c);
  self->defined_ = YES;
  self->gridWidth_ = 30;
  self->gridHeight_ = 30;
  self->minGap_ = 0.001;
  self->degX_ = -1;
  self->degY_ = -1;
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_coeffSquarefree_(self, [IOSDoubleArray newArrayWithDimensions:2 lengths:(jint[]){ 0, 0 }]);
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_coeff_(self, [IOSDoubleArray newArrayWithDimensions:2 lengths:(jint[]){ 0, 0 }]);
  GeogebraCommonKernelImplicitGeoImplicitPoly_setAndConsume_locus_(self, new_GeogebraCommonKernelGeosGeoLocus_initWithGeogebraCommonKernelConstruction_(c));
  [self->locus_ setDefinedWithBoolean:YES];
  self->calcPath_ = YES;
  [((GeogebraCommonKernelConstruction *) nil_chk(c)) registerEuclidianViewCEWithGeogebraCommonKernelEuclidianViewCE:self];
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(GeogebraCommonKernelConstruction *c) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(self, c);
  return self;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c, NSString *label, IOSObjectArray *coeff, jboolean calcPath) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(self, c);
  [self setLabelWithNSString:label];
  self->calcPath_ = calcPath;
  [self setCoeffWithDoubleArray2:coeff withBoolean:calcPath];
  if (!calcPath) [((GeogebraCommonKernelConstruction *) nil_chk(c)) unregisterEuclidianViewCEWithGeogebraCommonKernelEuclidianViewCE:self];
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(GeogebraCommonKernelConstruction *c, NSString *label, IOSObjectArray *coeff, jboolean calcPath) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(self, c, label, coeff, calcPath);
  return self;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c, NSString *label, IOSObjectArray *coeff) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(self, c, label, coeff, YES);
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_(GeogebraCommonKernelConstruction *c, NSString *label, IOSObjectArray *coeff) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_(self, c, label, coeff);
  return self;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c, NSString *label, GeogebraCommonKernelArithmeticPolynomial *poly, jboolean calcPath) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(self, c);
  [self setLabelWithNSString:label];
  self->calcPath_ = calcPath;
  [self setCoeffWithGeogebraCommonKernelArithmeticExpressionValueArray2:[((GeogebraCommonKernelArithmeticPolynomial *) nil_chk(poly)) getCoeff] withBoolean:calcPath];
  if (!calcPath) [((GeogebraCommonKernelConstruction *) nil_chk(c)) unregisterEuclidianViewCEWithGeogebraCommonKernelEuclidianViewCE:self];
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(GeogebraCommonKernelConstruction *c, NSString *label, GeogebraCommonKernelArithmeticPolynomial *poly, jboolean calcPath) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(self, c, label, poly, calcPath);
  return self;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelConstruction *c, NSString *label, GeogebraCommonKernelArithmeticPolynomial *poly) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_withBoolean_(self, c, label, poly, YES);
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_(GeogebraCommonKernelConstruction *c, NSString *label, GeogebraCommonKernelArithmeticPolynomial *poly) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelArithmeticPolynomial_(self, c, label, poly);
  return self;
}

GeogebraCommonKernelImplicitGeoImplicitPoly *GeogebraCommonKernelImplicitGeoImplicitPoly_createImplicitPolyWithoutPathWithGeogebraCommonKernelConstruction_withDoubleArray2_(GeogebraCommonKernelConstruction *c, IOSObjectArray *coeff) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initialize();
  return [new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_withNSString_withDoubleArray2_withBoolean_(c, nil, coeff, NO) autorelease];
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelImplicitGeoImplicitPoly_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelImplicitGeoImplicitPoly *g) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(self, ((GeogebraCommonKernelImplicitGeoImplicitPoly *) nil_chk(g))->cons_);
  [self setWithGeogebraCommonKernelGeosGeoElement:g];
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelImplicitGeoImplicitPoly_(GeogebraCommonKernelImplicitGeoImplicitPoly *g) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelImplicitGeoImplicitPoly_(self, g);
  return self;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelKernelNDGeoConicND_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, GeogebraCommonKernelKernelNDGeoConicND *c) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelConstruction_(self, [((GeogebraCommonKernelKernelNDGeoConicND *) nil_chk(c)) getConstruction]);
  GeogebraCommonKernelImplicitGeoImplicitPoly_set_coeff_(self, GeogebraCommonKernelImplicitGeoImplicitPoly_coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND_(c));
  self->degX_ = 2;
  self->degY_ = 2;
}

GeogebraCommonKernelImplicitGeoImplicitPoly *new_GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelKernelNDGeoConicND_(GeogebraCommonKernelKernelNDGeoConicND *c) {
  GeogebraCommonKernelImplicitGeoImplicitPoly *self = [GeogebraCommonKernelImplicitGeoImplicitPoly alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_initWithGeogebraCommonKernelKernelNDGeoConicND_(self, c);
  return self;
}

IOSObjectArray *GeogebraCommonKernelImplicitGeoImplicitPoly_coeffFromConicWithGeogebraCommonKernelKernelNDGeoConicND_(GeogebraCommonKernelKernelNDGeoConicND *c) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initialize();
  IOSObjectArray *mat = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ 3, 3 }];
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 0)), 0) = IOSDoubleArray_Get(nil_chk([((GeogebraCommonKernelKernelNDGeoConicND *) nil_chk(c)) getMatrix]), 2);
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 1)), 1) = 2 * IOSDoubleArray_Get(nil_chk([c getMatrix]), 3);
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 2)), 2) = 0;
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 1)), 0) = 2 * IOSDoubleArray_Get(nil_chk([c getMatrix]), 4);
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 0)), 1) = 2 * IOSDoubleArray_Get(nil_chk([c getMatrix]), 5);
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 2)), 0) = IOSDoubleArray_Get(nil_chk([c getMatrix]), 0);
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 0)), 2) = IOSDoubleArray_Get(nil_chk([c getMatrix]), 1);
  *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 2)), 1) = *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(mat, 1)), 2) = 0;
  return mat;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_addPowWithJavaLangStringBuilder_withInt_withGeogebraCommonKernelStringTemplate_(JavaLangStringBuilder *sb, jint exp, GeogebraCommonKernelStringTemplate *tpl) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initialize();
  if (exp > 1) {
    if ([((GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum *) nil_chk([((GeogebraCommonKernelStringTemplate *) nil_chk(tpl)) getStringType])) isEqual:GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_LATEX()]) {
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithChar:'^'];
      [sb appendWithChar:'{'];
      [sb appendWithInt:exp];
      [sb appendWithChar:'}'];
    }
    else if (([((GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum *) nil_chk([tpl getStringType])) isEqual:GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_GEOGEBRA_XML()]) || ([((GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum *) nil_chk([tpl getStringType])) isEqual:GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_GIAC()])) {
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithChar:'^'];
      [sb appendWithInt:exp];
    }
    else {
      NSString *p = @"";
      jint i = exp;
      while (i > 0) {
        jint c = i % 10;
        switch (c) {
          case 1:
          p = JreStrcat("C$", 0x00b9, p);
          break;
          case 2:
          p = JreStrcat("C$", 0x00b2, p);
          break;
          case 3:
          p = JreStrcat("C$", 0x00b3, p);
          break;
          default:
          p = JreStrcat("C$", (jchar) (0x2070 + c), p);
        }
        i = i / 10;
      }
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:p];
    }
  }
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_appendMultiplyWithJavaLangStringBuilder_(JavaLangStringBuilder *sb) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initialize();
  if ([((JavaLangStringBuilder *) nil_chk(sb)) length] == 0) {
    return;
  }
  jchar ch = [sb charAtWithInt:[sb length] - 1];
  if (ch != '*' && ch != ' ') {
    [sb appendWithChar:'*'];
  }
}

jdouble GeogebraCommonKernelImplicitGeoImplicitPoly_evalPolyCoeffAtWithDouble_withDouble_withDoubleArray2_(jdouble x, jdouble y, IOSObjectArray *coeff) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initialize();
  jdouble sum = 0;
  jdouble zs = 0;
  if (coeff != nil) for (jint i = coeff->size_ - 1; i >= 0; i--) {
    zs = 0;
    for (jint j = ((IOSDoubleArray *) nil_chk(IOSObjectArray_Get(coeff, i)))->size_ - 1; j >= 0; j--) {
      zs = y * zs + IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(coeff, i)), j);
    }
    sum = sum * x + zs;
  }
  return sum;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_polyMultWithDoubleArray2_withDoubleArray2_withInt_withInt_withInt_withInt_(IOSObjectArray *polyDest, IOSObjectArray *polySrc, jint degDestX, jint degDestY, jint degSrcX, jint degSrcY) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_initialize();
  IOSObjectArray *result = [IOSDoubleArray arrayWithDimensions:2 lengths:(jint[]){ degDestX + degSrcX + 1, degDestY + degSrcY + 1 }];
  for (jint n = 0; n <= degDestX + degSrcX; n++) {
    for (jint m = 0; m <= degDestY + degSrcY; m++) {
      jdouble sum = 0;
      for (jint k = JavaLangMath_maxWithInt_withInt_(0, n - degSrcX); k <= JavaLangMath_minWithInt_withInt_(n, degDestX); k++) for (jint j = JavaLangMath_maxWithInt_withInt_(0, m - degSrcY); j <= JavaLangMath_minWithInt_withInt_(m, degDestY); j++) sum += IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(polyDest), k)), j) * IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(nil_chk(polySrc), n - k)), m - j);
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(result, n)), m) = sum;
    }
  }
  for (jint n = 0; n <= degDestX + degSrcX; n++) {
    for (jint m = 0; m <= degDestY + degSrcY; m++) {
      *IOSDoubleArray_GetRef(nil_chk(IOSObjectArray_Get(nil_chk(polyDest), n)), m) = IOSDoubleArray_Get(nil_chk(IOSObjectArray_Get(result, n)), m);
    }
  }
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_getFactors(GeogebraCommonKernelImplicitGeoImplicitPoly *self) {
}

jdouble GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, jdouble x, jdouble y) {
  return x * x / self->scaleX_ / self->scaleX_ + y * y / self->scaleY_ / self->scaleY_;
}

void GeogebraCommonKernelImplicitGeoImplicitPoly_startPathWithInt_withInt_withDouble_withDouble_withGeogebraCommonKernelGeosGeoLocus_(GeogebraCommonKernelImplicitGeoImplicitPoly *self, jint width, jint height, jdouble x, jdouble y, GeogebraCommonKernelGeosGeoLocus *loc1) {
  jint w = width;
  jint h = height;
  jdouble sx = x;
  jdouble sy = y;
  jdouble lx = JavaLangDouble_NaN;
  jdouble ly = JavaLangDouble_NaN;
  jboolean first = YES;
  jdouble stepSize = GeogebraCommonKernelImplicitGeoImplicitPoly_START_STEP_SIZE * JavaLangMath_maxWithDouble_withDouble_(self->scaleX_, self->scaleY_);
  jdouble startX = x;
  jdouble startY = y;
  JavaUtilArrayList *firstDirPoints = [new_JavaUtilArrayList_init() autorelease];
  [firstDirPoints addWithId:[new_GeogebraCommonKernelMyPoint_initWithDouble_withDouble_withBoolean_(x, y, YES) autorelease]];
  jint s = 0;
  jint lastW = w;
  jint lastH = h;
  jint startW = w;
  jint startH = h;
  jboolean nearSing = NO;
  jdouble lastGradX = JavaLangDouble_POSITIVE_INFINITY;
  jdouble lastGradY = JavaLangDouble_POSITIVE_INFINITY;
  while (s < GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEPS) {
    s++;
    jboolean reachedSingularity = NO;
    jboolean reachedEnd = NO;
    if (!JavaLangDouble_isNaNWithDouble_(lx) && !JavaLangDouble_isNaNWithDouble_(ly)) {
      if ((GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(self, startX - sx, startY - sy) < GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEP_SIZE * GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEP_SIZE) && (GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(self, startX - sx, startY - sy) < GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(self, startX - lx, startY - ly))) {
        if (firstDirPoints != nil) {
          GeogebraCommonKernelMyPoint *firstPoint = [firstDirPoints getWithInt:0];
          ((GeogebraCommonKernelMyPoint *) nil_chk(firstPoint))->lineTo_ = NO;
          [((JavaUtilArrayList *) nil_chk([((GeogebraCommonKernelGeosGeoLocus *) nil_chk(loc1)) getPoints])) addAllWithJavaUtilCollection:firstDirPoints];
        }
        [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(loc1)) insertPointWithDouble:x withDouble:y withBoolean:YES];
        return;
      }
    }
    if (w > ((IOSObjectArray *) nil_chk(self->grid_))->size_ || h > ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(self->grid_, w)))->size_ || IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h) == nil) {
      if (w > self->grid_->size_ || h > ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(self->grid_, w)))->size_) {
        GeogebraCommonMainApp_printStacktraceWithId_(JreStrcat("$ICICI", @"GRID", self->grid_->size_, ',', w, ',', h));
      }
      else {
        GeogebraCommonMainApp_printStacktraceWithId_(JreStrcat("$ICICICICI", @"GRID NULL", self->grid_->size_, ',', w, ',', h, ',', self->gridWidth_, ',', self->gridHeight_));
      }
    }
    while (sx < ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h)))->x_) {
      if (w > 0) w--;
      else {
        reachedEnd = YES;
        break;
      }
    }
    while (sx > ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h)))->x_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h)))->width_) {
      if (w < self->grid_->size_ - 1) w++;
      else {
        reachedEnd = YES;
        break;
      }
    }
    while (sy < ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h)))->y_) {
      if (h > 0) h--;
      else {
        reachedEnd = YES;
        break;
      }
    }
    while (sy > ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h)))->y_ + ((GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *) nil_chk(IOSObjectArray_Get(nil_chk(IOSObjectArray_Get(self->grid_, w)), h)))->height_) {
      if (h < ((IOSObjectArray *) nil_chk(IOSObjectArray_Get(self->grid_, w)))->size_ - 1) h++;
      else {
        reachedEnd = YES;
        break;
      }
    }
    if (reachedEnd) {
      [((id<JavaUtilList>) nil_chk(self->boundaryIntersectCollection_)) addWithId:[IOSDoubleArray arrayWithDoubles:(jdouble[]){ sx, sy } count:2]];
    }
    if (lastW != w || lastH != h) {
      jint dw = J2ObjCFpToInt(JavaLangMath_signumWithFloat_(lastW - w));
      jint dh = J2ObjCFpToInt(JavaLangMath_signumWithFloat_(lastH - h));
      for (jint i = 0; i <= JavaLangMath_absWithInt_(lastW - w); i++) {
        for (jint j = 0; j <= JavaLangMath_absWithInt_(lastH - h); j++) {
          *IOSBooleanArray_GetRef(nil_chk(IOSObjectArray_Get(nil_chk(self->remember_), lastW - dw * i)), lastH - dh * j) = NO;
        }
      }
    }
    lastW = w;
    lastH = h;
    jdouble gradX = 0;
    jdouble gradY = 0;
    if (!reachedEnd) {
      gradX = [self evalDiffXPolyAtWithDouble:sx withDouble:sy withBoolean:YES];
      gradY = [self evalDiffYPolyAtWithDouble:sx withDouble:sy withBoolean:YES];
      if (nearSing || (JavaLangMath_absWithDouble_(gradX) < GeogebraCommonKernelImplicitGeoImplicitPoly_NEAR_SING && JavaLangMath_absWithDouble_(gradY) < GeogebraCommonKernelImplicitGeoImplicitPoly_NEAR_SING)) {
        for (IOSDoubleArray * __strong pair in nil_chk(self->singularitiesCollection_)) {
          if ((GeogebraCommonKernelImplicitGeoImplicitPoly_scaledNormSquaredWithDouble_withDouble_(self, IOSDoubleArray_Get(nil_chk(pair), 0) - sx, IOSDoubleArray_Get(pair, 1) - sy) < GeogebraCommonKernelImplicitGeoImplicitPoly_SING_RADIUS * GeogebraCommonKernelImplicitGeoImplicitPoly_SING_RADIUS)) {
            sx = IOSDoubleArray_Get(pair, 0);
            sy = IOSDoubleArray_Get(pair, 1);
            reachedSingularity = YES;
            reachedEnd = YES;
            break;
          }
        }
        if (!reachedEnd) {
          if (gradX * gradX + gradY * gradY > lastGradX * lastGradX + lastGradY * lastGradY) {
            [self->singularitiesCollection_ addWithId:[IOSDoubleArray arrayWithDoubles:(jdouble[]){ sx, sy } count:2]];
            reachedEnd = YES;
            reachedSingularity = YES;
          }
          else if (JavaLangMath_absWithDouble_(gradX) < GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_GRAD && JavaLangMath_absWithDouble_(gradY) < GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_GRAD) {
            [self->singularitiesCollection_ addWithId:[IOSDoubleArray arrayWithDoubles:(jdouble[]){ sx, sy } count:2]];
            reachedEnd = YES;
            reachedSingularity = YES;
          }
          lastGradX = gradX;
          lastGradY = gradY;
          nearSing = YES;
        }
      }
    }
    jdouble a = 0, nX = 0, nY = 0;
    if (!reachedEnd) {
      a = 1 / (JavaLangMath_absWithDouble_(gradX) + JavaLangMath_absWithDouble_(gradY));
      gradX = a * gradX;
      gradY = a * gradY;
      a = JavaLangMath_sqrtWithDouble_(gradX * gradX + gradY * gradY);
      gradX = gradX / a;
      gradY = gradY / a;
      nX = -gradY;
      nY = gradX;
      if (!JavaLangDouble_isNaNWithDouble_(lx) && !JavaLangDouble_isNaNWithDouble_(ly)) {
        jdouble c = (lx - sx) * nX + (ly - sy) * nY;
        if (c > 0) {
          nX = -nX;
          nY = -nY;
        }
      }
      else {
        if (!first) {
          nX = -nX;
          nY -= nY;
        }
      }
      lx = sx;
      ly = sy;
    }
    while (!reachedEnd) {
      sx = lx + nX * stepSize;
      sy = ly + nY * stepSize;
      jint e = [self epsSignumWithDouble:[self evalPolyAtWithDouble:sx withDouble:sy withBoolean:YES]];
      if (e == 0) {
        if (stepSize * 2 <= GeogebraCommonKernelImplicitGeoImplicitPoly_MAX_STEP_SIZE * JavaLangMath_maxWithDouble_withDouble_(self->scaleX_, self->scaleY_)) stepSize *= 2;
        break;
      }
      gradX = [self evalDiffXPolyAtWithDouble:sx withDouble:sy withBoolean:YES];
      gradY = [self evalDiffYPolyAtWithDouble:sx withDouble:sy withBoolean:YES];
      if (JavaLangMath_absWithDouble_(gradX) < GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_GRAD && JavaLangMath_absWithDouble_(gradY) < GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_GRAD) {
        stepSize /= 2;
        if (stepSize > GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_STEP_SIZE * JavaLangMath_maxWithDouble_withDouble_(self->scaleX_, self->scaleY_)) continue;
        [((id<JavaUtilList>) nil_chk(self->singularitiesCollection_)) addWithId:[IOSDoubleArray arrayWithDoubles:(jdouble[]){ sx, sy } count:2]];
        reachedEnd = YES;
        break;
      }
      a = JavaLangMath_sqrtWithDouble_(gradX * gradX + gradY * gradY);
      gradX *= stepSize / a;
      gradY *= stepSize / a;
      if (e > 0) {
        gradX = -gradX;
        gradY = -gradY;
      }
      jint e1 = [self epsSignumWithDouble:[self evalPolyAtWithDouble:sx + gradX withDouble:sy + gradY withBoolean:YES]];
      if (e1 == 0) {
        sx = sx + gradX;
        sy = sy + gradY;
        break;
      }
      if (e1 != e) {
        a = [self bisecWithDouble:sx withDouble:sy withDouble:sx + gradX withDouble:sy + gradY];
        sx += a * gradX;
        sy += a * gradY;
        break;
      }
      stepSize /= 2;
      if (stepSize > GeogebraCommonKernelImplicitGeoImplicitPoly_MIN_STEP_SIZE * JavaLangMath_maxWithDouble_withDouble_(self->scaleX_, self->scaleY_)) continue;
      reachedEnd = YES;
      break;
    }
    if (!reachedEnd || reachedSingularity) {
      if (reachedSingularity || ((lx - sx) * (lx - sx) + (ly - sy) * (ly - sy) > self->minGap_ * self->minGap_)) {
        if (firstDirPoints != nil) {
          [firstDirPoints addWithId:[new_GeogebraCommonKernelMyPoint_initWithDouble_withDouble_withBoolean_(sx, sy, YES) autorelease]];
        }
        else {
          [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(loc1)) insertPointWithDouble:sx withDouble:sy withBoolean:YES];
        }
      }
    }
    if (reachedEnd) {
      if (!first) {
        return;
      }
      lastGradX = JavaLangDouble_POSITIVE_INFINITY;
      lastGradY = JavaLangDouble_POSITIVE_INFINITY;
      JavaUtilArrayList *pointList = [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(loc1)) getPoints];
      if ([firstDirPoints size] > 0) {
        GeogebraCommonKernelMyPoint *lastPoint = [firstDirPoints getWithInt:[firstDirPoints size] - 1];
        ((GeogebraCommonKernelMyPoint *) nil_chk(lastPoint))->lineTo_ = NO;
        [pointList ensureCapacityWithInt:[((JavaUtilArrayList *) nil_chk(pointList)) size] + [firstDirPoints size]];
        for (jint i = [firstDirPoints size] - 1; i >= 0; i--) {
          [pointList addWithId:[firstDirPoints getWithInt:i]];
        }
      }
      firstDirPoints = nil;
      sx = startX;
      sy = startY;
      lx = JavaLangDouble_NaN;
      ly = JavaLangDouble_NaN;
      w = startW;
      h = startH;
      lastW = w;
      lastH = h;
      first = NO;
      reachedEnd = NO;
      reachedSingularity = NO;
      nearSing = NO;
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelImplicitGeoImplicitPoly)

@implementation GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect

- (instancetype)initWithDouble:(jdouble)x
                    withDouble:(jdouble)y
                    withDouble:(jdouble)width
                    withDouble:(jdouble)height {
  GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(self, x, y, width, height);
  return self;
}

- (void)dealloc {
  RELEASE_(eval_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithDouble:withDouble:withDouble:withDouble:", "GridRect", NULL, 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "x_", NULL, 0x0, "D", NULL, NULL,  },
    { "y_", NULL, 0x0, "D", NULL, NULL,  },
    { "width_", NULL, 0x0, "D", NULL, NULL,  },
    { "height_", NULL, 0x0, "D", NULL, NULL,  },
    { "eval_", NULL, 0x0, "[I", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect = { 2, "GridRect", "geogebra.common.kernel.implicit", "GeoImplicitPoly", 0xa, 1, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect;
}

@end

void GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *self, jdouble x, jdouble y, jdouble width, jdouble height) {
  NSObject_init(self);
  self->x_ = x;
  self->y_ = y;
  self->width_ = width;
  self->height_ = height;
  GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_setAndConsume_eval_(self, [IOSIntArray newArrayWithLength:4]);
}

GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *new_GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(jdouble x, jdouble y, jdouble width, jdouble height) {
  GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect *self = [GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect alloc];
  GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect_initWithDouble_withDouble_withDouble_withDouble_(self, x, y, width, height);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelImplicitGeoImplicitPoly_GridRect)
