//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/kernel/algos/AlgoGeoPointsFunction.java
//


#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/algos/AlgoGeoPointsFunction.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoFunction.h"
#include "geogebra/common/kernel/geos/GeoPoint.h"
#include "java/lang/Math.h"
#include "java/util/Arrays.h"

@interface GeogebraCommonKernelAlgosAlgoGeoPointsFunction () {
 @public
  IOSObjectArray *labels_;
  jboolean initLabels_;
}

- (void)removePointWithInt:(jint)pos;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoGeoPointsFunction, labels_, IOSObjectArray *)

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoGeoPointsFunction_removePointWithInt_(GeogebraCommonKernelAlgosAlgoGeoPointsFunction *self, jint pos);

@implementation GeogebraCommonKernelAlgosAlgoGeoPointsFunction

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons
                                       withNSStringArray:(IOSObjectArray *)labels
                                             withBoolean:(jboolean)setLabels
                 withGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initWithGeogebraCommonKernelConstruction_withNSStringArray_withBoolean_withGeogebraCommonKernelGeosGeoFunction_(self, cons, labels, setLabels, f);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons
                 withGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_(self, cons, f);
  return self;
}

- (void)setLabelsWithNSStringArray:(IOSObjectArray *)labels {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_set_labels_(self, labels);
  setLabels__ = YES;
  if (labels != nil) [self initPointsWithInt:labels->size_];
  [self update];
}

- (IOSObjectArray *)getPoints {
  return points_;
}

- (void)showOneRootInAlgebraView {
  if (![((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(nil_chk(points_), 0))) isDefined]) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, 0))) setCoordsWithDouble:0 withDouble:0 withDouble:1];
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, 0))) update];
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, 0))) setUndefined];
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, 0))) update];
  }
}

+ (void)removeDuplicatesWithDoubleArray:(IOSDoubleArray *)tab {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_removeDuplicatesWithDoubleArray_(tab);
}

- (void)setPointsWithDoubleArray:(IOSDoubleArray *)curXValues
                         withInt:(jint)number {
  [self initPointsWithInt:number];
  for (jint i = 0; i < number; i++) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(nil_chk(points_), i))) setCoordsWithDouble:IOSDoubleArray_Get(nil_chk(curXValues), i) withDouble:[self yAtWithDouble:IOSDoubleArray_Get(curXValues, i)] withDouble:1.0];
  }
  for (jint i = number; i < ((IOSObjectArray *) nil_chk(points_))->size_; i++) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, i))) setUndefined];
  }
  if (setLabels__) [self updateLabelsWithInt:number];
  [self noUndefinedPointsInAlgebraViewWithGeogebraCommonKernelGeosGeoPointArray:points_];
}

- (jdouble)yAtWithDouble:(jdouble)d {
  return [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(f_)) evaluateWithDouble:d];
}

- (void)updateLabelsWithInt:(jint)number {
  if (initLabels_) {
    GeogebraCommonKernelGeosGeoElement_setLabelsWithNSStringArray_withGeogebraCommonKernelGeosGeoElementArray_(labels_, points_);
    initLabels_ = NO;
  }
  else {
    for (jint i = 0; i < number; i++) {
      if (![((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(nil_chk(points_), i))) isLabelSet]) {
        NSString *newLabel = (labels_ != nil && i < labels_->size_) ? IOSObjectArray_Get(labels_, i) : nil;
        [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, i))) setLabelWithNSString:newLabel];
      }
    }
  }
  for (jint i = number; i < ((IOSObjectArray *) nil_chk(points_))->size_; i++) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, i))) setUndefined];
  }
}

- (void)noUndefinedPointsInAlgebraViewWithGeogebraCommonKernelGeosGeoPointArray:(IOSObjectArray *)gpts {
  for (jint i = 1; i < ((IOSObjectArray *) nil_chk(gpts))->size_; i++) {
    [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(gpts, i))) showUndefinedInAlgebraViewWithBoolean:NO];
  }
}

- (void)removeWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)output {
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(points_))->size_; i++) {
    if (IOSObjectArray_Get(points_, i) == output && ![((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(points_, i))) isDefined]) {
      GeogebraCommonKernelAlgosAlgoGeoPointsFunction_removePointWithInt_(self, i);
      return;
    }
  }
  [super remove];
}

- (void)initPointsWithInt:(jint)number {
  if (((IOSObjectArray *) nil_chk(points_))->size_ < number) {
    IOSObjectArray *temp = [IOSObjectArray arrayWithLength:number type:GeogebraCommonKernelGeosGeoPoint_class_()];
    for (jint i = 0; i < points_->size_; i++) {
      IOSObjectArray_Set(temp, i, IOSObjectArray_Get(points_, i));
      [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(temp, i))) setCoordsWithDouble:0 withDouble:0 withDouble:1];
    }
    for (jint i = points_->size_; i < temp->size_; i++) {
      IOSObjectArray_SetAndConsume(temp, i, new_GeogebraCommonKernelGeosGeoPoint_initWithGeogebraCommonKernelConstruction_(cons_));
      [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(temp, i))) setCoordsWithDouble:0 withDouble:0 withDouble:1];
      [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(temp, i))) setParentAlgorithmWithGeogebraCommonKernelAlgosAlgoElement:self];
    }
    GeogebraCommonKernelAlgosAlgoGeoPointsFunction_set_points_(self, temp);
    [super setOutputWithGeogebraCommonKernelGeosGeoElementArray:points_];
  }
}

- (void)removePointWithInt:(jint)pos {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_removePointWithInt_(self, pos);
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initWithGeogebraCommonKernelConstruction_(self, cons);
  return self;
}

- (void)dealloc {
  RELEASE_(f_);
  RELEASE_(points_);
  RELEASE_(labels_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:withNSStringArray:withBoolean:withGeogebraCommonKernelGeosGeoFunction:", "AlgoGeoPointsFunction", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withGeogebraCommonKernelGeosGeoFunction:", "AlgoGeoPointsFunction", NULL, 0x1, NULL, NULL },
    { "setLabelsWithNSStringArray:", "setLabels", "V", 0x1, NULL, NULL },
    { "getPoints", NULL, "[Lgeogebra.common.kernel.geos.GeoPoint;", 0x1, NULL, NULL },
    { "showOneRootInAlgebraView", NULL, "V", 0x14, NULL, NULL },
    { "removeDuplicatesWithDoubleArray:", "removeDuplicates", "V", 0x1c, NULL, NULL },
    { "setPointsWithDoubleArray:withInt:", "setPoints", "V", 0x14, NULL, NULL },
    { "yAtWithDouble:", "yAt", "D", 0x4, NULL, NULL },
    { "updateLabelsWithInt:", "updateLabels", "V", 0x4, NULL, NULL },
    { "noUndefinedPointsInAlgebraViewWithGeogebraCommonKernelGeosGeoPointArray:", "noUndefinedPointsInAlgebraView", "V", 0x4, NULL, NULL },
    { "removeWithGeogebraCommonKernelGeosGeoElement:", "remove", "V", 0x1, NULL, NULL },
    { "initPointsWithInt:", "initPoints", "V", 0x4, NULL, NULL },
    { "removePointWithInt:", "removePoint", "V", 0x2, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:", "AlgoGeoPointsFunction", NULL, 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "f_", NULL, 0x4, "Lgeogebra.common.kernel.geos.GeoFunction;", NULL, NULL,  },
    { "points_", NULL, 0x4, "[Lgeogebra.common.kernel.geos.GeoPoint;", NULL, NULL,  },
    { "labels_", NULL, 0x2, "[Ljava.lang.String;", NULL, NULL,  },
    { "initLabels_", NULL, 0x2, "Z", NULL, NULL,  },
    { "setLabels__", "setLabels", 0x4, "Z", NULL, NULL,  },
    { "numberOfXValues_", NULL, 0x0, "I", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonKernelAlgosAlgoGeoPointsFunction = { 2, "AlgoGeoPointsFunction", "geogebra.common.kernel.algos", NULL, 0x401, 14, methods, 6, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonKernelAlgosAlgoGeoPointsFunction;
}

@end

void GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initWithGeogebraCommonKernelConstruction_withNSStringArray_withBoolean_withGeogebraCommonKernelGeosGeoFunction_(GeogebraCommonKernelAlgosAlgoGeoPointsFunction *self, GeogebraCommonKernelConstruction *cons, IOSObjectArray *labels, jboolean setLabels, GeogebraCommonKernelGeosGeoFunction *f) {
  GeogebraCommonKernelAlgosAlgoElement_initWithGeogebraCommonKernelConstruction_(self, cons);
  self->setLabels__ = NO;
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_set_labels_(self, labels);
  self->setLabels__ = setLabels;
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_set_f_(self, f);
  jint number = labels == nil ? 1 : JavaLangMath_maxWithInt_withInt_(1, labels->size_);
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_setAndConsume_points_(self, [IOSObjectArray newArrayWithLength:0 type:GeogebraCommonKernelGeosGeoPoint_class_()]);
  [self initPointsWithInt:number];
  self->initLabels_ = YES;
}

void GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunction_(GeogebraCommonKernelAlgosAlgoGeoPointsFunction *self, GeogebraCommonKernelConstruction *cons, GeogebraCommonKernelGeosGeoFunction *f) {
  GeogebraCommonKernelAlgosAlgoElement_initWithGeogebraCommonKernelConstruction_(self, cons);
  self->setLabels__ = NO;
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_set_f_(self, f);
  jint number = 1;
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_setAndConsume_points_(self, [IOSObjectArray newArrayWithLength:0 type:GeogebraCommonKernelGeosGeoPoint_class_()]);
  [self initPointsWithInt:number];
}

void GeogebraCommonKernelAlgosAlgoGeoPointsFunction_removeDuplicatesWithDoubleArray_(IOSDoubleArray *tab) {
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initialize();
  JavaUtilArrays_sortWithDoubleArray_(tab);
  jint maxIndex = 0;
  jdouble max = IOSDoubleArray_Get(nil_chk(tab), 0);
  for (jint i = 1; i < tab->size_; i++) {
    if ((IOSDoubleArray_Get(tab, i) - max) > GeogebraCommonKernelKernel_MIN_PRECISION) {
      max = IOSDoubleArray_Get(tab, i);
      maxIndex++;
      *IOSDoubleArray_GetRef(tab, maxIndex) = max;
    }
  }
}

void GeogebraCommonKernelAlgosAlgoGeoPointsFunction_removePointWithInt_(GeogebraCommonKernelAlgosAlgoGeoPointsFunction *self, jint pos) {
  [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(IOSObjectArray_Get(nil_chk(self->points_), pos))) doRemove];
  IOSObjectArray *temp = [IOSObjectArray arrayWithLength:self->points_->size_ - 1 type:GeogebraCommonKernelGeosGeoPoint_class_()];
  jint i;
  for (i = 0; i < pos; i++) IOSObjectArray_Set(temp, i, IOSObjectArray_Get(self->points_, i));
  for (i = pos + 1; i < self->points_->size_; i++) IOSObjectArray_Set(temp, i - 1, IOSObjectArray_Get(self->points_, i));
  GeogebraCommonKernelAlgosAlgoGeoPointsFunction_set_points_(self, temp);
}

void GeogebraCommonKernelAlgosAlgoGeoPointsFunction_initWithGeogebraCommonKernelConstruction_(GeogebraCommonKernelAlgosAlgoGeoPointsFunction *self, GeogebraCommonKernelConstruction *cons) {
  GeogebraCommonKernelAlgosAlgoElement_initWithGeogebraCommonKernelConstruction_(self, cons);
  self->setLabels__ = NO;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelAlgosAlgoGeoPointsFunction)
