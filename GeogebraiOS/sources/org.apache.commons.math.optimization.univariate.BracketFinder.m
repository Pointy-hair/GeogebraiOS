//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/org/apache/commons/math/optimization/univariate/BracketFinder.java
//


#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "java/lang/Double.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "org/apache/commons/math/FunctionEvaluationException.h"
#include "org/apache/commons/math/MaxIterationsExceededException.h"
#include "org/apache/commons/math/analysis/UnivariateRealFunction.h"
#include "org/apache/commons/math/exception/NotStrictlyPositiveException.h"
#include "org/apache/commons/math/optimization/GoalType.h"
#include "org/apache/commons/math/optimization/univariate/BracketFinder.h"

#define OrgApacheCommonsMathOptimizationUnivariateBracketFinder_EPS_MIN 1.0E-21
#define OrgApacheCommonsMathOptimizationUnivariateBracketFinder_GOLD 1.618034

@interface OrgApacheCommonsMathOptimizationUnivariateBracketFinder () {
 @public
  jdouble growLimit_;
  jint maxIterations_;
  jint iterations_;
  jint evaluations_;
  jdouble lo_;
  jdouble hi_;
  jdouble mid_;
  jdouble fLo_;
  jdouble fHi_;
  jdouble fMid_;
}

- (jdouble)evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:(id<OrgApacheCommonsMathAnalysisUnivariateRealFunction>)f
                                                           withDouble:(jdouble)x;

- (void)reset;

@end

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathOptimizationUnivariateBracketFinder, EPS_MIN, jdouble)

J2OBJC_STATIC_FIELD_GETTER(OrgApacheCommonsMathOptimizationUnivariateBracketFinder, GOLD, jdouble)

__attribute__((unused)) static jdouble OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self, id<OrgApacheCommonsMathAnalysisUnivariateRealFunction> f, jdouble x);

__attribute__((unused)) static void OrgApacheCommonsMathOptimizationUnivariateBracketFinder_reset(OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self);

@implementation OrgApacheCommonsMathOptimizationUnivariateBracketFinder

- (instancetype)init {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_init(self);
  return self;
}

- (instancetype)initWithDouble:(jdouble)growLimit
                       withInt:(jint)maxIterations {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_initWithDouble_withInt_(self, growLimit, maxIterations);
  return self;
}

- (void)searchWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:(id<OrgApacheCommonsMathAnalysisUnivariateRealFunction>)func
                    withOrgApacheCommonsMathOptimizationGoalTypeEnum:(OrgApacheCommonsMathOptimizationGoalTypeEnum *)goal
                                                          withDouble:(jdouble)xA
                                                          withDouble:(jdouble)xB {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_reset(self);
  jboolean isMinim = goal == OrgApacheCommonsMathOptimizationGoalTypeEnum_get_MINIMIZE();
  jdouble fA = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, xA);
  jdouble fB = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, xB);
  if (isMinim ? fA < fB : fA > fB) {
    jdouble tmp = xA;
    xA = xB;
    xB = tmp;
    tmp = fA;
    fA = fB;
    fB = tmp;
  }
  jdouble xC = xB + OrgApacheCommonsMathOptimizationUnivariateBracketFinder_GOLD * (xB - xA);
  jdouble fC = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, xC);
  while (isMinim ? fC < fB : fC > fB) {
    if (++iterations_ > maxIterations_) {
      @throw [new_OrgApacheCommonsMathMaxIterationsExceededException_initWithInt_(maxIterations_) autorelease];
    }
    jdouble tmp1 = (xB - xA) * (fB - fC);
    jdouble tmp2 = (xB - xC) * (fB - fA);
    jdouble val = tmp2 - tmp1;
    jdouble denom = JavaLangMath_absWithDouble_(val) < OrgApacheCommonsMathOptimizationUnivariateBracketFinder_EPS_MIN ? 2 * OrgApacheCommonsMathOptimizationUnivariateBracketFinder_EPS_MIN : 2 * val;
    jdouble w = xB - ((xB - xC) * tmp2 - (xB - xA) * tmp1) / denom;
    jdouble wLim = xB + growLimit_ * (xC - xB);
    jdouble fW;
    if ((w - xC) * (xB - w) > 0) {
      fW = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, w);
      if (isMinim ? fW < fC : fW > fC) {
        xA = xB;
        xB = w;
        fA = fB;
        fB = fW;
        break;
      }
      else if (isMinim ? fW > fB : fW < fB) {
        xC = w;
        fC = fW;
        break;
      }
      w = xC + OrgApacheCommonsMathOptimizationUnivariateBracketFinder_GOLD * (xC - xB);
      fW = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, w);
    }
    else if ((w - wLim) * (wLim - xC) >= 0) {
      w = wLim;
      fW = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, w);
    }
    else if ((w - wLim) * (xC - w) > 0) {
      fW = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, w);
      if (isMinim ? fW < fC : fW > fC) {
        xB = xC;
        xC = w;
        w = xC + OrgApacheCommonsMathOptimizationUnivariateBracketFinder_GOLD * (xC - xB);
        fB = fC;
        fC = fW;
        fW = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, w);
      }
    }
    else {
      w = xC + OrgApacheCommonsMathOptimizationUnivariateBracketFinder_GOLD * (xC - xB);
      fW = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, func, w);
    }
    xA = xB;
    xB = xC;
    xC = w;
    fA = fB;
    fB = fC;
    fC = fW;
  }
  lo_ = xA;
  mid_ = xB;
  hi_ = xC;
  fLo_ = fA;
  fMid_ = fB;
  fHi_ = fC;
}

- (jint)getIterations {
  return iterations_;
}

- (jint)getEvaluations {
  return evaluations_;
}

- (jdouble)getLo {
  return lo_;
}

- (jdouble)getFLow {
  return fLo_;
}

- (jdouble)getHi {
  return hi_;
}

- (jdouble)getFHi {
  return fHi_;
}

- (jdouble)getMid {
  return mid_;
}

- (jdouble)getFMid {
  return fMid_;
}

- (jdouble)evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:(id<OrgApacheCommonsMathAnalysisUnivariateRealFunction>)f
                                                           withDouble:(jdouble)x {
  return OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(self, f, x);
}

- (void)reset {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_reset(self);
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "BracketFinder", NULL, 0x1, NULL, NULL },
    { "initWithDouble:withInt:", "BracketFinder", NULL, 0x1, NULL, NULL },
    { "searchWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:withOrgApacheCommonsMathOptimizationGoalTypeEnum:withDouble:withDouble:", "search", "V", 0x1, "Lorg.apache.commons.math.MaxIterationsExceededException;Lorg.apache.commons.math.FunctionEvaluationException;", NULL },
    { "getIterations", NULL, "I", 0x1, NULL, NULL },
    { "getEvaluations", NULL, "I", 0x1, NULL, NULL },
    { "getLo", NULL, "D", 0x1, NULL, NULL },
    { "getFLow", NULL, "D", 0x1, NULL, NULL },
    { "getHi", NULL, "D", 0x1, NULL, NULL },
    { "getFHi", NULL, "D", 0x1, NULL, NULL },
    { "getMid", NULL, "D", 0x1, NULL, NULL },
    { "getFMid", NULL, "D", 0x1, NULL, NULL },
    { "evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction:withDouble:", "eval", "D", 0x2, "Lorg.apache.commons.math.FunctionEvaluationException;", NULL },
    { "reset", NULL, "V", 0x2, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "EPS_MIN_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_EPS_MIN },
    { "GOLD_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = OrgApacheCommonsMathOptimizationUnivariateBracketFinder_GOLD },
    { "growLimit_", NULL, 0x12, "D", NULL, NULL,  },
    { "maxIterations_", NULL, 0x12, "I", NULL, NULL,  },
    { "iterations_", NULL, 0x2, "I", NULL, NULL,  },
    { "evaluations_", NULL, 0x2, "I", NULL, NULL,  },
    { "lo_", NULL, 0x2, "D", NULL, NULL,  },
    { "hi_", NULL, 0x2, "D", NULL, NULL,  },
    { "mid_", NULL, 0x2, "D", NULL, NULL,  },
    { "fLo_", NULL, 0x2, "D", NULL, NULL,  },
    { "fHi_", NULL, 0x2, "D", NULL, NULL,  },
    { "fMid_", NULL, 0x2, "D", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgApacheCommonsMathOptimizationUnivariateBracketFinder = { 2, "BracketFinder", "org.apache.commons.math.optimization.univariate", NULL, 0x1, 13, methods, 12, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheCommonsMathOptimizationUnivariateBracketFinder;
}

@end

void OrgApacheCommonsMathOptimizationUnivariateBracketFinder_init(OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self) {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_initWithDouble_withInt_(self, 100, 50);
}

OrgApacheCommonsMathOptimizationUnivariateBracketFinder *new_OrgApacheCommonsMathOptimizationUnivariateBracketFinder_init() {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self = [OrgApacheCommonsMathOptimizationUnivariateBracketFinder alloc];
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_init(self);
  return self;
}

void OrgApacheCommonsMathOptimizationUnivariateBracketFinder_initWithDouble_withInt_(OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self, jdouble growLimit, jint maxIterations) {
  NSObject_init(self);
  if (growLimit <= 0) {
    @throw [new_OrgApacheCommonsMathExceptionNotStrictlyPositiveException_initWithNSNumber_(JavaLangDouble_valueOfWithDouble_(growLimit)) autorelease];
  }
  if (maxIterations <= 0) {
    @throw [new_OrgApacheCommonsMathExceptionNotStrictlyPositiveException_initWithNSNumber_(JavaLangInteger_valueOfWithInt_(maxIterations)) autorelease];
  }
  self->growLimit_ = growLimit;
  self->maxIterations_ = maxIterations;
}

OrgApacheCommonsMathOptimizationUnivariateBracketFinder *new_OrgApacheCommonsMathOptimizationUnivariateBracketFinder_initWithDouble_withInt_(jdouble growLimit, jint maxIterations) {
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self = [OrgApacheCommonsMathOptimizationUnivariateBracketFinder alloc];
  OrgApacheCommonsMathOptimizationUnivariateBracketFinder_initWithDouble_withInt_(self, growLimit, maxIterations);
  return self;
}

jdouble OrgApacheCommonsMathOptimizationUnivariateBracketFinder_evalWithOrgApacheCommonsMathAnalysisUnivariateRealFunction_withDouble_(OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self, id<OrgApacheCommonsMathAnalysisUnivariateRealFunction> f, jdouble x) {
  ++self->evaluations_;
  return [((id<OrgApacheCommonsMathAnalysisUnivariateRealFunction>) nil_chk(f)) valueWithDouble:x];
}

void OrgApacheCommonsMathOptimizationUnivariateBracketFinder_reset(OrgApacheCommonsMathOptimizationUnivariateBracketFinder *self) {
  self->iterations_ = 0;
  self->evaluations_ = 0;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathOptimizationUnivariateBracketFinder)
