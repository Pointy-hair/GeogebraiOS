//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/geogebra3D/kernel3D/algos/AlgoPolyhedronPointsPrism.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/geogebra3D/kernel3D/algos/AlgoPolyhedron.h"
#include "geogebra/common/geogebra3D/kernel3D/algos/AlgoPolyhedronPoints.h"
#include "geogebra/common/geogebra3D/kernel3D/algos/AlgoPolyhedronPointsPrism.h"
#include "geogebra/common/geogebra3D/kernel3D/geos/GeoPoint3D.h"
#include "geogebra/common/geogebra3D/kernel3D/geos/GeoPolygon3D.h"
#include "geogebra/common/geogebra3D/kernel3D/geos/GeoPolyhedron.h"
#include "geogebra/common/geogebra3D/kernel3D/geos/GeoSegment3D.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Matrix/Coords.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/arithmetic/NumberValue.h"
#include "geogebra/common/kernel/commands/Commands.h"
#include "geogebra/common/kernel/geos/GeoPolygon.h"
#include "geogebra/common/kernel/kernelND/GeoPointND.h"
#include "geogebra/common/kernel/kernelND/GeoSegmentND.h"
#include "java/util/Collection.h"

@interface GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism () {
 @public
  GeogebraCommonKernelMatrixCoords *uptranslation_;
}

- (void)updateTopWithInt:(jint)n;

- (void)updateSideWithInt:(jint)index
withGeogebraCommonKernelKernelNDGeoPointNDArray:(IOSObjectArray *)bottomPoints
withGeogebraCommonKernelKernelNDGeoSegmentNDArray:(IOSObjectArray *)bottomSegments;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism, uptranslation_, GeogebraCommonKernelMatrixCoords *)

__attribute__((unused)) static void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateTopWithInt_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, jint n);

__attribute__((unused)) static void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateSideWithInt_withGeogebraCommonKernelKernelNDGeoPointNDArray_withGeogebraCommonKernelKernelNDGeoSegmentNDArray_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, jint index, IOSObjectArray *bottomPoints, IOSObjectArray *bottomSegments);

@implementation GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                       withNSStringArray:(IOSObjectArray *)labels
                  withGeogebraCommonKernelGeosGeoPolygon:(GeogebraCommonKernelGeosGeoPolygon *)polygon
              withGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)point {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelKernelNDGeoPointND_(self, c, labels, polygon, point);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                       withNSStringArray:(IOSObjectArray *)labels
         withGeogebraCommonKernelKernelNDGeoPointNDArray:(IOSObjectArray *)points {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelKernelNDGeoPointNDArray_(self, c, labels, points);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
                                       withNSStringArray:(IOSObjectArray *)labels
                  withGeogebraCommonKernelGeosGeoPolygon:(GeogebraCommonKernelGeosGeoPolygon *)polygon
           withGeogebraCommonKernelArithmeticNumberValue:(id<GeogebraCommonKernelArithmeticNumberValue>)height {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelArithmeticNumberValue_(self, c, labels, polygon, height);
  return self;
}

- (void)createPolyhedronWithGeogebraCommonKernelKernelNDGeoPointNDArray:(IOSObjectArray *)bottomPoints {
  [self setBottomWithGeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron:polyhedron_];
  id<GeogebraCommonKernelKernelNDGeoPointND> topPoint = [self getTopPoint];
  bottomPointsLength_ = ((IOSObjectArray *) nil_chk(bottomPoints))->size_;
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) augmentOutputSizeWithInt:bottomPointsLength_ - 1];
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPoints_setAndConsume_points_(self, [IOSObjectArray newArrayWithLength:bottomPointsLength_ * 2 type:GeogebraCommonKernelKernelNDGeoPointND_class_()]);
  for (jint i = 0; i < bottomPointsLength_; i++) IOSObjectArray_Set(points_, i, IOSObjectArray_Get(bottomPoints, i));
  IOSObjectArray_Set(points_, bottomPointsLength_, topPoint);
  for (jint i = 0; i < bottomPointsLength_ - 1; i++) {
    GeogebraCommonGeogebra3DKernel3DGeosGeoPoint3D *point = [outputPoints_ getElementWithInt:i + 1 - [self getShift]];
    IOSObjectArray_Set(points_, bottomPointsLength_ + 1 + i, point);
  }
  for (jint i = 0; i < bottomPointsLength_; i++) {
    [((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk(polyhedron_)) startNewFace];
    [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(points_, i)];
    [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(points_, (i + 1) % (bottomPointsLength_))];
    [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(points_, bottomPointsLength_ + ((i + 1) % (bottomPointsLength_)))];
    [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(points_, bottomPointsLength_ + i)];
    [polyhedron_ endCurrentFace];
  }
  [((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk(polyhedron_)) startNewFace];
  for (jint i = 0; i < bottomPointsLength_; i++) [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(points_, bottomPointsLength_ + i)];
  [polyhedron_ endCurrentFace];
  [polyhedron_ setCurrentFaceIsTopFace];
  [polyhedron_ setTypeWithInt:GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron_TYPE_PRISM];
}

- (id<GeogebraCommonKernelKernelNDGeoPointND>)getTopPointWithInt:(jint)index {
  if (index == 0) return [self getTopPoint];
  return [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) getElementWithInt:index - [self getShift]];
}

- (void)updateOutputWithInt:(jint)newBottomPointsLength {
  jint nOld = [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) size] + [self getShift];
  IOSObjectArray *bottomPoints = [self getBottomPoints];
  IOSObjectArray *bottomSegments = [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk([self getBottom])) getSegments];
  if (newBottomPointsLength > nOld) {
    [((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk(polyhedron_)) updateSegmentsLinked];
    jint length = newBottomPointsLength - nOld;
    [outputPoints_ augmentOutputSizeWithInt:length withBoolean:NO];
    if ([((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk([self getPolyhedron])) allLabelsAreSet]) {
      [outputPoints_ setLabelsWithNSStringArray:nil];
    }
    [self updateOutputPoints];
    jint l = nOld + length;
    for (jint i = nOld; i < l; i++) {
      [polyhedron_ startNewFace];
      [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(nil_chk(bottomPoints), i)];
      [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:IOSObjectArray_Get(bottomPoints, (i + 1) % l)];
      [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:[self getTopPointWithInt:(i + 1) % l]];
      [polyhedron_ addPointToCurrentFaceWithGeogebraCommonKernelKernelNDGeoPointND:[self getTopPointWithInt:i]];
      [polyhedron_ endCurrentFace];
      GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D *polygon = [polyhedron_ createPolygonWithInt:i + 1];
      if ([polyhedron_ allLabelsAreSet]) {
        [((GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D *) nil_chk(polygon)) setLabelWithNSString:nil];
      }
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsSide_)) addOutputWithGeogebraCommonKernelGeosGeoElement:polygon withBoolean:NO];
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsSide_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) check_class_cast(IOSObjectArray_Get(nil_chk([((GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D *) nil_chk(polygon)) getSegments]), 3), [GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D class]) withBoolean:NO];
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsTop_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) check_class_cast(IOSObjectArray_Get(nil_chk([polygon getSegments]), 2), [GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D class]) withBoolean:NO];
    }
    if ([((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk([self getPolyhedron])) allLabelsAreSet]) {
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsSide_)) setLabelsWithNSStringArray:nil];
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsTop_)) setLabelsWithNSStringArray:nil];
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsSide_)) setLabelsWithNSStringArray:nil];
    }
    [self refreshOutput];
  }
  else if (newBottomPointsLength < nOld) {
    for (jint i = newBottomPointsLength; i < bottomPointsLength_; i++) {
      [((GeogebraCommonGeogebra3DKernel3DGeosGeoPoint3D *) nil_chk([outputPoints_ getElementWithInt:i - [self getShift]])) setUndefined];
    }
    [self updateOutputPoints];
    [((GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) nil_chk([((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsTop_)) getElementWithInt:newBottomPointsLength - 1])) modifyInputPointsWithGeogebraCommonKernelKernelNDGeoPointND:[self getTopPointWithInt:newBottomPointsLength - 1] withGeogebraCommonKernelKernelNDGeoPointND:[self getTopPoint]];
    GeogebraCommonKernelGeosGeoPolygon *polygon = [self getTopFace];
    IOSObjectArray *p = [IOSObjectArray arrayWithLength:newBottomPointsLength type:GeogebraCommonKernelKernelNDGeoPointND_class_()];
    IOSObjectArray_Set(p, 0, [self getTopPoint]);
    for (jint i = 0; i < newBottomPointsLength - 1; i++) IOSObjectArray_Set(p, 1 + i, [self getTopPointWithInt:i + 1]);
    [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(polygon)) modifyInputPointsWithGeogebraCommonKernelKernelNDGeoPointNDArray:p];
    [polygon setSegmentsWithGeogebraCommonKernelKernelNDGeoSegmentNDArray:[outputSegmentsTop_ getOutputWithGeogebraCommonKernelGeosGeoElementArray:[IOSObjectArray arrayWithLength:newBottomPointsLength type:GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D_class_()]]];
    [polygon calcArea];
    polygon = [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsSide_)) getElementWithInt:newBottomPointsLength - 1];
    p = [IOSObjectArray arrayWithLength:4 type:GeogebraCommonKernelKernelNDGeoPointND_class_()];
    IOSObjectArray_Set(p, 0, IOSObjectArray_Get(nil_chk(bottomPoints), newBottomPointsLength - 1));
    IOSObjectArray_Set(p, 1, IOSObjectArray_Get(bottomPoints, 0));
    IOSObjectArray_Set(p, 2, [self getTopPoint]);
    IOSObjectArray_Set(p, 3, [self getTopPointWithInt:newBottomPointsLength - 1]);
    [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(polygon)) setPointsWithGeogebraCommonKernelKernelNDGeoPointNDArray:p withGeogebraCommonKernelMatrixCoordSys:nil withBoolean:NO];
    IOSObjectArray *s = [IOSObjectArray arrayWithLength:4 type:GeogebraCommonKernelKernelNDGeoSegmentND_class_()];
    IOSObjectArray_Set(s, 0, IOSObjectArray_Get(nil_chk([((GeogebraCommonKernelGeosGeoPolygon *) nil_chk([self getBottom])) getSegments]), newBottomPointsLength - 1));
    IOSObjectArray_Set(s, 1, [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsSide_)) getElementWithInt:0]);
    IOSObjectArray_Set(s, 2, [outputSegmentsTop_ getElementWithInt:newBottomPointsLength - 1]);
    IOSObjectArray_Set(s, 3, [outputSegmentsSide_ getElementWithInt:newBottomPointsLength - 1]);
    [polygon setSegmentsWithGeogebraCommonKernelKernelNDGeoSegmentNDArray:s];
    [polygon calcArea];
  }
  else [self updateOutputPoints];
  if (bottomPointsLength_ < newBottomPointsLength) {
    GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateTopWithInt_(self, newBottomPointsLength);
    for (jint i = bottomPointsLength_; i < newBottomPointsLength; i++) GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateSideWithInt_withGeogebraCommonKernelKernelNDGeoPointNDArray_withGeogebraCommonKernelKernelNDGeoSegmentNDArray_(self, i, bottomPoints, bottomSegments);
  }
  bottomPointsLength_ = newBottomPointsLength;
}

- (void)updateTopWithInt:(jint)n {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateTopWithInt_(self, n);
}

- (void)updateSideWithInt:(jint)index
withGeogebraCommonKernelKernelNDGeoPointNDArray:(IOSObjectArray *)bottomPoints
withGeogebraCommonKernelKernelNDGeoSegmentNDArray:(IOSObjectArray *)bottomSegments {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateSideWithInt_withGeogebraCommonKernelKernelNDGeoPointNDArray_withGeogebraCommonKernelKernelNDGeoSegmentNDArray_(self, index, bottomPoints, bottomSegments);
}

- (void)removeBottomPointsWithInt:(jint)length {
  for (jint i = bottomPointsLength_; i < bottomPointsLength_ + length; i++) [((GeogebraCommonGeogebra3DKernel3DGeosGeoPoint3D *) nil_chk([((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) getElementWithInt:i - [self getShift]])) setUndefined];
}

- (void)updateOutputPoints {
  if (height_ == nil) GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_set_uptranslation_(self, [((GeogebraCommonKernelMatrixCoords *) nil_chk([((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk([self getTopPoint])) getInhomCoordsInD3])) subWithGeogebraCommonKernelMatrixCoords:[((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(IOSObjectArray_Get(nil_chk([self getBottomPoints]), 0))) getInhomCoordsInD3]]);
  else GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_set_uptranslation_(self, [((GeogebraCommonKernelMatrixCoords *) nil_chk([((GeogebraCommonKernelMatrixCoords *) nil_chk([((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(bottom_)) getMainDirection])) normalized])) mulWithDouble:[height_ getDouble]]);
  IOSObjectArray *bottomPoints = [self getBottomPoints];
  if (bottomPoints != nil) {
    for (jint i = 0; i < [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) size] && i + [self getShift] < bottomPoints->size_; i++) [((GeogebraCommonGeogebra3DKernel3DGeosGeoPoint3D *) nil_chk([outputPoints_ getElementWithInt:i])) setCoordsWithGeogebraCommonKernelMatrixCoords:[((GeogebraCommonKernelMatrixCoords *) nil_chk([((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(IOSObjectArray_Get(bottomPoints, i + [self getShift]))) getInhomCoordsInD3])) addWithGeogebraCommonKernelMatrixCoords:uptranslation_] withBoolean:YES];
  }
}

- (void)compute {
  if (![self preCompute]) {
    for (jint i = 0; i < bottomPointsLength_ - [self getShift]; i++) [((GeogebraCommonGeogebra3DKernel3DGeosGeoPoint3D *) nil_chk([((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) getElementWithInt:i])) setUndefined];
    return;
  }
  if (!bottomAsInput_) [self updateOutputPoints];
}

- (GeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return GeogebraCommonKernelCommandsCommandsEnum_get_Prism();
}

- (void)updateOutput {
  id<JavaUtilCollection> faces = [((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk(polyhedron_)) getFacesCollection];
  jint top = [((id<JavaUtilCollection>) nil_chk(faces)) size];
  jint step = 1;
  for (GeogebraCommonKernelGeosGeoPolygon * __strong polygon in faces) {
    IOSObjectArray *segments = [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(polygon)) getSegments];
    if (step == 1 && !bottomAsInput_) {
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsBottom_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D *) check_class_cast(polygon, [GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D class]) withBoolean:NO];
      for (jint i = 0; i < ((IOSObjectArray *) nil_chk(segments))->size_; i++) [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsBottom_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) check_class_cast(IOSObjectArray_Get(segments, i), [GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D class]) withBoolean:NO];
      step++;
      continue;
    }
    else if (step == top) {
      [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsTop_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D *) check_class_cast(polygon, [GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D class]) withBoolean:NO];
      for (jint i = 0; i < ((IOSObjectArray *) nil_chk(segments))->size_; i++) [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsTop_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) check_class_cast(IOSObjectArray_Get(segments, i), [GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D class]) withBoolean:NO];
      step++;
      continue;
    }
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsSide_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D *) check_class_cast(polygon, [GeogebraCommonGeogebra3DKernel3DGeosGeoPolygon3D class]) withBoolean:NO];
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsSide_)) addOutputWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) check_class_cast(IOSObjectArray_Get(nil_chk([polygon getSegments]), 3), [GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D class]) withBoolean:NO];
    step++;
  }
  [self refreshOutput];
}

- (jint)getSideLengthFromLabelsLengthWithInt:(jint)length {
  if (bottomAsInput_) return (length + [self getShift] - 2) / 4;
  return (length + [self getShift] - 3) / 5;
}

- (void)updateVolumeWithDouble:(jdouble)height {
  [super updateVolumeWithDouble:height];
  [((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk([self getPolyhedron])) setVolumeWithDouble:[((GeogebraCommonKernelGeosGeoPolygon *) nil_chk([self getBottom])) getArea] * height];
}

- (void)updateDependentGeos {
  [super updateDependentGeos];
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPoints_)) update];
  if (![((GeogebraCommonGeogebra3DKernel3DGeosGeoPolyhedron *) nil_chk([self getPolyhedron])) allLabelsAreSet]) {
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsBottom_)) updateParentAlgorithm];
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsSide_)) updateParentAlgorithm];
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsTop_)) updateParentAlgorithm];
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsBottom_)) updateParentAlgorithm];
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsSide_)) updateParentAlgorithm];
    [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsTop_)) updateParentAlgorithm];
  }
}

- (void)updateOutputSegmentsAndPolygonsParentAlgorithms {
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsBottom_)) updateParentAlgorithm];
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsSide_)) updateParentAlgorithm];
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputSegmentsTop_)) updateParentAlgorithm];
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsBottom_)) updateParentAlgorithm];
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsSide_)) updateParentAlgorithm];
  [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(outputPolygonsTop_)) updateParentAlgorithm];
}

- (void)dealloc {
  RELEASE_(uptranslation_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:withNSStringArray:withGeogebraCommonKernelGeosGeoPolygon:withGeogebraCommonKernelKernelNDGeoPointND:", "AlgoPolyhedronPointsPrism", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withNSStringArray:withGeogebraCommonKernelKernelNDGeoPointNDArray:", "AlgoPolyhedronPointsPrism", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withNSStringArray:withGeogebraCommonKernelGeosGeoPolygon:withGeogebraCommonKernelArithmeticNumberValue:", "AlgoPolyhedronPointsPrism", NULL, 0x1, NULL, NULL },
    { "createPolyhedronWithGeogebraCommonKernelKernelNDGeoPointNDArray:", "createPolyhedron", "V", 0x4, NULL, NULL },
    { "getTopPointWithInt:", "getTopPoint", "Lgeogebra.common.kernel.kernelND.GeoPointND;", 0x4, NULL, NULL },
    { "updateOutputWithInt:", "updateOutput", "V", 0x4, NULL, NULL },
    { "updateTopWithInt:", "updateTop", "V", 0x2, NULL, NULL },
    { "updateSideWithInt:withGeogebraCommonKernelKernelNDGeoPointNDArray:withGeogebraCommonKernelKernelNDGeoSegmentNDArray:", "updateSide", "V", 0x2, NULL, NULL },
    { "removeBottomPointsWithInt:", "removeBottomPoints", "V", 0x4, NULL, NULL },
    { "updateOutputPoints", NULL, "V", 0x4, NULL, NULL },
    { "compute", NULL, "V", 0x1, NULL, NULL },
    { "getClassName", NULL, "Lgeogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "updateOutput", NULL, "V", 0x4, NULL, NULL },
    { "getSideLengthFromLabelsLengthWithInt:", "getSideLengthFromLabelsLength", "I", 0x4, NULL, NULL },
    { "updateVolumeWithDouble:", "updateVolume", "V", 0x4, NULL, NULL },
    { "updateDependentGeos", NULL, "V", 0x4, NULL, NULL },
    { "updateOutputSegmentsAndPolygonsParentAlgorithms", NULL, "V", 0x4, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "uptranslation_", NULL, 0x2, "Lgeogebra.common.kernel.Matrix.Coords;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism = { 2, "AlgoPolyhedronPointsPrism", "geogebra.common.geogebra3D.kernel3D.algos", NULL, 0x1, 17, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism;
}

@end

void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelKernelNDGeoPointND_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, GeogebraCommonKernelConstruction *c, IOSObjectArray *labels, GeogebraCommonKernelGeosGeoPolygon *polygon, id<GeogebraCommonKernelKernelNDGeoPointND> point) {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPoints_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelKernelNDGeoPointND_(self, c, labels, polygon, point);
}

GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *new_GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelKernelNDGeoPointND_(GeogebraCommonKernelConstruction *c, IOSObjectArray *labels, GeogebraCommonKernelGeosGeoPolygon *polygon, id<GeogebraCommonKernelKernelNDGeoPointND> point) {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self = [GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism alloc];
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelKernelNDGeoPointND_(self, c, labels, polygon, point);
  return self;
}

void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelKernelNDGeoPointNDArray_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, GeogebraCommonKernelConstruction *c, IOSObjectArray *labels, IOSObjectArray *points) {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPoints_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelKernelNDGeoPointNDArray_(self, c, labels, points);
}

GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *new_GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelKernelNDGeoPointNDArray_(GeogebraCommonKernelConstruction *c, IOSObjectArray *labels, IOSObjectArray *points) {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self = [GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism alloc];
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelKernelNDGeoPointNDArray_(self, c, labels, points);
  return self;
}

void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelArithmeticNumberValue_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, GeogebraCommonKernelConstruction *c, IOSObjectArray *labels, GeogebraCommonKernelGeosGeoPolygon *polygon, id<GeogebraCommonKernelArithmeticNumberValue> height) {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPoints_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelArithmeticNumberValue_(self, c, labels, polygon, height);
}

GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *new_GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelArithmeticNumberValue_(GeogebraCommonKernelConstruction *c, IOSObjectArray *labels, GeogebraCommonKernelGeosGeoPolygon *polygon, id<GeogebraCommonKernelArithmeticNumberValue> height) {
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self = [GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism alloc];
  GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_initWithGeogebraCommonKernelConstruction_withNSStringArray_withGeogebraCommonKernelGeosGeoPolygon_withGeogebraCommonKernelArithmeticNumberValue_(self, c, labels, polygon, height);
  return self;
}

void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateTopWithInt_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, jint n) {
  GeogebraCommonKernelGeosGeoPolygon *polygon = [self getTopFace];
  IOSObjectArray *p = [IOSObjectArray arrayWithLength:n type:GeogebraCommonKernelKernelNDGeoPointND_class_()];
  IOSObjectArray_Set(p, 0, [self getTopPoint]);
  for (jint i = 0; i < n - 1; i++) IOSObjectArray_Set(p, 1 + i, [self getTopPointWithInt:i + 1]);
  [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(polygon)) modifyInputPointsWithGeogebraCommonKernelKernelNDGeoPointNDArray:p];
  [polygon setSegmentsWithGeogebraCommonKernelKernelNDGeoSegmentNDArray:[((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(self->outputSegmentsTop_)) getOutputWithGeogebraCommonKernelGeosGeoElementArray:[IOSObjectArray arrayWithLength:n type:GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D_class_()]]];
  [polygon calcArea];
}

void GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism_updateSideWithInt_withGeogebraCommonKernelKernelNDGeoPointNDArray_withGeogebraCommonKernelKernelNDGeoSegmentNDArray_(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism *self, jint index, IOSObjectArray *bottomPoints, IOSObjectArray *bottomSegments) {
  [((GeogebraCommonGeogebra3DKernel3DGeosGeoSegment3D *) nil_chk([((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(self->outputSegmentsTop_)) getElementWithInt:index - 1])) modifyInputPointsWithGeogebraCommonKernelKernelNDGeoPointND:[self getTopPointWithInt:index - 1] withGeogebraCommonKernelKernelNDGeoPointND:[self getTopPointWithInt:index]];
  GeogebraCommonKernelGeosGeoPolygon *polygon = [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(self->outputPolygonsSide_)) getElementWithInt:index - 1];
  IOSObjectArray *p = [IOSObjectArray arrayWithLength:4 type:GeogebraCommonKernelKernelNDGeoPointND_class_()];
  IOSObjectArray_Set(p, 0, IOSObjectArray_Get(nil_chk(bottomPoints), index - 1));
  IOSObjectArray_Set(p, 1, IOSObjectArray_Get(bottomPoints, index));
  IOSObjectArray_Set(p, 2, [self getTopPointWithInt:index]);
  IOSObjectArray_Set(p, 3, [self getTopPointWithInt:index - 1]);
  [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(polygon)) modifyInputPointsWithGeogebraCommonKernelKernelNDGeoPointNDArray:p];
  IOSObjectArray *s = [IOSObjectArray arrayWithLength:4 type:GeogebraCommonKernelKernelNDGeoSegmentND_class_()];
  IOSObjectArray_Set(s, 0, IOSObjectArray_Get(nil_chk(bottomSegments), index - 1));
  IOSObjectArray_Set(s, 1, [((GeogebraCommonKernelAlgosAlgoElement_OutputHandler *) nil_chk(self->outputSegmentsSide_)) getElementWithInt:index]);
  IOSObjectArray_Set(s, 2, [self->outputSegmentsTop_ getElementWithInt:index - 1]);
  IOSObjectArray_Set(s, 3, [self->outputSegmentsSide_ getElementWithInt:index - 1]);
  [polygon setSegmentsWithGeogebraCommonKernelKernelNDGeoSegmentNDArray:s];
  [polygon calcArea];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonGeogebra3DKernel3DAlgosAlgoPolyhedronPointsPrism)
