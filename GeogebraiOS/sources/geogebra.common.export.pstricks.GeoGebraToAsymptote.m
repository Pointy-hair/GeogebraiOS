//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/export/pstricks/GeoGebraToAsymptote.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/awt/GAffineTransform.h"
#include "geogebra/common/awt/GColor.h"
#include "geogebra/common/awt/GFont.h"
#include "geogebra/common/euclidian/DrawableND.h"
#include "geogebra/common/euclidian/EuclidianView.h"
#include "geogebra/common/euclidian/draw/DrawPoint.h"
#include "geogebra/common/export/pstricks/ExportSettings.h"
#include "geogebra/common/export/pstricks/GeoGebraExport.h"
#include "geogebra/common/export/pstricks/GeoGebraToAsymptote.h"
#include "geogebra/common/export/pstricks/UnicodeTeX.h"
#include "geogebra/common/factories/AwtFactory.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/Matrix/Coords.h"
#include "geogebra/common/kernel/MyPoint.h"
#include "geogebra/common/kernel/StringTemplate.h"
#include "geogebra/common/kernel/algos/AlgoAngleLines.h"
#include "geogebra/common/kernel/algos/AlgoAnglePoints.h"
#include "geogebra/common/kernel/algos/AlgoAngleVector.h"
#include "geogebra/common/kernel/algos/AlgoAngleVectors.h"
#include "geogebra/common/kernel/algos/AlgoBoxPlot.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/algos/AlgoFunctionAreaSums.h"
#include "geogebra/common/kernel/algos/AlgoIntegralFunctions.h"
#include "geogebra/common/kernel/algos/AlgoSlope.h"
#include "geogebra/common/kernel/algos/ConstructionElement.h"
#include "geogebra/common/kernel/arithmetic/ExpressionNodeConstants.h"
#include "geogebra/common/kernel/arithmetic/Function.h"
#include "geogebra/common/kernel/arithmetic/NumberValue.h"
#include "geogebra/common/kernel/cas/AlgoIntegralDefinite.h"
#include "geogebra/common/kernel/commands/AlgebraProcessor.h"
#include "geogebra/common/kernel/geos/GeoAngle.h"
#include "geogebra/common/kernel/geos/GeoConic.h"
#include "geogebra/common/kernel/geos/GeoConicPart.h"
#include "geogebra/common/kernel/geos/GeoCurveCartesian.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoFunction.h"
#include "geogebra/common/kernel/geos/GeoLine.h"
#include "geogebra/common/kernel/geos/GeoLocus.h"
#include "geogebra/common/kernel/geos/GeoNumeric.h"
#include "geogebra/common/kernel/geos/GeoPoint.h"
#include "geogebra/common/kernel/geos/GeoPolyLine.h"
#include "geogebra/common/kernel/geos/GeoPolygon.h"
#include "geogebra/common/kernel/geos/GeoRay.h"
#include "geogebra/common/kernel/geos/GeoSegment.h"
#include "geogebra/common/kernel/geos/GeoText.h"
#include "geogebra/common/kernel/geos/GeoTransferFunction.h"
#include "geogebra/common/kernel/geos/GeoVec2D.h"
#include "geogebra/common/kernel/geos/GeoVec3D.h"
#include "geogebra/common/kernel/geos/GeoVector.h"
#include "geogebra/common/kernel/implicit/GeoImplicitPoly.h"
#include "geogebra/common/kernel/kernelND/GeoConicNDConstants.h"
#include "geogebra/common/kernel/kernelND/GeoPointND.h"
#include "geogebra/common/kernel/kernelND/GeoVectorND.h"
#include "geogebra/common/main/App.h"
#include "geogebra/common/plugin/EuclidianStyleConstants.h"
#include "geogebra/common/util/GStringTokenizer.h"
#include "geogebra/common/util/StringUtil.h"
#include "geogebra/common/util/Unicode.h"
#include "geogebra/common/util/debug/Log.h"
#include "java/lang/Character.h"
#include "java/lang/Double.h"
#include "java/lang/Float.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/NullPointerException.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/HashMap.h"
#include "java/util/Iterator.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "java/util/TreeSet.h"

@interface GeogebraCommonExportPstricksGeoGebraToAsymptote () {
 @public
  jboolean eurosym_, compact_, compactcse5_, grayscale_, dotColors_, pairName_;
  jint parabolaCount_, hyperbolaCount_, arcCount_, functionCount_, implicitFuncCount_, fillType_, fontsize_;
  JavaLangStringBuilder *codeBeginPic_, *codePointDecl_, *codeColors_, *codeEndDoc_;
  JavaUtilArrayList *pointList_;
  id<JavaUtilMap> pairNameTable_;
  id<JavaUtilMap> functionTable_, implicitPolyTable_;
  id<JavaUtilSet> usepackage_;
}

+ (void)renameFuncWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                               withNSString:(NSString *)nameFunc
                               withNSString:(NSString *)nameNew;

- (jdouble)maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f
                                                       withDouble:(jdouble)a
                                                       withDouble:(jdouble)b;

- (jdouble)firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f
                                                         withDouble:(jdouble)a
                                                         withDouble:(jdouble)b;

- (void)drawCircleWithGeogebraCommonKernelGeosGeoConic:(GeogebraCommonKernelGeosGeoConic *)geo;

- (void)initUnitAndVariable OBJC_METHOD_FAMILY_NONE;

- (void)initPointDeclarations OBJC_METHOD_FAMILY_NONE;

- (void)drawGrid;

- (void)drawAxis;

- (void)drawArrowsWithInt:(jint)axisStyle
              withBoolean:(jboolean)axisBold;

- (void)PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)geo
                                  withJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                                                 withDouble:(jdouble)dotsize;

- (void)PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)geo
                                  withJavaLangStringBuilder:(JavaLangStringBuilder *)sb;

- (NSString *)LineOptionCodeWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo
                                                       withBoolean:(jboolean)transparency;

+ (void)LinestyleCodeWithInt:(jint)linestyle
   withJavaLangStringBuilder:(JavaLangStringBuilder *)sb;

- (void)addTextWithNSString:(NSString *)st
                withBoolean:(jboolean)isLatex
                    withInt:(jint)style;

+ (NSString *)killSpaceWithNSString:(NSString *)name;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, codeBeginPic_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, codePointDecl_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, codeColors_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, codeEndDoc_, JavaLangStringBuilder *)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, pointList_, JavaUtilArrayList *)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, pairNameTable_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, functionTable_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, implicitPolyTable_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(GeogebraCommonExportPstricksGeoGebraToAsymptote, usepackage_, id<JavaUtilSet>)

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(JavaLangStringBuilder *sb, NSString *nameFunc, NSString *nameNew);

__attribute__((unused)) static jdouble GeogebraCommonExportPstricksGeoGebraToAsymptote_maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoFunction *f, jdouble a, jdouble b);

__attribute__((unused)) static jdouble GeogebraCommonExportPstricksGeoGebraToAsymptote_firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoFunction *f, jdouble a, jdouble b);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawCircleWithGeogebraCommonKernelGeosGeoConic_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoConic *geo);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_initUnitAndVariable(GeogebraCommonExportPstricksGeoGebraToAsymptote *self);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_initPointDeclarations(GeogebraCommonExportPstricksGeoGebraToAsymptote *self);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawGrid(GeogebraCommonExportPstricksGeoGebraToAsymptote *self);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawAxis(GeogebraCommonExportPstricksGeoGebraToAsymptote *self);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawArrowsWithInt_withBoolean_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, jint axisStyle, jboolean axisBold);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_withDouble_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoPoint *geo, JavaLangStringBuilder *sb, jdouble dotsize);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoPoint *geo, JavaLangStringBuilder *sb);

__attribute__((unused)) static NSString *GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoElement *geo, jboolean transparency);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_LinestyleCodeWithInt_withJavaLangStringBuilder_(jint linestyle, JavaLangStringBuilder *sb);

__attribute__((unused)) static void GeogebraCommonExportPstricksGeoGebraToAsymptote_addTextWithNSString_withBoolean_withInt_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, NSString *st, jboolean isLatex, jint style);

__attribute__((unused)) static NSString *GeogebraCommonExportPstricksGeoGebraToAsymptote_killSpaceWithNSString_(NSString *name);

@implementation GeogebraCommonExportPstricksGeoGebraToAsymptote

- (instancetype)initWithGeogebraCommonMainApp:(GeogebraCommonMainApp *)app {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initWithGeogebraCommonMainApp_(self, app);
  return self;
}

- (void)generateAllCode {
  parabolaCount_ = 0;
  hyperbolaCount_ = 0;
  arcCount_ = 0;
  functionCount_ = 0;
  implicitFuncCount_ = 0;
  fillType_ = 0;
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_usepackage_(self, new_JavaUtilTreeSet_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_importpackage_(self, new_JavaUtilTreeSet_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_pointList_(self, new_JavaUtilArrayList_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_pairNameTable_(self, new_JavaUtilHashMap_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_functionTable_(self, new_JavaUtilHashMap_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_implicitPolyTable_(self, new_JavaUtilHashMap_init());
  GeogebraCommonExportPstricksGeoGebraExport_setAndConsume_CustomColor_(self, new_JavaUtilHashMap_init());
  format__ = [((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(frame_)) getFormat];
  compact_ = ([frame_ getAsyCompact] || [frame_ getAsyCompactCse5]);
  compactcse5_ = [frame_ getAsyCompactCse5];
  fillType_ = [frame_ getFillType];
  fontsize_ = [frame_ getFontSize];
  grayscale_ = [frame_ isGrayscale];
  pairName_ = [frame_ getUsePairNames];
  dotColors_ = [frame_ getKeepDotColors];
  @try {
    xunit_ = [frame_ getXUnit];
    yunit_ = [frame_ getYUnit];
  }
  @catch (JavaLangNullPointerException *e2) {
    xunit_ = 1;
    yunit_ = 1;
  }
  GeogebraCommonExportPstricksGeoGebraExport_setAndConsume_code_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraExport_setAndConsume_codePreamble_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_codeBeginPic_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_codePointDecl_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_codeColors_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraExport_setAndConsume_codePoint_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraExport_setAndConsume_codeFilledObject_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_codeBeginPic_(self, new_JavaLangStringBuilder_init());
  GeogebraCommonExportPstricksGeoGebraToAsymptote_setAndConsume_codeEndDoc_(self, new_JavaLangStringBuilder_init());
  if (pairName_) {
    for (jint step = 0; step < [((GeogebraCommonKernelConstruction *) nil_chk(construction_)) steps]; step++) {
      IOSObjectArray *geos = [((GeogebraCommonKernelAlgosConstructionElement *) nil_chk([construction_ getConstructionElementWithInt:step])) getGeoElements];
      for (jint j = 0; j < ((IOSObjectArray *) nil_chk(geos))->size_; j++) {
        GeogebraCommonKernelGeosGeoElement *g = IOSObjectArray_Get(geos, j);
        if ([((GeogebraCommonKernelGeosGeoElement *) nil_chk(g)) isEuclidianVisible] && [g isGeoPoint]) [pointList_ addWithId:(GeogebraCommonKernelGeosGeoPoint *) check_class_cast(g, [GeogebraCommonKernelGeosGeoPoint class])];
      }
    }
  }
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initPointDeclarations(self);
  [self drawAllElements];
  if (!compact_) {
    [codePreamble_ appendWithNSString:@" /* Geogebra to Asymptote conversion, "];
    [codePreamble_ appendWithNSString:@"documentation at artofproblemsolving.com/Wiki, go to User:Azjps/geogebra */\n"];
  }
  [importpackage_ addWithId:@"graph"];
  for (NSString * __strong s in importpackage_) [codePreamble_ appendWithNSString:JreStrcat("$$$", @"import ", s, @"; ")];
  for (NSString * __strong s in usepackage_) [codePreamble_ appendWithNSString:JreStrcat("$$$", @"usepackage(\"", s, @"\"); ")];
  [codePreamble_ appendWithNSString:JreStrcat("$$$", @"size(", [self formatWithDouble:[frame_ getLatexWidth]], @"cm); ")];
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initUnitAndVariable(self);
  if ([((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) getShowGrid] && [frame_ getShowAxes]) GeogebraCommonExportPstricksGeoGebraToAsymptote_drawGrid(self);
  if (([euclidianView_ getShowXaxis] || [euclidianView_ getShowYaxis]) && [frame_ getShowAxes]) GeogebraCommonExportPstricksGeoGebraToAsymptote_drawAxis(self);
  [codeEndDoc_ appendWithNSString:@"\nclip((xmin,ymin)--(xmin,ymax)--(xmax,ymax)--(xmax,ymin)--cycle); "];
  if (![((GeogebraCommonAwtGColor *) nil_chk([euclidianView_ getBackgroundCommon])) isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) {
    if (!compact_) [codeEndDoc_ appendWithNSString:@"\n"];
    [codeEndDoc_ appendWithNSString:@"shipout(bbox("];
    [self ColorCodeWithGeogebraCommonAwtGColor:[euclidianView_ getBackgroundCommon] withJavaLangStringBuilder:codeEndDoc_];
    [codeEndDoc_ appendWithNSString:@",Fill)); "];
  }
  if ([((NSString *) nil_chk([self formatWithDouble:yunit_])) compareToWithId:[self formatWithDouble:xunit_]] != 0) {
    if (!compact_) [codeEndDoc_ appendWithNSString:@"\n /* re-scale y/x */\n"];
    [self packSpaceBetweenWithJavaLangStringBuilder:codeEndDoc_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"currentpicture", @"=", JreStrcat("$$C", @"yscale(", [self formatWithDouble:yunit_ / xunit_], ')'), @"*", @"currentpicture; " } count:5 type:NSString_class_()]];
  }
  if (!compact_) [codeEndDoc_ appendWithNSString:@"\n /* end of picture */"];
  [code_ appendWithNSString:@"\n"];
  if (!compact_) [code_ appendWithNSString:@" /* dots and labels */"];
  [code_ appendWithJavaLangCharSequence:codePoint_];
  if (!compact_) [code_ insertWithInt:0 withNSString:@" /* draw figures */"];
  [code_ insertWithInt:0 withNSString:@"\n"];
  [code_ insertWithInt:0 withJavaLangCharSequence:codeBeginPic_];
  [code_ insertWithInt:0 withJavaLangCharSequence:codeFilledObject_];
  if ([codeFilledObject_ length] != 0) [code_ insertWithInt:0 withNSString:@"\n"];
  [code_ insertWithInt:0 withJavaLangCharSequence:codePointDecl_];
  if (!compact_) [code_ insertWithInt:0 withJavaLangCharSequence:codeColors_];
  else if ([codeColors_ length] != 0) [code_ insertWithInt:0 withNSString:JreStrcat("$$$", @"\npen", [codeColors_ substringWithInt:1], @"; ")];
  [code_ insertWithInt:0 withJavaLangCharSequence:codePreamble_];
  [code_ appendWithJavaLangCharSequence:codeEndDoc_];
  [self convertUnicodeToTextWithJavaLangStringBuilder:code_];
  [frame_ writeWithJavaLangStringBuilder:code_];
}

- (void)drawLocusWithGeogebraCommonKernelGeosGeoLocus:(GeogebraCommonKernelGeosGeoLocus *)geo {
  JavaUtilArrayList *ll = [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(geo)) getPoints];
  id<JavaUtilIterator> it = [((JavaUtilArrayList *) nil_chk(ll)) iterator];
  jboolean first = YES, first2 = YES;
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@" /* locus construction */\n"];
  [self startDraw];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    GeogebraCommonKernelMyPoint *mp = [it next];
    if (((GeogebraCommonKernelMyPoint *) nil_chk(mp))->x_ > xmin_ && mp->x_ < xmax_ && mp->y_ > ymin_ && mp->y_ < ymax_) {
      NSString *x = [self formatWithDouble:mp->x_], *y = [self formatWithDouble:mp->y_];
      if (first && first2) {
        [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"("];
        first = NO;
        first2 = NO;
      }
      else if (first) {
        [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"^^("];
        first = NO;
      }
      else if (mp->lineTo_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--("];
      else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"^^("];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:JreStrcat("$C$C", x, ',', y, ')')];
    }
    else first = YES;
  }
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawBoxPlotWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  GeogebraCommonKernelAlgosAlgoBoxPlot *algo = ((GeogebraCommonKernelAlgosAlgoBoxPlot *) check_class_cast([((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) getParentAlgorithm], [GeogebraCommonKernelAlgosAlgoBoxPlot class]));
  jdouble y = [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([((GeogebraCommonKernelAlgosAlgoBoxPlot *) nil_chk(algo)) getA])) getDouble];
  jdouble height = [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getB])) getDouble];
  IOSDoubleArray *lf = [algo getLeftBorders];
  jdouble min = IOSDoubleArray_Get(nil_chk(lf), 0);
  jdouble q1 = IOSDoubleArray_Get(lf, 1);
  jdouble med = IOSDoubleArray_Get(lf, 2);
  jdouble q3 = IOSDoubleArray_Get(lf, 3);
  jdouble max = IOSDoubleArray_Get(lf, 4);
  [self drawLineWithDouble:min withDouble:y - height withDouble:min withDouble:y + height withGeogebraCommonKernelGeosGeoElement:geo];
  [self drawLineWithDouble:max withDouble:y - height withDouble:max withDouble:y + height withGeogebraCommonKernelGeosGeoElement:geo];
  [self drawLineWithDouble:med withDouble:y - height withDouble:med withDouble:y + height withGeogebraCommonKernelGeosGeoElement:geo];
  [self drawLineWithDouble:min withDouble:y withDouble:q1 withDouble:y withGeogebraCommonKernelGeosGeoElement:geo];
  [self drawLineWithDouble:q3 withDouble:y withDouble:max withDouble:y withGeogebraCommonKernelGeosGeoElement:geo];
  [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
  [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"box("];
  [self addPointWithNSString:[self formatWithDouble:q1] withNSString:[self formatWithDouble:y - height] withJavaLangStringBuilder:codeFilledObject_];
  [codeFilledObject_ appendWithNSString:@","];
  [self addPointWithNSString:[self formatWithDouble:q3] withNSString:[self formatWithDouble:y + height] withJavaLangStringBuilder:codeFilledObject_];
  [codeFilledObject_ appendWithNSString:@")"];
  [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
}

- (void)drawHistogramOrBarChartBoxWithDoubleArray:(IOSDoubleArray *)y
                                  withDoubleArray:(IOSDoubleArray *)x
                                          withInt:(jint)length
                                       withDouble:(jdouble)width
           withGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)g {
  for (jint i = 0; i < length; i++) {
    barNumber_ = i + 1;
    [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"box(("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(x), i)]];
    [codeFilledObject_ appendWithNSString:@",0),("];
    if (x->size_ == length) {
      [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, i) + width]];
    }
    else {
      [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, i + 1)]];
    }
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(y), i)]];
    [codeFilledObject_ appendWithNSString:@"))"];
    [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:g withJavaLangStringBuilder:codeFilledObject_];
  }
}

- (void)drawSumTrapezoidalWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  GeogebraCommonKernelAlgosAlgoFunctionAreaSums *algo = (GeogebraCommonKernelAlgosAlgoFunctionAreaSums *) check_class_cast([((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) getParentAlgorithm], [GeogebraCommonKernelAlgosAlgoFunctionAreaSums class]);
  jint n = [((GeogebraCommonKernelAlgosAlgoFunctionAreaSums *) nil_chk(algo)) getIntervals];
  IOSDoubleArray *y = [algo getValues];
  IOSDoubleArray *x = [algo getLeftBorder];
  for (jint i = 0; i < n; i++) {
    [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(x), i)]];
    [codeFilledObject_ appendWithNSString:@",0)--("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, i + 1)]];
    [codeFilledObject_ appendWithNSString:@",0)--("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, i + 1)]];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(y), i + 1)]];
    [codeFilledObject_ appendWithNSString:@")--("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, i)]];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(y, i)]];
    [codeFilledObject_ appendWithNSString:@")--cycle"];
    [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
  }
}

- (void)drawSumUpperLowerWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  GeogebraCommonKernelAlgosAlgoFunctionAreaSums *algo = (GeogebraCommonKernelAlgosAlgoFunctionAreaSums *) check_class_cast([((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) getParentAlgorithm], [GeogebraCommonKernelAlgosAlgoFunctionAreaSums class]);
  jint n = [((GeogebraCommonKernelAlgosAlgoFunctionAreaSums *) nil_chk(algo)) getIntervals];
  jdouble step = [algo getStep];
  IOSDoubleArray *y = [algo getValues];
  IOSDoubleArray *x = [algo getLeftBorder];
  for (jint i = 0; i < n; i++) {
    [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"box(("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(x), i)]];
    [codeFilledObject_ appendWithNSString:@",0),("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, i) + step]];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(y), i)]];
    [codeFilledObject_ appendWithNSString:@"))"];
    [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
  }
}

- (void)drawIntegralFunctionsWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  [((id<JavaUtilSet>) nil_chk(importpackage_)) addWithId:@"graph"];
  GeogebraCommonKernelAlgosAlgoIntegralFunctions *algo = (GeogebraCommonKernelAlgosAlgoIntegralFunctions *) check_class_cast([((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) getParentAlgorithm], [GeogebraCommonKernelAlgosAlgoIntegralFunctions class]);
  GeogebraCommonKernelGeosGeoFunction *f = [((GeogebraCommonKernelAlgosAlgoIntegralFunctions *) nil_chk(algo)) getF], *g = [algo getG];
  jdouble a = [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getA])) getDouble], b = [((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getB])) getDouble];
  NSString *sa = [self formatWithDouble:a], *sb = [self formatWithDouble:b];
  NSString *valueF = [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(f)) toValueStringWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]], *valueG = [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(g)) toValueStringWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]];
  valueF = [self parseFunctionWithNSString:valueF];
  valueG = [self parseFunctionWithNSString:valueG];
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"\n"];
  jint indexFunc = -1;
  NSString *tempFunctionCountF = JreStrcat("C$", 'f', JavaLangInteger_toStringWithInt_(functionCount_ + 1));
  NSString *returnCode = JreStrcat("$$$", @"(real x){return ", valueF, @";} ");
  if (compact_) {
    indexFunc = [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) indexOfWithNSString:returnCode];
    if (indexFunc != -1) {
      jint indexFuncStart = [codeFilledObject_ lastIndexOfWithNSString:@" " withInt:indexFunc];
      tempFunctionCountF = [codeFilledObject_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
    }
  }
  if (indexFunc == -1) {
    functionCount_++;
    [self packSpaceBetweenWithJavaLangStringBuilder:codeFilledObject_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$I", @"real f", functionCount_), @"(real x)", @"{", JreStrcat("$$C", @"return ", valueF, ';'), @"} " } count:5 type:NSString_class_()]];
  }
  indexFunc = -1;
  NSString *tempFunctionCountG = JreStrcat("C$", 'f', JavaLangInteger_toStringWithInt_(functionCount_ + 1));
  returnCode = JreStrcat("$$$", @"(real x){return ", valueG, @";} ");
  if (compact_) {
    indexFunc = [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) indexOfWithNSString:returnCode];
    if (indexFunc != -1) {
      jint indexFuncStart = [codeFilledObject_ lastIndexOfWithNSString:@" " withInt:indexFunc];
      tempFunctionCountG = [codeFilledObject_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
    }
  }
  if (indexFunc == -1) {
    functionCount_++;
    [self packSpaceBetweenWithJavaLangStringBuilder:codeFilledObject_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$I", @"real f", functionCount_), @"(real x)", @"{", JreStrcat("$$C", @"return ", valueG, ';'), @"} " } count:5 type:NSString_class_()]];
  }
  [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
  [self packSpaceBetweenWithJavaLangStringBuilder:codeFilledObject_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C", @"graph(", tempFunctionCountF, ','), JreStrcat("$C", sa, ','), JreStrcat("$C", sb, ')'), @"--", JreStrcat("$$C", @"graph(", tempFunctionCountG, ','), JreStrcat("$C", sb, ','), JreStrcat("$C", sa, ')'), @"--cycle" } count:8 type:NSString_class_()]];
  [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
}

- (void)drawIntegralWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  [((id<JavaUtilSet>) nil_chk(importpackage_)) addWithId:@"graph"];
  GeogebraCommonKernelCasAlgoIntegralDefinite *algo = (GeogebraCommonKernelCasAlgoIntegralDefinite *) check_class_cast([((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) getParentAlgorithm], [GeogebraCommonKernelCasAlgoIntegralDefinite class]);
  GeogebraCommonKernelGeosGeoFunction *f = [((GeogebraCommonKernelCasAlgoIntegralDefinite *) nil_chk(algo)) getFunction];
  NSString *a = [self formatWithDouble:[((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getA])) getDouble]];
  NSString *b = [self formatWithDouble:[((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getB])) getDouble]];
  if ([((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getA])) getDouble] == JavaLangDouble_NEGATIVE_INFINITY) {
    a = [self formatWithDouble:xmin_];
  }
  if ([((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getB])) getDouble] == JavaLangDouble_POSITIVE_INFINITY) {
    b = [self formatWithDouble:xmax_];
  }
  NSString *value = [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(f)) toValueStringWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]];
  value = [self parseFunctionWithNSString:value];
  if (![self isLatexFunctionWithNSString:[f toValueStringWithGeogebraCommonKernelStringTemplate:GeogebraCommonKernelStringTemplate_get_noLocalDefault_()]]) {
    jdouble af = xmin_;
    jdouble bf = xmax_;
    if ([f hasInterval]) {
      af = [f getIntervalMin];
      bf = [f getIntervalMax];
    }
    [f setIntervalWithDouble:[((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getA])) getDouble] withDouble:[((id<GeogebraCommonKernelArithmeticNumberValue>) nil_chk([algo getB])) getDouble]];
    [self drawFunctionWithGeogebraCommonKernelGeosGeoFunction:f withBoolean:YES withGeogebraCommonKernelGeosGeoNumeric:geo withBoolean:YES];
    [self drawFunctionWithGeogebraCommonKernelGeosGeoFunction:f withBoolean:YES withGeogebraCommonKernelGeosGeoNumeric:geo withBoolean:NO];
    [f setIntervalWithDouble:af withDouble:bf];
    if ([f isEuclidianVisible]) {
      [self drawFunctionWithGeogebraCommonKernelGeosGeoFunction:f withBoolean:NO withGeogebraCommonKernelGeosGeoNumeric:geo withBoolean:NO];
    }
  }
  else {
    jint indexFunc = -1;
    NSString *tempFunctionCount = JreStrcat("C$", 'f', JavaLangInteger_toStringWithInt_(functionCount_ + 1));
    NSString *returnCode = JreStrcat("$$$", @"(real x){return (", value, @");} ");
    if (compact_) {
      indexFunc = [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) indexOfWithNSString:returnCode];
      if (indexFunc != -1) {
        jint indexFuncStart = [codeFilledObject_ lastIndexOfWithNSString:@" " withInt:indexFunc];
        tempFunctionCount = [codeFilledObject_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
      }
    }
    if (indexFunc == -1) {
      functionCount_++;
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"\n"];
      [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"real f"];
      [codeFilledObject_ appendWithInt:functionCount_];
      [self packSpaceWithJavaLangStringBuilder:codeFilledObject_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real x)" } count:1 type:NSString_class_()]];
      [codeFilledObject_ appendWithNSString:@"{return "];
      [codeFilledObject_ appendWithNSString:value];
      [codeFilledObject_ appendWithNSString:@";} "];
    }
    [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"graph("];
    [codeFilledObject_ appendWithNSString:tempFunctionCount];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:a];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:b];
    [codeFilledObject_ appendWithNSString:@")--"];
    [self addPointWithNSString:b withNSString:@"0" withJavaLangStringBuilder:codeFilledObject_];
    [codeFilledObject_ appendWithNSString:@"--"];
    [self addPointWithNSString:a withNSString:@"0" withJavaLangStringBuilder:codeFilledObject_];
    [codeFilledObject_ appendWithNSString:@"--cycle"];
    [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
  }
}

- (void)drawSlopeWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  jint slopeTriangleSize = [((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) getSlopeTriangleSize];
  jdouble rwHeight = [geo getValue] * slopeTriangleSize;
  jdouble height = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) getYscale] * rwHeight;
  IOSDoubleArray *coords = [IOSDoubleArray arrayWithLength:2];
  if (JavaLangMath_absWithDouble_(height) > JavaLangFloat_MAX_VALUE) {
    return;
  }
  GeogebraCommonKernelGeosGeoLine *g = [((GeogebraCommonKernelAlgosAlgoSlope *) nil_chk(((GeogebraCommonKernelAlgosAlgoSlope *) check_class_cast([geo getParentAlgorithm], [GeogebraCommonKernelAlgosAlgoSlope class])))) getg];
  [((GeogebraCommonKernelGeosGeoLine *) nil_chk(g)) getInhomPointOnLineWithDoubleArray:coords];
  jfloat x = (jfloat) IOSDoubleArray_Get(coords, 0);
  jfloat y = (jfloat) IOSDoubleArray_Get(coords, 1);
  jfloat xright = x + slopeTriangleSize;
  [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
  [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:codeFilledObject_];
  [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"--"];
  [self addPointWithNSString:[self formatWithDouble:xright] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:codeFilledObject_];
  [codeFilledObject_ appendWithNSString:@"--"];
  [self addPointWithNSString:[self formatWithDouble:xright] withNSString:[self formatWithDouble:y + rwHeight] withJavaLangStringBuilder:codeFilledObject_];
  [codeFilledObject_ appendWithNSString:@"--cycle"];
  [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
  jfloat xLabelHor = (x + xright) / 2;
  jfloat yLabelHor = y - (jfloat) (([((GeogebraCommonAwtGFont *) nil_chk([euclidianView_ getFont])) getSize] + 2) / [euclidianView_ getYscale]);
  GeogebraCommonAwtGColor *geocolor = [geo getObjectColor];
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"\n"];
  [self packSpaceAfterWithJavaLangStringBuilder:codePoint_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$I$", @"label(\"$", slopeTriangleSize, @"$\","), JreStrcat("C$C", '(', [self formatWithDouble:xLabelHor], ','), JreStrcat("$$", [self formatWithDouble:yLabelHor], @"),"), @"NE", @"*" } count:5 type:NSString_class_()]];
  if (compact_) [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"lsf"];
  else [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"labelscalefactor"];
  if (![((GeogebraCommonAwtGColor *) nil_chk(geocolor)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) {
    [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@","];
    [self ColorCodeWithGeogebraCommonAwtGColor:geocolor withJavaLangStringBuilder:codePoint_];
  }
  [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"); "];
}

- (void)drawAngleWithGeogebraCommonKernelGeosGeoAngle:(GeogebraCommonKernelGeosGeoAngle *)geo {
  jint arcSize = [((GeogebraCommonKernelGeosGeoAngle *) nil_chk(geo)) getArcSize];
  GeogebraCommonKernelAlgosAlgoElement *algo = [geo getParentAlgorithm];
  id<GeogebraCommonKernelKernelNDGeoPointND> vertex, point;
  id<GeogebraCommonKernelKernelNDGeoVectorND> v;
  GeogebraCommonKernelGeosGeoLine *line, *line2;
  GeogebraCommonKernelGeosGeoPoint *tempPoint = [new_GeogebraCommonKernelGeosGeoPoint_initWithGeogebraCommonKernelConstruction_(construction_) autorelease];
  [tempPoint setCoordsWithDouble:0.0 withDouble:0.0 withDouble:1.0];
  IOSDoubleArray *firstVec = [IOSDoubleArray arrayWithLength:2];
  IOSDoubleArray *m = [IOSDoubleArray arrayWithLength:2];
  if ([algo isKindOfClass:[GeogebraCommonKernelAlgosAlgoAnglePoints class]]) {
    GeogebraCommonKernelAlgosAlgoAnglePoints *pa = (GeogebraCommonKernelAlgosAlgoAnglePoints *) check_class_cast(algo, [GeogebraCommonKernelAlgosAlgoAnglePoints class]);
    vertex = [((GeogebraCommonKernelAlgosAlgoAnglePoints *) nil_chk(pa)) getB];
    point = [pa getA];
    [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(vertex)) getInhomCoordsWithDoubleArray:m];
    GeogebraCommonKernelMatrixCoords *coords = [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(point)) getInhomCoordsInD3];
    *IOSDoubleArray_GetRef(firstVec, 0) = [((GeogebraCommonKernelMatrixCoords *) nil_chk(coords)) getX] - IOSDoubleArray_Get(m, 0);
    *IOSDoubleArray_GetRef(firstVec, 1) = [coords getY] - IOSDoubleArray_Get(m, 1);
  }
  else if ([algo isKindOfClass:[GeogebraCommonKernelAlgosAlgoAngleVectors class]]) {
    GeogebraCommonKernelAlgosAlgoAngleVectors *va = (GeogebraCommonKernelAlgosAlgoAngleVectors *) check_class_cast(algo, [GeogebraCommonKernelAlgosAlgoAngleVectors class]);
    v = [((GeogebraCommonKernelAlgosAlgoAngleVectors *) nil_chk(va)) getv];
    vertex = [((id<GeogebraCommonKernelKernelNDGeoVectorND>) nil_chk(v)) getStartPoint];
    if (vertex == nil) vertex = tempPoint;
    [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(vertex)) getInhomCoordsWithDoubleArray:m];
    [v getInhomCoordsWithDoubleArray:firstVec];
  }
  else if ([algo isKindOfClass:[GeogebraCommonKernelAlgosAlgoAngleLines class]]) {
    GeogebraCommonKernelAlgosAlgoAngleLines *la = (GeogebraCommonKernelAlgosAlgoAngleLines *) check_class_cast(algo, [GeogebraCommonKernelAlgosAlgoAngleLines class]);
    vertex = tempPoint;
    [((GeogebraCommonKernelAlgosAlgoAngleLines *) nil_chk(la)) updateDrawInfoWithDoubleArray:m withDoubleArray:firstVec withGeogebraCommonEuclidianDrawDrawAngle:nil];
  }
  else if ([algo isKindOfClass:[GeogebraCommonKernelAlgosAlgoAngleVector class]]) {
    GeogebraCommonKernelAlgosAlgoAngleVector *va = (GeogebraCommonKernelAlgosAlgoAngleVector *) check_class_cast(algo, [GeogebraCommonKernelAlgosAlgoAngleVector class]);
    GeogebraCommonKernelGeosGeoVec3D *vec = [((GeogebraCommonKernelAlgosAlgoAngleVector *) nil_chk(va)) getVec3D];
    if ([vec isKindOfClass:[GeogebraCommonKernelGeosGeoVector class]]) {
      v = (GeogebraCommonKernelGeosGeoVector *) check_class_cast(vec, [GeogebraCommonKernelGeosGeoVector class]);
      vertex = [((id<GeogebraCommonKernelKernelNDGeoVectorND>) nil_chk(v)) getStartPoint];
      if (vertex == nil) vertex = tempPoint;
      [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(vertex)) getInhomCoordsWithDoubleArray:m];
    }
    else if ([vec isKindOfClass:[GeogebraCommonKernelGeosGeoPoint class]]) {
      point = (GeogebraCommonKernelGeosGeoPoint *) check_class_cast(vec, [GeogebraCommonKernelGeosGeoPoint class]);
      vertex = tempPoint;
      [vertex getInhomCoordsWithDoubleArray:m];
    }
    *IOSDoubleArray_GetRef(firstVec, 0) = 1;
    *IOSDoubleArray_GetRef(firstVec, 1) = 0;
  }
  [tempPoint remove];
  jdouble angSt = JavaLangMath_atan2WithDouble_withDouble_(IOSDoubleArray_Get(firstVec, 1), IOSDoubleArray_Get(firstVec, 0));
  jdouble angExt = [geo getRawAngle];
  if (angExt > JavaLangMath_PI * 2) angExt -= JavaLangMath_PI * 2;
  if ([geo getAngleStyle] == GeogebraCommonKernelGeosGeoAngle_AngleStyleEnum_get_NOTREFLEX()) {
    if (angExt > JavaLangMath_PI) {
      angSt += angExt;
      angExt = 2.0 * JavaLangMath_PI - angExt;
    }
  }
  if ([geo getAngleStyle] == GeogebraCommonKernelGeosGeoAngle_AngleStyleEnum_get_ISREFLEX()) {
    if (angExt < JavaLangMath_PI) {
      angSt += angExt;
      angExt = 2.0 * JavaLangMath_PI - angExt;
    }
  }
  angExt += angSt;
  jdouble r = arcSize / [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) getXscale];
  [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
  if (GeogebraCommonKernelKernel_isEqualWithDouble_withDouble_([geo getValue], GeogebraCommonKernelKernel_PI_HALF) && [geo isEmphasizeRightAngle] && [euclidianView_ getRightAngleStyle] == GeogebraCommonPluginEuclidianStyleConstants_RIGHT_ANGLE_STYLE_SQUARE) {
    r = r / JavaLangMath_sqrtWithDouble_(2);
    IOSDoubleArray *x = [IOSDoubleArray arrayWithLength:8];
    *IOSDoubleArray_GetRef(x, 0) = IOSDoubleArray_Get(m, 0) + r * JavaLangMath_cosWithDouble_(angSt);
    *IOSDoubleArray_GetRef(x, 1) = IOSDoubleArray_Get(m, 1) + r * JavaLangMath_sinWithDouble_(angSt);
    *IOSDoubleArray_GetRef(x, 2) = IOSDoubleArray_Get(m, 0) + r * JavaLangMath_sqrtWithDouble_(2) * JavaLangMath_cosWithDouble_(angSt + GeogebraCommonKernelKernel_PI_HALF / 2);
    *IOSDoubleArray_GetRef(x, 3) = IOSDoubleArray_Get(m, 1) + r * JavaLangMath_sqrtWithDouble_(2) * JavaLangMath_sinWithDouble_(angSt + GeogebraCommonKernelKernel_PI_HALF / 2);
    *IOSDoubleArray_GetRef(x, 4) = IOSDoubleArray_Get(m, 0) + r * JavaLangMath_cosWithDouble_(angSt + GeogebraCommonKernelKernel_PI_HALF);
    *IOSDoubleArray_GetRef(x, 5) = IOSDoubleArray_Get(m, 1) + r * JavaLangMath_sinWithDouble_(angSt + GeogebraCommonKernelKernel_PI_HALF);
    *IOSDoubleArray_GetRef(x, 6) = IOSDoubleArray_Get(m, 0);
    *IOSDoubleArray_GetRef(x, 7) = IOSDoubleArray_Get(m, 1);
    for (jint i = 0; i < 4; i++) {
      [self addPointWithNSString:[self formatWithDouble:IOSDoubleArray_Get(x, 2 * i)] withNSString:[self formatWithDouble:IOSDoubleArray_Get(x, 2 * i + 1)] withJavaLangStringBuilder:codeFilledObject_];
      [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"--"];
    }
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"cycle"];
    [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
  }
  else {
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"arc("];
    [self addPointWithNSString:[self formatWithDouble:IOSDoubleArray_Get(m, 0)] withNSString:[self formatWithDouble:IOSDoubleArray_Get(m, 1)] withJavaLangStringBuilder:codeFilledObject_];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:r]];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(angSt)]];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(angExt)]];
    [codeFilledObject_ appendWithNSString:@")--("];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(m, 0)]];
    [codeFilledObject_ appendWithNSString:@","];
    [codeFilledObject_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(m, 1)]];
    [codeFilledObject_ appendWithNSString:@")--cycle"];
    [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
    if (GeogebraCommonKernelKernel_isEqualWithDouble_withDouble_([geo getValue], GeogebraCommonKernelKernel_PI_HALF) && [geo isEmphasizeRightAngle] && [euclidianView_ getRightAngleStyle] == GeogebraCommonPluginEuclidianStyleConstants_RIGHT_ANGLE_STYLE_DOT) {
      jdouble diameter = geo->lineThickness_ / [euclidianView_ getXscale];
      jdouble radius = arcSize / [euclidianView_ getXscale] / 1.7;
      jdouble labelAngle = (angSt + angExt) / 2.0;
      jdouble x1 = IOSDoubleArray_Get(m, 0) + radius * JavaLangMath_cosWithDouble_(labelAngle);
      jdouble x2 = IOSDoubleArray_Get(m, 1) + radius * JavaLangMath_sinWithDouble_(labelAngle);
      [self startDraw];
      if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"CR("];
      else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"circle("];
      [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:x2] withJavaLangStringBuilder:code_];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@","];
      [code_ appendWithNSString:[self formatWithDouble:diameter]];
      [code_ appendWithNSString:@")"];
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
    }
    if (geo->decorationType_ != GeogebraCommonKernelGeosGeoElement_DECORATION_NONE) {
      [self markAngleWithGeogebraCommonKernelGeosGeoAngle:geo withDouble:r withDoubleArray:m withDouble:angSt withDouble:angExt];
    }
  }
}

- (void)drawArrowArcWithGeogebraCommonKernelGeosGeoAngle:(GeogebraCommonKernelGeosGeoAngle *)geo
                                         withDoubleArray:(IOSDoubleArray *)vertex
                                              withDouble:(jdouble)angSt
                                              withDouble:(jdouble)angEnd
                                              withDouble:(jdouble)r
                                             withBoolean:(jboolean)anticlockwise {
  jdouble arrowHeight = (((GeogebraCommonKernelGeosGeoAngle *) nil_chk(geo))->lineThickness_ * 0.8 + 3) * 1.4 * 3 / 4;
  jdouble angle = JavaLangMath_asinWithDouble_(arrowHeight / 2 / [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) getXscale] / r);
  angEnd = angEnd - angle;
  [self startDraw];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"arc("];
  [self addPointWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(vertex), 0)] withNSString:[self formatWithDouble:IOSDoubleArray_Get(vertex, 1)] withJavaLangStringBuilder:code_];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:r]];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(angSt)]];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(angEnd)]];
  [code_ appendWithNSString:@")"];
  if (GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES) != nil) {
    [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    [code_ appendWithNSString:GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES)];
  }
  if (anticlockwise) [code_ appendWithNSString:@",EndArcArrow(6)"];
  else [code_ appendWithNSString:@",BeginArcArrow(6)"];
  [code_ appendWithNSString:@"); "];
}

- (void)drawArcWithGeogebraCommonKernelGeosGeoAngle:(GeogebraCommonKernelGeosGeoAngle *)geo
                                    withDoubleArray:(IOSDoubleArray *)vertex
                                         withDouble:(jdouble)angSt
                                         withDouble:(jdouble)angEnd
                                         withDouble:(jdouble)r {
  [self startDraw];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"arc("];
  [self addPointWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(vertex), 0)] withNSString:[self formatWithDouble:IOSDoubleArray_Get(vertex, 1)] withJavaLangStringBuilder:code_];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:r]];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(angSt)]];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(angEnd)]];
  [code_ appendWithNSString:@")"];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawTickWithGeogebraCommonKernelGeosGeoAngle:(GeogebraCommonKernelGeosGeoAngle *)geo
                                     withDoubleArray:(IOSDoubleArray *)vertex
                                          withDouble:(jdouble)angle {
  angle = -angle;
  jdouble radius = [((GeogebraCommonKernelGeosGeoAngle *) nil_chk(geo)) getArcSize];
  jdouble diff = 2.5 + geo->lineThickness_ / 4.0;
  jdouble x1 = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) toRealWorldCoordXWithDouble:IOSDoubleArray_Get(nil_chk(vertex), 0) + (radius - diff) * JavaLangMath_cosWithDouble_(angle)];
  jdouble x2 = [euclidianView_ toRealWorldCoordXWithDouble:IOSDoubleArray_Get(vertex, 0) + (radius + diff) * JavaLangMath_cosWithDouble_(angle)];
  jdouble y1 = [euclidianView_ toRealWorldCoordYWithDouble:IOSDoubleArray_Get(vertex, 1) + (radius - diff) * JavaLangMath_sinWithDouble_(angle) * [euclidianView_ getScaleRatio]];
  jdouble y2 = [euclidianView_ toRealWorldCoordYWithDouble:IOSDoubleArray_Get(vertex, 1) + (radius + diff) * JavaLangMath_sinWithDouble_(angle) * [euclidianView_ getScaleRatio]];
  [self startDraw];
  [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:y1] withJavaLangStringBuilder:code_];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
  [self addPointWithNSString:[self formatWithDouble:x2] withNSString:[self formatWithDouble:y2] withJavaLangStringBuilder:code_];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawSliderWithGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo {
  jboolean horizontal = [((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo)) isSliderHorizontal];
  jdouble max = [geo getIntervalMax];
  jdouble min = [geo getIntervalMin];
  jdouble value = [geo getValue];
  jdouble width = [geo getSliderWidth];
  jdouble x = [geo getSliderX];
  jdouble y = [geo getSliderY];
  if ([geo isAbsoluteScreenLocActive]) {
    x = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) toRealWorldCoordXWithDouble:x];
    y = [euclidianView_ toRealWorldCoordYWithDouble:y];
    width = horizontal ? width / [euclidianView_ getXscale] : width / [euclidianView_ getYscale];
  }
  GeogebraCommonKernelGeosGeoPoint *geoPoint = [new_GeogebraCommonKernelGeosGeoPoint_initWithGeogebraCommonKernelConstruction_(construction_) autorelease];
  [geoPoint setObjColorWithGeogebraCommonAwtGColor:[geo getObjectColor]];
  NSString *label = GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_([geo getLabelDescription], YES);
  [geoPoint setLabelWithNSString:label];
  jdouble param = (value - min) / (max - min);
  [geoPoint setPointSizeWithInt:2 + (geo->lineThickness_ + 1) / 3];
  [geoPoint setLabelVisibleWithBoolean:[geo isLabelVisible]];
  if (horizontal) [geoPoint setCoordsWithDouble:x + width * param withDouble:y withDouble:1.0];
  else [geoPoint setCoordsWithDouble:x withDouble:y + width * param withDouble:1.0];
  GeogebraCommonEuclidianDrawDrawPoint *drawPoint = [new_GeogebraCommonEuclidianDrawDrawPoint_initWithGeogebraCommonEuclidianEuclidianView_withGeogebraCommonKernelKernelNDGeoPointND_(euclidianView_, geoPoint) autorelease];
  [drawPoint setGeoElementWithGeogebraCommonKernelGeosGeoElement:geo];
  if ([geo isLabelVisible]) {
    if (horizontal) {
      drawPoint->xLabel_ -= 15;
      drawPoint->yLabel_ -= 5;
    }
    else {
      drawPoint->xLabel_ += 5;
      drawPoint->yLabel_ += 2 * [geoPoint getPointSize] + 4;
    }
  }
  [self drawGeoPointWithGeogebraCommonKernelGeosGeoPoint:geoPoint];
  [self drawLabelWithGeogebraCommonKernelGeosGeoElement:geoPoint withGeogebraCommonEuclidianDrawableND:drawPoint];
  [geoPoint remove];
  [self startDraw];
  [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:code_];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
  if (horizontal) x += width;
  else y += width;
  [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:code_];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawPolygonWithGeogebraCommonKernelGeosGeoPolygon:(GeogebraCommonKernelGeosGeoPolygon *)geo {
  IOSObjectArray *points = [((GeogebraCommonKernelGeosGeoPolygon *) nil_chk(geo)) getPoints];
  [self startTransparentFillWithJavaLangStringBuilder:codeFilledObject_];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(points))->size_; i++) {
    GeogebraCommonKernelMatrixCoords *coords = [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(IOSObjectArray_Get(points, i))) getCoordsInD2];
    jdouble x = [((GeogebraCommonKernelMatrixCoords *) nil_chk(coords)) getX], y = [coords getY], z = [coords getZ];
    x = x / z;
    y = y / z;
    [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:codeFilledObject_];
    [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"--"];
  }
  [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithNSString:@"cycle"];
  [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:codeFilledObject_];
}

- (void)drawTextWithGeogebraCommonKernelGeosGeoText:(GeogebraCommonKernelGeosGeoText *)geo {
  jboolean isLatex = [((GeogebraCommonKernelGeosGeoText *) nil_chk(geo)) isLaTeX];
  NSString *st = [geo getTextString];
  if (isLatex) st = GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_(st, YES);
  if ([((NSString *) nil_chk(st)) indexOfString:@"\u20ac"] != -1) {
    st = [st replace:@"\\u20ac" withSequence:@"\\\\euro{}"];
    if (!eurosym_) [((JavaLangStringBuilder *) nil_chk(codePreamble_)) appendWithNSString:@"usepackage(\"eurosym\"); "];
  }
  GeogebraCommonAwtGColor *geocolor = [geo getObjectColor];
  jint style = [geo getFontStyle];
  jint size = J2ObjCFpToInt(([geo getFontSizeMultiplier] * [((GeogebraCommonMainApp *) nil_chk([self getApp])) getFontSize]));
  GeogebraCommonKernelGeosGeoPoint *gp;
  jdouble x, y;
  if ([geo isAbsoluteScreenLocActive]) {
    x = [geo getAbsoluteScreenLocX];
    y = [geo getAbsoluteScreenLocY];
  }
  else {
    gp = (GeogebraCommonKernelGeosGeoPoint *) check_class_cast([geo getStartPoint], [GeogebraCommonKernelGeosGeoPoint class]);
    if (gp == nil) {
      x = J2ObjCFpToInt([((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) getXZero]);
      y = J2ObjCFpToInt([euclidianView_ getYZero]);
    }
    else {
      if (![gp isDefined]) {
        return;
      }
      x = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) toScreenCoordXWithDouble:gp->inhomX_];
      y = [euclidianView_ toScreenCoordYWithDouble:gp->inhomY_];
    }
    x += geo->labelOffsetX_;
    y += geo->labelOffsetY_;
  }
  x = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) toRealWorldCoordXWithDouble:x];
  y = [euclidianView_ toRealWorldCoordYWithDouble:y - [((GeogebraCommonAwtGFont *) nil_chk([euclidianView_ getFont])) getSize]];
  jint id_ = [((NSString *) nil_chk(st)) indexOfString:@"\n"];
  jboolean comma = NO;
  if (id_ == -1) {
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"label(\""];
    GeogebraCommonExportPstricksGeoGebraToAsymptote_addTextWithNSString_withBoolean_withInt_(self, st, isLatex, style);
    [code_ appendWithNSString:@"\","];
    [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:code_];
    [code_ appendWithNSString:@",SE*"];
    if (compact_) [code_ appendWithNSString:@"lsf"];
    else [code_ appendWithNSString:@"labelscalefactor"];
    if (![((GeogebraCommonAwtGColor *) nil_chk(geocolor)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) {
      [code_ appendWithNSString:@","];
      comma = YES;
      [self ColorCodeWithGeogebraCommonAwtGColor:geocolor withJavaLangStringBuilder:code_];
    }
    if (size != [((GeogebraCommonMainApp *) nil_chk([self getApp])) getFontSize]) {
      if (!comma) [code_ appendWithNSString:@","];
      else [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"fontsize("];
      [code_ appendWithInt:fontsize_ + (size - [((GeogebraCommonMainApp *) nil_chk([self getApp])) getFontSize])];
      [code_ appendWithNSString:@")"];
    }
    else if (compactcse5_) {
      if (!comma) [code_ appendWithNSString:@","];
      else [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"fp"];
    }
    [code_ appendWithNSString:@"); "];
  }
  else {
    JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
    GeogebraCommonUtilGStringTokenizer *stk = [new_GeogebraCommonUtilGStringTokenizer_initWithNSString_withChar_(st, 0x000a) autorelease];
    jint width = 0;
    GeogebraCommonAwtGFont *font = [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newFontWithNSString:[geo isSerifFont] ? @"Serif" : @"SansSerif" withInt:style withInt:size];
    while ([stk hasMoreTokens]) {
      NSString *line = [stk nextToken];
      width = JavaLangMath_maxWithInt_withInt_(width, J2ObjCFpToInt(JavaLangMath_ceilWithDouble_(GeogebraCommonUtilStringUtil_estimateLengthWithNSString_withGeogebraCommonAwtGFont_(line, font))));
      [sb appendWithNSString:line];
      if ([stk hasMoreTokens]) [sb appendWithNSString:@" \\\\ "];
    }
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"label(\"$"];
    [code_ appendWithNSString:@"\\parbox{"];
    [code_ appendWithNSString:[self formatWithDouble:width * (xmax_ - xmin_) * xunit_ / [euclidianView_ getWidth] + 1]];
    [code_ appendWithNSString:@" cm}{"];
    GeogebraCommonExportPstricksGeoGebraToAsymptote_addTextWithNSString_withBoolean_withInt_(self, [NSString stringWithJavaLangStringBuilder:sb], isLatex, style);
    [code_ appendWithNSString:@"}$\","];
    [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:code_];
    [code_ appendWithNSString:@",SE*"];
    if (compact_) [code_ appendWithNSString:@"lsf"];
    else [code_ appendWithNSString:@"labelscalefactor"];
    if (![((GeogebraCommonAwtGColor *) nil_chk(geocolor)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) {
      [code_ appendWithNSString:@","];
      comma = YES;
      [self ColorCodeWithGeogebraCommonAwtGColor:geocolor withJavaLangStringBuilder:code_];
    }
    if (size != [((GeogebraCommonMainApp *) nil_chk([self getApp])) getFontSize]) {
      if (!comma) [code_ appendWithNSString:@","];
      else [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"fontsize("];
      [code_ appendWithInt:fontsize_ + (size - [((GeogebraCommonMainApp *) nil_chk([self getApp])) getFontSize])];
      [code_ appendWithNSString:@")"];
    }
    else if (compactcse5_) {
      if (!comma) [code_ appendWithNSString:@","];
      else [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"fp"];
    }
    [code_ appendWithNSString:@"); "];
  }
}

- (void)drawGeoConicPartWithGeogebraCommonKernelGeosGeoConicPart:(GeogebraCommonKernelGeosGeoConicPart *)geo {
  JavaLangStringBuilder *tempsb = [new_JavaLangStringBuilder_init() autorelease];
  jdouble r1 = IOSDoubleArray_Get(nil_chk([((GeogebraCommonKernelGeosGeoConicPart *) nil_chk(geo)) getHalfAxes]), 0), r2 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 1);
  jdouble startAngle = [geo getParameterStart];
  jdouble endAngle = [geo getParameterEnd];
  id<GeogebraCommonAwtGAffineTransform> af = [geo getAffineTransform];
  jdouble m11 = [((id<GeogebraCommonAwtGAffineTransform>) nil_chk(af)) getScaleX];
  jdouble m22 = [af getScaleY];
  jdouble m12 = [af getShearX];
  jdouble m21 = [af getShearY];
  jdouble tx = [af getTranslateX];
  jdouble ty = [af getTranslateY];
  if (startAngle > endAngle) {
    startAngle -= JavaLangMath_PI * 2;
  }
  if (m11 == 1 && m22 == 1 && m12 == 0 && m21 == 0) {
    if ([geo getConicPartType] == GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_PART_SECTOR && fillType_ != GeogebraCommonExportPstricksExportSettings_FILL_NONE) [self startTransparentFillWithJavaLangStringBuilder:tempsb];
    else [self startDrawWithJavaLangStringBuilder:tempsb];
    [tempsb appendWithNSString:@"shift("];
    [self addPointWithNSString:[self formatWithDouble:tx] withNSString:[self formatWithDouble:ty] withJavaLangStringBuilder:tempsb];
    [tempsb appendWithNSString:@")*xscale("];
    [tempsb appendWithNSString:[self formatWithDouble:r1]];
    [tempsb appendWithNSString:@")*yscale("];
    [tempsb appendWithNSString:[self formatWithDouble:r2]];
    [tempsb appendWithNSString:@")*arc((0,0),1,"];
    [tempsb appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(startAngle)]];
    [tempsb appendWithNSString:@","];
    [tempsb appendWithNSString:[self formatWithDouble:JavaLangMath_toDegreesWithDouble_(endAngle)]];
    [tempsb appendWithNSString:@")"];
  }
  else {
    JavaLangStringBuilder *sb1 = [new_JavaLangStringBuilder_init() autorelease], *sb2 = [new_JavaLangStringBuilder_init() autorelease];
    [sb1 appendWithNSString:[self formatWithDouble:r1]];
    [sb1 appendWithNSString:@"*cos(t)"];
    [sb2 appendWithNSString:[self formatWithDouble:r2]];
    [sb2 appendWithNSString:@"*sin(t)"];
    arcCount_++;
    if (!compact_) [tempsb appendWithNSString:@"\n"];
    [tempsb appendWithNSString:@"pair arc"];
    [tempsb appendWithInt:arcCount_];
    [self packSpaceWithJavaLangStringBuilder:tempsb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real t)" } count:1 type:NSString_class_()]];
    [tempsb appendWithNSString:@"{return ("];
    [tempsb appendWithNSString:[self formatWithDouble:m11]];
    [tempsb appendWithNSString:@"*"];
    [tempsb appendWithJavaLangCharSequence:sb1];
    [tempsb appendWithNSString:@"+"];
    [tempsb appendWithNSString:[self formatWithDouble:m12]];
    [tempsb appendWithNSString:@"*"];
    [tempsb appendWithJavaLangCharSequence:sb2];
    [tempsb appendWithNSString:@"+"];
    [tempsb appendWithNSString:[self formatWithDouble:tx]];
    [tempsb appendWithNSString:@","];
    [tempsb appendWithNSString:[self formatWithDouble:m21]];
    [tempsb appendWithNSString:@"*"];
    [tempsb appendWithJavaLangCharSequence:sb1];
    [tempsb appendWithNSString:@"+"];
    [tempsb appendWithNSString:[self formatWithDouble:m22]];
    [tempsb appendWithNSString:@"*"];
    [tempsb appendWithJavaLangCharSequence:sb2];
    [tempsb appendWithNSString:@"+"];
    [tempsb appendWithNSString:[self formatWithDouble:ty]];
    [tempsb appendWithNSString:@");} "];
    if ([geo getConicPartType] == GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_PART_SECTOR && fillType_ != GeogebraCommonExportPstricksExportSettings_FILL_NONE) [self startTransparentFillWithJavaLangStringBuilder:tempsb];
    else [self startDrawWithJavaLangStringBuilder:tempsb];
    [tempsb appendWithNSString:@"graph(arc"];
    [tempsb appendWithInt:arcCount_];
    [tempsb appendWithNSString:@","];
    [tempsb appendWithNSString:[self formatWithDouble:startAngle]];
    [tempsb appendWithNSString:@","];
    [tempsb appendWithNSString:[self formatWithDouble:endAngle]];
    [tempsb appendWithNSString:@")"];
  }
  if ([geo getConicPartType] == GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_PART_SECTOR) {
    [tempsb appendWithNSString:@"--"];
    [self addPointWithNSString:[self formatWithDouble:tx] withNSString:[self formatWithDouble:ty] withJavaLangStringBuilder:tempsb];
    [tempsb appendWithNSString:@"--cycle"];
    if (fillType_ == GeogebraCommonExportPstricksExportSettings_FILL_NONE) [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
    else [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
  }
  else [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
  if ([geo getConicPartType] == GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_PART_SECTOR && fillType_ != GeogebraCommonExportPstricksExportSettings_FILL_NONE) [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) appendWithJavaLangCharSequence:tempsb];
  else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithJavaLangCharSequence:tempsb];
}

- (void)drawSingleCurveCartesianWithGeogebraCommonKernelGeosGeoCurveCartesian:(GeogebraCommonKernelGeosGeoCurveCartesian *)geo
                                                                  withBoolean:(jboolean)trasparency {
  [((id<JavaUtilSet>) nil_chk(importpackage_)) addWithId:@"graph"];
  jdouble start = [((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(geo)) getMinParameter], end = [geo getMaxParameter];
  NSString *fx = [self parseFunctionWithNSString:[geo getFunXWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]]];
  NSString *fy = [self parseFunctionWithNSString:[geo getFunYWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]]];
  NSString *variable = [self parseFunctionWithNSString:[geo getVarStringWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]]];
  jint indexFunc = -1;
  NSString *tempFunctionCount = JreStrcat("C$", 'f', JavaLangInteger_toStringWithInt_(functionCount_ + 1));
  NSString *returnCode = JreStrcat("$$$$C$$", @"(real ", variable, @"){return (", fx, ',', fy, @");} ");
  if (compact_) {
    indexFunc = [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) indexOfWithNSString:returnCode];
    if (indexFunc != -1) {
      jint indexFuncStart = [codeFilledObject_ lastIndexOfWithNSString:@" " withInt:indexFunc];
      tempFunctionCount = [codeFilledObject_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
    }
    else if ([((JavaLangStringBuilder *) nil_chk(code_)) indexOfWithNSString:returnCode] != -1) {
      indexFunc = [code_ indexOfWithNSString:returnCode];
      jint indexFuncStart = [code_ lastIndexOfWithNSString:@" " withInt:indexFunc];
      tempFunctionCount = [code_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
      indexFunc = [code_ indexOfWithNSString:returnCode];
    }
  }
  if (indexFunc == -1) {
    functionCount_++;
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"pair f"];
    [code_ appendWithInt:functionCount_];
    [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C", @"(real ", variable, ')') } count:1 type:NSString_class_()]];
    [code_ appendWithNSString:@"{return ("];
    [code_ appendWithNSString:fx];
    [code_ appendWithNSString:@","];
    [code_ appendWithNSString:fy];
    [code_ appendWithNSString:@");} "];
  }
  [self startDraw];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"graph("];
  [code_ appendWithNSString:tempFunctionCount];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:start]];
  [code_ appendWithNSString:@","];
  [code_ appendWithNSString:[self formatWithDouble:end]];
  [code_ appendWithNSString:@")"];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawFunctionWithGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)geo {
  [self drawFunctionWithGeogebraCommonKernelGeosGeoFunction:geo withBoolean:NO withGeogebraCommonKernelGeosGeoNumeric:nil withBoolean:NO];
}

- (void)drawFunctionWithGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)geo
                                                withBoolean:(jboolean)integral
                     withGeogebraCommonKernelGeosGeoNumeric:(GeogebraCommonKernelGeosGeoNumeric *)geo1
                                                withBoolean:(jboolean)contour {
  [((id<JavaUtilSet>) nil_chk(importpackage_)) addWithId:@"graph"];
  GeogebraCommonKernelArithmeticFunction *f = [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(geo)) getFunction];
  if (f == nil) return;
  NSString *value = [((GeogebraCommonKernelArithmeticFunction *) nil_chk(f)) toValueStringWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]];
  value = [self parseFunctionWithNSString:value];
  value = [((NSString *) nil_chk(value)) replace:@"\\\\pi" withSequence:@"pi"];
  jdouble a = xmin_;
  jdouble b = xmax_;
  if ([geo hasInterval]) {
    a = JavaLangMath_maxWithDouble_withDouble_(a, [geo getIntervalMin]);
    b = JavaLangMath_minWithDouble_withDouble_(b, [geo getIntervalMax]);
  }
  jdouble xrangemax = a, xrangemin = a;
  while (xrangemax < b) {
    xrangemin = GeogebraCommonExportPstricksGeoGebraToAsymptote_firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(self, geo, a, b);
    if (xrangemin == b) break;
    xrangemax = GeogebraCommonExportPstricksGeoGebraToAsymptote_maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(self, geo, xrangemin, b);
    jint indexFunc = -1;
    NSString *tempFunctionCount = nil;
    NSString *returnCode = nil;
    if (![self isLatexFunctionWithNSString:[f toValueStringWithGeogebraCommonKernelStringTemplate:GeogebraCommonKernelStringTemplate_get_noLocalDefault_()]]) {
      JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
      JavaLangStringBuilder *lineBuilder;
      if (integral) {
        [sb appendWithNSString:JreStrcat("$I$", @"path p", (++functionCount_), @";\n")];
        [sb appendWithNSString:JreStrcat("CIC", 'p', functionCount_, '=')];
        NSString *template_ = @"(%0,%1) -- (%2,%3) -- ";
        lineBuilder = [self drawNoLatexFunctionWithGeogebraCommonKernelGeosGeoFunction:geo withDouble:xrangemax withDouble:xrangemin withInt:400 withNSString:template_];
        [((JavaLangStringBuilder *) nil_chk(lineBuilder)) appendWithNSString:JreStrcat("C$$$$", '(', [self formatWithDouble:[geo getIntervalMax]], @",0) -- (", [self formatWithDouble:[geo getIntervalMin]], @",0) -- ")];
        JavaLangStringBuilder *color = [new_JavaLangStringBuilder_init() autorelease];
        [self ColorCodeWithGeogebraCommonAwtGColor:[((GeogebraCommonKernelGeosGeoNumeric *) nil_chk(geo1)) getObjectColor] withJavaLangStringBuilder:color];
        NSString *str = JreStrcat("$IC@", @"cycle;\ndraw(p", functionCount_, ',', color);
        if (!contour) {
          str = JreStrcat("$IC@", @"cycle;\nfill(p", functionCount_, ',', color);
          str = JreStrcat("$$", str, @"+opacity(0.05)");
        }
        [lineBuilder appendWithNSString:JreStrcat("$$", str, @");\n")];
        [sb appendWithJavaLangCharSequence:lineBuilder];
        lineBuilder = sb;
      }
      else {
        [self ColorCodeWithGeogebraCommonAwtGColor:[geo getObjectColor] withJavaLangStringBuilder:sb];
        NSString *template_ = JreStrcat("$@$I$", @"draw( (%0,%1) -- (%2,%3),", sb, @"+linewidth(", [geo getLineThickness], @"));\n");
        lineBuilder = [self drawNoLatexFunctionWithGeogebraCommonKernelGeosGeoFunction:geo withDouble:xrangemax withDouble:xrangemin withInt:400 withNSString:template_];
      }
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:JreStrcat("$$", [((JavaLangStringBuilder *) nil_chk(lineBuilder)) description], @";\n")];
    }
    else {
      tempFunctionCount = JreStrcat("C$", 'f', JavaLangInteger_toStringWithInt_(functionCount_ + 1));
      returnCode = JreStrcat("$$$", @"(real x){return ", value, @";} ");
      if (compact_) {
        indexFunc = [((JavaLangStringBuilder *) nil_chk(codeFilledObject_)) indexOfWithNSString:returnCode];
        if (indexFunc != -1) {
          jint indexFuncStart = [codeFilledObject_ lastIndexOfWithNSString:@" " withInt:indexFunc];
          tempFunctionCount = [codeFilledObject_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
        }
        else if ([((JavaLangStringBuilder *) nil_chk(code_)) indexOfWithNSString:returnCode] != -1) {
          indexFunc = [code_ indexOfWithNSString:returnCode];
          jint indexFuncStart = [code_ lastIndexOfWithNSString:@" " withInt:indexFunc];
          tempFunctionCount = [code_ substringWithInt:indexFuncStart + 1 withInt:indexFunc];
          indexFunc = [code_ indexOfWithNSString:returnCode];
        }
      }
      if (indexFunc == -1) {
        functionCount_++;
        if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
        [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"real "];
        [code_ appendWithNSString:tempFunctionCount];
        [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real x)" } count:1 type:NSString_class_()]];
        [code_ appendWithNSString:@"{return "];
        [code_ appendWithNSString:value];
        [code_ appendWithNSString:@";} "];
      }
      [self startDraw];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"graph("];
      [code_ appendWithNSString:tempFunctionCount];
      [code_ appendWithNSString:@","];
      [code_ appendWithNSString:[self formatWithDouble:xrangemin + 0.01]];
      [code_ appendWithNSString:@","];
      [code_ appendWithNSString:[self formatWithDouble:xrangemax - 0.01]];
      [code_ appendWithNSString:@")"];
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
    }
    xrangemax += PRECISION_XRANGE_FUNCTION_;
    a = xrangemax;
  }
}

+ (void)renameFuncWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                               withNSString:(NSString *)nameFunc
                               withNSString:(NSString *)nameNew {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, nameFunc, nameNew);
}

- (jdouble)maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f
                                                       withDouble:(jdouble)a
                                                       withDouble:(jdouble)b {
  return GeogebraCommonExportPstricksGeoGebraToAsymptote_maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(self, f, a, b);
}

- (jdouble)firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction:(GeogebraCommonKernelGeosGeoFunction *)f
                                                         withDouble:(jdouble)a
                                                         withDouble:(jdouble)b {
  return GeogebraCommonExportPstricksGeoGebraToAsymptote_firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(self, f, a, b);
}

- (void)drawGeoVectorWithGeogebraCommonKernelGeosGeoVector:(GeogebraCommonKernelGeosGeoVector *)geo {
  id<GeogebraCommonKernelKernelNDGeoPointND> pointStart = [((GeogebraCommonKernelGeosGeoVector *) nil_chk(geo)) getStartPoint];
  NSString *x1, *y1;
  if (pointStart == nil) {
    x1 = @"0";
    y1 = @"0";
  }
  else {
    GeogebraCommonKernelMatrixCoords *c = [pointStart getCoords];
    x1 = [self formatWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk(c)) getX] / [c getZ]];
    y1 = [self formatWithDouble:[c getY] / [c getZ]];
  }
  IOSDoubleArray *coord = [IOSDoubleArray arrayWithLength:3];
  [geo getCoordsWithDoubleArray:coord];
  NSString *x2 = [self formatWithDouble:IOSDoubleArray_Get(coord, 0) + [((GeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([((GeogebraCommonKernelKernel *) nil_chk(kernel_)) getAlgebraProcessor])) evaluateToDoubleWithNSString:x1]];
  NSString *y2 = [self formatWithDouble:IOSDoubleArray_Get(coord, 1) + [((GeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([kernel_ getAlgebraProcessor])) evaluateToDoubleWithNSString:y1]];
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
  if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"D("];
  else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"draw("];
  [self addPointWithNSString:x1 withNSString:y1 withJavaLangStringBuilder:code_];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
  [self addPointWithNSString:x2 withNSString:y2 withJavaLangStringBuilder:code_];
  if (GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES) != nil) {
    [code_ appendWithNSString:@","];
    if (!compact_) [code_ appendWithNSString:@" "];
    [code_ appendWithNSString:GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES)];
  }
  [code_ appendWithNSString:@",EndArrow(6)); "];
}

- (void)drawCircleWithGeogebraCommonKernelGeosGeoConic:(GeogebraCommonKernelGeosGeoConic *)geo {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_drawCircleWithGeogebraCommonKernelGeosGeoConic_(self, geo);
}

- (void)drawGeoConicWithGeogebraCommonKernelGeosGeoConic:(GeogebraCommonKernelGeosGeoConic *)geo {
  {
    id<GeogebraCommonAwtGAffineTransform> at;
    jdouble eigenvecX;
    jdouble eigenvecY;
    jdouble x1;
    jdouble y1;
    jdouble r1;
    jdouble r2;
    jdouble angle;
    jdouble p;
    jdouble x0;
    jint i, k2;
    switch ([((GeogebraCommonKernelGeosGeoConic *) nil_chk(geo)) getType]) {
      case GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_CIRCLE:
      GeogebraCommonExportPstricksGeoGebraToAsymptote_drawCircleWithGeogebraCommonKernelGeosGeoConic_(self, geo);
      break;
      case GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_ELLIPSE:
      at = [geo getAffineTransform];
      eigenvecX = [((id<GeogebraCommonAwtGAffineTransform>) nil_chk(at)) getScaleX];
      eigenvecY = [at getShearY];
      x1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getX];
      y1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getY];
      r1 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 0);
      r2 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 1);
      angle = JavaLangMath_toDegreesWithDouble_(JavaLangMath_atan2WithDouble_withDouble_(eigenvecY, eigenvecX));
      if (compactcse5_) if (fillInequality_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"filldraw(shift("];
      else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"D(shift("];
      else if (fillInequality_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"filldraw(shift("];
      else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"draw(shift("];
      [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:y1] withJavaLangStringBuilder:code_];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@")*rotate("];
      [code_ appendWithNSString:[self formatWithDouble:angle]];
      [code_ appendWithNSString:@")*xscale("];
      [code_ appendWithNSString:[self formatWithDouble:r1]];
      [code_ appendWithNSString:@")*yscale("];
      [code_ appendWithNSString:[self formatWithDouble:r2]];
      [code_ appendWithNSString:@")*unitcircle"];
      if (fillInequality_) {
        [code_ appendWithNSString:@",pattern(\"hatch\"),border);\n"];
      }
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
      break;
      case GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_PARABOLA:
      p = geo->p_;
      at = [geo getAffineTransform];
      eigenvecX = [((id<GeogebraCommonAwtGAffineTransform>) nil_chk(at)) getScaleX];
      eigenvecY = [at getShearY];
      x1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getX];
      y1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getY];
      x0 = JavaLangMath_maxWithDouble_withDouble_(JavaLangMath_absWithDouble_(x1 - xmin_), JavaLangMath_absWithDouble_(x1 - xmax_));
      x0 = JavaLangMath_maxWithDouble_withDouble_(x0, JavaLangMath_absWithDouble_(y1 - ymin_));
      x0 = JavaLangMath_maxWithDouble_withDouble_(x0, JavaLangMath_absWithDouble_(y1 - ymax_));
      x0 = 4 * x0 / p;
      i = 4;
      k2 = 16;
      while (k2 < x0) {
        i += 2;
        k2 = i * i;
      }
      x0 = i * p;
      angle = JavaLangMath_toDegreesWithDouble_(JavaLangMath_atan2WithDouble_withDouble_(eigenvecY, eigenvecX)) - 90;
      parabolaCount_++;
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"real p"];
      if (!compact_) [code_ appendWithNSString:@"arabola"];
      [code_ appendWithInt:parabolaCount_];
      [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real x)" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"{return x^2/2/"];
      if (compact_) [code_ appendWithNSString:[self formatWithDouble:p]];
      else [code_ appendWithDouble:p];
      [code_ appendWithNSString:@";} "];
      if (!compact_) [code_ appendWithNSString:@"\n"];
      if (compactcse5_) [code_ appendWithNSString:@"D(shift("];
      else [code_ appendWithNSString:@"draw(shift("];
      [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:y1] withJavaLangStringBuilder:code_];
      [code_ appendWithNSString:@")*rotate("];
      [code_ appendWithNSString:[self formatWithDouble:angle]];
      [code_ appendWithNSString:@")*graph(p"];
      if (!compact_) [code_ appendWithNSString:@"arabola"];
      [code_ appendWithInt:parabolaCount_];
      [code_ appendWithNSString:@","];
      [code_ appendWithNSString:[self formatWithDouble:-x0]];
      [code_ appendWithNSString:@","];
      [code_ appendWithNSString:[self formatWithDouble:x0]];
      [code_ appendWithNSString:@")"];
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
      if (!compact_) [code_ appendWithNSString:@"/* parabola construction */"];
      break;
      case GeogebraCommonKernelKernelNDGeoConicNDConstants_CONIC_HYPERBOLA:
      at = [geo getAffineTransform];
      eigenvecX = [((id<GeogebraCommonAwtGAffineTransform>) nil_chk(at)) getScaleX];
      eigenvecY = [at getShearY];
      x1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getX];
      y1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getY];
      r1 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 0);
      r2 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 1);
      angle = JavaLangMath_toDegreesWithDouble_(JavaLangMath_atan2WithDouble_withDouble_(eigenvecY, eigenvecX));
      hyperbolaCount_++;
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"pair hyperbolaLeft"];
      else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"pair hl"];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithInt:hyperbolaCount_];
      [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real t)" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"{return ("];
      [code_ appendWithNSString:[self formatWithDouble:r1]];
      [code_ appendWithNSString:@"*(1+t^2)/(1-t^2),"];
      [code_ appendWithNSString:[self formatWithDouble:r2]];
      [code_ appendWithNSString:@"*2*t/(1-t^2));} "];
      if (!compact_) [code_ appendWithNSString:@"pair hyperbolaRight"];
      else [code_ appendWithNSString:@"pair hr"];
      [code_ appendWithInt:hyperbolaCount_];
      [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real t)" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:@"{return ("];
      [code_ appendWithNSString:[self formatWithDouble:r1]];
      [code_ appendWithNSString:@"*(-1-t^2)/(1-t^2),"];
      [code_ appendWithNSString:[self formatWithDouble:r2]];
      [code_ appendWithNSString:@"*(-2)*t/(1-t^2));} "];
      if (!compact_) [code_ appendWithNSString:@"\n"];
      if (compactcse5_) [code_ appendWithNSString:@"D(shift("];
      else [code_ appendWithNSString:@"draw(shift("];
      [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:y1] withJavaLangStringBuilder:code_];
      [code_ appendWithNSString:@")*rotate("];
      [code_ appendWithNSString:[self formatWithDouble:angle]];
      if (!compact_) [code_ appendWithNSString:@")*graph(hyperbolaLeft"];
      else [code_ appendWithNSString:@")*graph(hl"];
      [code_ appendWithInt:hyperbolaCount_];
      [code_ appendWithNSString:@",-0.99,0.99)"];
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
      if (compactcse5_) [code_ appendWithNSString:@"D(shift("];
      else [code_ appendWithNSString:@"draw(shift("];
      [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:y1] withJavaLangStringBuilder:code_];
      [code_ appendWithNSString:@")*rotate("];
      [code_ appendWithNSString:[self formatWithDouble:angle]];
      if (!compact_) [code_ appendWithNSString:@")*graph(hyperbolaRight"];
      else [code_ appendWithNSString:@")*graph(hr"];
      [code_ appendWithInt:hyperbolaCount_];
      [code_ appendWithNSString:@",-0.99,0.99)"];
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
      if (!compact_) [code_ appendWithNSString:@"/* hyperbola construction */"];
      break;
    }
  }
}

- (void)drawGeoPointWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)gp {
  if ([((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(frame_)) getExportPointSymbol]) {
    jdouble x = [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(gp)) getX], y = [gp getY], z = [gp getZ];
    x = x / z;
    y = y / z;
    [gp getNameDescription];
    jint dotstyle = [gp getPointStyle];
    if (dotstyle == -1) {
      dotstyle = GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_DOT;
    }
    if (dotstyle != GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_DOT) {
      [self drawSpecialPointWithGeogebraCommonKernelGeosGeoPoint:gp];
    }
    else {
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"\n"];
      if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"D("];
      else [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"dot("];
      [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:codePoint_];
      GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_(self, gp, codePoint_);
      [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"); "];
    }
  }
}

- (void)drawSpecialPointWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)geo {
  jdouble dotsize = [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(geo)) getPointSize];
  jdouble radius = dotsize * (2.54 / 72) * ([((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(frame_)) getXUnit]);
  jint dotstyle = [geo getPointStyle];
  if (dotstyle == -1) {
    dotstyle = GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_DOT;
  }
  jdouble x = [geo getX], y = [geo getY], z = [geo getZ];
  x = x / z;
  y = y / z;
  GeogebraCommonAwtGColor *dotcolor = [geo getObjectColor];
  switch (dotstyle) {
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_CROSS:
    [self startDraw];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:JreStrcat("$$C$$", @"shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))*")];
    [code_ appendWithNSString:@"scale("];
    [code_ appendWithNSString:[self formatWithDouble:radius]];
    [code_ appendWithNSString:@")*(expi(pi/4)--expi(5*pi/4)"];
    if (compactcse5_) [code_ appendWithNSString:@"--(0,0)--"];
    else [code_ appendWithNSString:@"^^"];
    [code_ appendWithNSString:@"expi(3*pi/4)--expi(7*pi/4))"];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_CIRCLE:
    if (!compactcse5_) {
      [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"dot("];
      [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:codePoint_];
      GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_withDouble_(self, geo, codePoint_, [geo getPointSize] / 4.0);
      [codePoint_ appendWithNSString:@",UnFill(0)); "];
    }
    else {
      [self startDraw];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"CR(("];
      [code_ appendWithNSString:JreStrcat("$C$$", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"),")];
      [code_ appendWithNSString:[self formatWithDouble:radius]];
      [code_ appendWithNSString:@")"];
      [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    }
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_EMPTY_DIAMOND:
    [self startDraw];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:JreStrcat("$$C$$", @"shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))*")];
    [code_ appendWithNSString:@"scale("];
    [code_ appendWithNSString:[self formatWithDouble:radius]];
    [code_ appendWithNSString:@")*((1,0)--(0,1)--(-1,0)--(0,-1)--cycle)"];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_FILLED_DIAMOND:
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [self packSpaceBetweenWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C$$", @"fill(shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))"), @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:radius], ')'), @"*", @"((1,0)--(0,1)--(-1,0)--(0,-1)--cycle)" } count:5 type:NSString_class_()]];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_PLUS:
    [self startDraw];
    [self packSpaceBetweenWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C$$", @"shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))"), @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:radius], ')'), @"*", @"((0,1)--(0,-1)" } count:5 type:NSString_class_()]];
    if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--(0,0)--"];
    else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"^^"];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"(1,0)--(-1,0))"];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_TRIANGLE_EAST:
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [self packSpaceBetweenWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C$$", @"fill(shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))"), @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:radius], ')'), @"*", @"((1,0)--expi(2*pi/3)--expi(4*pi/3)--cycle)" } count:5 type:NSString_class_()]];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_TRIANGLE_NORTH:
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [self packSpaceBetweenWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C$$", @"fill(shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))"), @"*", @"rotate(90)", @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:radius], ')'), @"*", @"((1,0)--expi(2*pi/3)--expi(4*pi/3)--cycle)" } count:7 type:NSString_class_()]];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_TRIANGLE_SOUTH:
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [self packSpaceBetweenWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C$$", @"fill(shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))"), @"*", @"rotate(270)", @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:radius], ')'), @"*", @"((1,0)--expi(2*pi/3)--expi(4*pi/3)--cycle)" } count:7 type:NSString_class_()]];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_TRIANGLE_WEST:
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [self packSpaceBetweenWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("$$C$$", @"fill(shift((", [self formatWithDouble:x], ',', [self formatWithDouble:y], @"))"), @"*", @"rotate(180)", @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:radius], ')'), @"*", @"((1,0)--expi(2*pi/3)--expi(4*pi/3)--cycle)" } count:7 type:NSString_class_()]];
    [self endPointWithGeogebraCommonAwtGColor:dotcolor];
    break;
    default:
    break;
  }
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"/* special point */"];
}

- (void)drawGeoLineWithGeogebraCommonKernelGeosGeoLine:(GeogebraCommonKernelGeosGeoLine *)geo {
  jdouble x = [((GeogebraCommonKernelGeosGeoLine *) nil_chk(geo)) getX], y = [geo getY], z = [geo getZ];
  if (y != 0) {
    [self startDraw];
    [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(xmin," } count:1 type:NSString_class_()]];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:[self formatWithDouble:-x / y]];
    [code_ appendWithNSString:@"*xmin"];
    if (z / y < 0 || [((NSString *) nil_chk([self formatWithDouble:-z / y])) isEqual:@"0"]) [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    [code_ appendWithNSString:[self formatWithDouble:-z / y]];
    [code_ appendWithNSString:@")"];
    [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"--(xmax," } count:1 type:NSString_class_()]];
    [code_ appendWithNSString:[self formatWithDouble:-x / y]];
    [code_ appendWithNSString:@"*xmax"];
    if (z / y < 0 || [((NSString *) nil_chk([self formatWithDouble:-z / y])) isEqual:@"0"]) [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    [code_ appendWithNSString:[self formatWithDouble:-z / y]];
    [code_ appendWithNSString:@")"];
    [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
  }
  else {
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"D(("];
    else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"draw(("];
    NSString *s = [self formatWithDouble:-z / x];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:s];
    [code_ appendWithNSString:@",ymin)--("];
    [code_ appendWithNSString:s];
    [code_ appendWithNSString:@",ymax)"];
    [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
  }
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"/* line */"];
}

- (void)drawGeoSegmentWithGeogebraCommonKernelGeosGeoSegment:(GeogebraCommonKernelGeosGeoSegment *)geo {
  IOSDoubleArray *A = [IOSDoubleArray arrayWithLength:2], *B = [IOSDoubleArray arrayWithLength:2];
  GeogebraCommonKernelGeosGeoPoint *pointStart = ((GeogebraCommonKernelGeosGeoPoint *) [((GeogebraCommonKernelGeosGeoSegment *) nil_chk(geo)) getStartPoint]);
  GeogebraCommonKernelGeosGeoPoint *pointEnd = ((GeogebraCommonKernelGeosGeoPoint *) [geo getEndPoint]);
  [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(pointStart)) getInhomCoordsWithDoubleArray:A];
  [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(pointEnd)) getInhomCoordsWithDoubleArray:B];
  NSString *x1 = [self formatWithDouble:IOSDoubleArray_Get(A, 0)], *y1 = [self formatWithDouble:IOSDoubleArray_Get(A, 1)], *x2 = [self formatWithDouble:IOSDoubleArray_Get(B, 0)], *y2 = [self formatWithDouble:IOSDoubleArray_Get(B, 1)];
  jint deco = geo->decorationType_;
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
  if (!compactcse5_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"draw("];
  else [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"D("];
  [self addPointWithNSString:x1 withNSString:y1 withJavaLangStringBuilder:code_];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
  [self addPointWithNSString:x2 withNSString:y2 withJavaLangStringBuilder:code_];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
  if (deco != GeogebraCommonKernelGeosGeoElement_DECORATION_NONE) [self markWithDoubleArray:A withDoubleArray:B withInt:deco withGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawLineWithDouble:(jdouble)x1
                withDouble:(jdouble)y1
                withDouble:(jdouble)x2
                withDouble:(jdouble)y2
withGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  NSString *sx1 = [self formatWithDouble:x1];
  NSString *sy1 = [self formatWithDouble:y1];
  NSString *sx2 = [self formatWithDouble:x2];
  NSString *sy2 = [self formatWithDouble:y2];
  [self startDraw];
  [self addPointWithNSString:sx1 withNSString:sy1 withJavaLangStringBuilder:code_];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
  [self addPointWithNSString:sx2 withNSString:sy2 withJavaLangStringBuilder:code_];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawGeoRayWithGeogebraCommonKernelGeosGeoRay:(GeogebraCommonKernelGeosGeoRay *)geo {
  GeogebraCommonKernelGeosGeoPoint *pointStart = ((GeogebraCommonKernelGeosGeoPoint *) [((GeogebraCommonKernelGeosGeoRay *) nil_chk(geo)) getStartPoint]);
  jdouble x1 = [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(pointStart)) getX];
  jdouble z1 = [pointStart getZ];
  x1 = x1 / z1;
  NSString *y1 = [self formatWithDouble:[pointStart getY] / z1];
  jdouble x = [geo getX], y = [geo getY], z = [geo getZ];
  jdouble yEndpoint;
  jdouble inf = xmin_, sup = xmax_;
  if (y > 0) {
    inf = x1;
    yEndpoint = (-z - x * inf) / y;
  }
  else {
    sup = x1;
    yEndpoint = (-z - x * sup) / y;
  }
  [self startDraw];
  if (y != 0) {
    if (y > 0) {
      [self addPointWithNSString:[self formatWithDouble:inf] withNSString:[self formatWithDouble:yEndpoint] withJavaLangStringBuilder:code_];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
      [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(xmax," } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:[self formatWithDouble:-x / y]];
      [code_ appendWithNSString:@"*xmax"];
      if (z / y < 0 || [((NSString *) nil_chk([self formatWithDouble:-z / y])) isEqual:@"0"]) [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:[self formatWithDouble:-z / y]];
      [code_ appendWithNSString:@")"];
    }
    else {
      [self addPointWithNSString:[self formatWithDouble:sup] withNSString:[self formatWithDouble:yEndpoint] withJavaLangStringBuilder:code_];
      [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--"];
      [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(xmin," } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:[self formatWithDouble:-x / y]];
      [code_ appendWithNSString:@"*xmin"];
      if (z / y < 0 || [((NSString *) nil_chk([self formatWithDouble:-z / y])) isEqual:@"0"]) [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
      [code_ appendWithNSString:[self formatWithDouble:-z / y]];
      [code_ appendWithNSString:@")"];
    }
    [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
  }
  else {
    [self addPointWithNSString:[self formatWithDouble:x1] withNSString:y1 withJavaLangStringBuilder:code_];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"--("];
    [code_ appendWithNSString:[self formatWithDouble:x1]];
    [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    if (-x > 0) [code_ appendWithNSString:@"ymax"];
    else [code_ appendWithNSString:@"ymin"];
    [code_ appendWithNSString:@")"];
    [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
  }
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"/* ray */"];
}

- (void)drawImplicitPolyWithGeogebraCommonKernelImplicitGeoImplicitPoly:(GeogebraCommonKernelImplicitGeoImplicitPoly *)geo {
  [((id<JavaUtilSet>) nil_chk(importpackage_)) addWithId:@"contour"];
  NSString *polynomial = [((NSString *) nil_chk([self parseFunctionWithNSString:[self getImplicitExprWithGeogebraCommonKernelImplicitGeoImplicitPoly:geo]])) replace:@"\\\\pi" withSequence:@"pi"];
  implicitFuncCount_++;
  jint implicitFuncName = implicitFuncCount_;
  if (!compact_ || ![((id<JavaUtilMap>) nil_chk(implicitPolyTable_)) containsKeyWithId:polynomial]) {
    if (compact_) {
      if ([((id<JavaUtilMap>) nil_chk(implicitPolyTable_)) isEmpty]) [implicitPolyTable_ putWithId:polynomial withId:JavaLangInteger_valueOfWithInt_(1)];
      else {
        implicitFuncName = [implicitPolyTable_ size] + 1;
        [implicitPolyTable_ putWithId:polynomial withId:JavaLangInteger_valueOfWithInt_(implicitFuncName)];
      }
    }
    if (!compact_) [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"\n"];
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"real implicitf"];
    [code_ appendWithInt:implicitFuncName];
    [self packSpaceWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real x, real y)", @"{" } count:2 type:NSString_class_()]];
    [code_ appendWithNSString:JreStrcat("$$", @"return ", polynomial)];
    [self packSpaceAfterWithNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @";" } count:1 type:NSString_class_()]];
    [code_ appendWithNSString:@"} "];
  }
  else implicitFuncName = [((JavaLangInteger *) nil_chk([implicitPolyTable_ getWithId:polynomial])) intValue];
  [self startDraw];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"contour(implicitf"];
  [code_ appendWithInt:implicitFuncName];
  [self packSpaceBetweenWithJavaLangStringBuilder:code_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @",", @"(xmin,ymin),", @"(xmax,ymax),", @"new real[]{0},", @"500)" } count:5 type:NSString_class_()]];
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo];
}

- (void)drawPolyLineWithGeogebraCommonKernelGeosGeoPolyLine:(GeogebraCommonKernelGeosGeoPolyLine *)geo {
  IOSObjectArray *points = [((GeogebraCommonKernelGeosGeoPolyLine *) nil_chk(geo)) getPoints];
  JavaLangStringBuilder *str = [new_JavaLangStringBuilder_init() autorelease];
  [self startDrawWithJavaLangStringBuilder:str];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(points))->size_; i++) {
    GeogebraCommonKernelMatrixCoords *coords = [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(IOSObjectArray_Get(points, i))) getInhomCoords];
    jdouble x = [((GeogebraCommonKernelMatrixCoords *) nil_chk(coords)) getX], y = [coords getY];
    [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:str];
    if (i != points->size_ - 1) [str appendWithNSString:@"--"];
  }
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:str];
  NSString *s = [str description];
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  if (GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES) != nil) {
    [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    [sb appendWithNSString:GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES)];
  }
  [sb appendWithNSString:@"); "];
  JavaLangStringBuilder *sa = [new_JavaLangStringBuilder_init() autorelease];
  if (!compact_) [sa appendWithNSString:@"\n"];
  if (compactcse5_) [sa appendWithNSString:@"D("];
  else [sa appendWithNSString:@"draw("];
  s = [((NSString *) nil_chk(s)) replace:@"--\\(\\?,\\?\\)--" withSequence:JreStrcat("$$", [sb description], [sa description])];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:s];
}

- (void)initUnitAndVariable {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initUnitAndVariable(self);
}

- (void)initPointDeclarations {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initPointDeclarations(self);
}

- (void)drawLabelWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo
                  withGeogebraCommonEuclidianDrawableND:(GeogebraCommonEuclidianDrawableND *)drawGeo {
  @try {
    if ([((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isLabelVisible]) {
      NSString *name;
      if ([geo getLabelMode] == GeogebraCommonKernelGeosGeoElement_LABEL_CAPTION) {
        name = [((NSString *) nil_chk([self convertUnicodeToTextWithNSString:[geo getLabelDescription]])) replace:@"\\$" withSequence:@"dollar"];
        if ([((NSString *) nil_chk(name)) contains:@"_"]) {
          name = JreStrcat("C$C", '$', name, '$');
        }
      }
      else if (compactcse5_) {
        name = GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_([geo getLabelDescription], YES);
        name = [self convertUnicodeToLatexWithNSString:name];
      }
      else {
        name = JreStrcat("C$C", '$', GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_([geo getLabelDescription], YES), '$');
        name = [self convertUnicodeToLatexWithNSString:name];
      }
      if ([((NSString *) nil_chk(name)) indexOfString:@"\u00b0"] != -1) {
        name = [name replace:@"\u00b0" withSequence:@"^\\\\circ"];
      }
      if (drawGeo == nil) drawGeo = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) getDrawableForWithGeogebraCommonKernelGeosGeoElement:geo];
      jdouble xLabel = [((GeogebraCommonEuclidianDrawableND *) nil_chk(drawGeo)) getxLabel];
      jdouble yLabel = [drawGeo getyLabel];
      xLabel = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(euclidianView_)) toRealWorldCoordXWithDouble:JavaLangMath_roundWithDouble_(xLabel)];
      yLabel = [euclidianView_ toRealWorldCoordYWithDouble:JavaLangMath_roundWithDouble_(yLabel)];
      jboolean isPointLabel = NO;
      GeogebraCommonAwtGColor *geocolor = [geo getObjectColor];
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"\n"];
      if (compactcse5_ && [geo getLabelMode] != GeogebraCommonKernelGeosGeoElement_LABEL_CAPTION) [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"MP(\""];
      else [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:@"label(\""];
      [((JavaLangStringBuilder *) nil_chk(codePoint_)) appendWithNSString:name];
      [self packSpaceBetweenWithJavaLangStringBuilder:codePoint_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"\",", @"(" } count:2 type:NSString_class_()]];
      [codePoint_ appendWithNSString:[self formatWithDouble:xLabel]];
      [codePoint_ appendWithNSString:@","];
      [codePoint_ appendWithNSString:[self formatWithDouble:yLabel]];
      [codePoint_ appendWithNSString:@"),"];
      if (!compact_) [codePoint_ appendWithNSString:@" "];
      [codePoint_ appendWithNSString:@"NE"];
      [self packSpaceWithJavaLangStringBuilder:codePoint_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"*" } count:1 type:NSString_class_()]];
      if (compact_) [codePoint_ appendWithNSString:@"lsf"];
      if (!compact_) [codePoint_ appendWithNSString:@"labelscalefactor"];
      isPointLabel = (([((GeogebraCommonAwtGColor *) nil_chk(geocolor)) isEqual:GeogebraCommonAwtGColor_get_BLUE_()] || [self ColorEqualsWithGeogebraCommonAwtGColor:geocolor withGeogebraCommonAwtGColor:[((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:124 withInt:124 withInt:255]]) && (((((jint) [((NSString *) nil_chk(name)) length]) == 1) && JavaLangCharacter_isUpperCaseWithChar_([name charAtWithInt:0])) || (((((jint) [name length]) == 3) && [name charAtWithInt:0] == '$' && [name charAtWithInt:2] == '$' && JavaLangCharacter_isUpperCaseWithChar_([name charAtWithInt:1])))));
      isPointLabel = (isPointLabel || [geo isGeoPoint]);
      if (isPointLabel && ![((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(frame_)) getKeepDotColors]) {
      }
      else if (![geocolor isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) {
        if (compactcse5_) [codePoint_ appendWithNSString:@",fp+"];
        else [codePoint_ appendWithNSString:@","];
        [self ColorCodeWithGeogebraCommonAwtGColor:geocolor withJavaLangStringBuilder:codePoint_];
      }
      [codePoint_ appendWithNSString:@"); "];
    }
  }
  @catch (JavaLangNullPointerException *e) {
    GeogebraCommonUtilDebugLog_debugWithId_(e);
  }
}

- (jboolean)ColorEqualsWithGeogebraCommonAwtGColor:(GeogebraCommonAwtGColor *)c1
                       withGeogebraCommonAwtGColor:(GeogebraCommonAwtGColor *)c2 {
  return [((NSString *) nil_chk([self formatWithDouble:[((GeogebraCommonAwtGColor *) nil_chk(c1)) getRed] / 255.0])) isEqual:[self formatWithDouble:[((GeogebraCommonAwtGColor *) nil_chk(c2)) getRed] / 255.0]] && [((NSString *) nil_chk([self formatWithDouble:[c1 getGreen] / 255.0])) isEqual:[self formatWithDouble:[c2 getGreen] / 255.0]] && [((NSString *) nil_chk([self formatWithDouble:[c1 getBlue] / 255.0])) isEqual:[self formatWithDouble:[c2 getBlue] / 255.0]];
}

- (void)drawGrid {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_drawGrid(self);
}

- (void)drawAxis {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_drawAxis(self);
}

- (void)drawArrowsWithInt:(jint)axisStyle
              withBoolean:(jboolean)axisBold {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_drawArrowsWithInt_withBoolean_(self, axisStyle, axisBold);
}

- (void)PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)geo
                                  withJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                                                 withDouble:(jdouble)dotsize {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_withDouble_(self, geo, sb, dotsize);
}

- (void)PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint:(GeogebraCommonKernelGeosGeoPoint *)geo
                                  withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_(self, geo, sb);
}

- (NSString *)LineOptionCodeWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo
                                                       withBoolean:(jboolean)transparency {
  return GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, transparency);
}

+ (void)LinestyleCodeWithInt:(jint)linestyle
   withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_LinestyleCodeWithInt_withJavaLangStringBuilder_(linestyle, sb);
}

- (void)ColorCodeWithGeogebraCommonAwtGColor:(GeogebraCommonAwtGColor *)c
                   withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  jint red = [((GeogebraCommonAwtGColor *) nil_chk(c)) getRed], green = [c getGreen], blue = [c getBlue];
  if (grayscale_) {
    NSString *colorname = @"";
    jint grayscale = (red + green + blue) / 3;
    c = [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:grayscale withInt:grayscale withInt:grayscale];
    if ([((JavaUtilHashMap *) nil_chk(CustomColor_)) containsKeyWithId:c]) {
      colorname = [((NSString *) nil_chk([CustomColor_ getWithId:c])) description];
    }
    else {
      colorname = [self createCustomColorWithInt:grayscale withInt:grayscale withInt:grayscale];
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@"pen "];
      else [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@", "];
      [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:colorname];
      [self packSpaceWithJavaLangStringBuilder:codeColors_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"=" } count:1 type:NSString_class_()]];
      [codeColors_ appendWithNSString:JreStrcat("$$C$C$C", @"rgb(", [self formatWithDouble:grayscale / 255.0], ',', [self formatWithDouble:grayscale / 255.0], ',', [self formatWithDouble:grayscale / 255.0], ')')];
      if (!compact_) [codeColors_ appendWithNSString:@"; "];
      [CustomColor_ putWithId:c withId:colorname];
    }
    if ([((GeogebraCommonAwtGColor *) nil_chk(c)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"black"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_GRAY_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"gray"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"white"];
    else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:colorname];
  }
  else {
    if ([c isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"black"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_GRAY_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"gray"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"white"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_RED_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"red"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_GREEN_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"green"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_BLUE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"blue"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_YELLOW_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"yellow"];
    else {
      NSString *colorname = @"";
      if ([((JavaUtilHashMap *) nil_chk(CustomColor_)) containsKeyWithId:c]) {
        colorname = [((NSString *) nil_chk([CustomColor_ getWithId:c])) description];
      }
      else {
        colorname = [self createCustomColorWithInt:red withInt:green withInt:blue];
        if (!compact_) [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@"pen "];
        else [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@", "];
        [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:colorname];
        [self packSpaceWithJavaLangStringBuilder:codeColors_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"=" } count:1 type:NSString_class_()]];
        [codeColors_ appendWithNSString:JreStrcat("$$C$C$C", @"rgb(", [self formatWithDouble:red / 255.0], ',', [self formatWithDouble:green / 255.0], ',', [self formatWithDouble:blue / 255.0], ')')];
        if (!compact_) [codeColors_ appendWithNSString:@"; "];
        [CustomColor_ putWithId:c withId:colorname];
      }
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:colorname];
    }
  }
}

- (void)ColorLightCodeWithGeogebraCommonAwtGColor:(GeogebraCommonAwtGColor *)c
                                       withDouble:(jdouble)opacity
                        withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  GeogebraCommonAwtGColor *tempc;
  jint red = [((GeogebraCommonAwtGColor *) nil_chk(c)) getRed], green = [c getGreen], blue = [c getBlue];
  red = J2ObjCFpToInt((255 * (1 - opacity) + red * opacity));
  green = J2ObjCFpToInt((255 * (1 - opacity) + green * opacity));
  blue = J2ObjCFpToInt((255 * (1 - opacity) + blue * opacity));
  if (grayscale_) {
    NSString *colorname = @"";
    jint grayscale = (red + green + blue) / 3;
    tempc = [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:grayscale withInt:grayscale withInt:grayscale];
    if ([((JavaUtilHashMap *) nil_chk(CustomColor_)) containsKeyWithId:tempc]) {
      colorname = [((NSString *) nil_chk([CustomColor_ getWithId:tempc])) description];
    }
    else {
      colorname = [self createCustomColorWithInt:grayscale withInt:grayscale withInt:grayscale];
      if (!compact_) [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@"pen "];
      else [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@", "];
      [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:colorname];
      [self packSpaceWithJavaLangStringBuilder:codeColors_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"=" } count:1 type:NSString_class_()]];
      [codeColors_ appendWithNSString:JreStrcat("$$C$C$C", @"rgb(", [self formatWithDouble:grayscale / 255.0], ',', [self formatWithDouble:grayscale / 255.0], ',', [self formatWithDouble:grayscale / 255.0], ')')];
      if (!compact_) [codeColors_ appendWithNSString:@"; "];
      [CustomColor_ putWithId:tempc withId:colorname];
    }
    if ([((GeogebraCommonAwtGColor *) nil_chk(tempc)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"black"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_GRAY_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"gray"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"white"];
    else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:colorname];
  }
  else {
    tempc = [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:red withInt:green withInt:blue];
    if ([((GeogebraCommonAwtGColor *) nil_chk(tempc)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"black"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_GRAY_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"gray"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"white"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_RED_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"red"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_GREEN_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"green"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_BLUE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"blue"];
    else if ([tempc isEqual:GeogebraCommonAwtGColor_get_YELLOW_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"yellow"];
    else {
      NSString *colorname = @"";
      if ([((JavaUtilHashMap *) nil_chk(CustomColor_)) containsKeyWithId:tempc]) {
        colorname = [((NSString *) nil_chk([CustomColor_ getWithId:tempc])) description];
      }
      else {
        colorname = [self createCustomColorWithInt:red withInt:green withInt:blue];
        if (!compact_) [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@"pen "];
        else [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:@", "];
        [((JavaLangStringBuilder *) nil_chk(codeColors_)) appendWithNSString:colorname];
        [self packSpaceWithJavaLangStringBuilder:codeColors_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"=" } count:1 type:NSString_class_()]];
        [codeColors_ appendWithNSString:JreStrcat("$$C$C$C", @"rgb(", [self formatWithDouble:red / 255.0], ',', [self formatWithDouble:green / 255.0], ',', [self formatWithDouble:blue / 255.0], ')')];
        if (!compact_) [codeColors_ appendWithNSString:@"; "];
        [CustomColor_ putWithId:tempc withId:colorname];
      }
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:colorname];
    }
  }
}

- (void)ColorCode2WithGeogebraCommonAwtGColor:(GeogebraCommonAwtGColor *)c
                    withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  jint red = [((GeogebraCommonAwtGColor *) nil_chk(c)) getRed], green = [c getGreen], blue = [c getBlue];
  if (grayscale_) {
    jint grayscale = (red + green + blue) / 3;
    c = [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:grayscale withInt:grayscale withInt:grayscale];
    [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:JreStrcat("$$C$C$C", @"\\color[rgb]{", [self formatWithDouble:grayscale / 255.0], ',', [self formatWithDouble:grayscale / 255.0], ',', [self formatWithDouble:grayscale / 255.0], '}')];
    if ([((GeogebraCommonAwtGColor *) nil_chk(c)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) [sb appendWithNSString:@"black"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_GRAY_()]) [sb appendWithNSString:@"gray"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) [sb appendWithNSString:@"white"];
  }
  else {
    if ([c isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"black"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_GRAY_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"gray"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_WHITE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"white"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_RED_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"red"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_GREEN_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"green"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_BLUE_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"blue"];
    else if ([c isEqual:GeogebraCommonAwtGColor_get_YELLOW_()]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"yellow"];
    else {
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:JreStrcat("$$C$C$C", @"\\color[rgb]{", [self formatWithDouble:red / 255.0], ',', [self formatWithDouble:green / 255.0], ',', [self formatWithDouble:blue / 255.0], '}')];
    }
  }
}

- (void)addTextWithNSString:(NSString *)st
                withBoolean:(jboolean)isLatex
                    withInt:(jint)style {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_addTextWithNSString_withBoolean_withInt_(self, st, isLatex, style);
}

- (void)packSpaceBetweenWithNSStringArray:(IOSObjectArray *)s {
  [self packSpaceBetweenWithJavaLangStringBuilder:code_ withNSStringArray:s];
}

- (void)packSpaceBetweenWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                                withNSStringArray:(IOSObjectArray *)s {
  [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:IOSObjectArray_Get(nil_chk(s), 0)];
  for (jint i = 1; i < s->size_; i++) {
    if (!compact_) [sb appendWithNSString:JreStrcat("C$", ' ', IOSObjectArray_Get(s, i))];
    else [sb appendWithNSString:IOSObjectArray_Get(s, i)];
  }
}

- (void)packSpaceAfterWithNSStringArray:(IOSObjectArray *)s {
  [self packSpaceAfterWithJavaLangStringBuilder:code_ withNSStringArray:s];
}

- (void)packSpaceAfterWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                              withNSStringArray:(IOSObjectArray *)s {
  [self packSpaceBetweenWithJavaLangStringBuilder:sb withNSStringArray:s];
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@" "];
}

- (void)packSpaceWithNSStringArray:(IOSObjectArray *)s {
  [self packSpaceWithJavaLangStringBuilder:code_ withNSStringArray:s];
}

- (void)packSpaceWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb
                         withNSStringArray:(IOSObjectArray *)s {
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@" "];
  [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:s];
}

- (void)startDraw {
  [self startDrawWithJavaLangStringBuilder:code_];
}

- (void)startDrawWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"\n"];
  if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"D("];
  else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"draw("];
}

- (void)endDrawWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:code_];
}

- (void)endDrawWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo
                            withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  if (fillInequality_) return;
  if (GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES) != nil) {
    [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES)];
  }
  [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"); "];
}

- (void)startTransparentFillWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  if (!compact_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"\n"];
  if (fillType_ != GeogebraCommonExportPstricksExportSettings_FILL_NONE) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"filldraw("];
  else if (compactcse5_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"D("];
  else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"draw("];
}

- (void)endTransparentFillWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo
                                       withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  GeogebraCommonExportPstricksGeoGebraExport_Info *info = [new_GeogebraCommonExportPstricksGeoGebraExport_Info_initWithGeogebraCommonExportPstricksGeoGebraExport_withGeogebraCommonKernelGeosGeoElement_(self, geo) autorelease];
  if (fillType_ == GeogebraCommonExportPstricksExportSettings_FILL_OPAQUE) {
    [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    if ([info getAlpha] >= 0.9) [self ColorCodeWithGeogebraCommonAwtGColor:[info getLinecolor] withJavaLangStringBuilder:sb];
    else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"invisible"];
  }
  else if (fillType_ == GeogebraCommonExportPstricksExportSettings_FILL_OPACITY_PEN) {
    [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    [self ColorCodeWithGeogebraCommonAwtGColor:[info getLinecolor] withJavaLangStringBuilder:sb];
    [self packSpaceWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"opacity("];
    [sb appendWithFloat:[info getAlpha]];
    [sb appendWithNSString:@")"];
  }
  else if (fillType_ == GeogebraCommonExportPstricksExportSettings_FILL_LAYER) {
    [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    [self ColorLightCodeWithGeogebraCommonAwtGColor:[info getLinecolor] withDouble:[info getAlpha] withJavaLangStringBuilder:sb];
  }
  if (GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES) != nil) {
    [self packSpaceAfterWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, geo, YES)];
  }
  [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"); "];
}

- (void)endPointWithGeogebraCommonAwtGColor:(GeogebraCommonAwtGColor *)c {
  if (![((GeogebraCommonAwtGColor *) nil_chk(c)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()] && dotColors_) {
    [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@","];
    if (!compact_) [code_ appendWithNSString:@" "];
    [self ColorCodeWithGeogebraCommonAwtGColor:c withJavaLangStringBuilder:code_];
  }
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:@"); "];
}

- (void)addPointWithNSString:(NSString *)s1
                withNSString:(NSString *)s2
   withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  NSString *pairString = JreStrcat("C$C$C", '(', s1, ',', s2, ')');
  if (pairName_ && [((id<JavaUtilMap>) nil_chk(pairNameTable_)) containsKeyWithId:pairString]) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:[pairNameTable_ getWithId:pairString]];
  else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:pairString];
}

- (void)addPointWithDouble:(jdouble)x
                withDouble:(jdouble)y
 withJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:sb];
}

- (JavaLangStringBuilder *)convertUnicodeToTextWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  NSString *tempc = [((JavaLangStringBuilder *) nil_chk(sb)) description];
  tempc = [self convertUnicodeToTextWithNSString:tempc];
  [sb delete__WithInt:0 withInt:[sb length]];
  [sb appendWithNSString:tempc];
  return sb;
}

- (NSString *)convertUnicodeToTextWithNSString:(NSString *)s {
  NSString *s1 = [NSString stringWithString:s];
  id<JavaUtilIterator> it = [((id<JavaUtilSet>) nil_chk([((JavaUtilHashMap *) nil_chk(GeogebraCommonExportPstricksUnicodeTeX_getMap())) keySet])) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    NSString *skey = [it next];
    s1 = [s1 replace:skey withSequence:JreStrcat("$C", [((JavaUtilHashMap *) nil_chk(GeogebraCommonExportPstricksUnicodeTeX_getMap())) getWithId:skey], ' ')];
  }
  return [((NSString *) nil_chk([((NSString *) nil_chk([((NSString *) nil_chk([((NSString *) nil_chk([((NSString *) nil_chk(s1)) replace:@"\u00b0" withSequence:@"o "])) replace:@"\u212f" withSequence:@"e "])) replace:@"\u00b2" withSequence:@"2 "])) replace:@"\u00b3" withSequence:@"3 "])) replace:@"pi \\)" withSequence:@"pi\\)"];
}

- (NSString *)convertUnicodeToLatexWithNSString:(NSString *)s {
  NSString *s1 = [NSString stringWithString:s];
  id<JavaUtilIterator> it = [((id<JavaUtilSet>) nil_chk([((JavaUtilHashMap *) nil_chk(GeogebraCommonExportPstricksUnicodeTeX_getMap())) keySet])) iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    NSString *skey = [it next];
    s1 = [s1 replace:skey withSequence:JreStrcat("$$C", @"\\\\", [((JavaUtilHashMap *) nil_chk(GeogebraCommonExportPstricksUnicodeTeX_getMap())) getWithId:skey], ' ')];
  }
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  [sb appendWithChar:[((NSString *) nil_chk(s1)) charAtWithInt:0]];
  for (jint i = 1; i < ((jint) [s1 length]) - 1; i++) {
    if ([s1 charAtWithInt:i - 1] == '\\' && (i == 1 || [s1 charAtWithInt:i - 2] != '\\')) {
      [sb appendWithChar:[s1 charAtWithInt:i]];
      continue;
    }
    else if ([s1 charAtWithInt:i] == '$') [sb appendWithNSString:@"\\$"];
    else [sb appendWithChar:[s1 charAtWithInt:i]];
  }
  if (((jint) [s1 length]) > 1) [sb appendWithChar:[s1 charAtWithInt:((jint) [s1 length]) - 1]];
  s1 = [sb description];
  return [((NSString *) nil_chk([((NSString *) nil_chk([((NSString *) nil_chk([((NSString *) nil_chk([((NSString *) nil_chk(s1)) replace:@"\u00b0" withSequence:@"^\\\\circ"])) replace:@"\u212f" withSequence:@" e"])) replace:@"\u00b2" withSequence:@"^2"])) replace:@"\u00b3" withSequence:@"^3"])) replace:@"\\\\questeq" withSequence:@"\\\\stackrel{?}{=}"];
}

- (NSString *)parseFunctionWithNSString:(NSString *)s {
  return GeogebraCommonExportPstricksGeoGebraToAsymptote_killSpaceWithNSString_(GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_(s, YES));
}

+ (NSString *)killSpaceWithNSString:(NSString *)name {
  return GeogebraCommonExportPstricksGeoGebraToAsymptote_killSpaceWithNSString_(name);
}

- (GeogebraCommonKernelStringTemplate *)getStringTemplate {
  return GeogebraCommonKernelStringTemplate_fullFiguresWithGeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_(GeogebraCommonKernelArithmeticExpressionNodeConstants_StringTypeEnum_get_PSTRICKS());
}

- (NSString *)penStyleWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  switch ([((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) getLineType]) {
    case GeogebraCommonPluginEuclidianStyleConstants_DEFAULT_LINE_TYPE:
    [sb appendWithNSString:@"solid+"];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DASHED_LONG:
    [sb appendWithNSString:@"longdashed+"];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DASHED_SHORT:
    [sb appendWithNSString:@"dashed+"];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DASHED_DOTTED:
    [sb appendWithNSString:@"dashdotted+"];
    break;
    case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DOTTED:
    [sb appendWithNSString:@"Dotted+"];
    break;
  }
  return [sb description];
}

- (jboolean)isLatexFunctionWithNSString:(NSString *)s {
  return ![((NSString *) nil_chk([((NSString *) nil_chk(s)) lowercaseString])) contains:@"csc("] && ![((NSString *) nil_chk([s lowercaseString])) contains:@"csch("] && ![((NSString *) nil_chk([s lowercaseString])) contains:@"sec("] && ![((NSString *) nil_chk([s lowercaseString])) contains:@"cot("] && ![((NSString *) nil_chk([s lowercaseString])) contains:@"coth("] && ![((NSString *) nil_chk([s lowercaseString])) contains:@"sech("] && ![((NSString *) nil_chk([s lowercaseString])) contains:@"if"];
}

- (void)drawNyquistWithGeogebraCommonKernelGeosGeoTransferFunction:(GeogebraCommonKernelGeosGeoTransferFunction *)g {
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  [self ColorCodeWithGeogebraCommonAwtGColor:[((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(g)) getObjectColor] withJavaLangStringBuilder:sb];
  NSString *template_ = JreStrcat("$@$", @"draw( (%0,%1) -- (%2,%3),", sb, @"+linewidth(1)\u00a7,arrows\u00a7);\n");
  JavaLangStringBuilder *lineBuilder = [self drawNyquistDiagramWithGeogebraCommonKernelGeosGeoTransferFunction:g withNSString:template_ withNSString:@"\u00a7,arrows\u00a7" withNSString:@",BeginArrow" withNSString:@",EndArrow"];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithNSString:JreStrcat("$$", [((JavaLangStringBuilder *) nil_chk(lineBuilder)) description], @";\n")];
}

- (NSString *)formatWithDouble:(jdouble)d {
  return [((NSString *) nil_chk([super formatWithDouble:d])) replace:@"E" withSequence:@"e"];
}

- (jboolean)fillSplineWithGeogebraCommonKernelGeosGeoCurveCartesianArray:(IOSObjectArray *)curves {
  if ([((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(nil_chk(curves), 0))) getAlphaValue] == 0 && GeogebraCommonKernelGeosGeoElement_FillTypeEnum_get_STANDARD() == [((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, 0))) getFillType]) {
    return NO;
  }
  NSString *liopco = GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(self, IOSObjectArray_Get(curves, 0), YES);
  if (liopco == nil) {
    liopco = @"";
  }
  else {
    liopco = JreStrcat("C$", ',', liopco);
  }
  for (jint i = 0; i < curves->size_; i++) {
    [self drawSingleCurveCartesianWithGeogebraCommonKernelGeosGeoCurveCartesian:IOSObjectArray_Get(curves, i) withBoolean:NO];
  }
  JavaLangStringBuilder *fill = [new_JavaLangStringBuilder_init() autorelease];
  [fill appendWithNSString:@"\nfill("];
  jdouble p;
  jdouble y;
  jdouble x;
  for (jint i = 0; i < curves->size_; i++) {
    p = [((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getMinParameter];
    y = [((GeogebraCommonKernelArithmeticFunction *) nil_chk([((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getFunY])) evaluateWithDouble:[((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getMinParameter]];
    if (JavaLangMath_absWithDouble_(y) < 0.001) y = 0;
    jdouble step = ([((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getMaxParameter] - [((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getMinParameter]) / 200;
    for (; p <= [((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getMaxParameter]; p += step) {
      y = [((GeogebraCommonKernelArithmeticFunction *) nil_chk([((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getFunY])) evaluateWithDouble:p];
      x = [((GeogebraCommonKernelArithmeticFunction *) nil_chk([((GeogebraCommonKernelGeosGeoCurveCartesian *) nil_chk(IOSObjectArray_Get(curves, i))) getFunX])) evaluateWithDouble:p];
      if (JavaLangMath_absWithDouble_(y) < 0.001) y = 0;
      if (JavaLangMath_absWithDouble_(x) < 0.001) x = 0;
      [fill appendWithNSString:JreStrcat("CDCD$", '(', x, ',', y, @") -- ")];
    }
  }
  [fill appendWithNSString:JreStrcat("$$$", @"cycle", liopco, @");")];
  [((JavaLangStringBuilder *) nil_chk(code_)) appendWithJavaLangCharSequence:fill];
  return YES;
}

- (void)dealloc {
  RELEASE_(codeBeginPic_);
  RELEASE_(codePointDecl_);
  RELEASE_(codeColors_);
  RELEASE_(codeEndDoc_);
  RELEASE_(pointList_);
  RELEASE_(pairNameTable_);
  RELEASE_(functionTable_);
  RELEASE_(implicitPolyTable_);
  RELEASE_(usepackage_);
  RELEASE_(importpackage_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonMainApp:", "GeoGebraToAsymptote", NULL, 0x1, NULL, NULL },
    { "generateAllCode", NULL, "V", 0x1, NULL, NULL },
    { "drawLocusWithGeogebraCommonKernelGeosGeoLocus:", "drawLocus", "V", 0x4, NULL, NULL },
    { "drawBoxPlotWithGeogebraCommonKernelGeosGeoNumeric:", "drawBoxPlot", "V", 0x4, NULL, NULL },
    { "drawHistogramOrBarChartBoxWithDoubleArray:withDoubleArray:withInt:withDouble:withGeogebraCommonKernelGeosGeoNumeric:", "drawHistogramOrBarChartBox", "V", 0x4, NULL, NULL },
    { "drawSumTrapezoidalWithGeogebraCommonKernelGeosGeoNumeric:", "drawSumTrapezoidal", "V", 0x4, NULL, NULL },
    { "drawSumUpperLowerWithGeogebraCommonKernelGeosGeoNumeric:", "drawSumUpperLower", "V", 0x4, NULL, NULL },
    { "drawIntegralFunctionsWithGeogebraCommonKernelGeosGeoNumeric:", "drawIntegralFunctions", "V", 0x4, NULL, NULL },
    { "drawIntegralWithGeogebraCommonKernelGeosGeoNumeric:", "drawIntegral", "V", 0x4, NULL, NULL },
    { "drawSlopeWithGeogebraCommonKernelGeosGeoNumeric:", "drawSlope", "V", 0x4, NULL, NULL },
    { "drawAngleWithGeogebraCommonKernelGeosGeoAngle:", "drawAngle", "V", 0x4, NULL, NULL },
    { "drawArrowArcWithGeogebraCommonKernelGeosGeoAngle:withDoubleArray:withDouble:withDouble:withDouble:withBoolean:", "drawArrowArc", "V", 0x4, NULL, NULL },
    { "drawArcWithGeogebraCommonKernelGeosGeoAngle:withDoubleArray:withDouble:withDouble:withDouble:", "drawArc", "V", 0x4, NULL, NULL },
    { "drawTickWithGeogebraCommonKernelGeosGeoAngle:withDoubleArray:withDouble:", "drawTick", "V", 0x4, NULL, NULL },
    { "drawSliderWithGeogebraCommonKernelGeosGeoNumeric:", "drawSlider", "V", 0x4, NULL, NULL },
    { "drawPolygonWithGeogebraCommonKernelGeosGeoPolygon:", "drawPolygon", "V", 0x4, NULL, NULL },
    { "drawTextWithGeogebraCommonKernelGeosGeoText:", "drawText", "V", 0x4, NULL, NULL },
    { "drawGeoConicPartWithGeogebraCommonKernelGeosGeoConicPart:", "drawGeoConicPart", "V", 0x4, NULL, NULL },
    { "drawSingleCurveCartesianWithGeogebraCommonKernelGeosGeoCurveCartesian:withBoolean:", "drawSingleCurveCartesian", "V", 0x4, NULL, NULL },
    { "drawFunctionWithGeogebraCommonKernelGeosGeoFunction:", "drawFunction", "V", 0x4, NULL, NULL },
    { "drawFunctionWithGeogebraCommonKernelGeosGeoFunction:withBoolean:withGeogebraCommonKernelGeosGeoNumeric:withBoolean:", "drawFunction", "V", 0x4, NULL, NULL },
    { "renameFuncWithJavaLangStringBuilder:withNSString:withNSString:", "renameFunc", "V", 0xa, NULL, NULL },
    { "maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction:withDouble:withDouble:", "maxDefinedValue", "D", 0x2, NULL, NULL },
    { "firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction:withDouble:withDouble:", "firstDefinedValue", "D", 0x2, NULL, NULL },
    { "drawGeoVectorWithGeogebraCommonKernelGeosGeoVector:", "drawGeoVector", "V", 0x4, NULL, NULL },
    { "drawCircleWithGeogebraCommonKernelGeosGeoConic:", "drawCircle", "V", 0x2, NULL, NULL },
    { "drawGeoConicWithGeogebraCommonKernelGeosGeoConic:", "drawGeoConic", "V", 0x4, NULL, NULL },
    { "drawGeoPointWithGeogebraCommonKernelGeosGeoPoint:", "drawGeoPoint", "V", 0x4, NULL, NULL },
    { "drawSpecialPointWithGeogebraCommonKernelGeosGeoPoint:", "drawSpecialPoint", "V", 0x4, NULL, NULL },
    { "drawGeoLineWithGeogebraCommonKernelGeosGeoLine:", "drawGeoLine", "V", 0x4, NULL, NULL },
    { "drawGeoSegmentWithGeogebraCommonKernelGeosGeoSegment:", "drawGeoSegment", "V", 0x4, NULL, NULL },
    { "drawLineWithDouble:withDouble:withDouble:withDouble:withGeogebraCommonKernelGeosGeoElement:", "drawLine", "V", 0x4, NULL, NULL },
    { "drawGeoRayWithGeogebraCommonKernelGeosGeoRay:", "drawGeoRay", "V", 0x4, NULL, NULL },
    { "drawImplicitPolyWithGeogebraCommonKernelImplicitGeoImplicitPoly:", "drawImplicitPoly", "V", 0x4, NULL, NULL },
    { "drawPolyLineWithGeogebraCommonKernelGeosGeoPolyLine:", "drawPolyLine", "V", 0x4, NULL, NULL },
    { "initUnitAndVariable", NULL, "V", 0x2, NULL, NULL },
    { "initPointDeclarations", NULL, "V", 0x2, NULL, NULL },
    { "drawLabelWithGeogebraCommonKernelGeosGeoElement:withGeogebraCommonEuclidianDrawableND:", "drawLabel", "V", 0x4, NULL, NULL },
    { "ColorEqualsWithGeogebraCommonAwtGColor:withGeogebraCommonAwtGColor:", "ColorEquals", "Z", 0x0, NULL, NULL },
    { "drawGrid", NULL, "V", 0x2, NULL, NULL },
    { "drawAxis", NULL, "V", 0x2, NULL, NULL },
    { "drawArrowsWithInt:withBoolean:", "drawArrows", "V", 0x2, NULL, NULL },
    { "PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint:withJavaLangStringBuilder:withDouble:", "PointOptionCode", "V", 0x2, NULL, NULL },
    { "PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint:withJavaLangStringBuilder:", "PointOptionCode", "V", 0x2, NULL, NULL },
    { "LineOptionCodeWithGeogebraCommonKernelGeosGeoElement:withBoolean:", "LineOptionCode", "Ljava.lang.String;", 0x2, NULL, NULL },
    { "LinestyleCodeWithInt:withJavaLangStringBuilder:", "LinestyleCode", "V", 0xa, NULL, NULL },
    { "ColorCodeWithGeogebraCommonAwtGColor:withJavaLangStringBuilder:", "ColorCode", "V", 0x4, NULL, NULL },
    { "ColorLightCodeWithGeogebraCommonAwtGColor:withDouble:withJavaLangStringBuilder:", "ColorLightCode", "V", 0x4, NULL, NULL },
    { "ColorCode2WithGeogebraCommonAwtGColor:withJavaLangStringBuilder:", "ColorCode2", "V", 0x4, NULL, NULL },
    { "addTextWithNSString:withBoolean:withInt:", "addText", "V", 0x2, NULL, NULL },
    { "packSpaceBetweenWithNSStringArray:", "packSpaceBetween", "V", 0x84, NULL, NULL },
    { "packSpaceBetweenWithJavaLangStringBuilder:withNSStringArray:", "packSpaceBetween", "V", 0x84, NULL, NULL },
    { "packSpaceAfterWithNSStringArray:", "packSpaceAfter", "V", 0x84, NULL, NULL },
    { "packSpaceAfterWithJavaLangStringBuilder:withNSStringArray:", "packSpaceAfter", "V", 0x84, NULL, NULL },
    { "packSpaceWithNSStringArray:", "packSpace", "V", 0x84, NULL, NULL },
    { "packSpaceWithJavaLangStringBuilder:withNSStringArray:", "packSpace", "V", 0x84, NULL, NULL },
    { "startDraw", NULL, "V", 0x4, NULL, NULL },
    { "startDrawWithJavaLangStringBuilder:", "startDraw", "V", 0x4, NULL, NULL },
    { "endDrawWithGeogebraCommonKernelGeosGeoElement:", "endDraw", "V", 0x4, NULL, NULL },
    { "endDrawWithGeogebraCommonKernelGeosGeoElement:withJavaLangStringBuilder:", "endDraw", "V", 0x4, NULL, NULL },
    { "startTransparentFillWithJavaLangStringBuilder:", "startTransparentFill", "V", 0x4, NULL, NULL },
    { "endTransparentFillWithGeogebraCommonKernelGeosGeoElement:withJavaLangStringBuilder:", "endTransparentFill", "V", 0x4, NULL, NULL },
    { "endPointWithGeogebraCommonAwtGColor:", "endPoint", "V", 0x4, NULL, NULL },
    { "addPointWithNSString:withNSString:withJavaLangStringBuilder:", "addPoint", "V", 0x4, NULL, NULL },
    { "addPointWithDouble:withDouble:withJavaLangStringBuilder:", "addPoint", "V", 0x4, NULL, NULL },
    { "convertUnicodeToTextWithJavaLangStringBuilder:", "convertUnicodeToText", "Ljava.lang.StringBuilder;", 0x4, NULL, NULL },
    { "convertUnicodeToTextWithNSString:", "convertUnicodeToText", "Ljava.lang.String;", 0x4, NULL, NULL },
    { "convertUnicodeToLatexWithNSString:", "convertUnicodeToLatex", "Ljava.lang.String;", 0x4, NULL, NULL },
    { "parseFunctionWithNSString:", "parseFunction", "Ljava.lang.String;", 0x4, NULL, NULL },
    { "killSpaceWithNSString:", "killSpace", "Ljava.lang.String;", 0xa, NULL, NULL },
    { "getStringTemplate", NULL, "Lgeogebra.common.kernel.StringTemplate;", 0x4, NULL, NULL },
    { "penStyleWithGeogebraCommonKernelGeosGeoElement:", "penStyle", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "isLatexFunctionWithNSString:", "isLatexFunction", "Z", 0x4, NULL, NULL },
    { "drawNyquistWithGeogebraCommonKernelGeosGeoTransferFunction:", "drawNyquist", "V", 0x4, NULL, NULL },
    { "formatWithDouble:", "format", "Ljava.lang.String;", 0x4, NULL, NULL },
    { "fillSplineWithGeogebraCommonKernelGeosGeoCurveCartesianArray:", "fillSpline", "Z", 0x4, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "eurosym_", NULL, 0x2, "Z", NULL, NULL,  },
    { "compact_", NULL, 0x2, "Z", NULL, NULL,  },
    { "compactcse5_", NULL, 0x2, "Z", NULL, NULL,  },
    { "grayscale_", NULL, 0x2, "Z", NULL, NULL,  },
    { "dotColors_", NULL, 0x2, "Z", NULL, NULL,  },
    { "pairName_", NULL, 0x2, "Z", NULL, NULL,  },
    { "parabolaCount_", NULL, 0x2, "I", NULL, NULL,  },
    { "hyperbolaCount_", NULL, 0x2, "I", NULL, NULL,  },
    { "arcCount_", NULL, 0x2, "I", NULL, NULL,  },
    { "functionCount_", NULL, 0x2, "I", NULL, NULL,  },
    { "implicitFuncCount_", NULL, 0x2, "I", NULL, NULL,  },
    { "fillType_", NULL, 0x2, "I", NULL, NULL,  },
    { "fontsize_", NULL, 0x2, "I", NULL, NULL,  },
    { "codeBeginPic_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "codePointDecl_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "codeColors_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "codeEndDoc_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "pointList_", NULL, 0x2, "Ljava.util.ArrayList;", NULL, "Ljava/util/ArrayList<Lgeogebra/common/kernel/geos/GeoPoint;>;",  },
    { "pairNameTable_", NULL, 0x2, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/String;>;",  },
    { "functionTable_", NULL, 0x2, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Integer;>;",  },
    { "implicitPolyTable_", NULL, 0x2, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Ljava/lang/Integer;>;",  },
    { "usepackage_", NULL, 0x2, "Ljava.util.Set;", NULL, "Ljava/util/Set<Ljava/lang/String;>;",  },
    { "importpackage_", NULL, 0x1, "Ljava.util.Set;", NULL, "Ljava/util/Set<Ljava/lang/String;>;",  },
    { "fillInequality_", NULL, 0x1, "Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonExportPstricksGeoGebraToAsymptote = { 2, "GeoGebraToAsymptote", "geogebra.common.export.pstricks", NULL, 0x401, 76, methods, 24, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonExportPstricksGeoGebraToAsymptote;
}

@end

void GeogebraCommonExportPstricksGeoGebraToAsymptote_initWithGeogebraCommonMainApp_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonMainApp *app) {
  GeogebraCommonExportPstricksGeoGebraExport_initWithGeogebraCommonMainApp_(self, app);
  self->eurosym_ = NO;
  self->compact_ = NO;
  self->compactcse5_ = NO;
  self->grayscale_ = NO;
  self->dotColors_ = NO;
  self->pairName_ = NO;
  self->parabolaCount_ = 0;
  self->hyperbolaCount_ = 0;
  self->arcCount_ = 0;
  self->functionCount_ = 0;
  self->implicitFuncCount_ = 0;
  self->fillType_ = 0;
  self->fillInequality_ = NO;
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(JavaLangStringBuilder *sb, NSString *nameFunc, NSString *nameNew) {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initialize();
  jint ind = [((JavaLangStringBuilder *) nil_chk(sb)) indexOfWithNSString:nameFunc];
  while (ind > -1) {
    [sb replaceWithInt:ind withInt:ind + ((jint) [((NSString *) nil_chk(nameFunc)) length]) withNSString:nameNew];
    ind = [sb indexOfWithNSString:nameFunc];
  }
}

jdouble GeogebraCommonExportPstricksGeoGebraToAsymptote_maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoFunction *f, jdouble a, jdouble b) {
  jdouble x = a;
  jdouble step = (b - a) / 100;
  while (x <= b) {
    jdouble y = [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(f)) evaluateWithDouble:x];
    if (JavaLangDouble_isNaNWithDouble_(y)) {
      if (step < self->PRECISION_XRANGE_FUNCTION_) return x - step;
      return GeogebraCommonExportPstricksGeoGebraToAsymptote_maxDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(self, f, x - step, x);
    }
    x += step;
  }
  return b;
}

jdouble GeogebraCommonExportPstricksGeoGebraToAsymptote_firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoFunction *f, jdouble a, jdouble b) {
  jdouble x = a;
  jdouble step = (b - a) / 100;
  while (x <= b) {
    jdouble y = [((GeogebraCommonKernelGeosGeoFunction *) nil_chk(f)) evaluateWithDouble:x];
    if (!JavaLangDouble_isNaNWithDouble_(y)) {
      if (x == a) return a;
      else if (step < self->PRECISION_XRANGE_FUNCTION_) return x;
      else return GeogebraCommonExportPstricksGeoGebraToAsymptote_firstDefinedValueWithGeogebraCommonKernelGeosGeoFunction_withDouble_withDouble_(self, f, x - step, x);
    }
    x += step;
  }
  return b;
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawCircleWithGeogebraCommonKernelGeosGeoConic_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoConic *geo) {
  JavaLangStringBuilder *tempsb = [new_JavaLangStringBuilder_init() autorelease];
  jboolean nofill = [((GeogebraCommonKernelGeosGeoConic *) nil_chk(geo)) getAlphaValue] < 0.05;
  if (self->xunit_ == self->yunit_) {
    jdouble x = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getX];
    jdouble y = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getY];
    jdouble r = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 0);
    NSString *tmpr = [self formatWithDouble:r];
    if (nofill) {
      if (!self->compact_) [tempsb appendWithNSString:@"\n"];
      if (self->compactcse5_) [tempsb appendWithNSString:@"D(CR("];
      else [tempsb appendWithNSString:@"draw(circle("];
    }
    else {
      [self startTransparentFillWithJavaLangStringBuilder:tempsb];
      if (self->compactcse5_) [tempsb appendWithNSString:@"CR("];
      else [tempsb appendWithNSString:@"circle("];
    }
    [self addPointWithNSString:[self formatWithDouble:x] withNSString:[self formatWithDouble:y] withJavaLangStringBuilder:tempsb];
    [self packSpaceAfterWithJavaLangStringBuilder:tempsb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    if ([((GeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([((GeogebraCommonKernelKernel *) nil_chk(self->kernel_)) getAlgebraProcessor])) evaluateToDoubleWithNSString:tmpr] != 0) [tempsb appendWithNSString:tmpr];
    else [tempsb appendWithDouble:r];
    [tempsb appendWithNSString:@")"];
    if (nofill) {
      [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
    }
    else [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
  }
  else {
    jdouble x1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getX];
    jdouble y1 = [((GeogebraCommonKernelGeosGeoVec2D *) nil_chk([geo getTranslationVector])) getY];
    jdouble r1 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 0);
    jdouble r2 = IOSDoubleArray_Get(nil_chk([geo getHalfAxes]), 1);
    if (nofill) {
      if (!self->compact_) [tempsb appendWithNSString:@"\n"];
      if (self->compactcse5_) [tempsb appendWithNSString:@"D("];
      else [tempsb appendWithNSString:@"draw("];
    }
    else [self startTransparentFillWithJavaLangStringBuilder:tempsb];
    [tempsb appendWithNSString:@"shift("];
    [self addPointWithNSString:[self formatWithDouble:x1] withNSString:[self formatWithDouble:y1] withJavaLangStringBuilder:tempsb];
    [self packSpaceBetweenWithJavaLangStringBuilder:tempsb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @")", @"*", JreStrcat("$$C", @"scale(", [self formatWithDouble:r1], ','), JreStrcat("$$", [self formatWithDouble:r2], @")*unitcircle") } count:4 type:NSString_class_()]];
    if (nofill) [self endDrawWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
    else [self endTransparentFillWithGeogebraCommonKernelGeosGeoElement:geo withJavaLangStringBuilder:tempsb];
  }
  if (nofill) [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithJavaLangCharSequence:tempsb];
  else [((JavaLangStringBuilder *) nil_chk(self->codeFilledObject_)) appendWithJavaLangCharSequence:tempsb];
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_initUnitAndVariable(GeogebraCommonExportPstricksGeoGebraToAsymptote *self) {
  if (!self->compact_) {
    [((JavaLangStringBuilder *) nil_chk(self->codePreamble_)) appendWithNSString:@"\nreal labelscalefactor = 0.5; /* changes label-to-point distance */"];
    [self->codePreamble_ appendWithNSString:@"\npen dps = linewidth(0.7) + fontsize("];
    [self->codePreamble_ appendWithInt:self->fontsize_];
    [self->codePreamble_ appendWithNSString:@"); defaultpen(dps); /* default pen style */ "];
    if (![((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(self->frame_)) getKeepDotColors]) [self->codePreamble_ appendWithNSString:@"\npen dotstyle = black; /* point style */ \n"];
  }
  else if (!self->compactcse5_) {
    [((JavaLangStringBuilder *) nil_chk(self->codePreamble_)) appendWithNSString:@"real lsf=0.5; pen dps=linewidth(0.7)+fontsize("];
    [self->codePreamble_ appendWithInt:self->fontsize_];
    [self->codePreamble_ appendWithNSString:@"); defaultpen(dps); "];
    if (![((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(self->frame_)) getKeepDotColors]) [self->codePreamble_ appendWithNSString:@"pen ds=black; "];
  }
  else {
    [((JavaLangStringBuilder *) nil_chk(self->codePreamble_)) appendWithNSString:@"real lsf=0.5; pathpen=linewidth(0.7); pointpen=black; pen fp=fontsize("];
    [self->codePreamble_ appendWithInt:self->fontsize_];
    [self->codePreamble_ appendWithNSString:@"); pointfontpen=fp; "];
  }
  IOSBooleanArray *positiveOnly = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(self->euclidianView_)) getPositiveAxes];
  jdouble assignMinX = self->xmin_;
  jdouble assignMinY = self->ymin_;
  if (IOSBooleanArray_Get(nil_chk(positiveOnly), 0)) {
    assignMinX = -0.1;
  }
  if (IOSBooleanArray_Get(positiveOnly, 1)) {
    assignMinY = -0.1;
  }
  [self packSpaceBetweenWithJavaLangStringBuilder:self->codePreamble_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"real xmin", @"=", JreStrcat("$C", [self formatWithDouble:assignMinX], ','), @"xmax", @"=", JreStrcat("$C", [self formatWithDouble:self->xmax_], ','), @"ymin", @"=", JreStrcat("$C", [self formatWithDouble:assignMinY], ','), @"ymax", @"=", JreStrcat("$$", [self formatWithDouble:self->ymax_], @"; ") } count:12 type:NSString_class_()]];
  if (!self->compact_) [((JavaLangStringBuilder *) nil_chk(self->codePreamble_)) appendWithNSString:@" /* image dimensions */\n"];
  else {
  }
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_initPointDeclarations(GeogebraCommonExportPstricksGeoGebraToAsymptote *self) {
  if (!self->pairName_) return;
  id<JavaUtilIterator> it = [((JavaUtilArrayList *) nil_chk(self->pointList_)) iterator];
  jboolean comma = NO;
  IOSObjectArray *predefinedNames = [IOSObjectArray arrayWithObjects:(id[]){ @"N", @"S", @"E", @"W", @"NE", @"SE", @"NW", @"SW", @"NNE", @"NNW", @"SSE", @"SSW", @"ENE", @"WNW", @"ESE", @"WSW", @"left", @"right", @"up", @"down" } count:20 type:NSString_class_()];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    GeogebraCommonKernelGeosGeoPoint *gp = [it next];
    if ([((GeogebraCommonKernelGeosGeoPoint *) nil_chk(gp)) getPointStyle] == GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_DOT || [gp getPointStyle] == GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_CIRCLE) {
      jdouble x = [gp getX], y = [gp getY], z = [gp getZ];
      x /= z;
      y /= z;
      NSString *pairString = JreStrcat("C$C$C", '(', [self formatWithDouble:x], ',', [self formatWithDouble:y], ')');
      NSString *pointName = [gp getLabelWithGeogebraCommonKernelStringTemplate:[self getStringTemplate]];
      jboolean isVariable = YES;
      for (jint i = 0; i < ((jint) [((NSString *) nil_chk(pointName)) length]); i++) if (!JavaLangCharacter_isLetterOrDigitWithChar_([pointName charAtWithInt:i]) && [pointName charAtWithInt:i] != '_') isVariable = NO;
      for (jint i = 0; i < predefinedNames->size_; i++) if ([pointName isEqual:IOSObjectArray_Get(predefinedNames, i)]) isVariable = NO;
      if (![((id<JavaUtilMap>) nil_chk(self->pairNameTable_)) containsKeyWithId:pairString] && isVariable) {
        if (comma) [((JavaLangStringBuilder *) nil_chk(self->codePointDecl_)) appendWithNSString:@", "];
        else comma = YES;
        [self->pairNameTable_ putWithId:pairString withId:pointName];
        [((JavaLangStringBuilder *) nil_chk(self->codePointDecl_)) appendWithNSString:pointName];
        [self packSpaceWithJavaLangStringBuilder:self->codePointDecl_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"=" } count:1 type:NSString_class_()]];
        [self->codePointDecl_ appendWithNSString:pairString];
      }
    }
  }
  if (comma) {
    [((JavaLangStringBuilder *) nil_chk(self->codePointDecl_)) insertWithInt:0 withNSString:@"\npair "];
    [self->codePointDecl_ appendWithNSString:@"; "];
  }
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawGrid(GeogebraCommonExportPstricksGeoGebraToAsymptote *self) {
  GeogebraCommonAwtGColor *GridCol = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(self->euclidianView_)) getGridColor];
  IOSDoubleArray *GridDist = [self->euclidianView_ getGridDistances];
  jboolean GridBold = [self->euclidianView_ getGridIsBold];
  jint GridLine = [self->euclidianView_ getGridLineStyle];
  if (!self->compact_) {
    [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"\n /* draw grid of horizontal/vertical lines */"];
    [self->codeBeginPic_ appendWithNSString:@"\npen gridstyle = "];
    if (GridBold) [self->codeBeginPic_ appendWithNSString:@"linewidth(1.0)"];
    else [self->codeBeginPic_ appendWithNSString:@"linewidth(0.7)"];
    [self->codeBeginPic_ appendWithNSString:@" + "];
    [self ColorCodeWithGeogebraCommonAwtGColor:GridCol withJavaLangStringBuilder:self->codeBeginPic_];
    if (GridLine != GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_FULL) {
      [self->codeBeginPic_ appendWithNSString:@" + "];
      GeogebraCommonExportPstricksGeoGebraToAsymptote_LinestyleCodeWithInt_withJavaLangStringBuilder_(GridLine, self->codeBeginPic_);
    }
    [self->codeBeginPic_ appendWithNSString:@"; real gridx = "];
    [self->codeBeginPic_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(nil_chk(GridDist), 0)]];
    [self->codeBeginPic_ appendWithNSString:@", gridy = "];
    [self->codeBeginPic_ appendWithNSString:[self formatWithDouble:IOSDoubleArray_Get(GridDist, 1)]];
    [self->codeBeginPic_ appendWithNSString:@"; /* grid intervals */\nfor(real i = ceil(xmin/gridx)*gridx; i <= floor(xmax/gridx)*gridx; i += gridx)"];
    [self->codeBeginPic_ appendWithNSString:@"\n draw((i,ymin)--(i,ymax), gridstyle);"];
    [self->codeBeginPic_ appendWithNSString:@"\nfor(real i = ceil(ymin/gridy)*gridy; i <= floor(ymax/gridy)*gridy; i += gridy)"];
    [self->codeBeginPic_ appendWithNSString:@"\n draw((xmin,i)--(xmax,i), gridstyle);"];
    [self->codeBeginPic_ appendWithNSString:@"\n /* end grid */ \n"];
    return;
  }
  else if (!self->compactcse5_) [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"\n/*grid*/ "];
  [((id<JavaUtilSet>) nil_chk(self->importpackage_)) addWithId:@"math"];
  [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:JreStrcat("$$$$$", @"real gx=", [self formatWithDouble:IOSDoubleArray_Get(nil_chk(GridDist), 0)], @",gy=", [self formatWithDouble:IOSDoubleArray_Get(GridDist, 1)], @"; ")];
  [self->codeBeginPic_ appendWithNSString:@"add(scale(gx,gy)*shift(floor(xmin/gx),floor(ymin/gy))*grid(ceil(xmax-xmin)+1,ceil(ymax-ymin)+1,"];
  if (GridBold) [self->codeBeginPic_ appendWithNSString:@"linewidth(1.0)"];
  else [self->codeBeginPic_ appendWithNSString:@"linewidth(0.7)"];
  [self->codeBeginPic_ appendWithNSString:@"+"];
  [self ColorCodeWithGeogebraCommonAwtGColor:GridCol withJavaLangStringBuilder:self->codeBeginPic_];
  if (GridLine != GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_FULL) {
    [self->codeBeginPic_ appendWithNSString:@"+"];
    GeogebraCommonExportPstricksGeoGebraToAsymptote_LinestyleCodeWithInt_withJavaLangStringBuilder_(GridLine, self->codeBeginPic_);
  }
  [self->codeBeginPic_ appendWithNSString:@")); "];
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawAxis(GeogebraCommonExportPstricksGeoGebraToAsymptote *self) {
  jboolean xAxis = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(self->euclidianView_)) getShowXaxis];
  jboolean yAxis = [self->euclidianView_ getShowYaxis];
  jboolean bx = IOSBooleanArray_Get(nil_chk([self->euclidianView_ getShowAxesNumbers]), 0);
  jboolean by = IOSBooleanArray_Get(nil_chk([self->euclidianView_ getShowAxesNumbers]), 1);
  NSString *Dx = [self formatWithDouble:IOSDoubleArray_Get(nil_chk([self->euclidianView_ getAxesNumberingDistances]), 0)];
  NSString *Dy = [self formatWithDouble:IOSDoubleArray_Get(nil_chk([self->euclidianView_ getAxesNumberingDistances]), 1)];
  IOSObjectArray *label = [self->euclidianView_ getAxesLabelsWithBoolean:NO];
  IOSObjectArray *units = [self->euclidianView_ getAxesUnitLabels];
  jint axisStyle = [self->euclidianView_ getAxesLineStyle];
  IOSIntArray *tickStyle = [self->euclidianView_ getAxesTickStyles];
  GeogebraCommonAwtGColor *axisColor = [self->euclidianView_ getAxesColor];
  jboolean axisBold = (axisStyle & 2) == GeogebraCommonPluginEuclidianStyleConstants_AXES_BOLD;
  NSString *lx = @"", *ly = @"";
  if (IOSObjectArray_Get(nil_chk(label), 0) != nil) lx = JreStrcat("C$C", '$', GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_(IOSObjectArray_Get(label, 0), YES), '$');
  if (IOSObjectArray_Get(label, 1) != nil) ly = JreStrcat("C$C", '$', GeogebraCommonUtilStringUtil_toLaTeXStringWithNSString_withBoolean_(IOSObjectArray_Get(label, 1), YES), '$');
  if (xAxis || yAxis) {
    [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"\n"];
    [self->codeBeginPic_ appendWithNSString:@"Label laxis; laxis.p"];
    [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"=" } count:1 type:NSString_class_()]];
    [self->codeBeginPic_ appendWithNSString:JreStrcat("$I$", @"fontsize(", self->fontsize_, @"); ")];
    if (!bx || !by) {
      if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
      [self->codeBeginPic_ appendWithNSString:@"string blank(real x) {return \"\";} "];
    }
    if (bx || by) {
      if (IOSObjectArray_Get(nil_chk(units), 0) != nil && ![((NSString *) nil_chk(IOSObjectArray_Get(units, 0))) isEqual:@""]) {
        [self->codeBeginPic_ appendWithNSString:@"string "];
        if (self->compact_) [self->codeBeginPic_ appendWithNSString:@"xlbl"];
        else [self->codeBeginPic_ appendWithNSString:@"xaxislabel"];
        [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real x)" } count:1 type:NSString_class_()]];
        [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"{" } count:1 type:NSString_class_()]];
        if ([((NSString *) nil_chk(IOSObjectArray_Get(units, 0))) isEqual:@"\u03c0"]) {
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"string s; ", @"int n", @"=", @"round(2*x/pi); " } count:4 type:NSString_class_()]];
          if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"if(abs(n-2*x/pi)", @">", @"1e-3) return string(x); " } count:3 type:NSString_class_()]];
          if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"if(abs(n)", @">", @"2) s = string(round((n%2", @"+", @"1)*x/pi)); " } count:5 type:NSString_class_()]];
          if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"if(n%2", @"==", @"0) return \"$\"+s+\"\\pi$\"; " } count:3 type:NSString_class_()]];
        }
        [self->codeBeginPic_ appendWithNSString:@"return \"$\""];
        [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
        if ([((NSString *) nil_chk(IOSObjectArray_Get(units, 0))) isEqual:@"\u03c0"]) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"s", @"+", @"\"\\pi/2" } count:3 type:NSString_class_()]];
        else if ([((NSString *) nil_chk(IOSObjectArray_Get(units, 0))) isEqual:@"\u00b0"]) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"string(x)", @"+", @"\"^\\circ" } count:3 type:NSString_class_()]];
        else {
          [self->codeBeginPic_ appendWithNSString:@"string(x)"];
          [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
          [self->codeBeginPic_ appendWithNSString:JreStrcat("$$C", @"\"\\,\\mathrm{", IOSObjectArray_Get(units, 0), '}')];
        }
        [self->codeBeginPic_ appendWithNSString:@"$\";} "];
      }
      if (IOSObjectArray_Get(units, 1) != nil && ![((NSString *) nil_chk(IOSObjectArray_Get(units, 1))) isEqual:@""]) {
        [self->codeBeginPic_ appendWithNSString:@"string "];
        if (self->compact_) [self->codeBeginPic_ appendWithNSString:@"ylbl"];
        else [self->codeBeginPic_ appendWithNSString:@"yaxislabel"];
        [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"(real x)" } count:1 type:NSString_class_()]];
        [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"{" } count:1 type:NSString_class_()]];
        if ([((NSString *) nil_chk(IOSObjectArray_Get(units, 1))) isEqual:@"\u03c0"]) {
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"string s; ", @"int n", @"=", @"round(2*x/pi); " } count:4 type:NSString_class_()]];
          if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"if(abs(n-2*x/pi)", @">", @"1e-3) return string(x); " } count:3 type:NSString_class_()]];
          if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"if(abs(n)", @">", @"2) s = string(round((n%2", @"+", @"1)*x/pi)); " } count:5 type:NSString_class_()]];
          if (!self->compact_) [self->codeBeginPic_ appendWithNSString:@"\n"];
          [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"if(n%2", @"==", @"0) return \"$\"+s+\"\\pi$\"; " } count:3 type:NSString_class_()]];
        }
        [self->codeBeginPic_ appendWithNSString:@"return \"$\""];
        [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
        if ([((NSString *) nil_chk(IOSObjectArray_Get(units, 1))) isEqual:@"\u03c0"]) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"s", @"+", @"\"\\pi/2" } count:3 type:NSString_class_()]];
        else if ([((NSString *) nil_chk(IOSObjectArray_Get(units, 1))) isEqual:@"\u00b0"]) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"string(x)", @"+", @"\"^\\circ" } count:3 type:NSString_class_()]];
        else {
          [self->codeBeginPic_ appendWithNSString:@"string(x)"];
          [self packSpaceWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
          [self->codeBeginPic_ appendWithNSString:JreStrcat("$$C", @"\"\\,\\mathrm{", IOSObjectArray_Get(units, 1), '}')];
        }
        [self->codeBeginPic_ appendWithNSString:@"$\";} "];
      }
    }
    [self->codeBeginPic_ appendWithNSString:@"\n"];
  }
  if (xAxis) {
    [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"xaxis("];
    if (IOSObjectArray_Get(label, 0) != nil) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("C$$", '"', lx, @"\",") } count:1 type:NSString_class_()]];
    [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"xmin,", @"xmax" } count:2 type:NSString_class_()]];
    if (axisColor != GeogebraCommonAwtGColor_get_BLACK_()) {
      [self->codeBeginPic_ appendWithNSString:@","];
      if (self->compactcse5_) [self->codeBeginPic_ appendWithNSString:@"pathpen+"];
      else [self->codeBeginPic_ appendWithNSString:@"defaultpen+"];
      [self ColorCodeWithGeogebraCommonAwtGColor:axisColor withJavaLangStringBuilder:self->codeBeginPic_];
      if (axisBold) {
        [self->codeBeginPic_ appendWithNSString:@"+linewidth(1.2)"];
      }
    }
    else if (axisBold) {
      [self->codeBeginPic_ appendWithNSString:@",linewidth(1.2)"];
    }
    [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    if (IOSIntArray_Get(nil_chk(tickStyle), 0) == GeogebraCommonPluginEuclidianStyleConstants_AXES_TICK_STYLE_MAJOR) {
      [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"Ticks(laxis," } count:1 type:NSString_class_()]];
      if (!bx) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"blank," } count:1 type:NSString_class_()]];
      else if (IOSObjectArray_Get(nil_chk(units), 0) != nil && ![((NSString *) nil_chk(IOSObjectArray_Get(units, 0))) isEqual:@""]) {
        if (self->compact_) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"xlbl," } count:1 type:NSString_class_()]];
        else [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"xaxislabel," } count:1 type:NSString_class_()]];
      }
      [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"Step", @"=", JreStrcat("$C", Dx, ','), @"Size", @"=", @"2" } count:6 type:NSString_class_()]];
      if (yAxis) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @",", @"NoZero" } count:2 type:NSString_class_()]];
      [self->codeBeginPic_ appendWithNSString:@")"];
    }
    else if (IOSIntArray_Get(tickStyle, 0) == GeogebraCommonPluginEuclidianStyleConstants_AXES_TICK_STYLE_MAJOR_MINOR) {
      [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"Ticks(laxis," } count:1 type:NSString_class_()]];
      if (!bx) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"blank," } count:1 type:NSString_class_()]];
      else if (IOSObjectArray_Get(nil_chk(units), 0) != nil && ![((NSString *) nil_chk(IOSObjectArray_Get(units, 0))) isEqual:@""]) {
        if (self->compact_) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"xlbl," } count:1 type:NSString_class_()]];
        else [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"xaxislabel," } count:1 type:NSString_class_()]];
      }
      [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"n", @"=", @"2,", @"Step", @"=", JreStrcat("$C", Dx, ','), @"Size", @"=", @"2,", @"size", @"=", @"1" } count:12 type:NSString_class_()]];
      [self->codeBeginPic_ appendWithNSString:@")"];
    }
    [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @",", @"above", @"=", @"true); " } count:4 type:NSString_class_()]];
  }
  if (xAxis && yAxis && !self->compact_) [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"\n"];
  if (yAxis) {
    [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"yaxis("];
    if (IOSObjectArray_Get(label, 1) != nil) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ JreStrcat("C$$", '"', ly, @"\",") } count:1 type:NSString_class_()]];
    [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"ymin,", @"ymax" } count:2 type:NSString_class_()]];
    if (axisColor != GeogebraCommonAwtGColor_get_BLACK_()) {
      if (self->compactcse5_) [self->codeBeginPic_ appendWithNSString:@",pathpen+"];
      else [self->codeBeginPic_ appendWithNSString:@",defaultpen+"];
      [self ColorCodeWithGeogebraCommonAwtGColor:axisColor withJavaLangStringBuilder:self->codeBeginPic_];
      if (axisBold) {
        [self->codeBeginPic_ appendWithNSString:@"+linewidth(1.2)"];
      }
    }
    else if (axisBold) {
      [self->codeBeginPic_ appendWithNSString:@",linewidth(1.2)"];
    }
    [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"," } count:1 type:NSString_class_()]];
    if (IOSIntArray_Get(nil_chk(tickStyle), 1) == GeogebraCommonPluginEuclidianStyleConstants_AXES_TICK_STYLE_MAJOR) {
      [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"Ticks(laxis," } count:1 type:NSString_class_()]];
      if (!by) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"blank," } count:1 type:NSString_class_()]];
      else if (IOSObjectArray_Get(nil_chk(units), 1) != nil && ![((NSString *) nil_chk(IOSObjectArray_Get(units, 1))) isEqual:@""]) {
        if (self->compact_) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"ylbl," } count:1 type:NSString_class_()]];
        else [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"yaxislabel," } count:1 type:NSString_class_()]];
      }
      [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"Step", @"=", JreStrcat("$C", Dy, ','), @"Size", @"=", @"2" } count:6 type:NSString_class_()]];
      if (xAxis) [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @",", @"NoZero" } count:2 type:NSString_class_()]];
      [self->codeBeginPic_ appendWithNSString:@")"];
    }
    else if (IOSIntArray_Get(tickStyle, 1) == GeogebraCommonPluginEuclidianStyleConstants_AXES_TICK_STYLE_MAJOR_MINOR) {
      [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"Ticks(laxis," } count:1 type:NSString_class_()]];
      if (!by) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"blank," } count:1 type:NSString_class_()]];
      else if (IOSObjectArray_Get(nil_chk(units), 1) != nil && ![((NSString *) nil_chk(IOSObjectArray_Get(units, 1))) isEqual:@""]) {
        if (self->compact_) [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"ylbl," } count:1 type:NSString_class_()]];
        else [self packSpaceAfterWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"yaxislabel," } count:1 type:NSString_class_()]];
      }
      [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"n", @"=", @"2,", @"Step", @"=", JreStrcat("$C", Dy, ','), @"Size", @"=", @"2,", @"size", @"=", @"1" } count:12 type:NSString_class_()]];
      [self->codeBeginPic_ appendWithNSString:@")"];
    }
    [self packSpaceBetweenWithJavaLangStringBuilder:self->codeBeginPic_ withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @",", @"above", @"=", @"true); " } count:4 type:NSString_class_()]];
  }
  if ((xAxis || yAxis) && !self->compact_) [((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) appendWithNSString:@"/* draws axes; NoZero hides '0' label */ "];
  GeogebraCommonExportPstricksGeoGebraToAsymptote_drawArrowsWithInt_withBoolean_(self, axisStyle, axisBold);
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_drawArrowsWithInt_withBoolean_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, jint axisStyle, jboolean axisBold) {
  jboolean axisLeftArrow = (axisStyle & 4) == GeogebraCommonPluginEuclidianStyleConstants_AXES_LEFT_ARROW;
  jboolean axisRightArrow = (axisStyle & 1) == GeogebraCommonPluginEuclidianStyleConstants_AXES_RIGHT_ARROW;
  NSString *arrow = nil;
  NSString *pt = @"6";
  if (axisBold) {
    pt = @"9";
  }
  if (axisRightArrow && axisLeftArrow) {
    arrow = JreStrcat("$$$", @"Arrows(", pt, @"),");
    [self->codeBeginPic_ insertWithInt:[((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) indexOfWithNSString:@"above"] - 1 withNSString:arrow];
    [self->codeBeginPic_ insertWithInt:[self->codeBeginPic_ lastIndexOfWithNSString:@"above"] - 1 withNSString:arrow];
  }
  else {
    if (axisRightArrow) {
      arrow = JreStrcat("$$$", @"EndArrow(", pt, @"),");
      [self->codeBeginPic_ insertWithInt:[((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) indexOfWithNSString:@"above"] - 1 withNSString:arrow];
      [self->codeBeginPic_ insertWithInt:[self->codeBeginPic_ lastIndexOfWithNSString:@"above"] - 1 withNSString:arrow];
    }
    if (axisLeftArrow) {
      arrow = JreStrcat("$$$", @"BeginArrow(", pt, @"),");
      [self->codeBeginPic_ insertWithInt:[((JavaLangStringBuilder *) nil_chk(self->codeBeginPic_)) indexOfWithNSString:@"above"] - 1 withNSString:arrow];
      [self->codeBeginPic_ insertWithInt:[self->codeBeginPic_ lastIndexOfWithNSString:@"above"] - 1 withNSString:arrow];
    }
  }
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_withDouble_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoPoint *geo, JavaLangStringBuilder *sb, jdouble dotsize) {
  GeogebraCommonAwtGColor *dotcolor = [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(geo)) getObjectColor];
  jint dotstyle = [geo getPointStyle];
  if (dotstyle == -1) {
    dotstyle = GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_DOT;
  }
  jboolean comma = NO;
  if (dotsize != GeogebraCommonPluginEuclidianStyleConstants_DEFAULT_POINT_SIZE) {
    comma = YES;
    [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@",linewidth("];
    [sb appendWithNSString:[self formatWithDouble:dotsize]];
    [sb appendWithNSString:@"pt)"];
  }
  if (![((GeogebraCommonAwtGColor *) nil_chk(dotcolor)) isEqual:GeogebraCommonAwtGColor_get_BLACK_()] && [((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(self->frame_)) getKeepDotColors]) {
    if (comma) [self packSpaceWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@","];
    comma = YES;
    [self ColorCodeWithGeogebraCommonAwtGColor:dotcolor withJavaLangStringBuilder:sb];
  }
  else if (![((id<GeogebraCommonExportPstricksExportSettings>) nil_chk(self->frame_)) getKeepDotColors] && !self->compactcse5_) {
    if (comma) [self packSpaceWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@","];
    comma = YES;
    if (!self->compact_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"dotstyle"];
    else if (!self->compactcse5_) [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"ds"];
  }
  if (dotstyle != GeogebraCommonPluginEuclidianStyleConstants_POINT_STYLE_DOT) {
    if (comma) [self packSpaceWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    else [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@","];
    comma = YES;
    [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"invisible"];
  }
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoPoint *geo, JavaLangStringBuilder *sb) {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_PointOptionCodeWithGeogebraCommonKernelGeosGeoPoint_withJavaLangStringBuilder_withDouble_(self, geo, sb, [((GeogebraCommonKernelGeosGeoPoint *) nil_chk(geo)) getPointSize]);
}

NSString *GeogebraCommonExportPstricksGeoGebraToAsymptote_LineOptionCodeWithGeogebraCommonKernelGeosGeoElement_withBoolean_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, GeogebraCommonKernelGeosGeoElement *geo, jboolean transparency) {
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  jint linethickness = [((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) getLineThickness];
  jint linestyle = [geo getLineType];
  GeogebraCommonExportPstricksGeoGebraExport_Info *info = [new_GeogebraCommonExportPstricksGeoGebraExport_Info_initWithGeogebraCommonExportPstricksGeoGebraExport_withGeogebraCommonKernelGeosGeoElement_(self, geo) autorelease];
  jboolean noPlus = YES;
  if (linethickness != GeogebraCommonPluginEuclidianStyleConstants_DEFAULT_LINE_THICKNESS) {
    noPlus = NO;
    [sb appendWithNSString:@"linewidth("];
    [sb appendWithNSString:[self formatWithDouble:linethickness / 2.0 * 0.8]];
    [sb appendWithNSString:@")"];
  }
  if (linestyle != GeogebraCommonPluginEuclidianStyleConstants_DEFAULT_LINE_TYPE) {
    if (!noPlus) [self packSpaceWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    else noPlus = NO;
    GeogebraCommonExportPstricksGeoGebraToAsymptote_LinestyleCodeWithInt_withJavaLangStringBuilder_(linestyle, sb);
  }
  if (![((GeogebraCommonAwtGColor *) nil_chk([info getLinecolor])) isEqual:GeogebraCommonAwtGColor_get_BLACK_()]) {
    if (!noPlus) [self packSpaceWithJavaLangStringBuilder:sb withNSStringArray:[IOSObjectArray arrayWithObjects:(id[]){ @"+" } count:1 type:NSString_class_()]];
    else noPlus = NO;
    [self ColorCodeWithGeogebraCommonAwtGColor:[info getLinecolor] withJavaLangStringBuilder:sb];
  }
  if (transparency && [geo isFillable] && [info getAlpha] > 0.0f) {
  }
  if (noPlus) return nil;
  return [NSString stringWithJavaLangStringBuilder:sb];
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_LinestyleCodeWithInt_withJavaLangStringBuilder_(jint linestyle, JavaLangStringBuilder *sb) {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initialize();
  {
    jint size;
    jint size1, size2, size3;
    switch (linestyle) {
      case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DOTTED:
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"dotted"];
      break;
      case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DASHED_SHORT:
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"linetype(\""];
      size = 2;
      [sb appendWithInt:size];
      [sb appendWithNSString:@" "];
      [sb appendWithInt:size];
      [sb appendWithNSString:@"\")"];
      break;
      case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DASHED_LONG:
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"linetype(\""];
      size = 4;
      [sb appendWithInt:size];
      [sb appendWithNSString:@" "];
      [sb appendWithInt:size];
      [sb appendWithNSString:@"\")"];
      break;
      case GeogebraCommonPluginEuclidianStyleConstants_LINE_TYPE_DASHED_DOTTED:
      [((JavaLangStringBuilder *) nil_chk(sb)) appendWithNSString:@"linetype(\""];
      size1 = 0;
      size2 = 3;
      size3 = 4;
      [sb appendWithInt:size1];
      [sb appendWithNSString:@" "];
      [sb appendWithInt:size2];
      [sb appendWithNSString:@" "];
      [sb appendWithInt:size3];
      [sb appendWithNSString:@" "];
      [sb appendWithInt:size2];
      [sb appendWithNSString:@"\")"];
      break;
    }
  }
}

void GeogebraCommonExportPstricksGeoGebraToAsymptote_addTextWithNSString_withBoolean_withInt_(GeogebraCommonExportPstricksGeoGebraToAsymptote *self, NSString *st, jboolean isLatex, jint style) {
  if (isLatex) [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"$"];
  if (isLatex && [((NSString *) nil_chk(st)) charAtWithInt:0] == '$') st = [st substring:1];
  if (isLatex) {
    if ([((NSString *) nil_chk(st)) indexOfString:@"\\"] != -1) [((id<JavaUtilSet>) nil_chk(self->usepackage_)) addWithId:@"amsmath"];
    if ([st indexOfString:@"\\mathbb"] != -1 || [st indexOfString:@"\\mathfrak"] != -1) [((id<JavaUtilSet>) nil_chk(self->usepackage_)) addWithId:@"amssymb"];
    if ([st indexOfString:@"\\mathscr"] != -1) [((id<JavaUtilSet>) nil_chk(self->usepackage_)) addWithId:@"mathrsfs"];
  }
  if (isLatex) st = [self convertUnicodeToLatexWithNSString:st];
  else {
    st = [self convertUnicodeToTextWithNSString:st];
    st = [((NSString *) nil_chk(st)) replace:@"\\$" withSequence:@"dollar "];
    st = [((NSString *) nil_chk([((NSString *) nil_chk(st)) replace:@"\\\\" withSequence:@"\\\\textbackslash "])) replace:@"\\\\textbackslash \\\\textbackslash " withSequence:@"\\\\\\\\ "];
  }
  switch (style) {
    case 1:
    if (isLatex) [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"\\mathbf{"];
    else [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"\\textbf{"];
    break;
    case 2:
    if (isLatex) [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"\\mathit{"];
    else [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"\\textit{"];
    break;
    case 3:
    if (isLatex) [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"\\mathit{\\mathbf{"];
    else [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:@"\\textit{\\textbf{"];
    break;
  }
  [((JavaLangStringBuilder *) nil_chk(self->code_)) appendWithNSString:[st substring:0 endIndex:((jint) [((NSString *) nil_chk(st)) length]) - 1]];
  if (!isLatex || [st charAtWithInt:((jint) [st length]) - 1] != '$') [self->code_ appendWithChar:[st charAtWithInt:((jint) [st length]) - 1]];
  switch (style) {
    case 1:
    case 2:
    [self->code_ appendWithNSString:@"}"];
    break;
    case 3:
    [self->code_ appendWithNSString:@"}}"];
    break;
  }
  if (isLatex) [self->code_ appendWithNSString:@"$"];
}

NSString *GeogebraCommonExportPstricksGeoGebraToAsymptote_killSpaceWithNSString_(NSString *name) {
  GeogebraCommonExportPstricksGeoGebraToAsymptote_initialize();
  JavaLangStringBuilder *sb = [new_JavaLangStringBuilder_init() autorelease];
  jboolean operand = NO;
  jboolean space = NO;
  for (jint i = 0; i < ((jint) [((NSString *) nil_chk(name)) length]); i++) {
    jchar c = [name charAtWithInt:i];
    if ([@"*/+-" indexOf:c] != -1) {
      [sb appendWithChar:c];
      operand = YES;
      space = NO;
    }
    else if (c == ' ') {
      if (!operand) space = YES;
      else {
        space = NO;
        operand = NO;
      }
    }
    else {
      if (space) [sb appendWithNSString:@"*"];
      [sb appendWithChar:c];
      space = NO;
      operand = NO;
    }
  }
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\\\\pi", @"pi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"EXP(", @"exp(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ln(", @"log(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ceiling(", @"ceil(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"CEILING(", @"ceil(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"FLOOR(", @"floor(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"SIN(", @"sin(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"COS(", @"cos(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"TAN(", @"tan(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ASIN(", @"asin(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ACOS(", @"acos(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ATAN(", @"atan(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"SINH(", @"sinh(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"COSH(", @"cosh(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"TANH(", @"tanh(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ASINH(", @"asinh(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ACOSH(", @"acosh(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"ATANH(", @"atanh(");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, GeogebraCommonUtilUnicode_get_EULER_STRING_(), @"2.718");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u0393", @"Gamma");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u0394", @"Delta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u0398", @"Theta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u039b", @"Lambda");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u039e", @"Xi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03a0", @"Pi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03a3", @"Sigma");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03a6", @"Phi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03a8", @"Psi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03a9", @"Omega");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b1", @"alpha");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b2", @"beta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b3", @"gamma");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b4", @"delta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b5", @"epsilon");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b6", @"zeta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b7", @"eta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b8", @"theta");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03b9", @"iota");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03ba", @"kappa");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03bb", @"lambda");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03bc", @"mu");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03be", @"xi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c0", @"pi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c1", @"rho");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c2", @"varsigma");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c3", @"sigma");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c4", @"tau");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c5", @"upsilon");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c6", @"varphi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c7", @"chi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c8", @"psi");
  GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, @"\u03c9", @"omega");
  IOSObjectArray *greekalpha = [IOSObjectArray arrayWithObjects:(id[]){ @"alpha", @"beta", @"gamma", @"delta", @"epsilon", @"zeta", @"eta", @"theta", @"iota", @"kappa", @"lambda", @"mu", @"xi", @"pi", @"rho", @"varsigma", @"sigma", @"tau", @"upsilon", @"varphi", @"chi", @"psi", @"omega" } count:23 type:NSString_class_()];
  for (jint i = 0; i < greekalpha->size_; i++) {
    GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, JreStrcat("C$", '\\', IOSObjectArray_Get(greekalpha, i)), IOSObjectArray_Get(greekalpha, i));
    NSString *temps = JreStrcat("$$", JavaLangCharacter_toStringWithChar_(JavaLangCharacter_toUpperCaseWithChar_([((NSString *) nil_chk(IOSObjectArray_Get(greekalpha, i))) charAtWithInt:0])), [((NSString *) nil_chk(IOSObjectArray_Get(greekalpha, i))) substring:1]);
    GeogebraCommonExportPstricksGeoGebraToAsymptote_renameFuncWithJavaLangStringBuilder_withNSString_withNSString_(sb, JreStrcat("C$", '\\', temps), temps);
  }
  return [NSString stringWithJavaLangStringBuilder:sb];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonExportPstricksGeoGebraToAsymptote)
