//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/kernel/algos/AlgoDensityPlot.java
//


#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/awt/GColor.h"
#include "geogebra/common/awt/GFont.h"
#include "geogebra/common/awt/GFontRenderContext.h"
#include "geogebra/common/awt/GGraphics2D.h"
#include "geogebra/common/awt/font/GTextLayout.h"
#include "geogebra/common/euclidian/EuclidianViewInterfaceCommon.h"
#include "geogebra/common/factories/AwtFactory.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/algos/AlgoDensityPlot.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/algos/GetCommand.h"
#include "geogebra/common/kernel/arithmetic/FunctionNVar.h"
#include "geogebra/common/kernel/commands/Commands.h"
#include "geogebra/common/kernel/geos/GeoBoolean.h"
#include "geogebra/common/kernel/geos/GeoCanvasImage.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoFunctionNVar.h"
#include "geogebra/common/kernel/geos/GeoNumeric.h"
#include "geogebra/common/main/App.h"
#include "java/lang/Math.h"
#include "java/text/DecimalFormat.h"

@interface GeogebraCommonKernelAlgosAlgoDensityPlot () {
 @public
  GeogebraCommonKernelGeosGeoCanvasImage *outputImage_;
  GeogebraCommonKernelGeosGeoFunctionNVar *function_;
  jdouble minX_;
  jdouble maxX_;
  jdouble minY_;
  jdouble maxY_;
  jint offset_;
  jint imageSize_;
  jint gridPixel_;
  IOSIntArray *colors_;
  jint i_;
  jint j_;
  GeogebraCommonAwtGColor *color_;
  jdouble incX_;
  jdouble incY_;
  IOSDoubleArray *vals_;
  id<GeogebraCommonAwtGGraphics2D> g_;
  GeogebraCommonKernelArithmeticFunctionNVar *f_;
  JavaTextDecimalFormat *df_;
  id<GeogebraCommonAwtFontGTextLayout> t_;
  GeogebraCommonAwtGFont *font_;
  jdouble scaleX_;
  jdouble scaleY_;
  jint grade_;
  id<GeogebraCommonEuclidianEuclidianViewInterfaceCommon> view_;
  jboolean fixed_;
  jint imagePlusOffset_;
  jdouble value_;
  jboolean prevGrid_;
}

- (void)drawGrid;

- (void)drawAxes;

- (void)deleteAxes;

- (void)showGrid;

+ (jint)colWithDouble:(jdouble)x1;

+ (IOSIntArray *)hlsToRgbWithDouble:(jdouble)h
                         withDouble:(jdouble)l
                         withDouble:(jdouble)s;

+ (IOSIntArray *)rgbColorWithDouble:(jdouble)zre;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, outputImage_, GeogebraCommonKernelGeosGeoCanvasImage *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, function_, GeogebraCommonKernelGeosGeoFunctionNVar *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, colors_, IOSIntArray *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, color_, GeogebraCommonAwtGColor *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, vals_, IOSDoubleArray *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, g_, id<GeogebraCommonAwtGGraphics2D>)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, f_, GeogebraCommonKernelArithmeticFunctionNVar *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, df_, JavaTextDecimalFormat *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, t_, id<GeogebraCommonAwtFontGTextLayout>)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, font_, GeogebraCommonAwtGFont *)
J2OBJC_FIELD_SETTER(GeogebraCommonKernelAlgosAlgoDensityPlot, view_, id<GeogebraCommonEuclidianEuclidianViewInterfaceCommon>)

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoDensityPlot_drawGrid(GeogebraCommonKernelAlgosAlgoDensityPlot *self);

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoDensityPlot_drawAxes(GeogebraCommonKernelAlgosAlgoDensityPlot *self);

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoDensityPlot_deleteAxes(GeogebraCommonKernelAlgosAlgoDensityPlot *self);

__attribute__((unused)) static void GeogebraCommonKernelAlgosAlgoDensityPlot_showGrid(GeogebraCommonKernelAlgosAlgoDensityPlot *self);

__attribute__((unused)) static jint GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(jdouble x1);

__attribute__((unused)) static IOSIntArray *GeogebraCommonKernelAlgosAlgoDensityPlot_hlsToRgbWithDouble_withDouble_withDouble_(jdouble h, jdouble l, jdouble s);

__attribute__((unused)) static IOSIntArray *GeogebraCommonKernelAlgosAlgoDensityPlot_rgbColorWithDouble_(jdouble zre);

@implementation GeogebraCommonKernelAlgosAlgoDensityPlot

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c
             withGeogebraCommonKernelGeosGeoFunctionNVar:(GeogebraCommonKernelGeosGeoFunctionNVar *)function {
  GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_(self, c, function);
  return self;
}

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons
             withGeogebraCommonKernelGeosGeoFunctionNVar:(GeogebraCommonKernelGeosGeoFunctionNVar *)geoFunctionNVar
                                              withDouble:(jdouble)lowX
                                              withDouble:(jdouble)highX
                                              withDouble:(jdouble)lowY
                                              withDouble:(jdouble)highY
                                             withBoolean:(jboolean)fixed {
  GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_withDouble_withDouble_withDouble_withDouble_withBoolean_(self, cons, geoFunctionNVar, lowX, highX, lowY, highY, fixed);
  return self;
}

- (void)setInputOutput {
  GeogebraCommonKernelAlgosAlgoElement_setAndConsume_input_(self, [IOSObjectArray newArrayWithLength:6 type:GeogebraCommonKernelGeosGeoElement_class_()]);
  IOSObjectArray_Set(input_, 0, function_);
  IOSObjectArray_SetAndConsume(input_, 1, new_GeogebraCommonKernelGeosGeoNumeric_initWithGeogebraCommonKernelConstruction_withDouble_(cons_, minX_));
  IOSObjectArray_SetAndConsume(input_, 2, new_GeogebraCommonKernelGeosGeoNumeric_initWithGeogebraCommonKernelConstruction_withDouble_(cons_, maxX_));
  IOSObjectArray_SetAndConsume(input_, 3, new_GeogebraCommonKernelGeosGeoNumeric_initWithGeogebraCommonKernelConstruction_withDouble_(cons_, minY_));
  IOSObjectArray_SetAndConsume(input_, 4, new_GeogebraCommonKernelGeosGeoNumeric_initWithGeogebraCommonKernelConstruction_withDouble_(cons_, maxY_));
  IOSObjectArray_SetAndConsume(input_, 5, new_GeogebraCommonKernelGeosGeoBoolean_initWithGeogebraCommonKernelConstruction_withBoolean_(cons_, fixed_));
  [super setOutputLengthWithInt:1];
  [super setOutputWithInt:0 withGeogebraCommonKernelGeosGeoElement:outputImage_];
  [self setDependencies];
}

- (void)compute {
  incX_ = scaleX_ / imageSize_ * grade_;
  incY_ = scaleY_ / imageSize_ * grade_;
  for (j_ = offset_, *IOSDoubleArray_GetRef(nil_chk(vals_), 1) = maxY_; j_ < imagePlusOffset_; *IOSDoubleArray_GetRef(vals_, 1) -= incY_, j_ += grade_) {
    for (i_ = offset_, *IOSDoubleArray_GetRef(vals_, 0) = minX_; i_ < imagePlusOffset_; *IOSDoubleArray_GetRef(vals_, 0) += incX_, i_ += grade_) {
      value_ = [((GeogebraCommonKernelArithmeticFunctionNVar *) nil_chk(f_)) evaluateWithDoubleArray:vals_];
      GeogebraCommonKernelAlgosAlgoDensityPlot_set_colors_(self, GeogebraCommonKernelAlgosAlgoDensityPlot_rgbColorWithDouble_(value_));
      GeogebraCommonKernelAlgosAlgoDensityPlot_set_color_(self, [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:IOSIntArray_Get(nil_chk(colors_), 0) withInt:IOSIntArray_Get(colors_, 1) withInt:IOSIntArray_Get(colors_, 1)]);
      [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(g_)) setColorWithGeogebraCommonAwtGColor:color_];
      [g_ fillRectWithInt:i_ withInt:j_ withInt:grade_ withInt:grade_];
    }
  }
}

- (void)drawGrid {
  GeogebraCommonKernelAlgosAlgoDensityPlot_drawGrid(self);
}

- (void)drawAxes {
  GeogebraCommonKernelAlgosAlgoDensityPlot_drawAxes(self);
}

- (GeogebraCommonKernelGeosGeoCanvasImage *)getResult {
  return outputImage_;
}

- (id<GeogebraCommonKernelAlgosGetCommand>)getClassName {
  return GeogebraCommonKernelCommandsCommandsEnum_get_DensityPlot();
}

- (void)update {
  if (!fixed_) {
    if (minX_ != [((id<GeogebraCommonEuclidianEuclidianViewInterfaceCommon>) nil_chk(view_)) getXmin] || minY_ != [view_ getYmin] || maxX_ != [view_ getXmax] || maxY_ != [view_ getYmax]) {
      minX_ = [view_ getXmin];
      minY_ = [view_ getYmin];
      maxX_ = [view_ getXmax];
      maxY_ = [view_ getYmax];
      scaleX_ = maxX_ - minX_;
      scaleY_ = maxY_ - minY_;
      [self compute];
      [self setInputOutput];
    }
  }
  GeogebraCommonKernelAlgosAlgoDensityPlot_deleteAxes(self);
  if ([((id<GeogebraCommonEuclidianEuclidianViewInterfaceCommon>) nil_chk(view_)) getShowAxisWithInt:GeogebraCommonEuclidianEuclidianViewInterfaceCommon_AXIS_X] || [view_ getShowAxisWithInt:GeogebraCommonEuclidianEuclidianViewInterfaceCommon_AXIS_Y]) {
    GeogebraCommonKernelAlgosAlgoDensityPlot_drawAxes(self);
  }
  GeogebraCommonKernelAlgosAlgoDensityPlot_showGrid(self);
}

- (void)deleteAxes {
  GeogebraCommonKernelAlgosAlgoDensityPlot_deleteAxes(self);
}

- (void)showGrid {
  GeogebraCommonKernelAlgosAlgoDensityPlot_showGrid(self);
}

+ (jint)colWithDouble:(jdouble)x1 {
  return GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(x1);
}

+ (IOSIntArray *)hlsToRgbWithDouble:(jdouble)h
                         withDouble:(jdouble)l
                         withDouble:(jdouble)s {
  return GeogebraCommonKernelAlgosAlgoDensityPlot_hlsToRgbWithDouble_withDouble_withDouble_(h, l, s);
}

+ (IOSIntArray *)rgbColorWithDouble:(jdouble)zre {
  return GeogebraCommonKernelAlgosAlgoDensityPlot_rgbColorWithDouble_(zre);
}

- (void)dealloc {
  RELEASE_(outputImage_);
  RELEASE_(function_);
  RELEASE_(colors_);
  RELEASE_(color_);
  RELEASE_(vals_);
  RELEASE_(g_);
  RELEASE_(f_);
  RELEASE_(df_);
  RELEASE_(t_);
  RELEASE_(font_);
  RELEASE_(view_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:withGeogebraCommonKernelGeosGeoFunctionNVar:", "AlgoDensityPlot", NULL, 0x1, NULL, NULL },
    { "initWithGeogebraCommonKernelConstruction:withGeogebraCommonKernelGeosGeoFunctionNVar:withDouble:withDouble:withDouble:withDouble:withBoolean:", "AlgoDensityPlot", NULL, 0x1, NULL, NULL },
    { "setInputOutput", NULL, "V", 0x4, NULL, NULL },
    { "compute", NULL, "V", 0x1, NULL, NULL },
    { "drawGrid", NULL, "V", 0x2, NULL, NULL },
    { "drawAxes", NULL, "V", 0x2, NULL, NULL },
    { "getResult", NULL, "Lgeogebra.common.kernel.geos.GeoCanvasImage;", 0x1, NULL, NULL },
    { "getClassName", NULL, "Lgeogebra.common.kernel.algos.GetCommand;", 0x1, NULL, NULL },
    { "update", NULL, "V", 0x1, NULL, NULL },
    { "deleteAxes", NULL, "V", 0x2, NULL, NULL },
    { "showGrid", NULL, "V", 0x2, NULL, NULL },
    { "colWithDouble:", "col", "I", 0xa, NULL, NULL },
    { "hlsToRgbWithDouble:withDouble:withDouble:", "hlsToRgb", "[I", 0xa, NULL, NULL },
    { "rgbColorWithDouble:", "rgbColor", "[I", 0xa, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "outputImage_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoCanvasImage;", NULL, NULL,  },
    { "function_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoFunctionNVar;", NULL, NULL,  },
    { "minX_", NULL, 0x2, "D", NULL, NULL,  },
    { "maxX_", NULL, 0x2, "D", NULL, NULL,  },
    { "minY_", NULL, 0x2, "D", NULL, NULL,  },
    { "maxY_", NULL, 0x2, "D", NULL, NULL,  },
    { "offset_", NULL, 0x2, "I", NULL, NULL,  },
    { "imageSize_", NULL, 0x2, "I", NULL, NULL,  },
    { "gridPixel_", NULL, 0x2, "I", NULL, NULL,  },
    { "colors_", NULL, 0x2, "[I", NULL, NULL,  },
    { "i_", NULL, 0x2, "I", NULL, NULL,  },
    { "j_", NULL, 0x2, "I", NULL, NULL,  },
    { "color_", NULL, 0x2, "Lgeogebra.common.awt.GColor;", NULL, NULL,  },
    { "incX_", NULL, 0x2, "D", NULL, NULL,  },
    { "incY_", NULL, 0x2, "D", NULL, NULL,  },
    { "vals_", NULL, 0x2, "[D", NULL, NULL,  },
    { "g_", NULL, 0x2, "Lgeogebra.common.awt.GGraphics2D;", NULL, NULL,  },
    { "f_", NULL, 0x2, "Lgeogebra.common.kernel.arithmetic.FunctionNVar;", NULL, NULL,  },
    { "df_", NULL, 0x2, "Ljava.text.DecimalFormat;", NULL, NULL,  },
    { "t_", NULL, 0x2, "Lgeogebra.common.awt.font.GTextLayout;", NULL, NULL,  },
    { "font_", NULL, 0x2, "Lgeogebra.common.awt.GFont;", NULL, NULL,  },
    { "scaleX_", NULL, 0x2, "D", NULL, NULL,  },
    { "scaleY_", NULL, 0x2, "D", NULL, NULL,  },
    { "grade_", NULL, 0x2, "I", NULL, NULL,  },
    { "view_", NULL, 0x2, "Lgeogebra.common.euclidian.EuclidianViewInterfaceCommon;", NULL, NULL,  },
    { "fixed_", NULL, 0x2, "Z", NULL, NULL,  },
    { "imagePlusOffset_", NULL, 0x2, "I", NULL, NULL,  },
    { "value_", NULL, 0x2, "D", NULL, NULL,  },
    { "prevGrid_", NULL, 0x2, "Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonKernelAlgosAlgoDensityPlot = { 2, "AlgoDensityPlot", "geogebra.common.kernel.algos", NULL, 0x1, 14, methods, 29, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonKernelAlgosAlgoDensityPlot;
}

@end

void GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_(GeogebraCommonKernelAlgosAlgoDensityPlot *self, GeogebraCommonKernelConstruction *c, GeogebraCommonKernelGeosGeoFunctionNVar *function) {
  GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_withDouble_withDouble_withDouble_withDouble_withBoolean_(self, c, function, -2, 2, -2, 2, NO);
}

GeogebraCommonKernelAlgosAlgoDensityPlot *new_GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_(GeogebraCommonKernelConstruction *c, GeogebraCommonKernelGeosGeoFunctionNVar *function) {
  GeogebraCommonKernelAlgosAlgoDensityPlot *self = [GeogebraCommonKernelAlgosAlgoDensityPlot alloc];
  GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_(self, c, function);
  return self;
}

void GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_withDouble_withDouble_withDouble_withDouble_withBoolean_(GeogebraCommonKernelAlgosAlgoDensityPlot *self, GeogebraCommonKernelConstruction *cons, GeogebraCommonKernelGeosGeoFunctionNVar *geoFunctionNVar, jdouble lowX, jdouble highX, jdouble lowY, jdouble highY, jboolean fixed) {
  GeogebraCommonKernelAlgosAlgoElement_initWithGeogebraCommonKernelConstruction_(self, cons);
  self->offset_ = 30;
  self->imageSize_ = 280;
  self->gridPixel_ = 14;
  GeogebraCommonKernelAlgosAlgoDensityPlot_setAndConsume_vals_(self, [IOSDoubleArray newArrayWithLength:2]);
  GeogebraCommonKernelAlgosAlgoDensityPlot_set_font_(self, [((GeogebraCommonAwtGFont *) nil_chk([((GeogebraCommonMainApp *) nil_chk([((GeogebraCommonKernelKernel *) nil_chk(self->kernel_)) getApplication])) getFontCanDisplayWithNSString:@"-999"])) deriveFontWithInt:GeogebraCommonAwtGFont_PLAIN withInt:8]);
  self->grade_ = 1;
  if ([((GeogebraCommonMainApp *) nil_chk([self->kernel_ getApplication])) isHTML5Applet]) {
    self->grade_ = 2;
    self->offset_ = 25;
  }
  GeogebraCommonKernelAlgosAlgoDensityPlot_set_function_(self, geoFunctionNVar);
  GeogebraCommonKernelAlgosAlgoDensityPlot_set_f_(self, [((GeogebraCommonKernelGeosGeoFunctionNVar *) nil_chk(self->function_)) getFunction]);
  GeogebraCommonKernelAlgosAlgoDensityPlot_set_view_(self, [((GeogebraCommonMainApp *) nil_chk([self->kernel_ getApplication])) getActiveEuclidianView]);
  self->fixed_ = fixed;
  self->minX_ = -2;
  self->minY_ = -2;
  self->maxX_ = 2;
  self->maxY_ = 2;
  if (fixed) {
    self->minX_ = lowX;
    self->minY_ = lowY;
    self->maxX_ = highX;
    self->maxY_ = highY;
  }
  self->scaleX_ = self->maxX_ - self->minX_;
  self->scaleY_ = self->maxY_ - self->minY_;
  self->imageSize_ /= self->grade_;
  self->gridPixel_ /= self->grade_;
  GeogebraCommonKernelAlgosAlgoDensityPlot_setAndConsume_outputImage_(self, new_GeogebraCommonKernelGeosGeoCanvasImage_initWithGeogebraCommonKernelConstruction_withInt_withInt_(cons, self->imageSize_ + 2 * self->offset_, self->imageSize_ + 2 * self->offset_));
  GeogebraCommonKernelAlgosAlgoDensityPlot_set_g_(self, [self->outputImage_ getGraphics]);
  [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(self->g_)) setFontWithGeogebraCommonAwtGFont:self->font_];
  [self->g_ setColorWithGeogebraCommonAwtGColor:GeogebraCommonAwtGColor_get_white_()];
  [self->g_ fillRectWithInt:0 withInt:0 withInt:self->imageSize_ + 2 * self->offset_ withInt:self->offset_];
  GeogebraCommonKernelAlgosAlgoDensityPlot_setAndConsume_df_(self, new_JavaTextDecimalFormat_initWithNSString_(@"0.##"));
  self->imagePlusOffset_ = self->imageSize_ + self->offset_;
  [self->outputImage_ setAbsoluteScreenLocActiveWithBoolean:YES];
  [self->outputImage_ setAbsoluteScreenLocWithInt:[((id<GeogebraCommonEuclidianEuclidianViewInterfaceCommon>) nil_chk(self->view_)) getViewWidth] / 2 - (self->imageSize_ + 2 * self->offset_) / 2 withInt:[self->view_ getViewHeight] / 2 + (self->imageSize_ + 2 * self->offset_) / 2];
  [self setInputOutput];
  GeogebraCommonKernelAlgosAlgoDensityPlot_deleteAxes(self);
  if (fixed) {
    [self compute];
  }
  [self update];
}

GeogebraCommonKernelAlgosAlgoDensityPlot *new_GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_withDouble_withDouble_withDouble_withDouble_withBoolean_(GeogebraCommonKernelConstruction *cons, GeogebraCommonKernelGeosGeoFunctionNVar *geoFunctionNVar, jdouble lowX, jdouble highX, jdouble lowY, jdouble highY, jboolean fixed) {
  GeogebraCommonKernelAlgosAlgoDensityPlot *self = [GeogebraCommonKernelAlgosAlgoDensityPlot alloc];
  GeogebraCommonKernelAlgosAlgoDensityPlot_initWithGeogebraCommonKernelConstruction_withGeogebraCommonKernelGeosGeoFunctionNVar_withDouble_withDouble_withDouble_withDouble_withBoolean_(self, cons, geoFunctionNVar, lowX, highX, lowY, highY, fixed);
  return self;
}

void GeogebraCommonKernelAlgosAlgoDensityPlot_drawGrid(GeogebraCommonKernelAlgosAlgoDensityPlot *self) {
  [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(self->g_)) setColorWithGeogebraCommonAwtGColor:GeogebraCommonAwtGColor_get_lightGray_()];
  for (self->i_ = self->offset_; self->i_ <= self->imagePlusOffset_; self->i_ += self->gridPixel_ * 5) {
    [self->g_ drawLineWithInt:self->i_ withInt:self->offset_ withInt:self->i_ withInt:self->imagePlusOffset_];
  }
  for (self->i_ = self->offset_; self->i_ <= self->imagePlusOffset_; self->i_ += self->gridPixel_ * 5) {
    [self->g_ drawLineWithInt:self->offset_ withInt:self->i_ withInt:self->imagePlusOffset_ withInt:self->i_];
  }
}

void GeogebraCommonKernelAlgosAlgoDensityPlot_drawAxes(GeogebraCommonKernelAlgosAlgoDensityPlot *self) {
  jdouble xx = self->minX_;
  jdouble yy = self->maxY_;
  [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(self->g_)) setColorWithGeogebraCommonAwtGColor:GeogebraCommonAwtGColor_get_gray_()];
  for (self->i_ = self->offset_; self->i_ <= self->imagePlusOffset_; self->i_ += self->gridPixel_ * 5) {
    [self->g_ drawLineWithInt:self->i_ withInt:self->imagePlusOffset_ withInt:self->i_ withInt:self->imagePlusOffset_ + 2];
    [self->g_ drawLineWithInt:self->offset_ - 2 withInt:self->i_ withInt:self->offset_ withInt:self->i_];
  }
  [self->g_ setColorWithGeogebraCommonAwtGColor:GeogebraCommonAwtGColor_get_black_()];
  for (self->i_ = self->offset_; self->i_ <= self->imagePlusOffset_; self->i_ += self->gridPixel_ * 5) {
    GeogebraCommonKernelAlgosAlgoDensityPlot_set_t_(self, [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newTextLayoutWithNSString:[((JavaTextDecimalFormat *) nil_chk(self->df_)) formatWithDouble:xx] withGeogebraCommonAwtGFont:self->font_ withGeogebraCommonAwtGFontRenderContext:[self->g_ getFontRenderContext]]);
    [self->g_ drawStringWithNSString:[self->df_ formatWithDouble:xx] withFloat:self->i_ - [((id<GeogebraCommonAwtFontGTextLayout>) nil_chk(self->t_)) getAdvance] / 2 withFloat:self->imageSize_ + 2 * self->offset_ - self->offset_ / 3];
    [self->g_ drawStringWithNSString:[self->df_ formatWithDouble:yy] withInt:1 withInt:self->i_ + 4];
    yy -= self->incY_ * self->gridPixel_ * 5 / self->grade_;
    xx += self->incX_ * self->gridPixel_ * 5 / self->grade_;
  }
}

void GeogebraCommonKernelAlgosAlgoDensityPlot_deleteAxes(GeogebraCommonKernelAlgosAlgoDensityPlot *self) {
  [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(self->g_)) setColorWithGeogebraCommonAwtGColor:GeogebraCommonAwtGColor_get_white_()];
  [self->g_ fillRectWithInt:0 withInt:self->imagePlusOffset_ withInt:self->imagePlusOffset_ + 2 * self->offset_ withInt:self->offset_];
  [self->g_ fillRectWithInt:0 withInt:self->offset_ withInt:self->offset_ withInt:self->imagePlusOffset_];
  [self->g_ fillRectWithInt:0 withInt:0 withInt:self->imagePlusOffset_ + 2 * self->offset_ withInt:self->offset_];
  [self->g_ fillRectWithInt:self->imagePlusOffset_ withInt:self->offset_ withInt:self->offset_ withInt:self->imageSize_];
}

void GeogebraCommonKernelAlgosAlgoDensityPlot_showGrid(GeogebraCommonKernelAlgosAlgoDensityPlot *self) {
  if ([((id<GeogebraCommonEuclidianEuclidianViewInterfaceCommon>) nil_chk(self->view_)) getShowGrid]) {
    GeogebraCommonKernelAlgosAlgoDensityPlot_drawGrid(self);
    self->prevGrid_ = YES;
  }
  else {
    if ([self->view_ getShowGrid] != self->prevGrid_ && self->prevGrid_) {
      self->prevGrid_ = NO;
      [self compute];
    }
  }
}

jint GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(jdouble x1) {
  GeogebraCommonKernelAlgosAlgoDensityPlot_initialize();
  jint code;
  code = J2ObjCFpToInt((x1 * 256));
  if (code > 255) {
    return 255;
  }
  return (code);
}

IOSIntArray *GeogebraCommonKernelAlgosAlgoDensityPlot_hlsToRgbWithDouble_withDouble_withDouble_(jdouble h, jdouble l, jdouble s) {
  GeogebraCommonKernelAlgosAlgoDensityPlot_initialize();
  IOSIntArray *rgb = [IOSIntArray arrayWithLength:2];
  jdouble m2;
  if (l < 0.5) {
    m2 = l * (1 + s);
  }
  else {
    m2 = l + s - l * s;
  }
  if (h == 180) {
    *IOSIntArray_GetRef(rgb, 1) = GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(m2);
    *IOSIntArray_GetRef(rgb, 0) = GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(2.0 * l - m2);
  }
  else {
    *IOSIntArray_GetRef(rgb, 1) = GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(2.0 * l - m2);
    *IOSIntArray_GetRef(rgb, 0) = GeogebraCommonKernelAlgosAlgoDensityPlot_colWithDouble_(m2);
  }
  return rgb;
}

IOSIntArray *GeogebraCommonKernelAlgosAlgoDensityPlot_rgbColorWithDouble_(jdouble zre) {
  GeogebraCommonKernelAlgosAlgoDensityPlot_initialize();
  jdouble xx;
  xx = 1.0 - 2.0 * JavaLangMath_atanWithDouble_(JavaLangMath_sqrtWithDouble_(zre * zre)) / JavaLangMath_PI;
  jdouble x1 = xx <= 0.5 ? 2 * xx : 2 - 2 * xx;
  jdouble arg = zre < 0 ? 180 : 0;
  return GeogebraCommonKernelAlgosAlgoDensityPlot_hlsToRgbWithDouble_withDouble_withDouble_(arg, xx, x1);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelAlgosAlgoDensityPlot)
