//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/geogebra3D/euclidian3D/draw/DrawPlane3D.java
//


#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/awt/GColor.h"
#include "geogebra/common/euclidian/EuclidianController.h"
#include "geogebra/common/geogebra3D/euclidian3D/EuclidianView3D.h"
#include "geogebra/common/geogebra3D/euclidian3D/Hitting.h"
#include "geogebra/common/geogebra3D/euclidian3D/draw/DrawPlane3D.h"
#include "geogebra/common/geogebra3D/euclidian3D/draw/Drawable3D.h"
#include "geogebra/common/geogebra3D/euclidian3D/draw/Drawable3DLists.h"
#include "geogebra/common/geogebra3D/euclidian3D/draw/Drawable3DSurfaces.h"
#include "geogebra/common/geogebra3D/euclidian3D/openGL/Manager.h"
#include "geogebra/common/geogebra3D/euclidian3D/openGL/PlotterBrush.h"
#include "geogebra/common/geogebra3D/euclidian3D/openGL/PlotterSurface.h"
#include "geogebra/common/geogebra3D/euclidian3D/openGL/Renderer.h"
#include "geogebra/common/geogebra3D/euclidian3D/openGL/Textures.h"
#include "geogebra/common/geogebra3D/kernel3D/geos/GeoPlane3D.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/Matrix/CoordMatrix.h"
#include "geogebra/common/kernel/Matrix/CoordMatrix4x4.h"
#include "geogebra/common/kernel/Matrix/CoordSys.h"
#include "geogebra/common/kernel/Matrix/Coords.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "java/lang/Double.h"

#define GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_REDUCE_BOUNDS_FACTOR 0.975

@interface GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D () {
 @public
  jint gridIndex_;
  jint gridOutlineIndex_;
  jboolean viewDirectionIsParallel_;
  GeogebraCommonKernelMatrixCoords *o_;
  GeogebraCommonKernelMatrixCoords *tmpCoords1_, *tmpCoords2_;
}

- (void)drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer;

- (void)setMinMaxWithGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)origin
                 withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)vx
                 withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)vy
                 withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)vz;

- (void)checkViewDirectionIsParallel;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D, o_, GeogebraCommonKernelMatrixCoords *)
J2OBJC_FIELD_SETTER(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D, tmpCoords1_, GeogebraCommonKernelMatrixCoords *)
J2OBJC_FIELD_SETTER(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D, tmpCoords2_, GeogebraCommonKernelMatrixCoords *)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D, REDUCE_BOUNDS_FACTOR, jdouble)

__attribute__((unused)) static void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer_(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self, GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *renderer);

__attribute__((unused)) static void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_setMinMaxWithGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self, GeogebraCommonKernelMatrixCoords *origin, GeogebraCommonKernelMatrixCoords *vx, GeogebraCommonKernelMatrixCoords *vy, GeogebraCommonKernelMatrixCoords *vz);

__attribute__((unused)) static void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_checkViewDirectionIsParallel(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self);

@implementation GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D

- (void)setWaitForReset {
  gridIndex_ = -1;
  gridOutlineIndex_ = -1;
  [super setWaitForReset];
}

- (instancetype)initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D:(GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *)a_view3D
                        withGeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D:(GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *)a_plane3D {
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D_withGeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D_(self, a_view3D, a_plane3D);
  return self;
}

- (void)drawGeometryWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer {
  if ([((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class])))) isPlateVisible]) GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer_(self, renderer);
}

- (void)drawSurfaceGeometryWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer {
  [self drawGeometryWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:renderer];
}

- (void)drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer {
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer_(self, renderer);
}

- (void)drawGeometryHidingWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer {
  GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *plane = (GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class]);
  if ([((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(plane)) isPlateVisible]) {
    GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer_(self, renderer);
  }
}

- (void)drawOutlineWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer {
}

- (void)drawGeometryHiddenWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:(GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *)renderer {
  if (![self isVisible]) return;
  if (![self isGridVisible]) return;
  if (viewDirectionIsParallel_) {
    [((GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *) nil_chk(renderer)) setDashTextureWithInt:GeogebraCommonGeogebra3DEuclidian3DOpenGLTextures_get_DASH_LONG_()];
    [((GeogebraCommonGeogebra3DEuclidian3DOpenGLManager *) nil_chk([renderer getGeometryManager])) drawWithInt:gridOutlineIndex_];
  }
  else {
    [((GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *) nil_chk(renderer)) setDashTextureWithInt:GeogebraCommonGeogebra3DEuclidian3DOpenGLTextures_get_DASH_SHORT_()];
    [((GeogebraCommonGeogebra3DEuclidian3DOpenGLManager *) nil_chk([renderer getGeometryManager])) drawWithInt:gridIndex_];
  }
}

- (jboolean)isGridVisible {
  return [((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class])))) isGridVisible] || viewDirectionIsParallel_;
}

- (jboolean)updateForItSelf {
  [((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class])))) setGridCornersWithDouble:IOSDoubleArray_Get(nil_chk(minmaxXFinal_), 0) withDouble:IOSDoubleArray_Get(nil_chk(minmaxYFinal_), 0) withDouble:IOSDoubleArray_Get(minmaxXFinal_, 1) withDouble:IOSDoubleArray_Get(minmaxYFinal_, 1)];
  return [self updateGeometry];
}

- (jboolean)updateGeometry {
  GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *renderer = [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getRenderer];
  GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *geo = (GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class]);
  GeogebraCommonKernelMatrixCoordSys *coordsys = [((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(geo)) getCoordSys];
  jfloat xmin1 = (jfloat) [geo getXmin], xmax1 = (jfloat) [geo getXmax], xdelta1 = xmax1 - xmin1;
  jfloat ymin1 = (jfloat) [geo getYmin], ymax1 = (jfloat) [geo getYmax], ydelta1 = ymax1 - ymin1;
  GeogebraCommonGeogebra3DEuclidian3DOpenGLPlotterSurface *surface = [((GeogebraCommonGeogebra3DEuclidian3DOpenGLManager *) nil_chk([((GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *) nil_chk(renderer)) getGeometryManager])) getSurface];
  [((GeogebraCommonGeogebra3DEuclidian3DOpenGLPlotterSurface *) nil_chk(surface)) startWithGeogebraCommonKernelArithmeticFunctional2Var:geo withInt:[self getReusableSurfaceIndex]];
  [surface setUWithFloat:xmin1 withFloat:xmax1];
  [surface setNbUWithInt:2];
  [surface setVWithFloat:ymin1 withFloat:ymax1];
  [surface setNbVWithInt:2];
  if (![((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) useClippingCube]) {
    jfloat fading;
    fading = xdelta1 * [geo getFading];
    [surface setUFadingWithFloat:fading withFloat:fading];
    fading = ydelta1 * [geo getFading];
    [surface setVFadingWithFloat:fading withFloat:fading];
  }
  [surface draw];
  [self setSurfaceIndexWithInt:[surface end]];
  if ([self isGridVisible]) {
    GeogebraCommonGeogebra3DEuclidian3DOpenGLPlotterBrush *brush = [((GeogebraCommonGeogebra3DEuclidian3DOpenGLManager *) nil_chk([renderer getGeometryManager])) getBrush];
    if ([self hasTrace]) {
      [((GeogebraCommonGeogebra3DEuclidian3DOpenGLPlotterBrush *) nil_chk(brush)) startWithInt:-1];
    }
    else {
      [((GeogebraCommonGeogebra3DEuclidian3DOpenGLPlotterBrush *) nil_chk(brush)) startWithInt:gridIndex_];
    }
    [self removeGeometryIndexWithInt:gridIndex_];
    jfloat thickness = [((GeogebraCommonGeogebra3DEuclidian3DOpenGLPlotterBrush *) nil_chk(brush)) setThicknessWithInt:[((GeogebraCommonKernelGeosGeoElement *) nil_chk([self getGeoElement])) getLineThickness] withFloat:(jfloat) [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getScale]];
    [brush setColorWithGeogebraCommonAwtGColor:[((GeogebraCommonKernelGeosGeoElement *) nil_chk([self getGeoElement])) getObjectColor]];
    jdouble dx = [geo getGridXd];
    [geo getGridYd];
    jdouble dy;
    if (JavaLangDouble_isNaNWithDouble_(dx)) {
      dx = [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getNumbersDistance];
      dy = dx;
    }
    else {
      dy = [geo getGridYd];
    }
    [brush setAffineTextureWithFloat:(0.0f - xmin1) / ydelta1 withFloat:0.25f];
    jint i0 = J2ObjCFpToInt((ymin1 / dy));
    if (ymin1 > 0) i0++;
    for (jint i = i0; i <= ymax1 / dy; i++) [brush segmentWithGeogebraCommonKernelMatrixCoords:[((GeogebraCommonKernelMatrixCoordSys *) nil_chk(coordsys)) getPointForDrawingWithDouble:xmin1 withDouble:i * dy] withGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmax1 withDouble:i * dy]];
    [brush setAffineTextureWithFloat:(0.0f - ymin1) / xdelta1 withFloat:0.25f];
    i0 = J2ObjCFpToInt((xmin1 / dx));
    if (xmin1 > 0) i0++;
    for (jint i = i0; i <= xmax1 / dx; i++) [brush segmentWithGeogebraCommonKernelMatrixCoords:[((GeogebraCommonKernelMatrixCoordSys *) nil_chk(coordsys)) getPointForDrawingWithDouble:i * dx withDouble:ymin1] withGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:i * dx withDouble:ymax1]];
    gridIndex_ = [brush end];
    [brush startWithInt:gridOutlineIndex_];
    [self removeGeometryIndexWithInt:gridOutlineIndex_];
    jboolean showClippingCube = [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) showClippingCube];
    if (showClippingCube) {
      [brush setAffineTextureWithFloat:(0.0f - xmin1) / ydelta1 withFloat:0.25f];
    }
    else [brush setPlainTexture];
    [brush segmentWithGeogebraCommonKernelMatrixCoords:[((GeogebraCommonKernelMatrixCoordSys *) nil_chk(coordsys)) getPointForDrawingWithDouble:xmin1 withDouble:ymax1 - thickness] withGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmax1 withDouble:ymax1 - thickness]];
    [brush segmentWithGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmin1 withDouble:ymin1 + thickness] withGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmax1 withDouble:ymin1 + thickness]];
    if (showClippingCube) {
      [brush setAffineTextureWithFloat:(0.0f - ymin1) / xdelta1 withFloat:0.25f];
    }
    [brush segmentWithGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmin1 + thickness withDouble:ymin1] withGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmin1 + thickness withDouble:ymax1]];
    [brush segmentWithGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmax1 - thickness withDouble:ymin1] withGeogebraCommonKernelMatrixCoords:[coordsys getPointForDrawingWithDouble:xmax1 - thickness withDouble:ymax1]];
    gridOutlineIndex_ = [brush end];
  }
  return YES;
}

- (void)updateForView {
  if ([((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) viewChanged]) {
    if (![((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) viewChangedByTranslate] && ![((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) viewChangedByZoom]) {
      jboolean oldViewDirectionIsParallel = viewDirectionIsParallel_;
      GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_checkViewDirectionIsParallel(self);
      if (oldViewDirectionIsParallel != viewDirectionIsParallel_) {
        [self setWaitForUpdate];
      }
      return;
    }
    [self setWaitForUpdate];
  }
}

- (void)setWaitForUpdate {
  [super setWaitForUpdate];
  [self setMinMax];
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_checkViewDirectionIsParallel(self);
}

- (void)setMinMax {
  if (![((GeogebraCommonKernelGeosGeoElement *) nil_chk([self getGeoElement])) isDefined]) {
    return;
  }
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_setMinMaxWithGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_(self, [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getClippingVertexWithInt:0], [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getClippingVertexWithInt:1], [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getClippingVertexWithInt:2], [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getClippingVertexWithInt:4]);
}

- (void)setMinMaxWithGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)origin
                 withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)vx
                 withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)vy
                 withGeogebraCommonKernelMatrixCoords:(GeogebraCommonKernelMatrixCoords *)vz {
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_setMinMaxWithGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_(self, origin, vx, vy, vz);
}

- (jint)getPickOrder {
  return GeogebraCommonGeogebra3DEuclidian3DDrawDrawable3D_DRAW_PICK_ORDER_SURFACE;
}

- (void)addToDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:(GeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists *)lists {
  [self addToDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:lists withInt:GeogebraCommonGeogebra3DEuclidian3DDrawDrawable3D_DRAW_TYPE_CURVES];
  [super addToDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:lists];
}

- (void)removeFromDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:(GeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists *)lists {
  [self removeFromDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:lists withInt:GeogebraCommonGeogebra3DEuclidian3DDrawDrawable3D_DRAW_TYPE_CURVES];
  [super removeFromDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:lists];
}

- (void)checkViewDirectionIsParallel {
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_checkViewDirectionIsParallel(self);
}

- (void)setWaitForUpdateVisualStyle {
  [super setWaitForUpdateVisualStyle];
  [self setWaitForUpdate];
}

- (jboolean)hitWithGeogebraCommonGeogebra3DEuclidian3DHitting:(GeogebraCommonGeogebra3DEuclidian3DHitting *)hitting {
  if (waitForReset_) {
    return NO;
  }
  if ([((GeogebraCommonKernelGeosGeoElement *) nil_chk([self getGeoElement])) getAlphaValue] < GeogebraCommonEuclidianEuclidianController_MIN_VISIBLE_ALPHA_VALUE) {
    return NO;
  }
  GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *plane = (GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class]);
  if ([((GeogebraCommonGeogebra3DEuclidian3DHitting *) nil_chk(hitting)) isSphere]) {
    [((GeogebraCommonKernelMatrixCoords *) nil_chk(hitting->origin_)) projectPlaneWithGeogebraCommonKernelMatrixCoordMatrix:[((GeogebraCommonKernelMatrixCoordSys *) nil_chk([((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(plane)) getCoordSys])) getDrawingMatrix] withGeogebraCommonKernelMatrixCoords:tmpCoords1_ withGeogebraCommonKernelMatrixCoords:tmpCoords2_];
  }
  else {
    [((GeogebraCommonKernelMatrixCoords *) nil_chk(hitting->origin_)) projectPlaneThruVIfPossibleWithGeogebraCommonKernelMatrixCoordMatrix:[((GeogebraCommonKernelMatrixCoordSys *) nil_chk([((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(plane)) getCoordSys])) getDrawingMatrix] withGeogebraCommonKernelMatrixCoords:hitting->direction_ withGeogebraCommonKernelMatrixCoords:tmpCoords1_ withGeogebraCommonKernelMatrixCoords:tmpCoords2_];
  }
  if (![hitting isInsideClippingWithGeogebraCommonKernelMatrixCoords:tmpCoords1_]) {
    return NO;
  }
  jdouble x = [((GeogebraCommonKernelMatrixCoords *) nil_chk(tmpCoords2_)) getX];
  if (x < [((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(plane)) getXmin]) {
    return NO;
  }
  if (x > [plane getXmax]) {
    return NO;
  }
  jdouble y = [tmpCoords2_ getY];
  if (y < [plane getYmin]) {
    return NO;
  }
  if (y > [plane getYmax]) {
    return NO;
  }
  if ([hitting isSphere]) {
    jdouble d = [((GeogebraCommonKernelMatrixCoords *) nil_chk(tmpCoords1_)) distanceWithGeogebraCommonKernelMatrixCoords:hitting->origin_];
    jdouble scale_ = [((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getScale];
    if (d * scale_ <= [hitting getThreshold]) {
      [self setZPickWithDouble:-d withDouble:-d];
      return YES;
    }
  }
  else {
    jdouble parameterOnHitting = [tmpCoords2_ getZ];
    [self setZPickWithDouble:parameterOnHitting withDouble:parameterOnHitting];
    return YES;
  }
  return NO;
}

- (void)dealloc {
  RELEASE_(minmaxXFinal_);
  RELEASE_(minmaxYFinal_);
  RELEASE_(o_);
  RELEASE_(tmpCoords1_);
  RELEASE_(tmpCoords2_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "setWaitForReset", NULL, "V", 0x1, NULL, NULL },
    { "initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D:withGeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D:", "DrawPlane3D", NULL, 0x1, NULL, NULL },
    { "drawGeometryWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:", "drawGeometry", "V", 0x1, NULL, NULL },
    { "drawSurfaceGeometryWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:", "drawSurfaceGeometry", "V", 0x4, NULL, NULL },
    { "drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:", "drawPlate", "V", 0x2, NULL, NULL },
    { "drawGeometryHidingWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:", "drawGeometryHiding", "V", 0x1, NULL, NULL },
    { "drawOutlineWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:", "drawOutline", "V", 0x1, NULL, NULL },
    { "drawGeometryHiddenWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer:", "drawGeometryHidden", "V", 0x1, NULL, NULL },
    { "isGridVisible", NULL, "Z", 0x4, NULL, NULL },
    { "updateForItSelf", NULL, "Z", 0x4, NULL, NULL },
    { "updateGeometry", NULL, "Z", 0x4, NULL, NULL },
    { "updateForView", NULL, "V", 0x4, NULL, NULL },
    { "setWaitForUpdate", NULL, "V", 0x1, NULL, NULL },
    { "setMinMax", NULL, "V", 0x4, NULL, NULL },
    { "setMinMaxWithGeogebraCommonKernelMatrixCoords:withGeogebraCommonKernelMatrixCoords:withGeogebraCommonKernelMatrixCoords:withGeogebraCommonKernelMatrixCoords:", "setMinMax", "V", 0x2, NULL, NULL },
    { "getPickOrder", NULL, "I", 0x1, NULL, NULL },
    { "addToDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:", "addToDrawable3DLists", "V", 0x1, NULL, NULL },
    { "removeFromDrawable3DListsWithGeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DLists:", "removeFromDrawable3DLists", "V", 0x1, NULL, NULL },
    { "checkViewDirectionIsParallel", NULL, "V", 0x2, NULL, NULL },
    { "setWaitForUpdateVisualStyle", NULL, "V", 0x1, NULL, NULL },
    { "hitWithGeogebraCommonGeogebra3DEuclidian3DHitting:", "hit", "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "gridIndex_", NULL, 0x2, "I", NULL, NULL,  },
    { "gridOutlineIndex_", NULL, 0x2, "I", NULL, NULL,  },
    { "xmin_", NULL, 0x4, "D", NULL, NULL,  },
    { "xmax_", NULL, 0x4, "D", NULL, NULL,  },
    { "ymin_", NULL, 0x4, "D", NULL, NULL,  },
    { "ymax_", NULL, 0x4, "D", NULL, NULL,  },
    { "minmaxXFinal_", NULL, 0x0, "[D", NULL, NULL,  },
    { "minmaxYFinal_", NULL, 0x0, "[D", NULL, NULL,  },
    { "viewDirectionIsParallel_", NULL, 0x2, "Z", NULL, NULL,  },
    { "o_", NULL, 0x2, "Lgeogebra.common.kernel.Matrix.Coords;", NULL, NULL,  },
    { "tmpCoords1_", NULL, 0x2, "Lgeogebra.common.kernel.Matrix.Coords;", NULL, NULL,  },
    { "tmpCoords2_", NULL, 0x2, "Lgeogebra.common.kernel.Matrix.Coords;", NULL, NULL,  },
    { "REDUCE_BOUNDS_FACTOR_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_REDUCE_BOUNDS_FACTOR },
  };
  static const J2ObjcClassInfo _GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D = { 2, "DrawPlane3D", "geogebra.common.geogebra3D.euclidian3D.draw", NULL, 0x1, 21, methods, 13, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D;
}

@end

void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D_withGeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D_(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self, GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *a_view3D, GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *a_plane3D) {
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawable3DSurfaces_initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D_withGeogebraCommonKernelGeosGeoElement_(self, a_view3D, a_plane3D);
  self->gridIndex_ = -1;
  self->gridOutlineIndex_ = -1;
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_setAndConsume_minmaxXFinal_(self, [IOSDoubleArray newArrayWithLength:2]);
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_setAndConsume_minmaxYFinal_(self, [IOSDoubleArray newArrayWithLength:2]);
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_set_o_(self, GeogebraCommonKernelMatrixCoords_createInhomCoorsInD3());
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_set_tmpCoords1_(self, GeogebraCommonKernelMatrixCoords_createInhomCoorsInD3());
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_set_tmpCoords2_(self, GeogebraCommonKernelMatrixCoords_createInhomCoorsInD3());
  [self setMinMax];
}

GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *new_GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D_withGeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D_(GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *a_view3D, GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *a_plane3D) {
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self = [GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D alloc];
  GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_initWithGeogebraCommonGeogebra3DEuclidian3DEuclidianView3D_withGeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D_(self, a_view3D, a_plane3D);
  return self;
}

void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_drawPlateWithGeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer_(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self, GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *renderer) {
  [((GeogebraCommonGeogebra3DEuclidian3DOpenGLRenderer *) nil_chk(renderer)) setLayerWithFloat:[self getLayer] - 1.0f];
  [((GeogebraCommonGeogebra3DEuclidian3DOpenGLManager *) nil_chk([renderer getGeometryManager])) drawWithInt:[self getSurfaceIndex]];
  [renderer setLayerWithFloat:0];
}

void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_setMinMaxWithGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_withGeogebraCommonKernelMatrixCoords_(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self, GeogebraCommonKernelMatrixCoords *origin, GeogebraCommonKernelMatrixCoords *vx, GeogebraCommonKernelMatrixCoords *vy, GeogebraCommonKernelMatrixCoords *vz) {
  GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *geo = (GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class]);
  GeogebraCommonKernelMatrixCoordMatrix *m = [((GeogebraCommonKernelMatrixCoordSys *) nil_chk([((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(geo)) getCoordSys])) getDrawingMatrix];
  [((GeogebraCommonKernelMatrixCoords *) nil_chk(origin)) projectPlaneInPlaneCoordsWithGeogebraCommonKernelMatrixCoordMatrix:m withGeogebraCommonKernelMatrixCoords:self->o_];
  *IOSDoubleArray_GetRef(nil_chk(self->minmaxXFinal_), 0) = [((GeogebraCommonKernelMatrixCoords *) nil_chk(self->o_)) getX];
  *IOSDoubleArray_GetRef(nil_chk(self->minmaxYFinal_), 0) = [self->o_ getY];
  *IOSDoubleArray_GetRef(self->minmaxXFinal_, 1) = [self->o_ getX];
  *IOSDoubleArray_GetRef(self->minmaxYFinal_, 1) = [self->o_ getY];
  IOSObjectArray *v = [IOSObjectArray arrayWithLength:3 type:GeogebraCommonKernelMatrixCoords_class_()];
  [((GeogebraCommonKernelMatrixCoords *) nil_chk(vx)) projectPlaneInPlaneCoordsWithGeogebraCommonKernelMatrixCoordMatrix:m withGeogebraCommonKernelMatrixCoords:self->tmpCoords1_];
  IOSObjectArray_Set(v, 0, [((GeogebraCommonKernelMatrixCoords *) nil_chk(self->tmpCoords1_)) subWithGeogebraCommonKernelMatrixCoords:self->o_]);
  [((GeogebraCommonKernelMatrixCoords *) nil_chk(vy)) projectPlaneInPlaneCoordsWithGeogebraCommonKernelMatrixCoordMatrix:m withGeogebraCommonKernelMatrixCoords:self->tmpCoords1_];
  IOSObjectArray_Set(v, 1, [self->tmpCoords1_ subWithGeogebraCommonKernelMatrixCoords:self->o_]);
  [((GeogebraCommonKernelMatrixCoords *) nil_chk(vz)) projectPlaneInPlaneCoordsWithGeogebraCommonKernelMatrixCoordMatrix:m withGeogebraCommonKernelMatrixCoords:self->tmpCoords1_];
  IOSObjectArray_Set(v, 2, [self->tmpCoords1_ subWithGeogebraCommonKernelMatrixCoords:self->o_]);
  for (jint i = 0; i < 3; i++) {
    jdouble x = [((GeogebraCommonKernelMatrixCoords *) nil_chk(IOSObjectArray_Get(v, i))) getX];
    if (x < 0) *IOSDoubleArray_GetRef(self->minmaxXFinal_, 0) += x;
    else *IOSDoubleArray_GetRef(self->minmaxXFinal_, 1) += x;
    jdouble y = [((GeogebraCommonKernelMatrixCoords *) nil_chk(IOSObjectArray_Get(v, i))) getY];
    if (y < 0) *IOSDoubleArray_GetRef(self->minmaxYFinal_, 0) += y;
    else *IOSDoubleArray_GetRef(self->minmaxYFinal_, 1) += y;
  }
}

void GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D_checkViewDirectionIsParallel(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D *self) {
  if (GeogebraCommonKernelKernel_isZeroWithDouble_([((GeogebraCommonKernelMatrixCoords *) nil_chk([((GeogebraCommonKernelMatrixCoordSys *) nil_chk([((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) nil_chk(((GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D *) check_class_cast([self getGeoElement], [GeogebraCommonGeogebra3DKernel3DGeosGeoPlane3D class])))) getCoordSys])) getEquationVector])) dotproductWithGeogebraCommonKernelMatrixCoords:[((GeogebraCommonGeogebra3DEuclidian3DEuclidianView3D *) nil_chk([self getView3D])) getEyePosition]])) {
    self->viewDirectionIsParallel_ = YES;
  }
  else {
    self->viewDirectionIsParallel_ = NO;
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonGeogebra3DEuclidian3DDrawDrawPlane3D)
