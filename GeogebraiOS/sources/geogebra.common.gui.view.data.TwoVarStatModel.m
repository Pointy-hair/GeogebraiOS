//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/gui/view/data/TwoVarStatModel.java
//


#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/gui/view/data/TwoVarStatModel.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoList.h"
#include "geogebra/common/main/App.h"
#include "java/lang/Exception.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "org/apache/commons/math/stat/StatUtils.h"
#include "org/apache/commons/math/stat/descriptive/SummaryStatistics.h"

@interface GeogebraCommonGuiViewDataTwoVarStatModel () {
 @public
  IOSObjectArray *selectedDataIndex_;
  jboolean isPairedData_;
  jdouble mean1_, mean2_, sd1_, sd2_, sdDifference_, meanDifference_;
  jlong n1_, n2_;
  id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener> listener_;
}

- (void)updateStat;

- (void)updateDifferences;

- (jboolean)evaluatePairedDifferences;

- (jboolean)evaluateSampleData;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonGuiViewDataTwoVarStatModel, selectedDataIndex_, IOSObjectArray *)
J2OBJC_FIELD_SETTER(GeogebraCommonGuiViewDataTwoVarStatModel, listener_, id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>)

__attribute__((unused)) static void GeogebraCommonGuiViewDataTwoVarStatModel_updateStat(GeogebraCommonGuiViewDataTwoVarStatModel *self);

__attribute__((unused)) static void GeogebraCommonGuiViewDataTwoVarStatModel_updateDifferences(GeogebraCommonGuiViewDataTwoVarStatModel *self);

__attribute__((unused)) static jboolean GeogebraCommonGuiViewDataTwoVarStatModel_evaluatePairedDifferences(GeogebraCommonGuiViewDataTwoVarStatModel *self);

__attribute__((unused)) static jboolean GeogebraCommonGuiViewDataTwoVarStatModel_evaluateSampleData(GeogebraCommonGuiViewDataTwoVarStatModel *self);

@interface GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener : NSObject
@end

@implementation GeogebraCommonGuiViewDataTwoVarStatModel

- (instancetype)initWithGeogebraCommonMainApp:(GeogebraCommonMainApp *)app
                                  withBoolean:(jboolean)isPairedData
withGeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener:(id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>)listener {
  GeogebraCommonGuiViewDataTwoVarStatModel_initWithGeogebraCommonMainApp_withBoolean_withGeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener_(self, app, isPairedData, listener);
  return self;
}

- (void)setPairedDataWithBoolean:(jboolean)isPairedData {
  self->isPairedData_ = isPairedData;
}

- (IOSObjectArray *)getRowNames {
  return nil;
}

- (IOSObjectArray *)getColumnNames {
  IOSObjectArray *names = [IOSObjectArray arrayWithObjects:(id[]){ @" ", [((GeogebraCommonMainApp *) nil_chk(app_)) getMenuWithNSString:@"Mean"], [app_ getMenuWithNSString:@"SampleStandardDeviation.short"], [app_ getMenuWithNSString:@"Length.short"] } count:4 type:NSString_class_()];
  return names;
}

- (jint)getRowCount {
  if (isPairedData_) {
    return 3;
  }
  return 2;
}

- (jint)getColumnCount {
  return ((IOSObjectArray *) nil_chk([self getColumnNames]))->size_;
}

- (IOSObjectArray *)getSelectedDataIndex {
  return selectedDataIndex_;
}

- (void)setSelectedDataIndexWithJavaLangIntegerArray:(IOSObjectArray *)selectedDataIndex {
  GeogebraCommonGuiViewDataTwoVarStatModel_set_selectedDataIndex_(self, selectedDataIndex);
}

- (void)update {
  GeogebraCommonGuiViewDataTwoVarStatModel_updateStat(self);
  GeogebraCommonGuiViewDataTwoVarStatModel_updateDifferences(self);
}

- (void)updateStat {
  GeogebraCommonGuiViewDataTwoVarStatModel_updateStat(self);
}

- (void)updateDifferences {
  GeogebraCommonGuiViewDataTwoVarStatModel_updateDifferences(self);
}

- (jint)getSelectedDataIndex0 {
  return [((JavaLangInteger *) nil_chk(IOSObjectArray_Get(nil_chk(selectedDataIndex_), 0))) intValue];
}

- (jint)getSelectedDataIndex1 {
  return [((JavaLangInteger *) nil_chk(IOSObjectArray_Get(nil_chk(selectedDataIndex_), 1))) intValue];
}

- (jboolean)evaluatePairedDifferences {
  return GeogebraCommonGuiViewDataTwoVarStatModel_evaluatePairedDifferences(self);
}

- (jboolean)evaluateSampleData {
  return GeogebraCommonGuiViewDataTwoVarStatModel_evaluateSampleData(self);
}

- (void)setSelectedDataIndex0WithInt:(jint)idx {
  IOSObjectArray_Set(nil_chk(selectedDataIndex_), 0, JavaLangInteger_valueOfWithInt_(idx));
}

- (void)setSelectedDataIndex1WithInt:(jint)idx {
  IOSObjectArray_Set(nil_chk(selectedDataIndex_), 1, JavaLangInteger_valueOfWithInt_(idx));
}

- (void)dealloc {
  RELEASE_(app_);
  RELEASE_(selectedDataIndex_);
  RELEASE_(listener_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonMainApp:withBoolean:withGeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener:", "TwoVarStatModel", NULL, 0x1, NULL, NULL },
    { "setPairedDataWithBoolean:", "setPairedData", "V", 0x1, NULL, NULL },
    { "getRowNames", NULL, "[Ljava.lang.String;", 0x1, NULL, NULL },
    { "getColumnNames", NULL, "[Ljava.lang.String;", 0x1, NULL, NULL },
    { "getRowCount", NULL, "I", 0x1, NULL, NULL },
    { "getColumnCount", NULL, "I", 0x1, NULL, NULL },
    { "getSelectedDataIndex", NULL, "[Ljava.lang.Integer;", 0x1, NULL, NULL },
    { "setSelectedDataIndexWithJavaLangIntegerArray:", "setSelectedDataIndex", "V", 0x1, NULL, NULL },
    { "update", NULL, "V", 0x1, NULL, NULL },
    { "updateStat", NULL, "V", 0x2, NULL, NULL },
    { "updateDifferences", NULL, "V", 0x2, NULL, NULL },
    { "getSelectedDataIndex0", NULL, "I", 0x1, NULL, NULL },
    { "getSelectedDataIndex1", NULL, "I", 0x1, NULL, NULL },
    { "evaluatePairedDifferences", NULL, "Z", 0x2, NULL, NULL },
    { "evaluateSampleData", NULL, "Z", 0x2, NULL, NULL },
    { "setSelectedDataIndex0WithInt:", "setSelectedDataIndex0", "V", 0x1, NULL, NULL },
    { "setSelectedDataIndex1WithInt:", "setSelectedDataIndex1", "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "app_", NULL, 0x4, "Lgeogebra.common.main.App;", NULL, NULL,  },
    { "selectedDataIndex_", NULL, 0x2, "[Ljava.lang.Integer;", NULL, NULL,  },
    { "isPairedData_", NULL, 0x2, "Z", NULL, NULL,  },
    { "mean1_", NULL, 0x2, "D", NULL, NULL,  },
    { "mean2_", NULL, 0x2, "D", NULL, NULL,  },
    { "sd1_", NULL, 0x2, "D", NULL, NULL,  },
    { "sd2_", NULL, 0x2, "D", NULL, NULL,  },
    { "sdDifference_", NULL, 0x2, "D", NULL, NULL,  },
    { "meanDifference_", NULL, 0x2, "D", NULL, NULL,  },
    { "n1_", NULL, 0x2, "J", NULL, NULL,  },
    { "n2_", NULL, 0x2, "J", NULL, NULL,  },
    { "listener_", NULL, 0x2, "Lgeogebra.common.gui.view.data.TwoVarStatModel$TwoVarStatListener;", NULL, NULL,  },
  };
  static const char *inner_classes[] = {"Lgeogebra.common.gui.view.data.TwoVarStatModel$TwoVarStatListener;"};
  static const J2ObjcClassInfo _GeogebraCommonGuiViewDataTwoVarStatModel = { 2, "TwoVarStatModel", "geogebra.common.gui.view.data", NULL, 0x1, 17, methods, 12, fields, 0, NULL, 1, inner_classes, NULL, NULL };
  return &_GeogebraCommonGuiViewDataTwoVarStatModel;
}

@end

void GeogebraCommonGuiViewDataTwoVarStatModel_initWithGeogebraCommonMainApp_withBoolean_withGeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener_(GeogebraCommonGuiViewDataTwoVarStatModel *self, GeogebraCommonMainApp *app, jboolean isPairedData, id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener> listener) {
  NSObject_init(self);
  GeogebraCommonGuiViewDataTwoVarStatModel_setAndConsume_selectedDataIndex_(self, [IOSObjectArray newArrayWithObjects:(id[]){ JavaLangInteger_valueOfWithInt_(0), JavaLangInteger_valueOfWithInt_(1) } count:2 type:JavaLangInteger_class_()]);
  self->isPairedData_ = NO;
  GeogebraCommonGuiViewDataTwoVarStatModel_set_app_(self, app);
  self->isPairedData_ = isPairedData;
  GeogebraCommonGuiViewDataTwoVarStatModel_set_listener_(self, listener);
}

GeogebraCommonGuiViewDataTwoVarStatModel *new_GeogebraCommonGuiViewDataTwoVarStatModel_initWithGeogebraCommonMainApp_withBoolean_withGeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener_(GeogebraCommonMainApp *app, jboolean isPairedData, id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener> listener) {
  GeogebraCommonGuiViewDataTwoVarStatModel *self = [GeogebraCommonGuiViewDataTwoVarStatModel alloc];
  GeogebraCommonGuiViewDataTwoVarStatModel_initWithGeogebraCommonMainApp_withBoolean_withGeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener_(self, app, isPairedData, listener);
  return self;
}

void GeogebraCommonGuiViewDataTwoVarStatModel_updateStat(GeogebraCommonGuiViewDataTwoVarStatModel *self) {
  jboolean ok = GeogebraCommonGuiViewDataTwoVarStatModel_evaluateSampleData(self);
  if (!ok) {
    [((id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>) nil_chk(self->listener_)) clear];
    return;
  }
  [((id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>) nil_chk(self->listener_)) setValueAtWithDouble:self->mean1_ withInt:0 withInt:1];
  [self->listener_ setValueAtWithDouble:self->sd1_ withInt:0 withInt:2];
  [self->listener_ setValueAtWithDouble:self->n1_ withInt:0 withInt:3];
  [self->listener_ setValueAtWithDouble:self->mean2_ withInt:1 withInt:1];
  [self->listener_ setValueAtWithDouble:self->sd2_ withInt:1 withInt:2];
  [self->listener_ setValueAtWithDouble:self->n2_ withInt:1 withInt:3];
}

void GeogebraCommonGuiViewDataTwoVarStatModel_updateDifferences(GeogebraCommonGuiViewDataTwoVarStatModel *self) {
  if (!self->isPairedData_) {
    return;
  }
  jboolean ok = GeogebraCommonGuiViewDataTwoVarStatModel_evaluatePairedDifferences(self);
  if (!ok) {
    [((id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>) nil_chk(self->listener_)) clear];
    return;
  }
  [((id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>) nil_chk(self->listener_)) setValueAtWithNSString:[((GeogebraCommonMainApp *) nil_chk(self->app_)) getMenuWithNSString:@"Differences"] withInt:2 withInt:0];
  [self->listener_ setValueAtWithDouble:self->meanDifference_ withInt:2 withInt:1];
  [self->listener_ setValueAtWithDouble:self->sdDifference_ withInt:2 withInt:2];
  [self->listener_ setValueAtWithDouble:self->n1_ withInt:2 withInt:3];
}

jboolean GeogebraCommonGuiViewDataTwoVarStatModel_evaluatePairedDifferences(GeogebraCommonGuiViewDataTwoVarStatModel *self) {
  @try {
    GeogebraCommonKernelGeosGeoList *dataCollection = [((id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>) nil_chk(self->listener_)) getDataSelected];
    GeogebraCommonKernelGeosGeoList *dataList1 = (GeogebraCommonKernelGeosGeoList *) check_class_cast([((GeogebraCommonKernelGeosGeoList *) nil_chk(dataCollection)) getWithInt:[((JavaLangInteger *) nil_chk(IOSObjectArray_Get(nil_chk(self->selectedDataIndex_), 0))) intValue]], [GeogebraCommonKernelGeosGeoList class]);
    IOSDoubleArray *sample1 = [self->listener_ getValueArrayWithGeogebraCommonKernelGeosGeoList:dataList1];
    OrgApacheCommonsMathStatDescriptiveSummaryStatistics *stats1 = [new_OrgApacheCommonsMathStatDescriptiveSummaryStatistics_init() autorelease];
    for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(sample1))->size_; i++) {
      [stats1 addValueWithDouble:IOSDoubleArray_Get(sample1, i)];
    }
    GeogebraCommonKernelGeosGeoList *dataList2 = (GeogebraCommonKernelGeosGeoList *) check_class_cast([dataCollection getWithInt:[((JavaLangInteger *) nil_chk(IOSObjectArray_Get(self->selectedDataIndex_, 1))) intValue]], [GeogebraCommonKernelGeosGeoList class]);
    IOSDoubleArray *sample2 = [self->listener_ getValueArrayWithGeogebraCommonKernelGeosGeoList:dataList2];
    OrgApacheCommonsMathStatDescriptiveSummaryStatistics *stats2 = [new_OrgApacheCommonsMathStatDescriptiveSummaryStatistics_init() autorelease];
    for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(sample2))->size_; i++) {
      [stats2 addValueWithDouble:IOSDoubleArray_Get(sample2, i)];
    }
    if ([stats1 getN] != [stats2 getN]) return NO;
    self->meanDifference_ = OrgApacheCommonsMathStatStatUtils_meanDifferenceWithDoubleArray_withDoubleArray_(sample1, sample2);
    self->sdDifference_ = JavaLangMath_sqrtWithDouble_(OrgApacheCommonsMathStatStatUtils_varianceDifferenceWithDoubleArray_withDoubleArray_withDouble_(sample1, sample2, self->meanDifference_));
  }
  @catch (JavaLangException *e) {
    [((JavaLangException *) nil_chk(e)) printStackTrace];
    return NO;
  }
  return YES;
}

jboolean GeogebraCommonGuiViewDataTwoVarStatModel_evaluateSampleData(GeogebraCommonGuiViewDataTwoVarStatModel *self) {
  @try {
    GeogebraCommonKernelGeosGeoList *dataCollection = [((id<GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener>) nil_chk(self->listener_)) getDataSelected];
    GeogebraCommonKernelGeosGeoList *dataList1 = (GeogebraCommonKernelGeosGeoList *) check_class_cast([((GeogebraCommonKernelGeosGeoList *) nil_chk(dataCollection)) getWithInt:[((JavaLangInteger *) nil_chk(IOSObjectArray_Get(nil_chk(self->selectedDataIndex_), 0))) intValue]], [GeogebraCommonKernelGeosGeoList class]);
    IOSDoubleArray *sample1 = [self->listener_ getValueArrayWithGeogebraCommonKernelGeosGeoList:dataList1];
    OrgApacheCommonsMathStatDescriptiveSummaryStatistics *stats1 = [new_OrgApacheCommonsMathStatDescriptiveSummaryStatistics_init() autorelease];
    for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(sample1))->size_; i++) {
      [stats1 addValueWithDouble:IOSDoubleArray_Get(sample1, i)];
    }
    GeogebraCommonKernelGeosGeoList *dataList2 = (GeogebraCommonKernelGeosGeoList *) check_class_cast([dataCollection getWithInt:[((JavaLangInteger *) nil_chk(IOSObjectArray_Get(self->selectedDataIndex_, 1))) intValue]], [GeogebraCommonKernelGeosGeoList class]);
    IOSDoubleArray *sample2 = [self->listener_ getValueArrayWithGeogebraCommonKernelGeosGeoList:dataList2];
    OrgApacheCommonsMathStatDescriptiveSummaryStatistics *stats2 = [new_OrgApacheCommonsMathStatDescriptiveSummaryStatistics_init() autorelease];
    for (jint i = 0; i < ((IOSDoubleArray *) nil_chk(sample2))->size_; i++) {
      [stats2 addValueWithDouble:IOSDoubleArray_Get(sample2, i)];
    }
    self->mean1_ = [stats1 getMean];
    self->sd1_ = [stats1 getStandardDeviation];
    self->n1_ = [stats1 getN];
    self->mean2_ = [stats2 getMean];
    self->sd2_ = [stats2 getStandardDeviation];
    self->n2_ = [stats2 getN];
  }
  @catch (JavaLangException *e) {
    [((JavaLangException *) nil_chk(e)) printStackTrace];
    return NO;
  }
  return YES;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonGuiViewDataTwoVarStatModel)

@implementation GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "setValueAtWithNSString:withInt:withInt:", "setValueAt", "V", 0x401, NULL, NULL },
    { "setValueAtWithDouble:withInt:withInt:", "setValueAt", "V", 0x401, NULL, NULL },
    { "getDataSelected", NULL, "Lgeogebra.common.kernel.geos.GeoList;", 0x401, NULL, NULL },
    { "getValueArrayWithGeogebraCommonKernelGeosGeoList:", "getValueArray", "[D", 0x401, NULL, NULL },
    { "clear", NULL, "V", 0x401, NULL, NULL },
  };
  static const J2ObjcClassInfo _GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener = { 2, "TwoVarStatListener", "geogebra.common.gui.view.data", "TwoVarStatModel", 0x609, 5, methods, 0, NULL, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener;
}

@end

J2OBJC_INTERFACE_TYPE_LITERAL_SOURCE(GeogebraCommonGuiViewDataTwoVarStatModel_TwoVarStatListener)
