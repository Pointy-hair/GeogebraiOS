//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/gui/dialog/handler/RedefineInputHandler.java
//


#include "J2ObjC_source.h"
#include "geogebra/common/gui/dialog/handler/RedefineInputHandler.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/StringTemplate.h"
#include "geogebra/common/kernel/arithmetic/FunctionalNVar.h"
#include "geogebra/common/kernel/commands/AlgebraProcessor.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/main/App.h"
#include "geogebra/common/main/MyError.h"
#include "java/lang/Exception.h"

@interface GeogebraCommonGuiDialogHandlerRedefineInputHandler () {
 @public
  GeogebraCommonKernelGeosGeoElement *geo_;
  GeogebraCommonMainApp *app_;
  NSString *oldString_;
}

@end

J2OBJC_FIELD_SETTER(GeogebraCommonGuiDialogHandlerRedefineInputHandler, geo_, GeogebraCommonKernelGeosGeoElement *)
J2OBJC_FIELD_SETTER(GeogebraCommonGuiDialogHandlerRedefineInputHandler, app_, GeogebraCommonMainApp *)
J2OBJC_FIELD_SETTER(GeogebraCommonGuiDialogHandlerRedefineInputHandler, oldString_, NSString *)

@implementation GeogebraCommonGuiDialogHandlerRedefineInputHandler

- (instancetype)initWithGeogebraCommonMainApp:(GeogebraCommonMainApp *)app
       withGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo
                                 withNSString:(NSString *)oldString {
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithGeogebraCommonMainApp_withGeogebraCommonKernelGeosGeoElement_withNSString_(self, app, geo, oldString);
  return self;
}

- (void)setGeoElementWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_set_geo_(self, geo);
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_set_oldString_(self, [((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) getRedefineStringWithBoolean:NO withBoolean:YES]);
}

- (GeogebraCommonKernelGeosGeoElement *)getGeoElement {
  return geo_;
}

- (jboolean)processInputWithNSString:(NSString *)rawInput {
  if (rawInput == nil) return NO;
  if ([((NSString *) nil_chk(rawInput)) isEqual:self->oldString_]) return YES;
  @try {
    NSString *inputValue = rawInput;
    if ([GeogebraCommonKernelArithmeticFunctionalNVar_class_() isInstance:geo_]) {
      inputValue = JreStrcat("$C$$$", [((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo_)) getLabelWithGeogebraCommonKernelStringTemplate:GeogebraCommonKernelStringTemplate_get_defaultTemplate_()], '(', [((id<GeogebraCommonKernelArithmeticFunctionalNVar>) check_protocol_cast(geo_, @protocol(GeogebraCommonKernelArithmeticFunctionalNVar))) getVarStringWithGeogebraCommonKernelStringTemplate:GeogebraCommonKernelStringTemplate_get_defaultTemplate_()], @")=", inputValue);
    }
    GeogebraCommonKernelGeosGeoElement *newGeo = [((GeogebraCommonKernelCommandsAlgebraProcessor *) nil_chk([((GeogebraCommonKernelKernel *) nil_chk([((GeogebraCommonMainApp *) nil_chk(app_)) getKernel])) getAlgebraProcessor])) changeGeoElementWithGeogebraCommonKernelGeosGeoElement:geo_ withNSString:inputValue withBoolean:YES withBoolean:YES];
    [((GeogebraCommonKernelKernel *) nil_chk([app_ getKernel])) clearJustCreatedGeosInViews];
    if (newGeo != nil) {
      [app_ doAfterRedefineWithGeogebraCommonKernelGeosGeoElement:newGeo];
      [self setGeoElementWithGeogebraCommonKernelGeosGeoElement:newGeo];
      GeogebraCommonGuiDialogHandlerRedefineInputHandler_set_oldString_(self, inputValue);
    }
    return newGeo != nil;
  }
  @catch (JavaLangException *e) {
    [((GeogebraCommonMainApp *) nil_chk(app_)) showErrorWithNSString:@"ReplaceFailed"];
  }
  @catch (GeogebraCommonMainMyError *err) {
    [((GeogebraCommonMainApp *) nil_chk(app_)) showErrorWithGeogebraCommonMainMyError:err];
  }
  return NO;
}

- (void)dealloc {
  RELEASE_(geo_);
  RELEASE_(app_);
  RELEASE_(oldString_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonMainApp:withGeogebraCommonKernelGeosGeoElement:withNSString:", "RedefineInputHandler", NULL, 0x1, NULL, NULL },
    { "setGeoElementWithGeogebraCommonKernelGeosGeoElement:", "setGeoElement", "V", 0x1, NULL, NULL },
    { "getGeoElement", NULL, "Lgeogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "processInputWithNSString:", "processInput", "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "geo_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoElement;", NULL, NULL,  },
    { "app_", NULL, 0x2, "Lgeogebra.common.main.App;", NULL, NULL,  },
    { "oldString_", NULL, 0x2, "Ljava.lang.String;", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonGuiDialogHandlerRedefineInputHandler = { 2, "RedefineInputHandler", "geogebra.common.gui.dialog.handler", NULL, 0x1, 4, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonGuiDialogHandlerRedefineInputHandler;
}

@end

void GeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithGeogebraCommonMainApp_withGeogebraCommonKernelGeosGeoElement_withNSString_(GeogebraCommonGuiDialogHandlerRedefineInputHandler *self, GeogebraCommonMainApp *app, GeogebraCommonKernelGeosGeoElement *geo, NSString *oldString) {
  NSObject_init(self);
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_set_geo_(self, geo);
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_set_app_(self, app);
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_set_oldString_(self, oldString);
}

GeogebraCommonGuiDialogHandlerRedefineInputHandler *new_GeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithGeogebraCommonMainApp_withGeogebraCommonKernelGeosGeoElement_withNSString_(GeogebraCommonMainApp *app, GeogebraCommonKernelGeosGeoElement *geo, NSString *oldString) {
  GeogebraCommonGuiDialogHandlerRedefineInputHandler *self = [GeogebraCommonGuiDialogHandlerRedefineInputHandler alloc];
  GeogebraCommonGuiDialogHandlerRedefineInputHandler_initWithGeogebraCommonMainApp_withGeogebraCommonKernelGeosGeoElement_withNSString_(self, app, geo, oldString);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonGuiDialogHandlerRedefineInputHandler)
