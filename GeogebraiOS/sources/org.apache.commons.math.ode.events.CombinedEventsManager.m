//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/org/apache/commons/math/ode/events/CombinedEventsManager.java
//


#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Deprecated.h"
#include "java/lang/Double.h"
#include "java/lang/Throwable.h"
#include "java/util/ArrayList.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/List.h"
#include "org/apache/commons/math/ConvergenceException.h"
#include "org/apache/commons/math/ode/DerivativeException.h"
#include "org/apache/commons/math/ode/IntegratorException.h"
#include "org/apache/commons/math/ode/events/CombinedEventsManager.h"
#include "org/apache/commons/math/ode/events/EventException.h"
#include "org/apache/commons/math/ode/events/EventHandler.h"
#include "org/apache/commons/math/ode/events/EventState.h"
#include "org/apache/commons/math/ode/sampling/StepInterpolator.h"

@interface OrgApacheCommonsMathOdeEventsCombinedEventsManager () {
 @public
  id<JavaUtilList> states_;
  OrgApacheCommonsMathOdeEventsEventState *first_;
  jboolean initialized_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheCommonsMathOdeEventsCombinedEventsManager, states_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(OrgApacheCommonsMathOdeEventsCombinedEventsManager, first_, OrgApacheCommonsMathOdeEventsEventState *)

@implementation OrgApacheCommonsMathOdeEventsCombinedEventsManager

- (instancetype)init {
  OrgApacheCommonsMathOdeEventsCombinedEventsManager_init(self);
  return self;
}

- (void)addEventHandlerWithOrgApacheCommonsMathOdeEventsEventHandler:(id<OrgApacheCommonsMathOdeEventsEventHandler>)handler
                                                          withDouble:(jdouble)maxCheckInterval
                                                          withDouble:(jdouble)convergence
                                                             withInt:(jint)maxIterationCount {
  [((id<JavaUtilList>) nil_chk(states_)) addWithId:[new_OrgApacheCommonsMathOdeEventsEventState_initWithOrgApacheCommonsMathOdeEventsEventHandler_withDouble_withDouble_withInt_(handler, maxCheckInterval, convergence, maxIterationCount) autorelease]];
}

- (id<JavaUtilCollection>)getEventsHandlers {
  id<JavaUtilList> list = [new_JavaUtilArrayList_init() autorelease];
  for (OrgApacheCommonsMathOdeEventsEventState * __strong state in nil_chk(states_)) {
    [list addWithId:[((OrgApacheCommonsMathOdeEventsEventState *) nil_chk(state)) getEventHandler]];
  }
  return JavaUtilCollections_unmodifiableCollectionWithJavaUtilCollection_(list);
}

- (void)clearEventsHandlers {
  [((id<JavaUtilList>) nil_chk(states_)) clear];
}

- (id<JavaUtilCollection>)getEventsStates {
  return states_;
}

- (jboolean)isEmpty {
  return [((id<JavaUtilList>) nil_chk(states_)) isEmpty];
}

- (jboolean)evaluateStepWithOrgApacheCommonsMathOdeSamplingStepInterpolator:(id<OrgApacheCommonsMathOdeSamplingStepInterpolator>)interpolator {
  @try {
    OrgApacheCommonsMathOdeEventsCombinedEventsManager_set_first_(self, nil);
    if ([((id<JavaUtilList>) nil_chk(states_)) isEmpty]) {
      return NO;
    }
    if (!initialized_) {
      for (OrgApacheCommonsMathOdeEventsEventState * __strong state in states_) {
        [((OrgApacheCommonsMathOdeEventsEventState *) nil_chk(state)) reinitializeBeginWithOrgApacheCommonsMathOdeSamplingStepInterpolator:interpolator];
      }
      initialized_ = YES;
    }
    for (OrgApacheCommonsMathOdeEventsEventState * __strong state in states_) {
      if ([((OrgApacheCommonsMathOdeEventsEventState *) nil_chk(state)) evaluateStepWithOrgApacheCommonsMathOdeSamplingStepInterpolator:interpolator]) {
        if (first_ == nil) {
          OrgApacheCommonsMathOdeEventsCombinedEventsManager_set_first_(self, state);
        }
        else {
          if ([((id<OrgApacheCommonsMathOdeSamplingStepInterpolator>) nil_chk(interpolator)) isForward]) {
            if ([state getEventTime] < [first_ getEventTime]) {
              OrgApacheCommonsMathOdeEventsCombinedEventsManager_set_first_(self, state);
            }
          }
          else {
            if ([state getEventTime] > [first_ getEventTime]) {
              OrgApacheCommonsMathOdeEventsCombinedEventsManager_set_first_(self, state);
            }
          }
        }
      }
    }
    return first_ != nil;
  }
  @catch (OrgApacheCommonsMathOdeEventsEventException *se) {
    JavaLangThrowable *cause = [((OrgApacheCommonsMathOdeEventsEventException *) nil_chk(se)) getCause];
    if ((cause != nil) && ([cause isKindOfClass:[OrgApacheCommonsMathOdeDerivativeException class]])) {
      @throw (OrgApacheCommonsMathOdeDerivativeException *) check_class_cast(cause, [OrgApacheCommonsMathOdeDerivativeException class]);
    }
    @throw [new_OrgApacheCommonsMathOdeIntegratorException_initWithJavaLangThrowable_(se) autorelease];
  }
  @catch (OrgApacheCommonsMathConvergenceException *ce) {
    @throw [new_OrgApacheCommonsMathOdeIntegratorException_initWithJavaLangThrowable_(ce) autorelease];
  }
}

- (jdouble)getEventTime {
  return (first_ == nil) ? JavaLangDouble_NaN : [first_ getEventTime];
}

- (void)stepAcceptedWithDouble:(jdouble)t
               withDoubleArray:(IOSDoubleArray *)y {
  @try {
    for (OrgApacheCommonsMathOdeEventsEventState * __strong state in nil_chk(states_)) {
      [((OrgApacheCommonsMathOdeEventsEventState *) nil_chk(state)) stepAcceptedWithDouble:t withDoubleArray:y];
    }
  }
  @catch (OrgApacheCommonsMathOdeEventsEventException *se) {
    @throw [new_OrgApacheCommonsMathOdeIntegratorException_initWithJavaLangThrowable_(se) autorelease];
  }
}

- (jboolean)stop {
  for (OrgApacheCommonsMathOdeEventsEventState * __strong state in nil_chk(states_)) {
    if ([((OrgApacheCommonsMathOdeEventsEventState *) nil_chk(state)) stop]) {
      return YES;
    }
  }
  return NO;
}

- (jboolean)resetWithDouble:(jdouble)t
            withDoubleArray:(IOSDoubleArray *)y {
  @try {
    jboolean resetDerivatives = NO;
    for (OrgApacheCommonsMathOdeEventsEventState * __strong state in nil_chk(states_)) {
      if ([((OrgApacheCommonsMathOdeEventsEventState *) nil_chk(state)) resetWithDouble:t withDoubleArray:y]) {
        resetDerivatives = YES;
      }
    }
    return resetDerivatives;
  }
  @catch (OrgApacheCommonsMathOdeEventsEventException *se) {
    @throw [new_OrgApacheCommonsMathOdeIntegratorException_initWithJavaLangThrowable_(se) autorelease];
  }
}

- (void)dealloc {
  RELEASE_(states_);
  RELEASE_(first_);
  [super dealloc];
}

+ (IOSObjectArray *)__annotations {
  return [IOSObjectArray arrayWithObjects:(id[]) { [[[JavaLangDeprecated alloc] init] autorelease] } count:1 type:JavaLangAnnotationAnnotation_class_()];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "CombinedEventsManager", NULL, 0x1, NULL, NULL },
    { "addEventHandlerWithOrgApacheCommonsMathOdeEventsEventHandler:withDouble:withDouble:withInt:", "addEventHandler", "V", 0x1, NULL, NULL },
    { "getEventsHandlers", NULL, "Ljava.util.Collection;", 0x1, NULL, NULL },
    { "clearEventsHandlers", NULL, "V", 0x1, NULL, NULL },
    { "getEventsStates", NULL, "Ljava.util.Collection;", 0x1, NULL, NULL },
    { "isEmpty", NULL, "Z", 0x1, NULL, NULL },
    { "evaluateStepWithOrgApacheCommonsMathOdeSamplingStepInterpolator:", "evaluateStep", "Z", 0x1, "Lorg.apache.commons.math.ode.DerivativeException;Lorg.apache.commons.math.ode.IntegratorException;", NULL },
    { "getEventTime", NULL, "D", 0x1, NULL, NULL },
    { "stepAcceptedWithDouble:withDoubleArray:", "stepAccepted", "V", 0x1, "Lorg.apache.commons.math.ode.IntegratorException;", NULL },
    { "stop", NULL, "Z", 0x1, NULL, NULL },
    { "resetWithDouble:withDoubleArray:", "reset", "Z", 0x1, "Lorg.apache.commons.math.ode.IntegratorException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "states_", NULL, 0x12, "Ljava.util.List;", NULL, "Ljava/util/List<Lorg/apache/commons/math/ode/events/EventState;>;",  },
    { "first_", NULL, 0x2, "Lorg.apache.commons.math.ode.events.EventState;", NULL, NULL,  },
    { "initialized_", NULL, 0x2, "Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _OrgApacheCommonsMathOdeEventsCombinedEventsManager = { 2, "CombinedEventsManager", "org.apache.commons.math.ode.events", NULL, 0x1, 11, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheCommonsMathOdeEventsCombinedEventsManager;
}

@end

void OrgApacheCommonsMathOdeEventsCombinedEventsManager_init(OrgApacheCommonsMathOdeEventsCombinedEventsManager *self) {
  NSObject_init(self);
  OrgApacheCommonsMathOdeEventsCombinedEventsManager_setAndConsume_states_(self, new_JavaUtilArrayList_init());
  OrgApacheCommonsMathOdeEventsCombinedEventsManager_set_first_(self, nil);
  self->initialized_ = NO;
}

OrgApacheCommonsMathOdeEventsCombinedEventsManager *new_OrgApacheCommonsMathOdeEventsCombinedEventsManager_init() {
  OrgApacheCommonsMathOdeEventsCombinedEventsManager *self = [OrgApacheCommonsMathOdeEventsCombinedEventsManager alloc];
  OrgApacheCommonsMathOdeEventsCombinedEventsManager_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheCommonsMathOdeEventsCombinedEventsManager)
