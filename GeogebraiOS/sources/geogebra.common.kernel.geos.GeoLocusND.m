//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/kernel/geos/GeoLocusND.java
//


#include "J2ObjC_source.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/MyPoint.h"
#include "geogebra/common/kernel/PathMover.h"
#include "geogebra/common/kernel/PathMoverLocus.h"
#include "geogebra/common/kernel/PathOrPoint.h"
#include "geogebra/common/kernel/PathParameter.h"
#include "geogebra/common/kernel/StringTemplate.h"
#include "geogebra/common/kernel/algos/AlgoElement.h"
#include "geogebra/common/kernel/algos/AlgoLocusSliderInterface.h"
#include "geogebra/common/kernel/algos/ConstructionElement.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoLocusND.h"
#include "geogebra/common/kernel/kernelND/GeoPointND.h"
#include "geogebra/common/kernel/kernelND/GeoSegmentND.h"
#include "geogebra/common/plugin/GeoClass.h"
#include "java/lang/Double.h"
#include "java/lang/Math.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"

#pragma clang diagnostic ignored "-Wprotocol"

@interface GeogebraCommonKernelGeosGeoLocusND () {
 @public
  jboolean defined_;
  JavaLangStringBuilder *sbToString_;
  jdouble closestPointDist_;
  jboolean trace_;
}

- (void)getClosestLine;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonKernelGeosGeoLocusND, sbToString_, JavaLangStringBuilder *)

__attribute__((unused)) static void GeogebraCommonKernelGeosGeoLocusND_getClosestLine(GeogebraCommonKernelGeosGeoLocusND *self);

@implementation GeogebraCommonKernelGeosGeoLocusND

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)c {
  GeogebraCommonKernelGeosGeoLocusND_initWithGeogebraCommonKernelConstruction_(self, c);
  return self;
}

- (GeogebraCommonKernelGeosGeoElement *)copy__ {
  GeogebraCommonKernelGeosGeoLocusND *ret = [self newGeoLocus];
  [((GeogebraCommonKernelGeosGeoLocusND *) nil_chk(ret)) setWithGeogebraCommonKernelGeosGeoElement:self];
  return ret;
}

- (GeogebraCommonKernelGeosGeoLocusND *)newGeoLocus {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (void)setWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  GeogebraCommonKernelGeosGeoLocusND *locus = (GeogebraCommonKernelGeosGeoLocusND *) check_class_cast(geo, [GeogebraCommonKernelGeosGeoLocusND class]);
  defined_ = ((GeogebraCommonKernelGeosGeoLocusND *) nil_chk(locus))->defined_;
  [((JavaUtilArrayList *) nil_chk(myPointList_)) clear];
  [myPointList_ addAllWithJavaUtilCollection:locus->myPointList_];
}

- (jint)getPointLength {
  return [((JavaUtilArrayList *) nil_chk(myPointList_)) size];
}

- (void)clearPoints {
  [((JavaUtilArrayList *) nil_chk(myPointList_)) clear];
}

- (JavaUtilArrayList *)getPoints {
  return myPointList_;
}

- (NSString *)toStringWithGeogebraCommonKernelStringTemplate:(GeogebraCommonKernelStringTemplate *)tpl {
  [((JavaLangStringBuilder *) nil_chk(sbToString_)) setLengthWithInt:0];
  [sbToString_ appendWithNSString:label_];
  [sbToString_ appendWithNSString:@" = "];
  [sbToString_ appendWithNSString:[self getCommandDescriptionWithGeogebraCommonKernelStringTemplate:tpl]];
  return [sbToString_ description];
}

- (jboolean)showInAlgebraView {
  return YES;
}

- (GeogebraCommonPluginGeoClassEnum *)getGeoClassType {
  return GeogebraCommonPluginGeoClassEnum_get_LOCUS();
}

- (void)getXMLtagsWithJavaLangStringBuilder:(JavaLangStringBuilder *)sb {
  [super getXMLtagsWithJavaLangStringBuilder:sb];
  [self getLineStyleXMLWithJavaLangStringBuilder:sb];
}

- (jboolean)isDefined {
  return defined_;
}

- (void)setDefinedWithBoolean:(jboolean)flag {
  defined_ = flag;
}

- (void)setUndefined {
  defined_ = NO;
}

- (NSString *)toValueStringWithGeogebraCommonKernelStringTemplate:(GeogebraCommonKernelStringTemplate *)tpl {
  return [self getCommandDescriptionWithGeogebraCommonKernelStringTemplate:tpl];
}

- (jboolean)showInEuclidianView {
  return [self isDefined];
}

- (jboolean)isGeoLocus {
  return YES;
}

- (jdouble)getMaxParameter {
  return [((JavaUtilArrayList *) nil_chk(myPointList_)) size] - 1;
}

- (jdouble)getMinParameter {
  return 0;
}

- (jboolean)isClosedPath {
  if ([((JavaUtilArrayList *) nil_chk(myPointList_)) size] > 0) {
    GeogebraCommonKernelMyPoint *first = [myPointList_ getWithInt:0];
    GeogebraCommonKernelMyPoint *last = [myPointList_ getWithInt:[myPointList_ size] - 1];
    return [((GeogebraCommonKernelMyPoint *) nil_chk(first)) isEqualWithGeogebraCommonKernelMyPoint:last];
  }
  return NO;
}

- (jboolean)isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)P
                                                    withDouble:(jdouble)eps {
  [self setChangingPointWithGeogebraCommonKernelKernelNDGeoPointND:P];
  GeogebraCommonKernelMyPoint *closestPoint = [self getClosestPoint];
  if (closestPoint != nil) {
    return JavaLangMath_sqrtWithDouble_(closestPointDist_) < eps;
  }
  return NO;
}

- (void)setChangingPointWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)P {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (jdouble)getChangingPointParameterWithGeogebraCommonKernelKernelNDGeoSegmentND:(id<GeogebraCommonKernelKernelNDGeoSegmentND>)segment {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (GeogebraCommonKernelMyPoint *)getClosestPoint {
  GeogebraCommonKernelGeosGeoLocusND_getClosestLine(self);
  jboolean temp = [((GeogebraCommonKernelConstruction *) nil_chk(cons_)) isSuppressLabelsActive];
  [cons_ setSuppressLabelCreationWithBoolean:YES];
  id<GeogebraCommonKernelKernelNDGeoSegmentND> closestSegment = [self newGeoSegment];
  [cons_ setSuppressLabelCreationWithBoolean:temp];
  if (closestPointIndex_ == -1) return nil;
  GeogebraCommonKernelMyPoint *locusPoint = [((JavaUtilArrayList *) nil_chk(myPointList_)) getWithInt:closestPointIndex_];
  GeogebraCommonKernelMyPoint *locusPoint2 = [myPointList_ getWithInt:closestPointIndex_ + 1];
  [((id<GeogebraCommonKernelKernelNDGeoSegmentND>) nil_chk(closestSegment)) setCoordsWithGeogebraCommonKernelMyPoint:locusPoint withGeogebraCommonKernelMyPoint:locusPoint2];
  closestPointParameter_ = [self getChangingPointParameterWithGeogebraCommonKernelKernelNDGeoSegmentND:closestSegment];
  if (closestPointParameter_ < 0) closestPointParameter_ = 0;
  else if (closestPointParameter_ > 1) closestPointParameter_ = 1;
  return [((GeogebraCommonKernelMyPoint *) nil_chk(locusPoint)) barycenterWithDouble:closestPointParameter_ withGeogebraCommonKernelMyPoint:locusPoint2];
}

- (id<GeogebraCommonKernelKernelNDGeoSegmentND>)newGeoSegment {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (jdouble)changingPointDistanceWithGeogebraCommonKernelKernelNDGeoSegmentND:(id<GeogebraCommonKernelKernelNDGeoSegmentND>)segment {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (void)getClosestLine {
  GeogebraCommonKernelGeosGeoLocusND_getClosestLine(self);
}

- (void)pathChangedWithGeogebraCommonKernelKernelNDGeoPointND:(id<GeogebraCommonKernelKernelNDGeoPointND>)P {
  if (![((GeogebraCommonKernelKernel *) nil_chk([self getKernel])) usePathAndRegionParametersWithGeogebraCommonKernelKernelNDGeoPointND:P]) {
    [self pointChangedWithGeogebraCommonKernelKernelNDGeoPointND:P];
    return;
  }
  if ([GeogebraCommonKernelAlgosAlgoLocusSliderInterface_class_() isInstance:[self getParentAlgorithm]]) {
    [self pointChangedWithGeogebraCommonKernelKernelNDGeoPointND:P];
    return;
  }
  GeogebraCommonKernelPathParameter *pp = [((id<GeogebraCommonKernelKernelNDGeoPointND>) nil_chk(P)) getPathParameter];
  jint n = J2ObjCFpToInt(JavaLangMath_floorWithDouble_(((GeogebraCommonKernelPathParameter *) nil_chk(pp))->t_));
  jdouble t = pp->t_ - n;
  if (n >= [((JavaUtilArrayList *) nil_chk(myPointList_)) size] || n < 0) {
    n = (n < 0) ? 0 : [myPointList_ size] - 1;
  }
  GeogebraCommonKernelMyPoint *locusPoint = [myPointList_ getWithInt:n];
  GeogebraCommonKernelMyPoint *locusPoint2 = [myPointList_ getWithInt:(n + 1) % [myPointList_ size]];
  [P setWithDouble:1 - t withDouble:t withGeogebraCommonKernelMyPoint:locusPoint withGeogebraCommonKernelMyPoint:locusPoint2];
}

- (jboolean)isPath {
  return YES;
}

- (jboolean)isEqualWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  return NO;
}

- (jboolean)isLabelValueShowable {
  return YES;
}

- (jboolean)isLabelShowable {
  return YES;
}

- (void)setPointsWithJavaUtilArrayList:(JavaUtilArrayList *)al {
  GeogebraCommonKernelGeosGeoLocusND_set_myPointList_(self, al);
}

- (jboolean)isAuxiliaryObjectByDefault {
  return YES;
}

- (void)setTraceWithBoolean:(jboolean)trace {
  self->trace_ = trace;
}

- (jboolean)getTrace {
  return trace_;
}

- (jboolean)isTraceable {
  return YES;
}

- (jboolean)isFillable {
  return YES;
}

- (jboolean)isInverseFillable {
  return YES;
}

- (id<GeogebraCommonKernelPathMover>)createPathMover {
  return [new_GeogebraCommonKernelPathMoverLocus_initWithGeogebraCommonKernelGeosGeoLocusND_(self) autorelease];
}

- (jboolean)hasDrawable3D {
  return YES;
}

- (void)dealloc {
  RELEASE_(myPointList_);
  RELEASE_(sbToString_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:", "GeoLocusND", NULL, 0x1, NULL, NULL },
    { "copy__", "copy", "Lgeogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "newGeoLocus", NULL, "Lgeogebra.common.kernel.geos.GeoLocusND;", 0x404, NULL, NULL },
    { "setWithGeogebraCommonKernelGeosGeoElement:", "set", "V", 0x1, NULL, NULL },
    { "getPointLength", NULL, "I", 0x11, NULL, NULL },
    { "clearPoints", NULL, "V", 0x1, NULL, NULL },
    { "getPoints", NULL, "Ljava.util.ArrayList;", 0x1, NULL, NULL },
    { "toStringWithGeogebraCommonKernelStringTemplate:", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "showInAlgebraView", NULL, "Z", 0x1, NULL, NULL },
    { "getGeoClassType", NULL, "Lgeogebra.common.plugin.GeoClass;", 0x1, NULL, NULL },
    { "getXMLtagsWithJavaLangStringBuilder:", "getXMLtags", "V", 0x4, NULL, NULL },
    { "isDefined", NULL, "Z", 0x1, NULL, NULL },
    { "setDefinedWithBoolean:", "setDefined", "V", 0x1, NULL, NULL },
    { "setUndefined", NULL, "V", 0x1, NULL, NULL },
    { "toValueStringWithGeogebraCommonKernelStringTemplate:", "toValueString", "Ljava.lang.String;", 0x1, NULL, NULL },
    { "showInEuclidianView", NULL, "Z", 0x4, NULL, NULL },
    { "isGeoLocus", NULL, "Z", 0x1, NULL, NULL },
    { "getMaxParameter", NULL, "D", 0x1, NULL, NULL },
    { "getMinParameter", NULL, "D", 0x1, NULL, NULL },
    { "isClosedPath", NULL, "Z", 0x1, NULL, NULL },
    { "isOnPathWithGeogebraCommonKernelKernelNDGeoPointND:withDouble:", "isOnPath", "Z", 0x1, NULL, NULL },
    { "setChangingPointWithGeogebraCommonKernelKernelNDGeoPointND:", "setChangingPoint", "V", 0x404, NULL, NULL },
    { "getChangingPointParameterWithGeogebraCommonKernelKernelNDGeoSegmentND:", "getChangingPointParameter", "D", 0x404, NULL, NULL },
    { "getClosestPoint", NULL, "Lgeogebra.common.kernel.MyPoint;", 0x4, NULL, NULL },
    { "newGeoSegment", NULL, "Lgeogebra.common.kernel.kernelND.GeoSegmentND;", 0x404, NULL, NULL },
    { "changingPointDistanceWithGeogebraCommonKernelKernelNDGeoSegmentND:", "changingPointDistance", "D", 0x404, NULL, NULL },
    { "getClosestLine", NULL, "V", 0x2, NULL, NULL },
    { "pathChangedWithGeogebraCommonKernelKernelNDGeoPointND:", "pathChanged", "V", 0x1, NULL, NULL },
    { "isPath", NULL, "Z", 0x1, NULL, NULL },
    { "isEqualWithGeogebraCommonKernelGeosGeoElement:", "isEqual", "Z", 0x11, NULL, NULL },
    { "isLabelValueShowable", NULL, "Z", 0x11, NULL, NULL },
    { "isLabelShowable", NULL, "Z", 0x11, NULL, NULL },
    { "setPointsWithJavaUtilArrayList:", "setPoints", "V", 0x1, NULL, NULL },
    { "isAuxiliaryObjectByDefault", NULL, "Z", 0x11, NULL, NULL },
    { "setTraceWithBoolean:", "setTrace", "V", 0x1, NULL, NULL },
    { "getTrace", NULL, "Z", 0x1, NULL, NULL },
    { "isTraceable", NULL, "Z", 0x1, NULL, NULL },
    { "isFillable", NULL, "Z", 0x1, NULL, NULL },
    { "isInverseFillable", NULL, "Z", 0x1, NULL, NULL },
    { "createPathMover", NULL, "Lgeogebra.common.kernel.PathMover;", 0x11, NULL, NULL },
    { "hasDrawable3D", NULL, "Z", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "MAX_PATH_RUNS_", NULL, 0x19, "I", NULL, NULL, .constantValue.asInt = GeogebraCommonKernelGeosGeoLocusND_MAX_PATH_RUNS },
    { "defined_", NULL, 0x2, "Z", NULL, NULL,  },
    { "myPointList_", NULL, 0x4, "Ljava.util.ArrayList;", NULL, "Ljava/util/ArrayList<TT;>;",  },
    { "sbToString_", NULL, 0x2, "Ljava.lang.StringBuilder;", NULL, NULL,  },
    { "closestPointDist_", NULL, 0x2, "D", NULL, NULL,  },
    { "closestPointIndex_", NULL, 0x4, "I", NULL, NULL,  },
    { "closestPointParameter_", NULL, 0x4, "D", NULL, NULL,  },
    { "trace_", NULL, 0x2, "Z", NULL, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonKernelGeosGeoLocusND = { 2, "GeoLocusND", "geogebra.common.kernel.geos", NULL, 0x401, 41, methods, 8, fields, 0, NULL, 0, NULL, NULL, "<T:Lgeogebra/common/kernel/MyPoint;>Lgeogebra/common/kernel/geos/GeoElement;Lgeogebra/common/kernel/Path;Lgeogebra/common/kernel/geos/Traceable;" };
  return &_GeogebraCommonKernelGeosGeoLocusND;
}

@end

void GeogebraCommonKernelGeosGeoLocusND_initWithGeogebraCommonKernelConstruction_(GeogebraCommonKernelGeosGeoLocusND *self, GeogebraCommonKernelConstruction *c) {
  GeogebraCommonKernelGeosGeoElement_initWithGeogebraCommonKernelConstruction_(self, c);
  GeogebraCommonKernelGeosGeoLocusND_setAndConsume_sbToString_(self, new_JavaLangStringBuilder_initWithInt_(80));
  [self setConstructionDefaults];
  GeogebraCommonKernelGeosGeoLocusND_setAndConsume_myPointList_(self, new_JavaUtilArrayList_initWithInt_(500));
}

void GeogebraCommonKernelGeosGeoLocusND_getClosestLine(GeogebraCommonKernelGeosGeoLocusND *self) {
  jint size = [((JavaUtilArrayList *) nil_chk(self->myPointList_)) size];
  if (size == 0) return;
  self->closestPointDist_ = JavaLangDouble_MAX_VALUE;
  self->closestPointIndex_ = -1;
  id<GeogebraCommonKernelKernelNDGeoSegmentND> segment = [self newGeoSegment];
  for (jint i = 0; i < size - 1; i++) {
    GeogebraCommonKernelMyPoint *locusPoint = [self->myPointList_ getWithInt:i];
    GeogebraCommonKernelMyPoint *locusPoint2 = [self->myPointList_ getWithInt:i + 1];
    if (!((GeogebraCommonKernelMyPoint *) nil_chk(locusPoint2))->lineTo_) continue;
    [((id<GeogebraCommonKernelKernelNDGeoSegmentND>) nil_chk(segment)) setCoordsWithGeogebraCommonKernelMyPoint:locusPoint withGeogebraCommonKernelMyPoint:locusPoint2];
    jdouble dist = [self changingPointDistanceWithGeogebraCommonKernelKernelNDGeoSegmentND:segment];
    if (dist < self->closestPointDist_) {
      self->closestPointDist_ = dist;
      self->closestPointIndex_ = i;
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelGeosGeoLocusND)
