//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/kernel/discrete/AlgoVoronoi.java
//


#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "geogebra/common/awt/GPoint2D.h"
#include "geogebra/common/kernel/Construction.h"
#include "geogebra/common/kernel/Kernel.h"
#include "geogebra/common/kernel/MyPoint.h"
#include "geogebra/common/kernel/commands/Commands.h"
#include "geogebra/common/kernel/discrete/AlgoDelauneyTriangulation.h"
#include "geogebra/common/kernel/discrete/AlgoHull.h"
#include "geogebra/common/kernel/discrete/AlgoVoronoi.h"
#include "geogebra/common/kernel/discrete/MyLine.h"
#include "geogebra/common/kernel/discrete/delaunay/Delaunay_Triangulation.h"
#include "geogebra/common/kernel/discrete/delaunay/Point_dt.h"
#include "geogebra/common/kernel/discrete/delaunay/Triangle_dt.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoList.h"
#include "geogebra/common/kernel/geos/GeoLocus.h"
#include "geogebra/common/kernel/kernelND/GeoPointND.h"
#include "java/lang/Double.h"
#include "java/util/ArrayList.h"
#include "java/util/Comparator.h"
#include "java/util/Iterator.h"
#include "java/util/TreeSet.h"

static id<JavaUtilComparator> GeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_;
J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonKernelDiscreteAlgoVoronoi, pointComparator_, id<JavaUtilComparator>)
J2OBJC_STATIC_FIELD_SETTER(GeogebraCommonKernelDiscreteAlgoVoronoi, pointComparator_, id<JavaUtilComparator>)

@interface GeogebraCommonKernelDiscreteAlgoVoronoi_$1 : NSObject < JavaUtilComparator >

- (jint)compareWithId:(GeogebraCommonAwtGPoint2D *)p1
               withId:(GeogebraCommonAwtGPoint2D *)p2;

- (instancetype)init;

@end

J2OBJC_EMPTY_STATIC_INIT(GeogebraCommonKernelDiscreteAlgoVoronoi_$1)

__attribute__((unused)) static void GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(GeogebraCommonKernelDiscreteAlgoVoronoi_$1 *self);

__attribute__((unused)) static GeogebraCommonKernelDiscreteAlgoVoronoi_$1 *new_GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init() NS_RETURNS_RETAINED;

J2OBJC_TYPE_LITERAL_HEADER(GeogebraCommonKernelDiscreteAlgoVoronoi_$1)

@implementation GeogebraCommonKernelDiscreteAlgoVoronoi

- (instancetype)initWithGeogebraCommonKernelConstruction:(GeogebraCommonKernelConstruction *)cons
                                            withNSString:(NSString *)label
                     withGeogebraCommonKernelGeosGeoList:(GeogebraCommonKernelGeosGeoList *)inputList {
  GeogebraCommonKernelDiscreteAlgoVoronoi_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoList_(self, cons, label, inputList);
  return self;
}

- (GeogebraCommonKernelCommandsCommandsEnum *)getClassName {
  return GeogebraCommonKernelCommandsCommandsEnum_get_Voronoi();
}

- (void)compute {
  size_ = [((GeogebraCommonKernelGeosGeoList *) nil_chk(inputList_)) size];
  if (![inputList_ isDefined] || size_ == 0) {
    [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setUndefined];
    return;
  }
  IOSDoubleArray *inhom = [IOSDoubleArray arrayWithLength:2];
  JavaUtilArrayList *xcoords = [new_JavaUtilArrayList_init() autorelease];
  JavaUtilArrayList *ycoords = [new_JavaUtilArrayList_init() autorelease];
  jdouble delta = 0.0000001;
  JavaUtilTreeSet *pointTree = [new_JavaUtilTreeSet_initWithJavaUtilComparator_(GeogebraCommonKernelDiscreteAlgoVoronoi_getPointComparator()) autorelease];
  for (jint i = 0; i < size_; i++) {
    GeogebraCommonKernelGeosGeoElement *geo = [inputList_ getWithInt:i];
    if ([((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo)) isDefined] && [geo isGeoPoint]) {
      id<GeogebraCommonKernelKernelNDGeoPointND> p = (id<GeogebraCommonKernelKernelNDGeoPointND>) check_protocol_cast(geo, @protocol(GeogebraCommonKernelKernelNDGeoPointND));
      [p getInhomCoordsWithDoubleArray:inhom];
      [pointTree addWithId:[new_GeogebraCommonAwtGPoint2D_Double_initWithDouble_withDouble_(IOSDoubleArray_Get(inhom, 0), IOSDoubleArray_Get(inhom, 1)) autorelease]];
    }
  }
  IOSObjectArray *points = [IOSObjectArray arrayWithLength:[pointTree size] type:GeogebraCommonKernelDiscreteDelaunayPoint_dt_class_()];
  jint indx = 0;
  id<JavaUtilIterator> it3 = [pointTree iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it3)) hasNext]) {
    GeogebraCommonAwtGPoint2D *p = [it3 next];
    jdouble x = [((GeogebraCommonAwtGPoint2D *) nil_chk(p)) getX];
    jdouble y = [p getY];
    while ([xcoords containsWithId:JavaLangDouble_valueOfWithDouble_(x)]) {
      x += delta;
    }
    while ([ycoords containsWithId:JavaLangDouble_valueOfWithDouble_(y)]) {
      y += delta;
    }
    [xcoords addWithId:JavaLangDouble_valueOfWithDouble_(x)];
    [ycoords addWithId:JavaLangDouble_valueOfWithDouble_(y)];
    IOSObjectArray_SetAndConsume(points, indx++, new_GeogebraCommonKernelDiscreteDelaunayPoint_dt_initWithDouble_withDouble_(x, y));
  }
  GeogebraCommonKernelDiscreteDelaunayDelaunay_Triangulation *dt = [new_GeogebraCommonKernelDiscreteDelaunayDelaunay_Triangulation_initWithGeogebraCommonKernelDiscreteDelaunayPoint_dtArray_(points) autorelease];
  if (dt->allCollinear_) {
    [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setUndefined];
    return;
  }
  id<JavaUtilIterator> it = [dt trianglesIterator];
  if (al_ == nil) {
    GeogebraCommonKernelDiscreteAlgoHull_setAndConsume_al_(self, new_JavaUtilArrayList_init());
  }
  else {
    [al_ clear];
  }
  JavaUtilTreeSet *tree = [new_JavaUtilTreeSet_initWithJavaUtilComparator_(GeogebraCommonKernelDiscreteAlgoDelauneyTriangulation_getComparator()) autorelease];
  while ([((id<JavaUtilIterator>) nil_chk(it)) hasNext]) {
    GeogebraCommonKernelDiscreteDelaunayTriangle_dt *triangle = [it next];
    for (jint index = 0; index < 3; index++) {
      GeogebraCommonKernelDiscreteDelaunayPoint_dt *corner = [((GeogebraCommonKernelDiscreteDelaunayTriangle_dt *) nil_chk(triangle)) getCornerWithInt:index];
      if (corner != nil) {
        IOSObjectArray *voronoiCell = [dt calcVoronoiCellWithGeogebraCommonKernelDiscreteDelaunayTriangle_dt:triangle withGeogebraCommonKernelDiscreteDelaunayPoint_dt:corner];
        if (voronoiCell != nil) for (jint i = 0; i < voronoiCell->size_ - 1; i++) {
          [tree addWithId:[new_GeogebraCommonKernelDiscreteMyLine_initWithGeogebraCommonAwtGPoint2D_withGeogebraCommonAwtGPoint2D_([new_GeogebraCommonAwtGPoint2D_Double_initWithDouble_withDouble_([((GeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, i))) x], [((GeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, i))) y]) autorelease], [new_GeogebraCommonAwtGPoint2D_Double_initWithDouble_withDouble_([((GeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, (i + 1) % voronoiCell->size_))) x], [((GeogebraCommonKernelDiscreteDelaunayPoint_dt *) nil_chk(IOSObjectArray_Get(voronoiCell, (i + 1) % voronoiCell->size_))) y]) autorelease]) autorelease]];
        }
      }
    }
  }
  id<JavaUtilIterator> it2 = [tree iterator];
  while ([((id<JavaUtilIterator>) nil_chk(it2)) hasNext]) {
    GeogebraCommonKernelDiscreteMyLine *line = [it2 next];
    [((JavaUtilArrayList *) nil_chk(al_)) addWithId:[new_GeogebraCommonKernelMyPoint_initWithDouble_withDouble_withBoolean_([((GeogebraCommonAwtGPoint2D *) nil_chk(((GeogebraCommonKernelDiscreteMyLine *) nil_chk(line))->p1_)) getX], [line->p1_ getY], NO) autorelease]];
    [al_ addWithId:[new_GeogebraCommonKernelMyPoint_initWithDouble_withDouble_withBoolean_([((GeogebraCommonAwtGPoint2D *) nil_chk(line->p2_)) getX], [line->p2_ getY], YES) autorelease]];
  }
  [((GeogebraCommonKernelGeosGeoLocus *) nil_chk(locus_)) setPointsWithJavaUtilArrayList:al_];
  [locus_ setDefinedWithBoolean:YES];
}

+ (id<JavaUtilComparator>)getPointComparator {
  return GeogebraCommonKernelDiscreteAlgoVoronoi_getPointComparator();
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonKernelConstruction:withNSString:withGeogebraCommonKernelGeosGeoList:", "AlgoVoronoi", NULL, 0x1, NULL, NULL },
    { "getClassName", NULL, "Lgeogebra.common.kernel.commands.Commands;", 0x1, NULL, NULL },
    { "compute", NULL, "V", 0x11, NULL, NULL },
    { "getPointComparator", NULL, "Ljava.util.Comparator;", 0x9, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "pointComparator_", NULL, 0xa, "Ljava.util.Comparator;", &GeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_, "Ljava/util/Comparator<Lgeogebra/common/awt/GPoint2D;>;",  },
  };
  static const J2ObjcClassInfo _GeogebraCommonKernelDiscreteAlgoVoronoi = { 2, "AlgoVoronoi", "geogebra.common.kernel.discrete", NULL, 0x1, 4, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonKernelDiscreteAlgoVoronoi;
}

@end

void GeogebraCommonKernelDiscreteAlgoVoronoi_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoList_(GeogebraCommonKernelDiscreteAlgoVoronoi *self, GeogebraCommonKernelConstruction *cons, NSString *label, GeogebraCommonKernelGeosGeoList *inputList) {
  GeogebraCommonKernelDiscreteAlgoHull_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoList_withGeogebraCommonKernelGeosGeoNumeric_(self, cons, label, inputList, nil);
}

GeogebraCommonKernelDiscreteAlgoVoronoi *new_GeogebraCommonKernelDiscreteAlgoVoronoi_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoList_(GeogebraCommonKernelConstruction *cons, NSString *label, GeogebraCommonKernelGeosGeoList *inputList) {
  GeogebraCommonKernelDiscreteAlgoVoronoi *self = [GeogebraCommonKernelDiscreteAlgoVoronoi alloc];
  GeogebraCommonKernelDiscreteAlgoVoronoi_initWithGeogebraCommonKernelConstruction_withNSString_withGeogebraCommonKernelGeosGeoList_(self, cons, label, inputList);
  return self;
}

id<JavaUtilComparator> GeogebraCommonKernelDiscreteAlgoVoronoi_getPointComparator() {
  GeogebraCommonKernelDiscreteAlgoVoronoi_initialize();
  if (GeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_ == nil) {
    JreStrongAssignAndConsume(&GeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_, nil, new_GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init());
  }
  return GeogebraCommonKernelDiscreteAlgoVoronoi_pointComparator_;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelDiscreteAlgoVoronoi)

@implementation GeogebraCommonKernelDiscreteAlgoVoronoi_$1

- (jint)compareWithId:(GeogebraCommonAwtGPoint2D *)p1
               withId:(GeogebraCommonAwtGPoint2D *)p2 {
  if (GeogebraCommonKernelKernel_isEqualWithDouble_withDouble_([((GeogebraCommonAwtGPoint2D *) nil_chk(p1)) getX], [((GeogebraCommonAwtGPoint2D *) nil_chk(p2)) getX]) && GeogebraCommonKernelKernel_isEqualWithDouble_withDouble_([p1 getY], [p2 getY])) {
    return 0;
  }
  return [p1 getX] > [p2 getX] ? -1 : 1;
}

- (instancetype)init {
  GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(self);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "compareWithId:withId:", "compare", "I", 0x1, NULL, NULL },
    { "init", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "GeogebraCommonKernelDiscreteAlgoVoronoi", "getPointComparator" };
  static const J2ObjcClassInfo _GeogebraCommonKernelDiscreteAlgoVoronoi_$1 = { 2, "", "geogebra.common.kernel.discrete", "AlgoVoronoi", 0x8008, 2, methods, 0, NULL, 0, NULL, 0, NULL, &enclosing_method, "Ljava/lang/Object;Ljava/util/Comparator<Lgeogebra/common/awt/GPoint2D;>;" };
  return &_GeogebraCommonKernelDiscreteAlgoVoronoi_$1;
}

@end

void GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(GeogebraCommonKernelDiscreteAlgoVoronoi_$1 *self) {
  NSObject_init(self);
}

GeogebraCommonKernelDiscreteAlgoVoronoi_$1 *new_GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init() {
  GeogebraCommonKernelDiscreteAlgoVoronoi_$1 *self = [GeogebraCommonKernelDiscreteAlgoVoronoi_$1 alloc];
  GeogebraCommonKernelDiscreteAlgoVoronoi_$1_init(self);
  return self;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonKernelDiscreteAlgoVoronoi_$1)
