//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/jacky/GSoC/geogebra_iOS/geogebra/geogebra/common/src/geogebra/common/euclidian/draw/DrawNyquist.java
//


#include "J2ObjC_source.h"
#include "geogebra/common/awt/GColor.h"
#include "geogebra/common/awt/GGraphics2D.h"
#include "geogebra/common/awt/GRectangle.h"
#include "geogebra/common/euclidian/Drawable.h"
#include "geogebra/common/euclidian/EuclidianView.h"
#include "geogebra/common/euclidian/GeneralPathClipped.h"
#include "geogebra/common/euclidian/draw/DrawNyquist.h"
#include "geogebra/common/factories/AwtFactory.h"
#include "geogebra/common/kernel/Matrix/Coords.h"
#include "geogebra/common/kernel/geos/GeoElement.h"
#include "geogebra/common/kernel/geos/GeoTransferFunction.h"
#include "java/lang/Math.h"
#include "java/util/List.h"

#define GeogebraCommonEuclidianDrawDrawNyquist_LEN 6.0

@interface GeogebraCommonEuclidianDrawDrawNyquist () {
 @public
  GeogebraCommonKernelGeosGeoTransferFunction *gcf_;
  jboolean isVisible_;
  GeogebraCommonEuclidianGeneralPathClipped *gpP_;
  id<JavaUtilList> coordsList_;
  GeogebraCommonKernelMatrixCoords *p_;
  jdouble yP_;
  jdouble xPN_;
  GeogebraCommonEuclidianGeneralPathClipped *gpN_;
  jdouble yN_;
}

- (void)drawArrowWithGeogebraCommonAwtGGraphics2D:(id<GeogebraCommonAwtGGraphics2D>)g2;

- (void)fillWithGeogebraCommonAwtGGraphics2D:(id<GeogebraCommonAwtGGraphics2D>)g2
                                  withDouble:(jdouble)y2
                                  withDouble:(jdouble)x2
                                  withDouble:(jdouble)angle;

+ (jdouble)getAngleWithDouble:(jdouble)x1
                   withDouble:(jdouble)y1
                   withDouble:(jdouble)x2
                   withDouble:(jdouble)y2;

@end

J2OBJC_FIELD_SETTER(GeogebraCommonEuclidianDrawDrawNyquist, gcf_, GeogebraCommonKernelGeosGeoTransferFunction *)
J2OBJC_FIELD_SETTER(GeogebraCommonEuclidianDrawDrawNyquist, gpP_, GeogebraCommonEuclidianGeneralPathClipped *)
J2OBJC_FIELD_SETTER(GeogebraCommonEuclidianDrawDrawNyquist, coordsList_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(GeogebraCommonEuclidianDrawDrawNyquist, p_, GeogebraCommonKernelMatrixCoords *)
J2OBJC_FIELD_SETTER(GeogebraCommonEuclidianDrawDrawNyquist, gpN_, GeogebraCommonEuclidianGeneralPathClipped *)

J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonEuclidianDrawDrawNyquist, LEN, jdouble)

static jdouble GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_L_;
J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonEuclidianDrawDrawNyquist, ANGLE_L_, jdouble)

static jdouble GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_R_;
J2OBJC_STATIC_FIELD_GETTER(GeogebraCommonEuclidianDrawDrawNyquist, ANGLE_R_, jdouble)

__attribute__((unused)) static void GeogebraCommonEuclidianDrawDrawNyquist_drawArrowWithGeogebraCommonAwtGGraphics2D_(GeogebraCommonEuclidianDrawDrawNyquist *self, id<GeogebraCommonAwtGGraphics2D> g2);

__attribute__((unused)) static void GeogebraCommonEuclidianDrawDrawNyquist_fillWithGeogebraCommonAwtGGraphics2D_withDouble_withDouble_withDouble_(GeogebraCommonEuclidianDrawDrawNyquist *self, id<GeogebraCommonAwtGGraphics2D> g2, jdouble y2, jdouble x2, jdouble angle);

__attribute__((unused)) static jdouble GeogebraCommonEuclidianDrawDrawNyquist_getAngleWithDouble_withDouble_withDouble_withDouble_(jdouble x1, jdouble y1, jdouble x2, jdouble y2);

J2OBJC_INITIALIZED_DEFN(GeogebraCommonEuclidianDrawDrawNyquist)

@implementation GeogebraCommonEuclidianDrawDrawNyquist

- (instancetype)initWithGeogebraCommonEuclidianEuclidianView:(GeogebraCommonEuclidianEuclidianView *)view
             withGeogebraCommonKernelGeosGeoTransferFunction:(GeogebraCommonKernelGeosGeoTransferFunction *)geo {
  GeogebraCommonEuclidianDrawDrawNyquist_initWithGeogebraCommonEuclidianEuclidianView_withGeogebraCommonKernelGeosGeoTransferFunction_(self, view, geo);
  return self;
}

- (void)update {
  isVisible_ = [((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(gcf_)) isEuclidianVisible];
  if (!isVisible_ || ![gcf_ isDefined]) {
    return;
  }
}

- (void)drawWithGeogebraCommonAwtGGraphics2D:(id<GeogebraCommonAwtGGraphics2D>)g2 {
  if (!isVisible_ || ![((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(gcf_)) isDefined]) {
    return;
  }
  jboolean highlighting = [((GeogebraCommonKernelGeosGeoElement *) nil_chk(geo_)) doHighlighting];
  if (highlighting) {
    [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(g2)) setPaintWithGeogebraCommonAwtGPaint:[geo_ getSelColor]];
    [g2 setStrokeWithGeogebraCommonAwtGBasicStroke:selStroke_];
  }
  else {
    [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(g2)) setPaintWithGeogebraCommonAwtGPaint:[geo_ getObjectColor]];
    [g2 setStrokeWithGeogebraCommonAwtGBasicStroke:objStroke_];
  }
  GeogebraCommonEuclidianDrawDrawNyquist_setAndConsume_gpP_(self, new_GeogebraCommonEuclidianGeneralPathClipped_initWithGeogebraCommonEuclidianEuclidianViewInterfaceSlim_(view_));
  GeogebraCommonEuclidianDrawDrawNyquist_setAndConsume_gpN_(self, new_GeogebraCommonEuclidianGeneralPathClipped_initWithGeogebraCommonEuclidianEuclidianViewInterfaceSlim_(view_));
  for (jint i = 0; i < [((id<JavaUtilList>) nil_chk(coordsList_)) size]; i++) {
    GeogebraCommonEuclidianDrawDrawNyquist_set_p_(self, [coordsList_ getWithInt:i]);
    xPN_ = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(view_)) toScreenCoordXdWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk(p_)) getX]];
    yP_ = [view_ toScreenCoordYdWithDouble:[p_ getY]];
    yN_ = [view_ toScreenCoordYdWithDouble:-[p_ getY]];
    [gpP_ lineToWithDouble:xPN_ withDouble:yP_];
    [gpN_ lineToWithDouble:xPN_ withDouble:yN_];
  }
  GeogebraCommonAwtGColor *geoColor = [geo_ getObjectColor];
  GeogebraCommonAwtGColor *color = [((GeogebraCommonFactoriesAwtFactory *) nil_chk(GeogebraCommonFactoriesAwtFactory_get_prototype_())) newColorWithInt:[((GeogebraCommonAwtGColor *) nil_chk(geoColor)) getRed] withInt:[geoColor getGreen] withInt:[geoColor getBlue] withInt:127];
  [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(g2)) setColorWithGeogebraCommonAwtGColor:color];
  [g2 drawWithValueStrokePureWithGeogebraCommonAwtGShape:gpN_];
  [g2 setColorWithGeogebraCommonAwtGColor:geoColor];
  [g2 drawWithValueStrokePureWithGeogebraCommonAwtGShape:gpP_];
  GeogebraCommonEuclidianDrawDrawNyquist_drawArrowWithGeogebraCommonAwtGGraphics2D_(self, g2);
}

- (void)drawArrowWithGeogebraCommonAwtGGraphics2D:(id<GeogebraCommonAwtGGraphics2D>)g2 {
  GeogebraCommonEuclidianDrawDrawNyquist_drawArrowWithGeogebraCommonAwtGGraphics2D_(self, g2);
}

- (void)fillWithGeogebraCommonAwtGGraphics2D:(id<GeogebraCommonAwtGGraphics2D>)g2
                                  withDouble:(jdouble)y2
                                  withDouble:(jdouble)x2
                                  withDouble:(jdouble)angle {
  GeogebraCommonEuclidianDrawDrawNyquist_fillWithGeogebraCommonAwtGGraphics2D_withDouble_withDouble_withDouble_(self, g2, y2, x2, angle);
}

+ (jdouble)getAngleWithDouble:(jdouble)x1
                   withDouble:(jdouble)y1
                   withDouble:(jdouble)x2
                   withDouble:(jdouble)y2 {
  return GeogebraCommonEuclidianDrawDrawNyquist_getAngleWithDouble_withDouble_withDouble_withDouble_(x1, y1, x2, y2);
}

- (jboolean)hitWithInt:(jint)x
               withInt:(jint)y
               withInt:(jint)hitThreshold {
  if (!isVisible_ || ![((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(gcf_)) isDefined]) {
    return NO;
  }
  return [((GeogebraCommonEuclidianGeneralPathClipped *) nil_chk(gpP_)) containsWithInt:x withInt:y] || [((GeogebraCommonEuclidianGeneralPathClipped *) nil_chk(gpN_)) containsWithInt:x withInt:y];
}

- (jboolean)isInsideWithGeogebraCommonAwtGRectangle:(id<GeogebraCommonAwtGRectangle>)rect {
  if (!isVisible_ || ![((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(gcf_)) isDefined]) {
    return NO;
  }
  return [((GeogebraCommonEuclidianGeneralPathClipped *) nil_chk(gpP_)) containsWithGeogebraCommonAwtGRectangle:rect] || [((GeogebraCommonEuclidianGeneralPathClipped *) nil_chk(gpN_)) containsWithGeogebraCommonAwtGRectangle:rect];
}

- (GeogebraCommonKernelGeosGeoElement *)getGeoElement {
  return geo_;
}

- (void)setGeoElementWithGeogebraCommonKernelGeosGeoElement:(GeogebraCommonKernelGeosGeoElement *)geo {
  GeogebraCommonEuclidianDrawable_set_geo_(self, geo);
}

- (void)dealloc {
  RELEASE_(gcf_);
  RELEASE_(gpP_);
  RELEASE_(coordsList_);
  RELEASE_(p_);
  RELEASE_(gpN_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [GeogebraCommonEuclidianDrawDrawNyquist class]) {
    GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_L_ = JavaLangMath_toRadiansWithDouble_(135);
    GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_R_ = -GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_L_;
    J2OBJC_SET_INITIALIZED(GeogebraCommonEuclidianDrawDrawNyquist)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithGeogebraCommonEuclidianEuclidianView:withGeogebraCommonKernelGeosGeoTransferFunction:", "DrawNyquist", NULL, 0x1, NULL, NULL },
    { "update", NULL, "V", 0x1, NULL, NULL },
    { "drawWithGeogebraCommonAwtGGraphics2D:", "draw", "V", 0x1, NULL, NULL },
    { "drawArrowWithGeogebraCommonAwtGGraphics2D:", "drawArrow", "V", 0x2, NULL, NULL },
    { "fillWithGeogebraCommonAwtGGraphics2D:withDouble:withDouble:withDouble:", "fill", "V", 0x2, NULL, NULL },
    { "getAngleWithDouble:withDouble:withDouble:withDouble:", "getAngle", "D", 0xa, NULL, NULL },
    { "hitWithInt:withInt:withInt:", "hit", "Z", 0x1, NULL, NULL },
    { "isInsideWithGeogebraCommonAwtGRectangle:", "isInside", "Z", 0x1, NULL, NULL },
    { "getGeoElement", NULL, "Lgeogebra.common.kernel.geos.GeoElement;", 0x1, NULL, NULL },
    { "setGeoElementWithGeogebraCommonKernelGeosGeoElement:", "setGeoElement", "V", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "gcf_", NULL, 0x2, "Lgeogebra.common.kernel.geos.GeoTransferFunction;", NULL, NULL,  },
    { "isVisible_", NULL, 0x2, "Z", NULL, NULL,  },
    { "gpP_", NULL, 0x2, "Lgeogebra.common.euclidian.GeneralPathClipped;", NULL, NULL,  },
    { "coordsList_", NULL, 0x2, "Ljava.util.List;", NULL, "Ljava/util/List<Lgeogebra/common/kernel/Matrix/Coords;>;",  },
    { "p_", NULL, 0x2, "Lgeogebra.common.kernel.Matrix.Coords;", NULL, NULL,  },
    { "yP_", NULL, 0x2, "D", NULL, NULL,  },
    { "xPN_", NULL, 0x2, "D", NULL, NULL,  },
    { "gpN_", NULL, 0x2, "Lgeogebra.common.euclidian.GeneralPathClipped;", NULL, NULL,  },
    { "yN_", NULL, 0x2, "D", NULL, NULL,  },
    { "LEN_", NULL, 0x1a, "D", NULL, NULL, .constantValue.asDouble = GeogebraCommonEuclidianDrawDrawNyquist_LEN },
    { "ANGLE_L_", NULL, 0x1a, "D", &GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_L_, NULL,  },
    { "ANGLE_R_", NULL, 0x1a, "D", &GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_R_, NULL,  },
  };
  static const J2ObjcClassInfo _GeogebraCommonEuclidianDrawDrawNyquist = { 2, "DrawNyquist", "geogebra.common.euclidian.draw", NULL, 0x1, 10, methods, 12, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_GeogebraCommonEuclidianDrawDrawNyquist;
}

@end

void GeogebraCommonEuclidianDrawDrawNyquist_initWithGeogebraCommonEuclidianEuclidianView_withGeogebraCommonKernelGeosGeoTransferFunction_(GeogebraCommonEuclidianDrawDrawNyquist *self, GeogebraCommonEuclidianEuclidianView *view, GeogebraCommonKernelGeosGeoTransferFunction *geo) {
  GeogebraCommonEuclidianDrawable_init(self);
  GeogebraCommonEuclidianDrawDrawNyquist_set_gcf_(self, geo);
  GeogebraCommonEuclidianDrawable_set_geo_(self, geo);
  GeogebraCommonEuclidianDrawable_set_view_(self, view);
  GeogebraCommonEuclidianDrawable_set_labelDesc_(self, [((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(geo)) getLabelSimple]);
  GeogebraCommonEuclidianDrawDrawNyquist_set_coordsList_(self, [((GeogebraCommonKernelGeosGeoTransferFunction *) nil_chk(self->gcf_)) getCoordsList]);
  [self update];
}

GeogebraCommonEuclidianDrawDrawNyquist *new_GeogebraCommonEuclidianDrawDrawNyquist_initWithGeogebraCommonEuclidianEuclidianView_withGeogebraCommonKernelGeosGeoTransferFunction_(GeogebraCommonEuclidianEuclidianView *view, GeogebraCommonKernelGeosGeoTransferFunction *geo) {
  GeogebraCommonEuclidianDrawDrawNyquist *self = [GeogebraCommonEuclidianDrawDrawNyquist alloc];
  GeogebraCommonEuclidianDrawDrawNyquist_initWithGeogebraCommonEuclidianEuclidianView_withGeogebraCommonKernelGeosGeoTransferFunction_(self, view, geo);
  return self;
}

void GeogebraCommonEuclidianDrawDrawNyquist_drawArrowWithGeogebraCommonAwtGGraphics2D_(GeogebraCommonEuclidianDrawDrawNyquist *self, id<GeogebraCommonAwtGGraphics2D> g2) {
  jint i = J2ObjCFpToInt(([((id<JavaUtilList>) nil_chk(self->coordsList_)) size] / 2.3));
  jdouble x1 = [((GeogebraCommonEuclidianEuclidianView *) nil_chk(self->view_)) toScreenCoordXdWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i])) getX]];
  jdouble y1 = [self->view_ toScreenCoordYdWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i])) getY]];
  jdouble y2 = [self->view_ toScreenCoordYdWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i - 1])) getY]];
  jdouble x2 = [self->view_ toScreenCoordXdWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i - 1])) getX]];
  jdouble angle = GeogebraCommonEuclidianDrawDrawNyquist_getAngleWithDouble_withDouble_withDouble_withDouble_(x1, y1, x2, y2);
  GeogebraCommonAwtGColor *color = [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(g2)) getColor];
  [g2 setColorWithGeogebraCommonAwtGColor:GeogebraCommonAwtGColor_get_blue_()];
  GeogebraCommonEuclidianDrawDrawNyquist_fillWithGeogebraCommonAwtGGraphics2D_withDouble_withDouble_withDouble_(self, g2, y2, x2, angle);
  y1 = [self->view_ toScreenCoordYdWithDouble:-[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i])) getY]];
  y2 = [self->view_ toScreenCoordYdWithDouble:-[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i + 1])) getY]];
  x2 = [self->view_ toScreenCoordXdWithDouble:[((GeogebraCommonKernelMatrixCoords *) nil_chk([self->coordsList_ getWithInt:i + 1])) getX]];
  angle = GeogebraCommonEuclidianDrawDrawNyquist_getAngleWithDouble_withDouble_withDouble_withDouble_(x1, y1, x2, y2);
  GeogebraCommonEuclidianDrawDrawNyquist_fillWithGeogebraCommonAwtGGraphics2D_withDouble_withDouble_withDouble_(self, g2, y2, x2, angle);
  [g2 setColorWithGeogebraCommonAwtGColor:color];
}

void GeogebraCommonEuclidianDrawDrawNyquist_fillWithGeogebraCommonAwtGGraphics2D_withDouble_withDouble_withDouble_(GeogebraCommonEuclidianDrawDrawNyquist *self, id<GeogebraCommonAwtGGraphics2D> g2, jdouble y2, jdouble x2, jdouble angle) {
  GeogebraCommonEuclidianGeneralPathClipped *arrow = [new_GeogebraCommonEuclidianGeneralPathClipped_initWithGeogebraCommonEuclidianEuclidianViewInterfaceSlim_(self->view_) autorelease];
  [arrow moveToWithDouble:x2 withDouble:y2];
  [arrow lineToWithDouble:x2 + GeogebraCommonEuclidianDrawDrawNyquist_LEN * JavaLangMath_cosWithDouble_(angle + GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_L_) withDouble:y2 + GeogebraCommonEuclidianDrawDrawNyquist_LEN * JavaLangMath_sinWithDouble_(angle + GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_L_)];
  [arrow lineToWithDouble:x2 + GeogebraCommonEuclidianDrawDrawNyquist_LEN * JavaLangMath_cosWithDouble_(angle + GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_R_) withDouble:y2 + GeogebraCommonEuclidianDrawDrawNyquist_LEN * JavaLangMath_sinWithDouble_(angle + GeogebraCommonEuclidianDrawDrawNyquist_ANGLE_R_)];
  [arrow closePath];
  [((id<GeogebraCommonAwtGGraphics2D>) nil_chk(g2)) fillWithGeogebraCommonAwtGShape:arrow];
}

jdouble GeogebraCommonEuclidianDrawDrawNyquist_getAngleWithDouble_withDouble_withDouble_withDouble_(jdouble x1, jdouble y1, jdouble x2, jdouble y2) {
  GeogebraCommonEuclidianDrawDrawNyquist_initialize();
  jdouble m = (y2 - y1) / (x2 - x1);
  if (x2 - x1 < 0 && y2 - y1 < 0) {
    return JavaLangMath_atanWithDouble_(m) + JavaLangMath_PI;
  }
  else if (x2 - x1 < 0 && y2 - y1 >= 0) {
    return JavaLangMath_atanWithDouble_(m) + JavaLangMath_PI;
  }
  else if (x2 - x1 >= 0 && y2 - y1 < 0) {
    return 2 * JavaLangMath_PI + JavaLangMath_atanWithDouble_(m);
  }
  else if (x2 - x1 >= 0 && y2 - y1 >= 0) {
    return JavaLangMath_atanWithDouble_(m);
  }
  return 0;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(GeogebraCommonEuclidianDrawDrawNyquist)
